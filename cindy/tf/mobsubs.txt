; mobsubs.tf

; Mob substitutions. Used to get a clearer name of the mob, to directly see
; some useful info on the mob, and to autoattack suitable mobs if you are
; leading a group.
; * To get the subs, you must have: "/set mobsubs 1"
; * In some situations you need to know the name of the area you are in. If
;   you don't have an area-variable, best is to add: "/set area unknown"
; * To skip autoattacks and only have substitutions, remove the alias
;   attackIfLeaderEtc and replace with the line:
;   "/alias attackIfLeaderEtc /set slask 0"
; * For a small alias to show standard-irv:s on different mob types (troll,
;   canine, botanic,...), check the alias "irv".
; * The first lines can be skipped (they remove spam when reloading this file)

/purge tfMobsubst*
/unaliasSilent attackIfLeaderEtc
/unaliasSilent mobs
/unaliasSilent mobsubs
/unaliasSilent irv


/alias mobs /load mobsubs.tf

/alias mobsubs \
    /if ({*} =~ '1' | {*} =~ 'on') \
      /tfshow Ok. MobSubs mode is ON.%; \
      /set mobsubs 1%; \
    /elseif ({*} =~ '0' | {*} =~ 'off') \
      /tfshow Ok. MobSubs mode is OFF.%; \
      /set mobsubs 0%; \
    /else \
      /tfshow MobSubs 0 or 1?%; \
    /endif

/def -F -mregexp -t"^([A-z]+) (asks|tells) you '(wellinfo|mobsubs|subs)[ ]*([^']*)'$" tfMobsubstSwitch = \
    /if (classRo == 2) \
      /if ({P4} =~ 'off' | {P4} =~ '0') \
        mobsubs 0%; \
        tell %{P1} Mobsubs off%; \
      /elseif ({P4} =~ 'on' | {P4} =~ '1' | {P4} =~ '') \
        mobsubs 1%; \
        tell %{P1} Mobsubs on%; \
      /else \
        tell %P1 Mobsubs on or off?%; \
      /endif%; \
    /endif

/alias attackIfLeaderEtc \
    /if (groupleader =~ name & initiator =~ 'none' & autoattack & (vuln =~ {2} | {2} =~ 'none') & mobsinroom == 0 & !fighting) \
      /set mobsinroom 1%; \
      /if ((classRo | classNb) & area !~ 'CohnShar' & area !~ 'Laboratory' & area !~ 'DragontailIsle' & area !~ 'Guallidurth' & (area !~ 'Alterac' | ({1} !~ 'gatekeeper' & {1} !~ 'mercenary' & {1} !~ 'counsellor' & {1} !~ 'waywatcher'))) \
        /if (classRo) \
          backstab %{1}%; \
        /else \
          assassinate %{1}%; \
        /endif%; \
      /else \
        ki %{1}%; \
      /endif%; \
    /endif


; irv <empty>: Shows list of creature types
; irv <type>:  Shows irv for that type
; irv <mob>:   Shows data on a specific mob (must be in the area, and doesn't work for all mobs)
/alias irv \
    /let slask=$[tolower({*})]%; \
    /if (slask =~ '') \
      /tfshow Options: Amphibian, Animal, Astral, Beholder, Bird, Botanic, Canine, Demon, Devil, Dinosaur, Dragon, Drow-elf, Dwarf, Elemental, Elf, Entity, Fairie, Feline, Fish, Giant, Gnome, Goblin, Half-elf, Half-orc, Hobbit, Human, Insubstantial, Jelly, Ktv, Lizardman, Lugroki, Magical, Mythical, Orc, Reptile, Rodent, Skeleton, Snake, Spider, Troll, Undead, Vampire%; \
    /elseif (slask =~ 'amphibian') \
      /tfshow Amphibian: Vuln ---, Immune ---, Resist water%; \
    /elseif ({*} =~ 'animal') \
      /tfshow Animal: Vuln mental/gas, Immune ---, Resist earth%; \
    /elseif ({*} =~ 'astral') \
      /tfshow Astral: Vuln ---, Immune ---, Resist Pure/Light/Unlife/Dark%; \
    /elseif ({*} =~ 'beholder') \
      /tfshow Beholder: Vuln Light, Immune ---, Resist Dark/Magic%; \
    /elseif ({*} =~ 'bird') \
      /tfshow Bird: Vuln Air, Immune Earth, Resist ---%; \
    /elseif ({*} =~ 'botanic') \
      /tfshow Botanic: Vuln Acid, Immune Air/Gas/Light/Dark, Resist ---%; \
    /elseif ({*} =~ 'canine') \
      /tfshow Canine: Vuln Mental, Immune ---, Resist Dark%; \
    /elseif ({*} =~ 'demon') \
      /tfshow Demon: Vuln Pure/Light/Iron, Immune Fire, Resist Dark/Unlife/Poison%; \
    /elseif ({*} =~ 'devil') \
      /tfshow Devil: Vuln Pure/Light/Iron, Immune Fire, Resist Dark/Unlife/Poison%; \
    /elseif ({*} =~ 'dinosaur') \
      /tfshow Dinosaur: Vuln Fire, Immune ---, Resist ---%; \
    /elseif ({*} =~ 'dragon') \
      /tfshow Dragon: Vuln ---, Immune ---, Resist Fire/Ice/Earth/Air/Gas%; \
    /elseif ({*} =~ 'drow' | {*} =~ 'drow-elf' | {*} =~ 'drowelf') \
      /tfshow Drow-elf: Vuln Pure/Light/Ice, Immune ---, Resist Unlife/Dark/Magic%; \
    /elseif ({*} =~ 'dwarf') \
      /tfshow Dwarf: Vuln SLarge/Water/Magic, Immune ---, Resist Fire/Earth/Poison%; \
    /elseif ({*} =~ 'elemental') \
      /tfshow Elemental: Vuln ---, Immune ---, Resist Light/Dark%; \
    /elseif ({*} =~ 'elf') \
      /tfshow Elf: Vuln Unlife/Dark/Iron, Immune ---, Resist Magic/Light/Pure%; \
    /elseif ({*} =~ 'entity') \
      /tfshow Entity: Vuln ---, Immune ---, Resist Fire/Ice/Unlife/Earth/Air%; \
    /elseif ({*} =~ 'fairie') \
      /tfshow Fairie: Vuln Unlife/Dark, Immune Pure/Light, Resist Magic%; \
    /elseif ({*} =~ 'feline') \
      /tfshow Feline: Vuln Mental, Immune ---, Resist Dark%; \
    /elseif ({*} =~ 'fish') \
      /tfshow Fish: Vuln ---, Immune Water, Resist ---%; \
    /elseif ({*} =~ 'giant') \
      /tfshow Giant: Vuln ---, Immune ---, Resist Crush/Large/SLarge/Poison%; \
    /elseif ({*} =~ 'gnome') \
      /tfshow Gnome: Vuln Large/SLarge, Immune ---, Resist Mental%; \
    /elseif ({*} =~ 'goblin') \
      /tfshow Goblin: Vuln Fire/Large/SLarge/Light, Immune ---, Resist Dark/Gas/Poison%; \
    /elseif ({*} =~ 'half-elf' | {*} =~ 'halfelf') \
      /tfshow Half-elf: Vuln Unlife, Immune ---, Resist Light%; \
    /elseif ({*} =~ 'half-orc' | {*} =~ 'halforc') \
      /tfshow Half-orc: Vuln Light, Immune ---, Resist Dark%; \
    /elseif ({*} =~ 'hobbit') \
      /tfshow Hobbit: Vuln Large/SLarge/Air/Gas, Immune ---, Resist Unlife/Poison/Mental%; \
    /elseif ({*} =~ 'human') \
      /tfshow Human: Vuln ---, Immune ---, Resist ---%; \
    /elseif ({*} =~ 'insect') \
      /tfshow Insect: Vuln Gas, Immune ---, Resist ---%; \
    /elseif ({*} =~ 'insubstantial') \
      /tfshow Insubstantial: Vuln Energy, Immune Unlife, Resist Weapon%; \
    /elseif ({*} =~ 'jelly') \
      /tfshow Jelly: Vuln ---, Immune ---, Resist Weapon%; \
    /elseif ({*} =~ 'ktv') \
      /tfshow Ktv: Vuln ---, Immune ---, Resist Gas/Poison/Energy/Mental%; \
    /elseif ({*} =~ 'lizardman') \
      /tfshow Lizardman: Vuln Fire/Ice, Immune ---, Resist Electricity/Water%; \
    /elseif ({*} =~ 'lugroki') \
      /tfshow Lugroki: Vuln Pure/Light/Fire, Immune ---, Resist Ice/Dark/Poison%; \
    /elseif ({*} =~ 'magical') \
      /tfshow Magical: Vuln Unlife, Immune ---, Resist Magic/Energy%; \
    /elseif ({*} =~ 'mythical') \
      /tfshow Mythical: Vuln ---, Immune ---, Resist Fire/Ice/Unlife/Earth/Air%; \
    /elseif ({*} =~ 'orc') \
      /tfshow Orc: Vuln Fire/Light/Pure, Immune ---, Resist Ice/Poison/Dark%; \
    /elseif ({*} =~ 'reptile') \
      /tfshow Reptile: Vuln Ice/Fire, Immune ---, Resist Water%; \
    /elseif ({*} =~ 'rodent') \
      /tfshow Rodent: Vuln Gas/Poison, Immune ---, Resist Dark%; \
    /elseif ({*} =~ 'skeleton') \
      /tfshow Skeleton: Vuln ---, Immune ---, Resist Pierce/Slash%; \
    /elseif ({*} =~ 'snake') \
      /tfshow Snake: Vuln ---, Immune Poison, Resist ---%; \
    /elseif ({*} =~ 'spider') \
      /tfshow Spider: Vuln Fire, Immune Poison, Resist ---%; \
    /elseif ({*} =~ 'troll') \
      /tfshow Troll: Vuln Fire/Acid/Mental, Immune ---, Resist Earth/Poison/Crush%; \
    /elseif ({*} =~ 'undead') \
      /tfshow Undead: Vuln Pure/Light/Silver/Heal, Immune Unlife/Dark, Resist Earth/Water/Air/Mental%; \
    /elseif ({*} =~ 'vampire') \
      /tfshow Vampire: Vuln Pure/Light/Silver/Wood, Immune Unlife/Dark, Resist Crush%; \
    /else \
      whe %{*}%; \
      /eval /set mobCapital=$[strcat(toupper(substr({*}, 0, 1)), tolower(substr({*}, 1)))]%; \
      /purge irvMobCheck*%; \
      /def -F -mregexp -t"^No-one around by that name\\.$$" irvMobCheckNoneAround = \
        /substitute -p @{BCbgblue}IRV:@{n} %{*}: No-one around by that name.%%; \
        /purge irvMobCheck*%; \
      /def -F -mregexp -t"^In your dreams, or what?$$" irvMobCheckSleeping = \
        /substitute -p @{BCbgblue}IRV:@{n} %{*}: In your dreams, or what?%%; \
        /purge irvMobCheck*%; \
      /def -F -p999999 -mregexp -t"(%{*}|%{mobCapital}) ([^-]*) - " irvMobCheckFound = \
        /set mobToCheck %%{P1} %%{P2}%%; \
        /substitute -p @{BCbgblue}IRV:@{n} %%{PL}%%{mobToCheck} is here%%; \
        /purge irvMobCheck*%; \
    /endif



; -----------------------  Pets  -----------------------
/def -p99 -F -mregexp -t"A menacing adult wolf stands here, watching over its keeper." tfMobsubstPetsWolf = \
    /if (mobsubs) \
      /substitute -p @{nCcyan}Animist Wolf is here.@{n}%; \
    /endif
/def -p99 -F -mregexp -t"^An elemental creature formed from rock is held here by magic\." tfMobsubstPetsEarthElem = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCcyan}Animist Earth Elemental@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"^The shape of an elemental is here emerging from a pool of water\." tfMobsubstPetsWaterElem = \
    /if (mobsubs) \
      /substitute -p @{nCcyan}Animist Water Elemental@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"^The air magically swirls around, forming the shape of an elemental\." tfMobsubstPetsAirElem = \
    /if (mobsubs) \
      /substitute -p @{nCcyan}Animist Air Elemental@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"^A mythical bird, reborn from flames, awaits its keeper's instruction\." tfMobsubstPetsPhoenix = \
    /if (mobsubs) \
      /substitute -p @{nCcyan}Animist Phoenix@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"^A ghoulish spectre drifts around, controlled by magic\." tfMobsubstPetsSpectre = \
    /if (mobsubs) \
      /substitute -p @{nCcyan}Priest Spectre@{n}%{PR}%; \
    /endif

; -----------------------  3 mages  -----------------------
/def -p99 -F -mregexp -t"(A homeless Bum sits in his own misery\.|The homeless bum is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubst3magesBum = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The homeless bum @{Cgreen}(@{hCwhite}G@{nCgreen}, 10, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A large Rat is here looking for food\. \(hidden\)|A large Rat \(hidden\) is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubst3magesRat = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A large Rat @{Cgreen}(@{hCwhite}G@{nCgreen}, 20, animal)@{n} (hide)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The living one can do nothing but blow bubbles here, and perhaps fight\.|The living one is here)(, fighting [^\.!]+.|)" tfMobsubst3magesLivingOne = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The living one @{Cgreen}(N, 20/25/30/35/40, entity)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(You see Fantus, the Good Mages pet fire drake lying here\.|Fantus is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubst3magesFantus = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Fantus @{Cgreen}(@{hCwhite}G@{nCgreen}, 35, dragon)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(You see a large bat hanging from a rack\.|Henry the Bat is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubst3magesHenry = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Henry the Bat @{Cgreen}(@{hCwhite}G@{nCgreen}, 35, bird)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The lesser demon scurries about here\. \(invisible\)|A Lesser Demon \(invisible\) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubst3magesLesserDemon = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Lesser Demon @{Cgreen}(@{nCred}E@{nCgreen}, 35, demon)@{n} (imp)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Wild Wight screams horribly here\.|A wild wight is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubst3magesWildWight = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A wild wight @{Cgreen}(@{nCred}E@{nCgreen}, 35, undead)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Yugaloth stands here guarding against all\.|A Yugaloth is here)(, fighting [^\.!]+.|)" tfMobsubst3magesYugaloth = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Yugaloth @{Cgreen}(N, 45, magical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A mage in white robes stands here\. \(invisible\)|The Good Mage \(invisible\) is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubst3magesGoodMage = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Good Mage @{Cgreen}(@{hCwhite}G@{nCgreen}, 50, human)@{n} (imp)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Skeletal Warrior stands here guarding the grove\.|The skeletal warrior is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubst3magesSkeletalWarrior = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The skeletal warrior @{Cgreen}(@{nCred}E@{nCgreen}, 55, undead, immune pierce)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Mage that keeps the Balance is standing here\. \(invisible\)|The Neutral Mage \(invisible\) is here)(, fighting [^\.!]+.|)" tfMobsubst3magesNeutralMage = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Neutral Mage @{Cgreen}(N, 60, human)@{n} (imp)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"The Shopkeeper eyes you warily." tfMobsubst3magesShopkeeper = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Shopkeeper @{Cgreen}(N, 70, shopkeeper)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An Evil Mage stand before you\. \(invisible\)|The Evil Mage \(invisible\) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubst3magesEvilMage = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Evil Mage @{Cgreen}(@{nCred}E@{nCgreen}, 75, human, deathspell)@{n} (imp)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Lahrohn the former hero \(invisible\)|Lahrohn \(invisible\) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubst3magesLahrohn = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Lahrohn @{Cgreen}(@{nCred}E@{nCgreen}, 75, undead)@{n} (imp)%{P2}%{PR}%; \
    /endif

; -----------------------  3 of swords  -----------------------
/def -p99 -F -mregexp -t"(A horse does horsely things here\.|The Horse is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubst3ofSwordsHorse = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Horse @{Cgreen}(@{hCwhite}G@{nCgreen}, 5, ---)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A waiter rushes by, intent on his business\.|A waiter is here)(, fighting [^\.!]+.|)" tfMobsubst3ofSwordsWaiter = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A waiter @{Cgreen}(N, 5, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A waitress rushes by, intent on her business\.|A waitress is here)(, fighting [^\.!]+.|)" tfMobsubst3ofSwordsWaitress = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A waitress @{Cgreen}(N, 5, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A slave here is mining out a new passageway\.|The slave is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubst3ofSwordsSlave = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The slave @{Cgreen}(@{hCwhite}G@{nCgreen}, 6, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A farmer walks around, looking for something to do\.|The Farmer is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubst3ofSwordsFarmer = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Farmer @{Cgreen}(@{hCwhite}G@{nCgreen}, 7, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An aged innkeeper greets you as you enter\.|The innkeeper is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubst3ofSwordsInnkeeper = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The innkeeper @{Cgreen}(@{hCwhite}G@{nCgreen}, 10, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A hunter walks through the town streets on his own time\.|The hunter is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubst3ofSwordsHunter = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The hunter @{Cgreen}(@{hCwhite}G@{nCgreen}, 11, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"A receptionist offers you a room.( \(White Aura\)|)" tfMobsubst3ofSwordsReceptionist = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Receptionist @{Cgreen}(@{hCwhite}G@{nCgreen}, 12, no-attack)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"A bartender washes a glass idly here.( \(White Aura\)|)" tfMobsubst3ofSwordsBartender = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A bartender @{Cgreen}(@{hCwhite}G@{nCgreen}, 15, shopkeeper)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A woman ignores you completely, so intent is she upon her sword\.|Salle is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubst3ofSwordsSalle = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Salle @{Cgreen}(@{nCred}E@{nCgreen}, 15, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A bandit springs into action upon seeing you\.|The bandit is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubst3ofSwordsBandit = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The bandit @{Cgreen}(@{nCred}E@{nCgreen}, 16, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Cyclops is here, trying to judge range with no depth perception\.|The Cyclops is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubst3ofSwordsCyclops = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Cyclops @{Cgreen}(@{nCred}E@{nCgreen}, 16, giant)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A bandit guard stands at attention here\.|The bandit guard is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubst3ofSwordsBanditGuard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The bandit guard @{Cgreen}(@{nCred}E@{nCgreen}, 18, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A cowgirl stand here ready to defend her horses\.\.\. \(hidden\)|The Cowgirl \(hidden\) is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubst3ofSwordsCowgirl = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Cowgirl @{Cgreen}(@{hCwhite}G@{nCgreen}, 20, human)@{n} (hide)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A farmer's wife offers you some vegetables\.|The Farmer's Wife is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubst3ofSwordsFarmersWife = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Farmer's Wife @{Cgreen}(@{hCwhite}G@{nCgreen}, 20, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"A bored storekeeper waits for you to do something.( \(White Aura\)|)" tfMobsubst3ofSwordsStorekeeper = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Storekeeper @{Cgreen}(@{hCwhite}G@{nCgreen}, 20, shopkeeper)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A truly immense man laughs at you, and draws his knife!|Duwick is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubst3ofSwordsDuwick = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Duwick @{Cgreen}(@{nCred}E@{nCgreen}, 22, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Dragon Prince, Aglandiir, sits here looking at you curiously\.|Aglandiir is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubst3ofSwordsAglandiir = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Aglandiir @{Cgreen}(@{hCwhite}G@{nCgreen}, 30, dragon)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Abandoned Caves  -----------------------
/def -p99 -F -mregexp -t"(An ugly orc stands here\.|The orc is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstAbandonedCavesOrc = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The orc @{Cgreen}(@{nCred}E@{nCgreen}, 55, orc)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Far'nachtar the second in command stands here\.|Far'nachtar the orc is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstAbandonedCavesFarnachtar = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Far'nachtar the orc @{Cgreen}(@{nCred}E@{nCgreen}, 58, orc)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Mor'balach the orc leader stands here\.|Mor'balach the orc leader is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstAbandonedCavesMorbalach = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Mor'balach the orc leader @{Cgreen}(@{nCred}E@{nCgreen}, 70, orc)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A pale blue humanoid with a fish-like head stands here\.|The deep one is here)(, fighting [^\.!]+.|)" tfMobsubstAbandonedCavesDeepOne = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The deep one @{Cgreen}(N, 75, ---)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A huge winged creature flies around here\.|The hunting horror is here)(, fighting [^\.!]+.|)" tfMobsubstAbandonedCavesHuntingHorror = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The hunting horror @{Cgreen}(N, 75, entity)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Something is lurking in the shadows here\.|The star spawn is here)(, fighting [^\.!]+.|)" tfMobsubstAbandonedCavesStarSpawn = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The star spawn @{Cgreen}(N, 80, entity)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A proto shoggoth is standing here, guarding the perimeter\.|The proto shoggoth is here)(, fighting [^\.!]+.|)" tfMobsubstAbandonedCavesProtoShoggoth = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The proto shoggoth @{Cgreen}(N, 85, entity)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The black goat with a thousand young stands here\.|Shub-Niggurath is here)" tfMobsubstAbandonedCavesShubNiggurath = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Shub-Niggurath @{Cgreen}(N, 100, entity)@{n}%{PR}%; \
    /endif

; -----------------------  Alchor  -----------------------
/def -p99 -F -mregexp -t"(A lindskiarn is standing silently here\.|A lindskiarn is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstAlchorLindskiarn = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A lindskiarn @{Cgreen}(@{nCred}E@{nCgreen}, 36/40/45, magical/poison/silver)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A lindskiarn artist is sitting here\.|A lindskiarn artist is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstAlchorArtist = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A lindskiarn artist @{Cgreen}(@{nCred}E@{nCgreen}, 55, magical/poison/silver)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A crazed elven mage is here, screaming strange sounds at you\.|A crazed elven mage is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstAlchorCrazedMage = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A crazed elven mage @{Cgreen}(@{hCwhite}G@{nCgreen}, 60, elf, resist WEAPON)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A mighty lindskiarn warchief is standing here looking upset\.|A lindskiarn warchief is here)" tfMobsubstAlchorWarchief = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A lindskiarn warchief @{Cgreen}(N, 76, magical)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"The Duchess of Alchor sits here sobbing quietly.( \(White Aura\)|)" tfMobsubstAlchorDuchess = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Duchess of Alchor @{Cgreen}(@{hCwhite}G@{nCgreen}, 99, QM)@{n}%{PR}%; \
    /endif

; -----------------------  Alterac  -----------------------
/def -p99 -F -mregexp -t"(A creature of the night is slowly being tortured to death|A doomed lugroki prisoner is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstAlteracDoomedLugrokiPrisoner = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A doomed lugroki prisoner @{Cgreen}(@{nCred}E@{nCgreen}, 50, lugroki)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Gatekeeper of the stronghold stands here proudly|The Gatekeeper of Alterac is here)" tfMobsubstAlteracGKeeper = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Gatekeeper of Alterac @{Cgreen}(N, 60, human)@{n}%{PR}%; \
    /endif%; \
    attackIfLeaderEtc gatekeeper none
/def -p99 -F -mregexp -t"A female peasant is busy working here(  \(White Aura\)|)" tfMobsubstAlteracWorkerF = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A peasant worker (female) @{Cgreen}(@{hCwhite}G@{nCgreen}, 65, human)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"A healthy peasant toils for the Alliance here( \(White Aura\)|)" tfMobsubstAlteracWorkerM = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A peasant worker (male) @{Cgreen}(@{hCwhite}G@{nCgreen}, 65, human)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"A peasant worker is here(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstAlteracWorkerFM = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A peasant worker (female/male) @{Cgreen}(@{hCwhite}G@{nCgreen}, 65, human)@{n}%{P1}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A trader from the northern lands barters here|A merchant of the north is here)" tfMobsubstAlteracMerchN = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A merchant of the north @{Cgreen}(N, 68, human)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"An Alterac custodian holds a position of great responsibility here" tfMobsubstAlteracCustGuard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Prison guard (custodian) @{Cgreen}(N, 70, human)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"A guard of the detention complex has been stationed here" tfMobsubstAlteracDetGuard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Prison guard (detention) @{Cgreen}(N, 70, human)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"A Prison guard is here" tfMobsubstAlteracCustDetGuard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Prison guard (custodian/detention) @{Cgreen}(N, 70, human)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"A Brettonian guard relaxes here whilst off duty.( \(White Aura\)|)" tfMobsubstAlteracBrGuardRel = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Brettonian Guard (relaxes) @{Cgreen}(@{hCwhite}G@{nCgreen}, 78, human)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"A Brettonian Guard is here(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstAlteracBrGuardDefRel = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Brettonian Guard (defends/relaxes) @{Cgreen}(@{hCwhite}G@{nCgreen}, 78, human)@{n}%{P1}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Bretonnian guardsman is here patrolling the compound\.|A Brettonian guardsman is here)" tfMobsubstAlteracBrGMan = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Brettonian guardsman @{Cgreen}(N, 79, human)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A counsellor of the Alliance is in discussion here|An Alliance counsellor is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstAlteracCouns = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An Alliance counsellor @{Cgreen}(@{hCwhite}G@{nCgreen}, 80, human)@{n}%{P2}%{PR}%; \
    /endif%; \
    attackIfLeaderEtc counsellor slayhuman
/def -p99 -F -mregexp -t"(A weary Bretonnian soldier recuperates from the strains of battle here\.|A Brettonian man-at-arms is here)" tfMobsubstAlteracBrMaA = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Brettonian man-at-arms @{Cgreen}(N, 80, human)@{n}%{PR}%; \
    /endif%; \
    attackIfLeaderEtc man-at-arms slayhuman
/def -p99 -F -mregexp -t"(An elven ranger scouts the surrounding hinterland|An Elven waywatcher is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstAlteracWayw = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An Elven waywatcher @{Cgreen}(@{hCwhite}G@{nCgreen}, 80, elf)@{n}%{P2}%{PR}%; \
    /endif%; \
    attackIfLeaderEtc waywatcher unlife
/def -p99 -F -msimple -t"An Elven waywatcher is dead! R.I.P." tfMobsubstAlteracRIPWayw = \
    /if (groupleader =~ name & initiator =~ 'none' & autoattack) \
      k waywatcher%; \
    /endif
/def -p99 -F -mregexp -t"(A lieutenant of the high command oversees proceedings|A lieutenant of the Brettonian High Command is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstAlteracBrLieu = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A lieutenant of the Brettonian High Command @{Cgreen}(@{hCwhite}G@{nCgreen}, 80, human/pierce/crush)@{n}%{P2}%{PR}%; \
    /endif%; \
    attackIfLeaderEtc lieutenant slayhuman
/def -p99 -F -mregexp -t"(A member of the Alterac high command opposes you|A captain of the Brettonian High Command is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstAlteracBrCap = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A captain of the Brettonian High Command @{Cgreen}(@{hCwhite}G@{nCgreen}, 82, human/slash)@{n}%{P2}%{PR}%; \
    /endif%; \
    attackIfLeaderEtc captain slayhuman
/def -p99 -F -mregexp -t"(A wild lugroki has been captured and placed here|A lugroki prisoner is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstAlteracLugrokiPrisoner = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A lugroki prisoner @{Cgreen}(@{nCred}E@{nCgreen}, 83, lugroki)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An adventurer of the realm is killing some time here \(invisible\)|A soldier of fortune waits here for direction \(invisible\)|An Ofcol mercenary \(invisible\) is here)(, fighting [^\.!]+.|)" tfMobsubstAlteracMerc = \
    /if (mobsubs) \
      /if ({P1} =~ 'An adventurer of the realm is killing some time here (invisible)') \
        /substitute -p %{PL}@{nCyellow}An Ofcol mercenary (advent.) @{Cgreen}(N, 83, human)@{n} (imp)%{P2}%{PR}%; \
        attackIfLeaderEtc mercenary slayhuman%; \
      /elseif ({P1} =~ 'A soldier of fortune waits here for direction (invisible)') \
        /substitute -p %{PL}@{nCyellow}An Ofcol mercenary (soldier) @{Cgreen}(N, 83, human)@{n} (imp)%{P2}%{PR}%; \
        attackIfLeaderEtc mercenary slayhuman%; \
      /else \
        /substitute -p %{PL}@{nCyellow}An Ofcol mercenary (advent./soldier) @{Cgreen}(N, 83, human)@{n} (imp)%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(A savage lugroki is here prowling the cell\.|A lugroki berserker is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstAlteracLugrokiBerserker = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A lugroki berserker @{Cgreen}(@{nCred}E@{nCgreen}, 84, lugroki, murder)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A hero of the Alliance stands on full alert|A Champion of Alterac is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstAlteracChamp = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Champion of Alterac @{Cgreen}(@{hCwhite}G@{nCgreen}, 90, fire, immune slash/pierce)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The leader of a band of mercenaries ponders the final battle \(invisible\)|The Ofcol Condottiere \(invisible\) is here)(, fighting [^\.!]+.|)" tfMobsubstAlteracCondot = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Ofcol Condottiere @{Cgreen}(N, 91, human, nasty irvs and mana shield)@{n} (imp)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A practicioner of pain waits for his next victim|Giran the Torture Lord is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstAlteracGiran = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Giran the Torture Lord @{Cgreen}(@{nCred}E@{nCgreen}, 92, human/stun, pkill)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A lord of another continent awaits Alliance resolve|The Lord of Sundhaven is here)" tfMobsubstAlteracLord = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Lord of Sundhaven @{Cgreen}(N, 94, human/fire)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The High Commander of Alterac ponders Alliance tactics|Vabal the Brettonian High Commander is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstAlteracVabal = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Vabal the Brettonian High Commander @{Cgreen}(@{hCwhite}G@{nCgreen}, 95, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"The gatekeeper to the battlefield gatehouse looms above you." tfMobsubstAlteracBFGateK = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The battlefield gatekeeper @{Cgreen}(N, 99, no-attack)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"The strangest of men confronts you and says 'hhgool insq monegfo\?'" tfMobsubstAlteracWakin = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Old Mr Wakinesse @{Cgreen}(N, 100, shopkeeper)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"A sexy young temptress offers you all you could ever desire( \(WHite Aura\)|)" tfMobsubstAlteracOnions = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The sexy young onion saleswoman @{Cgreen}(@{hCwhite}G@{nCgreen}, 100, shopkeeper)@{n}%{PR}%; \
    /endif

; ----- Malius -----
/def -p99 -F -mregexp -t"(A devious drow-elf masquerades as an Alliance ranger\.|Malius is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstAlteracMalius = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Malius @{Cgreen}(@{nCred}E@{nCgreen}, 100, pure/light/earth, specials)@{n}%{P2}%{PR}%; \
      /def -p99 -F -n1 -ag -mregexp -t"...shrouded in a veil of deep red light!" tfMobsubstAlteracMaliusGag%; \
    /endif

/def -p99 -F -mregexp -t"A female peasant is busy at work here( \(White Aura\)|)" tfMobsubstAlteracMaliusPeasant = \
    /if (mobsubs) \
      /substitute -p %{PL}@{hCyellow}MALIUS!!! (A peasant worker) @{Cgreen}(@{hCwhite}G@{nCgreen}, 65, human)@{n}%{PR}%; \
    /else \
      /substitute -p %{PL}@{hCyellow}MALIUS!!! (A female peasant is busy at work here)%{PR}%; \
    /endif%; \
    point peasant

/def -p99 -F -mregexp -t"(A merchant has stopped here briefly to trade|A travelling merchant is here)( goods|)" tfMobsubstAlteracMaliusMerchant = \
    /if ({P2} =~ ' goods') \
      /if (mobsubs) \
        /substitute -p %{PL}@{hCyellow}MALIUS!!! (A travelling merchant) @{Cgreen}(@{n}N@{h}, 67, human)@{n}%{PR}%; \
      /else \
        /substitute -p %{PL}@{hCyellow}MALIUS!!! (A merchant has stopped here briefly to trade goods)%{PR}%; \
      /endif%; \
      point merchant%; \
    /else \
      /if (mobsubs) \
        /substitute -p %{PL}@{nCyellow}A travelling merchant @{Cgreen}(N, 67, human)@{n}%{PR}%; \
      /endif%; \
    /endif

/def -p99 -F -mregexp -t"A guard of Alterac defends the sanctity of his homeland(s here|)( \(White Aura\)|)" tfMobsubstAlteracMaliusGuard = \
    /if ({P1} =~ '') \
      /if (mobsubs) \
        /substitute -p %{PL}@{hCyellow}MALIUS!!! (A Brettonian Guard) @{Cgreen}(@{hCwhite}G@{hCgreen}, 78, human)@{n}%{PR}%; \
      /else \
        /substitute -p %{PL}@{hCyellow}MALIUS!!! (A guard of Alterac defends the sanctity of his homeland)%{PR}%; \
      /endif%; \
      point guard%; \
    /else \
      /if (mobsubs) \
        /substitute -p %{PL}@{nCyellow}A Brettonian Guard (defends) @{Cgreen}(@{hCwhite}G@{nCgreen}, 78, human)@{n}%{PR}%; \
      /endif%; \
    /endif

/def -p99 -F -mregexp -t"A soldier of fortune waits here for instruction" tfMobsubstAlteracMaliusSoldier = \
    /if (mobsubs) \
      /substitute -p %{PL}@{hCyellow}MALIUS!!! (An Ofcol mercenary - soldier) @{Cgreen}(N, 83, human)@{n}%{PR}%; \
    /else \
      /substitute -p %{PL}@{hCyellow}MALIUS!!! (A soldier of fortune waits here for instruction)%{PR}%; \
    /endif%; \
    point soldier

/def -p99 -F -mregexp -t"An elven ranger is scouting the surrounding hinterland( \(White Aura\)|)" tfMobsubstAlteracMaliusWay = \
    /if (mobsubs) \
      /substitute -p %{PL}@{hCyellow}MALIUS!!! (An Elven waywatcher) @{Cgreen}(@{hCwhite}G@{nCgreen}, 80, elf)@{n}%{PR}%; \
    /else \
      /substitute -p %{PL}@{hCyellow}MALIUS!!! (An elven ranger is scouting the surrounding hinterland)%{PR}%; \
    /endif%; \
    point ranger

/def -p99 -F -mregexp -t"A hero of the Alliance stands fully alert( \(White Aura\)|)" tfMobsubstAlteracMaliusChamp = \
    /if (mobsubs) \
      /substitute -p %{PL}@{hCyellow}MALIUS!!! (A Champion of Alterac) @{Cgreen}(@{hCwhite}G@{nCgreen}, 90, fire, immune slash/pierce)@{n}%{PR}%; \
    /else \
      /substitute -p %{PL}@{hCyellow}MALIUS!!! (A hero of the Alliance stands fully alert)%{PR}%; \
    /endif%; \
    point champion

; -----------------------  Amazonia  -----------------------
/def -p99 -F -mregexp -t"(A bat zigzags around confusedly\.|The bat is here)" tfMobsubstAmazoniaBat = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The bat @{Cgreen}(N, 5, animal)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A hummingbird flutters in the air\.|The hummingbird is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstAmazoniaHummingbird = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The hummingbird @{Cgreen}(@{hCwhite}G@{nCgreen}, 5, bird)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A leech tries to get at your blood! \(hidden\)|The leech \(hidden\) is here)(, fighting [^\.!]+.|)" tfMobsubstAmazoniaLeech = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The leech @{Cgreen}(N, 10, animal)@{n} (hide)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A pig is here, burrowing in the ground for food\.|The pig is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstAmazoniaPig = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The pig @{Cgreen}(@{hCwhite}G@{nCgreen}, 10, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A villager carries on his daily life, oblivious of your presence\.|The village man is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstAmazoniaMan = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The village man @{Cgreen}(@{hCwhite}G@{nCgreen}, 10, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A woman of this village hurries around, doing this and that\.|The village woman is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstAmazoniaWoman = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The village woman @{Cgreen}(@{hCwhite}G@{nCgreen}, 10, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An avalanche is rolling down the mountain towards you!|The avalanche is here)" tfMobsubstAmazoniaAvalanche = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The avalanche @{Cgreen}(N, 15, magical)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A big fat fish is swimming around, scared by your intrusion\.|The fat fish is here)" tfMobsubstAmazoniaFatFish = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The fat fish @{Cgreen}(N, 15, fish)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(You see the village chief standing nearby and wonder if you're to bow\.|The village chief is here)" tfMobsubstAmazoniaChief = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The village chief @{Cgreen}(N, 17, human)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A dark fish blends nicely into the background\.( \(invisible\)|)|The dark fish( \(invisible\)|) is here)(, fighting [^\.!]+.|)" tfMobsubstAmazoniaDarkFish = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}The dark fish @{Cgreen}(N, 20, fish)@{n}%{invisTxt}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A headhunter is looking at you with obvious interest\.|The headhunter is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstAmazoniaHeadhunter = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The headhunter @{Cgreen}(@{nCred}E@{nCgreen}, 20, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The priest's servant stares at you, trying to meditate\.|The native servant is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstAmazoniaServant = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The native servant @{Cgreen}(@{hCwhite}G@{nCgreen}, 20, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A dead sailor's ghost floats in the air\.( \(invisible\)|) \(hidden\)|A sailor's ghost( \(invisible\)|) \(hidden\) is here)(, fighting [^\.!]+.|)" tfMobsubstAmazoniaSailorGhost = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}A sailor's ghost @{Cgreen}(N, 20, insubstantial)@{n}%{invisTxt} (hide)%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A waterfall spirit is guarding the natives' sacred place\.|The waterfall spirit is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstAmazoniaSpirit = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The waterfall spirit @{Cgreen}(@{hCwhite}G@{nCgreen}, 25, insubstantial)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A priest of an unknown religion prays by his altar\.|The priest is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstAmazoniaPriest = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The priest @{Cgreen}(@{hCwhite}G@{nCgreen}, 27, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Aguirre, the wrath of god, stares into the emptiness\.|Aguirre is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstAmazoniaAguirre = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Aguirre @{Cgreen}(@{hCwhite}G@{nCgreen}, 30, human)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Amber Keep  -----------------------
/def -p99 -F -mregexp -t"(A traveller, on a trek to the Keep|A traveller is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstAmberkeepTraveller = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A traveller @{Cgreen}(@{hCwhite}G@{nCgreen}, 8, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Merchant, leading a caravan on a journey to the Keep|A merchant is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstAmberkeepMerchant = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A merchant @{Cgreen}(@{hCwhite}G@{nCgreen}, 10, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A journeyman, travelling to the Keep|A journeyman is here)" tfMobsubstAmberkeepJourneyman = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A journeyman @{Cgreen}(N, 12, human)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Medium Warhorse stands here\.|A Medium Warhorse is here)" tfMobsubstAmberkeepMediumWarhorse = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Medium Warhorse @{Cgreen}(N, 15, ---)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A pilgrim, on a pilgramage to the Keep\.|A pilgrim is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstAmberkeepPilgrim = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A pilgrim @{Cgreen}(@{hCwhite}G@{nCgreen}, 15, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Giant worker ant is here moving bits of food and rubbish around\.|A Worker Ant is here)" tfMobsubstAmberkeepWorkerAnt = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Worker Ant @{Cgreen}(N, 15, insect)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Bandit, holds you up for your money\.( \(invisible\)|) \(hidden\)|A bandit( \(invisible\)|) \(hidden\) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstAmberkeepBandit = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}A bandit @{Cgreen}(@{nCred}E@{nCgreen}, 16, human)@{n}%{invisTxt} (hide)%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Soldier ant is here guarding the queen ant\.|A Soldier Ant is here)" tfMobsubstAmberkeepSoldierAnt = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Soldier Ant @{Cgreen}(N, 20, insect)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An Animated Cleric, sits in the north-western chair\.|The Animated Cleric is here)" tfMobsubstAmberkeepAnimatedCleric = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Animated Cleric @{Cgreen}(N, 25, undead)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An Animated Mage, sits in the north-western chair\.|The Animated Mage is here)" tfMobsubstAmberkeepAnimatedMage = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Animated Mage @{Cgreen}(N, 25, undead)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An Animated Warrior, sits in the north-western chair\.|The Animated Warrior is here)" tfMobsubstAmberkeepAnimatedWarrior = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Animated Warrior @{Cgreen}(N, 25, undead)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Heavy Warhorse stands here\.|A Heavy Warhorse is here)" tfMobsubstAmberkeepHeavyWarhorse = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Heavy Warhorse @{Cgreen}(N, 25, ---)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Female Gnoll is cleaning off the table\.|A Female Gnoll is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstAmberkeepFemaleGnoll = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Female Gnoll @{Cgreen}(@{nCred}E@{nCgreen}, 30, lugroki)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Gnoll guard stands here, waiting for intruders\.|A Gnoll Guard is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstAmberkeepGnollGuardW = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Gnoll Guard @{Cgreen}(@{nCred}E@{nCgreen}, 30, lugroki)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Queen ant is bloated and resting on the floor\.|The Queen Ant is here)" tfMobsubstAmberkeepQueenAnt = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Queen Ant @{Cgreen}(N, 30, insect)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A war dog growls at you, then attacks\.|A War Dog is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstAmberkeepWarDog = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A War Dog @{Cgreen}(@{nCred}E@{nCgreen}, 30, canine)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A wolf like creature stands at the feet of ogre\.|A Worg is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstAmberkeepWorg = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Worg @{Cgreen}(@{nCred}E@{nCgreen}, 30, canine)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A tough Gnoll guard stands here\.|Gnoll Guard is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstAmberkeepGnollGuardT = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Gnoll Guard @{Cgreen}(@{nCred}E@{nCgreen}, 35, lugroki)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Huge Gnoll stands here guarding the upper gate\.|A Huge Gnoll is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstAmberkeepHugeGnoll = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Huge Gnoll @{Cgreen}(@{nCred}E@{nCgreen}, 35, lugroki)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A dog like creature is here lying next the chair\.|A Hyena is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstAmberkeepHyena = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Hyena @{Cgreen}(@{nCred}E@{nCgreen}, 35, canine)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A volt, comes over to you to investigate who you are\.|A Volt is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstAmberkeepVolt = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Volt @{Cgreen}(@{nCred}E@{nCgreen}, 40, magical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A bony skeletal figure has been waiting for you\.|A Revenant is here)" tfMobsubstAmberkeepRevenant = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Revenant @{Cgreen}(N, 45, undead)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Seated in a chair is an ancient female humanoid|A Witch Doctor is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstAmberkeepWitchDoctor = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Witch Doctor @{Cgreen}(@{nCred}E@{nCgreen}, 45, lugroki)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A very tall humanoid looms towards you from the center of the room\.|An Ogre is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstAmberkeepOgre = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An Ogre @{Cgreen}(@{nCred}E@{nCgreen}, 47, lugroki)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Gnoll Chief is resting here\.|The Gnoll Chief is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstAmberkeepGnollChief = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Gnoll Chief @{Cgreen}(@{nCred}E@{nCgreen}, 50, lugroki)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Gnoll Leader is here, and orders the gnolls to attack\.|The Gnoll Leader is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstAmberkeepGnollLeader = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Gnoll Leader @{Cgreen}(@{nCred}E@{nCgreen}, 50, lugroki)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(His is huge and mean looking with coal black skin, flaming red hair, deep red|A Fire Giant is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstAmberkeepFireGiant = \
    /let mobName=@{nCyellow}A Fire Giant @{Cgreen}(@{nCred}E@{nCgreen}, 55, giant)@{n}%; \
    /if (mobsubs & {P1} =~ "A Fire Giant is here") \
      /substitute -p %{PL}%{mobName}%{P2}%{PR}%; \
    /elseif (mobsubs) \
      /substitute%; \
      /def -p99 -F -n1 -mregexp -t"^eyes and yellow teeth\\.( \\(Red Aura\\)|)" tfMobsubstSpecial = \
        /substitute -p %%{PL}%{mobName}%%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Ogre Magi is here glaring at you\.|The Ogre Magi is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstAmberkeepOgreMagi = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Ogre Magi @{Cgreen}(@{nCred}E@{nCgreen}, 55, lugroki)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An almost transparent being is here\. \(hidden\)|Skulk \(hidden\) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstAmberkeepSkulk = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Skulk @{Cgreen}(@{nCred}E@{nCgreen}, 55, insubstantial)@{n} (hide)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Giant Two-Headed Troll, limbers towards you and attacks\.|A Two-Headed Troll is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstAmberkeep2HTroll = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Two-Headed Troll @{Cgreen}(@{nCred}E@{nCgreen}, 55, troll)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An old and tall, elven like mage stands in front of you\.|Gandolf is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstAmberkeepGandolf = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Gandolf @{Cgreen}(@{hCwhite}G@{nCgreen}, 99, elf)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Amphitheatre  -----------------------
/def -p99 -F -mregexp -t"(A black caped human is here|A fanatic Grolim priest is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstAmphitheatreFanaticPriest = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A fanatic Grolim priest @{Cgreen}(@{nCred}E@{nCgreen}, 90, iron)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A warrior in heavy armour is here|A Grolim warrior priest is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstAmphitheatreWarriorPriest = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Grolim warrior priest @{Cgreen}(@{nCred}E@{nCgreen}, 94, human/iron)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A large human with a silver decorated cape is here( \(invisible\)|)|Grolim high priest( \(invisible\)|) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstAmphitheatreHighPriest = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}Grolim high priest @{Cgreen}(@{nCred}E@{nCgreen}, 95, human/energy)@{n}%{invisTxt}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(u_n_k_n_o_w_n( \(invisible\)|)|Mordja the demon lord( \(invisible\)|) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstAmphitheatreMordja = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (invis/imp)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}Mordja the demon lord @{Cgreen}(@{nCred}E@{nCgreen}, 100, pure/light/energy, immune WEAPON)@{n}%{invisTxt}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A huge fire colored dragon is here\.|The red dragon is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstAmphitheatreRedDragon = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The red dragon @{Cgreen}(@{nCred}E@{nCgreen}, 100, dragon)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A female human stands here wearing a black hooded cape( \(invisible\)|)|Zandramas the child of dark( \(invisible\)|) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstAmphitheatreZandramas = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}Zandramas the child of dark @{Cgreen}(@{nCred}E@{nCgreen}, 100, light)@{n}%{invisTxt}%{P4}%{PR}%; \
    /endif

; -----------------------  Ancalador  -----------------------
/def -p99 -F -mregexp -t"(A zombie staggers forth and attacks!|The zombie is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstAncaladorZombie = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The zombie @{Cgreen}(@{nCred}E@{nCgreen}, 5, undead)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A blob of green slime drops upon you!|The green slime is here)" tfMobsubstAncaladorGreenSlime = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The green slime @{Cgreen}(N, 6, jelly)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A yellow crystal spider is clicking its mandibles here\.|The yellow crystal spider is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstAncaladorYCSpider = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The yellow crystal spider @{Cgreen}(@{nCred}E@{nCgreen}, 7, insect)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A green crystal spider is roaming here\.|The green crystal spider is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstAncaladorGCSpider = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The green crystal spider @{Cgreen}(@{nCred}E@{nCgreen}, 8, insect)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Hermit, starved for company, is here\.|The hermit is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstAncaladorHermit = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The hermit @{Cgreen}(@{hCwhite}G@{nCgreen}, 10, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A spectre is here.  It senses your presence and attacks!|The spectre is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstAncaladorSpectre = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The spectre @{Cgreen}(@{nCred}E@{nCgreen}, 10, insubstantial)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An undead riding beetle is parked here\.|The undead riding beetle is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstAncaladorUndeadBeetle = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The undead riding beetle @{Cgreen}(@{nCred}E@{nCgreen}, 11, insect)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A poisonous asp slithers here\.|The deadly asp is here)" tfMobsubstAncaladorAsp = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The deadly asp @{Cgreen}(N, 12, snake)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Petrified Warden guards the way\.|The Petrified Warden is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstAncaladorWarden = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Petrified Warden @{Cgreen}(@{nCred}E@{nCgreen}, 12, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A putrid zombie is here\.|The putrid zombie is here)" tfMobsubstAncaladorPutridZombie = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The putrid zombie @{Cgreen}(N, 13, undead)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A flame dweller is basking in fire here\.|The flame dweller is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstAncaladorFlameDweller = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The flame dweller @{Cgreen}(@{nCred}E@{nCgreen}, 14, elemental)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A wraith is floating here, looking to drain you for dinner\.|The wraith is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstAncaladorWraith = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The wraith @{Cgreen}(@{nCred}E@{nCgreen}, 15, insubstantial)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A wraith knight stands a silent watch here\.|The wraith knight is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstAncaladorWraithKnight = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The wraith knight @{Cgreen}(@{nCred}E@{nCgreen}, 15, undead)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A hideous ochre jello approaches\.|The ochre jello is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstAncaladorJello = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The ochre jello @{Cgreen}(@{nCred}E@{nCgreen}, 16, jelly)@{n}%{P2}%{PR}%; \
    /endif
/def -p100 -F -mregexp -t"(A Necromancer of the Bloodstone, creating zombies, is here\.|The Necromancer is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstAncaladorNecromancer = \
    /if (mobsubs & ({P1} =~ 'A Necromancer of the Bloodstone, creating zombies, is here.' | area =~ 'Ancalador')) \
      /substitute -p %{PL}@{nCyellow}The Necromancer @{Cgreen}(@{nCred}E@{nCgreen}, 17, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A lumbering umber hulk is here\.|The umber hulk is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstAncaladorUmberHulk = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The umber hulk @{Cgreen}(@{nCred}E@{nCgreen}, 18, magical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Lazarus, Assassin and Guild Physician, is here\.|Lazarus is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstAncaladorLazarus = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Lazarus @{Cgreen}(@{nCred}E@{nCgreen}, 19, undead)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Morticia, Guildhead of the Living Dead, is here\.|Morticia is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstAncaladorMorticia = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Morticia @{Cgreen}(@{nCred}E@{nCgreen}, 23, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Crypt Keeper, grinning at you maliciously, is here\.|The Crypt Keeper is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstAncaladorKeeper = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Crypt Keeper @{Cgreen}(@{nCred}E@{nCgreen}, 25, undead)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Ancient Lands  -----------------------
/def -p99 -F -mregexp -t"(A small green snake is curled up here, watching you with unblinking eyes\.|A green snake is here)" tfMobsubstAncientlandsSnake = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A green snake @{Cgreen}(N, 35, snake)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A female neanderthal is sitting by the campfire\.|A female neanderthal is here)" tfMobsubstAncientlandsFemale = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A female neanderthal @{Cgreen}(N, 40, ---)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A neanderthal hunter is here, eyeing you suspiciously\.|A neanderthal hunter is here)" tfMobsubstAncientlandsHunter = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A neanderthal hunter @{Cgreen}(N, 45, ---)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A huge cave-bear lies sleeping peacefully here\.|A huge cave-bear is here)" tfMobsubstAncientlandsBear = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A huge cave-bear @{Cgreen}(N, 55, animal)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The pterodactyl spreads its wings and shrieks as it spots you\.|The pterodactyl is here)" tfMobsubstAncientlandsPterodactyl = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The pterodactyl @{Cgreen}(N, 60, fire)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The neanderthal shaman sits here, chanting in a nonsense language\.|The neanderthal shaman is here)" tfMobsubstAncientlandsShaman = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The neanderthal shaman @{Cgreen}(N, 65, ---)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A velociraptor jumps at you without hesitation\.|A velociraptor is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstAncientlandsVelociraptor = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A velociraptor @{Cgreen}(@{nCred}E@{nCgreen}, 65, fire)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The triceratops stands here, idly chewing on some leaves\.|The triceratops is here)" tfMobsubstAncientlandsTriceratops = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The triceratops @{Cgreen}(N, 70, fire)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The neanderthal headman stands by his fire, looking thoughtful\.|The neanderthal leader is here)" tfMobsubstAncientlandsLeader = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The neanderthal leader @{Cgreen}(N, 75, ---)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The stegosaurus is wandering aimlessly in the forest\.|The stegosaurus is here)" tfMobsubstAncientlandsStegosaurus = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The stegosaurus @{Cgreen}(N, 75, fire)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Allosaurus roars menacingly at you\.|The allosaurus is here)" tfMobsubstAncientlandsAllosaurus = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The allosaurus @{Cgreen}(N, 80, fire)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The brontosaur stands here, peacefully chewing on some water-plants\.|The brontosaur is here)" tfMobsubstAncientlandsBrontosaur = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The brontosaur @{Cgreen}(N, 85, fire)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A large crystal guardian stands here, silent and unmoving like a statue\.|Crystal Guardian is here)" tfMobsubstAncientlandsGuardian = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Crystal Guardian @{Cgreen}(N, 85, unlife/fire)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The huge tyrannosaur charges you with a loud roar\.|The tyrannosaurus rex is here)" tfMobsubstAncientlandsRex = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The tyrannosaurus rex @{Cgreen}(N, 99, dinosaur?, resist WEAPON)@{n}%{PR}%; \
    /endif

; -----------------------  Antharia  -----------------------
/def -p99 -F -mregexp -t"(An Antharian child is playing here\.|An Antharian child is here)" tfMobsubstAnthariaChild = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An Antharian child @{Cgreen}(N, 9, ---)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A sucker fish is here keeping the streets clean\.|A sucker fish is here)" tfMobsubstAnthariaSuckerFish = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A sucker fish @{Cgreen}(N, 10, fish)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An Antharian citizen is standing here\.|An Antharian citizen is here)" tfMobsubstAnthariaCitizen = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An Antharian citizen @{Cgreen}(N, 15, ---)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An Antharian Peace guard is watching you here\.|An Antharian Peace Guard is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstAnthariaPeaceGuard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An Antharian Peace Guard @{Cgreen}(@{hCwhite}G@{nCgreen}, 27, ---)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Ertuvia is here, a master of the Antharian weapons of war\.|Ertuvia is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstAnthariaErtuvia = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Ertuvia @{Cgreen}(@{hCwhite}G@{nCgreen}, 32, ---)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A High Guard of Antharia is here\.|High Guard of Antharia is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstAnthariaHighGuard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}High Guard of Antharia @{Cgreen}(@{hCwhite}G@{nCgreen}, 32, ---)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Suretin, a healer-priest of Anthar, is here\.|Suretin is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstAnthariaSuretin = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Suretin @{Cgreen}(@{hCwhite}G@{nCgreen}, 35, ---)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An antharian beaurocrat is standing here\.|An antharian representative is here)" tfMobsubstAnthariaAntharianRep = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An antharian representative @{Cgreen}(N, 40, ---)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An avian representative is standing here\.|An avian representative is here)" tfMobsubstAnthariaAvianRep = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An avian representative @{Cgreen}(N, 40, bird)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A representative from the druids is standing here\.|A druidic representative is here)" tfMobsubstAnthariaDruidRep = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A druidic representative @{Cgreen}(N, 40, elf)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A dwarven representative is standing here\.|A dwarven representative is here)" tfMobsubstAnthariaDwarvenRep = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A dwarven representative @{Cgreen}(N, 40, dwarf)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An elven representative is standing here\.|An elven representative is here)" tfMobsubstAnthariaElvenRep = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An elven representative @{Cgreen}(N, 40, elf)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A human representative is standing here\.|A human representative is here)" tfMobsubstAnthariaHumanRep = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A human representative @{Cgreen}(N, 40, human)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An illithid representative is standing here\.|An illithid representative is here)" tfMobsubstAnthariaIllithidRep = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An illithid representative @{Cgreen}(N, 40, ---)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A kender is here looking after the guild\.|A kender representative is here)" tfMobsubstAnthariaKenderRep = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A kender representative @{Cgreen}(N, 40, hobbit)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"An Antharian knight is here(\.|)" tfMobsubstAnthariaKnight = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An Antharian Knight @{Cgreen}(N, 42, ---)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"Cyrtpea, sorceress of Antharia, is here staring into your soul\.( \(White Aura\)|)" tfMobsubstAnthariaCyrtpea = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Cyrtpea @{Cgreen}(@{hCwhite}G@{nCgreen}, 100, shopkeeper)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"Heaustf, the maker of fine Antharian armor, is here\.( \(White Aura\)|)" tfMobsubstAnthariaHeaustf = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Heaustf @{Cgreen}(@{hCwhite}G@{nCgreen}, 100, shopkeeper)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"Irghum is here fixing fine Antharian foods\.( \(White Aura\)|)" tfMobsubstAnthariaIrghum = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Irghum @{Cgreen}(@{hCwhite}G@{nCgreen}, 100, shopkeeper)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"Zaertses is here trying to sell you an old Antharian relic\.( \(White Aura\)|)" tfMobsubstAnthariaZaertses = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Zaertses @{Cgreen}(@{hCwhite}G@{nCgreen}, 100, shopkeeper)@{n}%{PR}%; \
    /endif

; -----------------------  Antiriad  -----------------------
/def -p99 -F -mregexp -t"(A white worm-like creature lies motionless in the slime\. \(hidden\)|The Rock Grub \(hidden\) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstAntiriadRockGrub = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Rock Grub @{Cgreen}(@{nCred}E@{nCgreen}, 45, animal)@{n} (hide)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A strange lizard with glowing eyes crawls about in the dust\.|The Basilisk is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstAntiriadBasilisk = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Basilisk @{Cgreen}(@{nCred}E@{nCgreen}, 50, reptile)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A smelly unkempt Troglodyte stands here, eyeing you menacingly\.|The troglodyte is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstAntiriadTroglodyte = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The troglodyte @{Cgreen}(@{nCred}E@{nCgreen}, 52, lugroki)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A disgusting looking Skorn stands here, eyeing you suspiciously\.|The skorn is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstAntiriadSkorn = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The skorn @{Cgreen}(@{nCred}E@{nCgreen}, 55, lugroki, murder)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A burning dog is standing here, growling at you\.|The Fire-Hound is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstAntiriadFireHound = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Fire-Hound @{Cgreen}(@{nCred}E@{nCgreen}, 57, magical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A large skorn stands here, growling menacingly\.|The greater skorn is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstAntiriadGreaterSkorn = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The greater skorn @{Cgreen}(@{nCred}E@{nCgreen}, 60, lugroki)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Guardian of the WatchTower stands guard against Eternity\.|The Watchtower Guardian is here)" tfMobsubstAntiriadWatchtowerGuardian = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Watchtower Guardian @{Cgreen}(N, 62, entity)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Serpent Guard stands guard here against intruders\.|}The Serpent Guardian is here)" tfMobsubstAntiriadSerpentGuardian = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Serpent Guardian @{Cgreen}(N, 65, snake, murder)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A vague shape flits around, on the edge of vision\.|The Poltergeist is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstAntiriadPoltergeist = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Poltergeist @{Cgreen}(@{nCred}E@{nCgreen}, 70, insubstantial)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A huge Snake-like figure stands here, eyeing you remorselessly\.|Lord Sith is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstAntiriadSith = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Lord Sith @{Cgreen}(@{nCred}E@{nCgreen}, 80, snake, murder)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Apocalypse  -----------------------
/def -p99 -F -mregexp -t"(An exhausted woman is here, lying helplessly on the floor\.|The battered slave is here)" tfMobsubstApocalypseBatteredSlave = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The battered slave @{Cgreen}(N, 15, human)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A brutally wounded slave begs you to free him\.|The tortured slave is here)" tfMobsubstApocalypseTorturedSlave = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The tortured slave @{Cgreen}(N, 15, human)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An enormous rat is here, gnawing on an eyeball\.|The hungry rat is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstApocalypseRat = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The hungry rat @{Cgreen}(@{nCred}E@{nCgreen}, 30, rodent)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A sheep with ivory-white wool bellows with happiness\.|The Sheep is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstApocalypseSheep = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Sheep @{Cgreen}(@{hCwhite}G@{nCgreen}, 30, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A human with a golden aura tends to his sheep\.|The Shepherd is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstApocalypseShepherd = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Shepherd @{Cgreen}(@{hCwhite}G@{nCgreen}, 63, human/fire, mana shielded)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A muscular two horned flaming demon is here whipping the life|The Fiery Demon is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstApocalypseDemon = \
    /let mobName=@{nCyellow}The Fiery Demon @{Cgreen}(@{nCred}E@{nCgreen}, 65, demon)@{n}%; \
    /if (mobsubs & {P1} =~ "The Fiery Demon is here") \
      /substitute -p %{PL}%{mobName}%{P2}%{PR}%; \
    /elseif (mobsubs) \
      /substitute%; \
      /def -p99 -F -n1 -mregexp -t"^out of a slave\\.( \\(Red Aura\\)|)" tfMobsubstSpecial = \
        /substitute -p %%{PL}%{mobName}%%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An odd looking figure is here feasting on corpses\.|The Fiery Ghoul is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstApocalypseGhoul = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Fiery Ghoul @{Cgreen}(@{nCred}E@{nCgreen}, 65, demon/poison)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A tall, well built man with beautiful feathered wings looks for|The Winged Angel is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstApocalypseWingedAngel = \
    /let mobName=@{nCyellow}The Winged Angel @{Cgreen}(@{hCwhite}G@{nCgreen}, 65, human, mana shielded)@{n}%; \
    /if (mobsubs & {P1} =~ "The Winged Angel is here") \
      /substitute -p %{PL}%{mobName}%{P2}%{PR}%; \
    /elseif (mobsubs) \
      /substitute%; \
      /def -p99 -F -n1 -mregexp -t"^intruders\\.( \\(White Aura\\)|)" tfMobsubstSpecial = \
        /substitute -p %%{PL}%{mobName}%%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A wraith covered in blood is here, searching for souls\.|The Bloody Wraith is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstApocalypseBloodyWraith = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Bloody Wraith @{Cgreen}(@{nCred}E@{nCgreen}, 66, demon)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Grey Serpent is here circling around in the air\.|The Grey Serpent is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstApocalypseGreySerpent = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Grey Serpent @{Cgreen}(@{nCred}E@{nCgreen}, 66, snake)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A monk dressed in white robes prays deeply to the Gods\.|The white hooded monk is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstApocalypseMonk = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The white hooded monk @{Cgreen}(@{hCwhite}G@{nCgreen}, 66, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A small green colored dragon peers around for lunch\.|The Green Dragon is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstApocalypseGreenDragon = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Green Dragon @{Cgreen}(@{hCwhite}G@{nCgreen}, 70, dragon)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A knight dressed in the finest armor holds a cross by his heart\.|The Holy Templar is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstApocalypseHolyTemplar = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Holy Templar @{Cgreen}(@{hCwhite}G@{nCgreen}, 70, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Something lurks in the shadows\. \(hidden\)|Translucent demon \(hidden\) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstApocalypseTranslucentDemon = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Translucent demon @{Cgreen}(@{nCred}E@{nCgreen}, 70, demon)@{n} (hide)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A man of immense size guards the abyss\.|Guardian of the Abyss is here)" tfMobsubstApocalypseGuardianOfAbyss = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Guardian of the Abyss @{Cgreen}(N, 75, human)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A man of immense size guards the Gate|Guardian of the Gate is here)" tfMobsubstApocalypseGuardianOfGate = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Guardian of the Gate @{Cgreen}(N, 75, human)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An angel hovering in the air glows with a beautiful purple|The angel of dominations is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstApocalypseDominations = \
    /let mobName=@{nCyellow}The angel of dominations @{Cgreen}(@{hCwhite}G@{nCgreen}, 92, human, mana shielded)@{n}%; \
    /if (mobsubs & {P1} =~ "The angel of dominations is here") \
      /substitute -p %{PL}%{mobName}%{P2}%{PR}%; \
    /elseif (mobsubs) \
      /substitute%; \
      /def -p99 -F -n1 -mregexp -t"^glow\\.( \\(White Aura\\)|)" tfMobsubstSpecial = \
        /substitute -p %%{PL}%{mobName}%%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An angel radiating with a red glow glares around for unfaithful|The Angel of Powers is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstApocalypseAOPowers = \
    /let mobName=@{nCyellow}The Angel of Powers @{Cgreen}(@{hCwhite}G@{nCgreen}, 92, human, mana shielded)@{n}%; \
    /if (mobsubs & {P1} =~ "The Angel of Powers is here") \
      /substitute -p %{PL}%{mobName}%{P2}%{PR}%; \
    /elseif (mobsubs) \
      /substitute%; \
      /def -p99 -F -n1 -mregexp -t"^believers\\.( \\(White Aura\\)|)" tfMobsubstSpecial = \
        /substitute -p %%{PL}%{mobName}%%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An angel of incredible wisdom stands before you\.|The Angel of Principalities is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstApocalypsePrincipalities = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Angel of Principalities @{Cgreen}(@{hCwhite}G@{nCgreen}, 92, human, mana shielded)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An angel glowing with a purple glow is here, preaching the|The Angel of Thrones is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstApocalypseThrones = \
    /let mobName=@{nCyellow}The Angel of Thrones @{Cgreen}(@{hCwhite}G@{nCgreen}, 92, human, mana shielded)@{n}%; \
    /if (mobsubs & {P1} =~ "The Angel of Thrones is here") \
      /substitute -p %{PL}%{mobName}%{P2}%{PR}%; \
    /elseif (mobsubs) \
      /substitute%; \
      /def -p99 -F -n1 -mregexp -t"^power of God\\.( \\(White Aura\\)|)" tfMobsubstSpecial = \
        /substitute -p %%{PL}%{mobName}%%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An angel radiating a yellow glow beckons you to approach him\.|The Angel of Virtues is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstApocalypseAOVirtues = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Angel of Virtues @{Cgreen}(@{hCwhite}G@{nCgreen}, 92, human, mana shielded)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An angel with a huge wing span stands here, praising the Lord\.|The Archangel is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstApocalypseArchangel = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Archangel @{Cgreen}(@{hCwhite}G@{nCgreen}, 92, human, mana shielded)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A large centaur with a muscular build looks around for something|Gzora is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstApocalypseGzora = \
    /let mobName=@{nCyellow}Gzora @{Cgreen}(@{hCred}E@{nCgreen}, 92, ???)@{n}%; \
    /if (mobsubs & {P1} =~ "Gzora is here") \
      /substitute -p %{PL}%{mobName}%{P2}%{PR}%; \
    /elseif (mobsubs) \
      /substitute%; \
      /def -p99 -F -n1 -mregexp -t"^to hunt\\.( \\(Red Aura\\)|)" tfMobsubstSpecial = \
        /substitute -p %%{PL}%{mobName}%%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A demon of great dignity with glowing red eyes stands|K'intar is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstApocalypseKintar = \
    /let mobName=@{nCyellow}K'intar @{Cgreen}(@{nCred}E@{nCgreen}, 92, demon)@{n}%; \
    /if (mobsubs & {P1} =~ "K'intar is here") \
      /substitute -p %{PL}%{mobName}%{P2}%{PR}%; \
    /elseif (mobsubs) \
      /substitute%; \
      /def -p99 -F -n1 -mregexp -t"^here, admiring his collections\\.( \\(Red Aura\\)|)" tfMobsubstSpecial = \
        /substitute -p %%{PL}%{mobName}%%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A red hooded priest is here, writing new anti-christ scriptures\.|Khondar is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstApocalypseKhondar = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Khondar @{Cgreen}(@{nCred}E@{nCgreen}, 92, demon?/pure/light/iron)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A black hooded sorceror of evil magic is here, brewing his pot\.|Kjata is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstApocalypseKjata = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Kjata @{Cgreen}(@{nCred}E@{nCgreen}, 92, demon, deathspell)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An angel with a bright aura surrounding his head stands here,|The Lesser Angel is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstApocalypseLesserAngel = \
    /let mobName=@{nCyellow}The Lesser Angel @{Cgreen}(@{hCwhite}G@{nCgreen}, 92, human, mana shielded)@{n}%; \
    /if (mobsubs & {P1} =~ "The Lesser Angel is here") \
      /substitute -p %{PL}%{mobName}%{P2}%{PR}%; \
    /elseif (mobsubs) \
      /substitute%; \
      /def -p99 -F -n1 -mregexp -t"^preaching the Gospel\\.( \\(White Aura\\)|)" tfMobsubstSpecial = \
        /substitute -p %%{PL}%{mobName}%%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A giant with two heads is here, sharpening his sword\\.|Lorgon is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstApocalypseLorgon = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Lorgon @{Cgreen}(@{nCred}E@{nCgreen}, 92, demon?/pure/light/iron)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A red dragon of enormous size with a spiked tail is here,|Ragnarok is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstApocalypseRagnarok = \
    /let mobName=@{nCyellow}Ragnarok @{Cgreen}(@{nCred}E@{nCgreen}, 92, dragon)@{n}%; \
    /if (mobsubs & {P1} =~ "Ragnarok is here") \
      /substitute -p %{PL}%{mobName}%{P2}%{PR}%; \
    /elseif (mobsubs) \
      /substitute%; \
      /def -p99 -F -n1 -mregexp -t"^snoring loudly\\.( \\(Red Aura\\)|)" tfMobsubstSpecial = \
        /substitute -p %%{PL}%{mobName}%%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A hooded figure stands here, mumbling his fumbling\.|Zorath is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstApocalypseZorath = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Zorath @{Cgreen}(@{nCred}E@{nCgreen}, 92, demon?, deathspell)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Angel of Cherubim floats here\.|The Angel of Cherubim is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstApocalypseCherubim = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Angel of Cherubim @{Cgreen}(@{hCwhite}G@{nCgreen}, 93, human, NOT mana shielded, deathspell)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Angel of Seraphim is here circling around in the air\.|The Angel of Seraphim is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstApocalypseSeraphim = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Angel of Seraphim @{Cgreen}(@{hCwhite}G@{nCgreen}, 93, human, mana shielded)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A huge giant with an enormous head glares at you icilly\.|Goliath is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstApocalypseGoliath = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Goliath @{Cgreen}(@{nCred}E@{nCgreen}, 93, giant?, mana shielded)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A vile rogue stares at you evilly\.|Kinslaughter is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstApocalypseKinslaughter = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Kinslaughter @{Cgreen}(@{nCred}E@{nCgreen}, 93, demon?/pure/light/iron)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A seven headed, ten horned beast tattooed with a number 666 radiates with the ultimate evil power\.|Shatan is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstApocalypseShatan = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Shatan @{Cgreen}(@{nCred}E@{nCgreen}, 95, mythical/pure, deathspell)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Yahweh stands here, predicting your arrival\.|Yahweh is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstApocalypseYahweh = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Yahweh @{Cgreen}(@{hCwhite}G@{nCgreen}, 95, mythical, mana shielded, deathspell)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A hooded figure is standing here, staring at you with disbelief\.|The Ambivalent Mediator is here)(, fighting [^\.!]+.|)" tfMobsubstApocalypseMediator = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Ambivalent Mediator @{Cgreen}(N, 99, nofight-room)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Something with an unusual physique blurs in and out of phase\.|It is here)" tfMobsubstApocalypseIt = \
    /if (mobsubs & area =~ 'Apocalypse') \
      /substitute -p %{PL}@{nCyellow}It @{Cgreen}(N, 100, mythical?)@{n}%{PR}%; \
    /endif

; -----------------------  Arachnos  -----------------------
/def -p100 -F -mregexp -t"(The orc is stuck in the web and he can't get out\.|The orc is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstArachnosOrc = \
    /if (mobsubs & ({P1} != 'The orc is here' | area =~ 'Arachnos')) \
      /substitute -p %{PL}@{nCyellow}The orc @{Cgreen}(@{nCred}E@{nCgreen}, 5, orc)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The young spider is ballooning by you\.|The young spider is here)" tfMobsubstArachnosYoungSpider = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The young spider @{Cgreen}(N, 5, spider)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The drone spider walks around doing her master's bidding\.|The drone spider is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstArachnosDroneSpider = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The drone spider @{Cgreen}(@{nCred}E@{nCgreen}, 6, spider)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Wolf Spider is here, licking its bloody fangs\.|The Wolf Spider is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstArachnosWolfSpider = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Wolf Spider @{Cgreen}(@{nCred}E@{nCgreen}, 6, spider)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A huge, poisonous spider is here\.|The huge, poisonous spider is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstArachnosHPSpider = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The huge, poisonous spider @{Cgreen}(@{nCred}E@{nCgreen}, 8, spider)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The ethereal spider strides here, traveling to different worlds\.|The ethereal spider is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstArachnosEtherealSpider = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The ethereal spider @{Cgreen}(@{hCwhite}G@{nCgreen}, 10, spider)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The quasit blinks in and out, grinning at you\.( \(invisible\)|) \(hidden\)|The quasit( \(invisible\)|) \(hidden\) is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstArachnosQuasit = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}The quasit @{Cgreen}(@{hCwhite}G@{nCgreen}, 10, magical)@{n}%{invisTxt} (hide)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The slave works here relentlessly\.|The slave of Arachnos is here)" tfMobsubstArachnosSlave = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The slave of Arachnos @{Cgreen}(N, 10, human)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Bird Spider snaps its powerful jaws\.|The Bird Spider is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstArachnosBirdSpider = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Bird Spider @{Cgreen}(@{nCred}E@{nCgreen}, 14, spider)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Queen Wasp is here, thinking that you would make a tasty offering|The Queen Wasp is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstArachnosQueenWasp = \
    /let mobName=@{nCyellow}The Queen Wasp @{Cgreen}(@{nCred}E@{nCgreen}, 14, insect)@{n}%; \
    /if (mobsubs & {P1} =~ "The Queen Wasp is here") \
      /substitute -p %{PL}%{mobName}%{P2}%{PR}%; \
    /elseif (mobsubs) \
      /substitute%; \
      /def -p99 -F -n1 -mregexp -t"^to her master\\.( \\(Red Aura\\)|)" tfMobsubstSpecial = \
        /substitute -p %%{PL}%{mobName}%%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Hermit sits here and warns, \"Go back before it's too late!\"|}The Hermit is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstArachnosHermit = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Hermit @{Cgreen}(@{nCred}E@{nCgreen}, 15, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The guardian is obviously not doing his job\. \(hidden\)|The guardian \(hidden\) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstArachnosGuardian = \
    /if (mobsubs & area =~ 'Arachnos') \
      /substitute -p %{PL}@{nCyellow}The guardian @{Cgreen}(@{hCwhite}G@{nCgreen}, 17, human)@{n} (hide)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A wormkin with no teeth plays here\.|The young dragon wormkin is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstArachnosYDWormkin = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The young dragon wormkin @{Cgreen}(@{hCwhite}G@{nCgreen}, 23, dragon)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Yevaud the Usurper of Karandras here, grinning evilly at you\.|Yevaud is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstArachnosYevaud = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Yevaud @{Cgreen}(@{nCred}E@{nCgreen}, 24, dragon)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Donjonkeeper eyes you and wonders how pure your soul is\.|The Donjonkeeper is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstArachnosDonjonKeeper = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Donjonkeeper @{Cgreen}(@{hCwhite}G@{nCgreen}, 25, entity)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The huge, bulky Queen Spider is here\.|The Queen Spider is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstArachnosSpiderQueen = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Queen Spider @{Cgreen}(@{nCred}E@{nCgreen}, 25, spider)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Arachnos the Empress of Spiders welcomes you with an evil smile\.|Arachnos is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstArachnosArachnos = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Arachnos @{Cgreen}(@{nCred}E@{nCgreen}, 29, spider)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Ki-Rin smiles good-naturedly to you\.|The Ki-Rin is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstArachnosKiRin = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Ki-Rin @{Cgreen}(@{hCwhite}G@{nCgreen}, 40, bird)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A wormkin that has grown a bit stares at you inquisitively\.|The elder dragon wormkin is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstArachnosEDWormkin = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The elder dragon wormkin @{Cgreen}(@{hCwhite}G@{nCgreen}, 49, dragon)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Arena  -----------------------

; -----------------------  Argo  -----------------------
/def -p99 -F -mregexp -t"(an imp clad in the black uniform of Tumuz Orgmeen stands here\.|An Orgeem Imp is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstArgoImp = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An Orgeem Imp @{Cgreen}(@{nCred}E@{nCgreen}, 30, ---)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Harcho the dragonboy stands here beside his Battle Dragon\.|Harcho is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstArgoHarcho = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Harcho @{Cgreen}(@{hCwhite}G@{nCgreen}, 32, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Kastrul the dragonboy stands here beside his Battle Dragon\.|Kastrul is here)(, fighting [^\.!]+.|)( \(Good Aura\)|)" tfMobsubstArgoKastrul = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Kastrul @{Cgreen}(@{hCwhite}G@{nCgreen}, 32, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Marco Veli the dragonboy stands here beside his Battle Dragon\.|Marco Veli is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstArgoMarcoVeli = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Marco Veli @{Cgreen}(@{hCwhite}G@{nCgreen}, 32, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Tomas the dragonboy stands here beside his Battle Dragon\.|Tomas is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstArgoTomas = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Tomas @{Cgreen}(@{hCwhite}G@{nCgreen}, 32, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Relkin Orphanboy of Quosh stands here beside his Battle Dragon\.|Relkin Orphanboy is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstArgoRelkin = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Relkin Orphanboy @{Cgreen}(@{hCwhite}G@{nCgreen}, 33, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Dragoneer Third Class Rosen Jaib stands here in charge of the left flank\.|Dragoneer Rosen Jaib is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstArgoRosenJaib = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Dragoneer Rosen Jaib @{Cgreen}(@{hCwhite}G@{nCgreen}, 47, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Dragoneer Second Class Heltifer stands here in charge of the right flank\.|Dragoneer Heltifer is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstArgoHeltifer = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Dragoneer Heltifer @{Cgreen}(@{hCwhite}G@{nCgreen}, 48, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Dragoneer First Class Tetzarch stands here in charge of the center\.|Dragoneer Tetzarch is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstArgoTetzarch = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Dragoneer Tetzarch @{Cgreen}(@{hCwhite}G@{nCgreen}, 50, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(a Black Troll of Tumuz Orgmeen stands here\.|A Black Troll is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstArgoBTroll = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Black Troll @{Cgreen}(@{nCred}E@{nCgreen}, 52, troll)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Chektor, a medium brasshide Battle Dragon, stands here\.|Chektor is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstArgoChektor = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Chektor @{Cgreen}(@{hCwhite}G@{nCgreen}, 55, dragon, specials)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Bazil of Quosh, a medium leatherback Battle Dragon, stands here\.|Bazil Broketail is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstArgoBazil = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Bazil Broketail @{Cgreen}(@{hCwhite}G@{nCgreen}, 57, dragon, specials)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(a whitish skinned Troll of Tumuz Orgmeen stands here\.|A Whitish Troll is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstArgoWTroll = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Whitish Troll @{Cgreen}(@{nCred}E@{nCgreen}, 61, troll)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Vander, a large silverhide Battle Dragon, stands here\.|Vander is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstArgoVander = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Vander @{Cgreen}(@{hCwhite}G@{nCgreen}, 62, dragon, specials)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Kepabar, a great brasshide Battle Dragon, stands here\.|Kepabar is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstArgoKepabar = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Kepabar @{Cgreen}(@{hCwhite}G@{nCgreen}, 64, dragon, specials)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Nesessitas, a large brasshide Battle Dragon, stands here\.|Nesessitas is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstArgoNesessitas = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Nesessitas @{Cgreen}(@{hCwhite}G@{nCgreen}, 64, dragon, specials)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Astral Plane  -----------------------
/def -p99 -F -mregexp -t"(A grey figure guards the entrance to the astral plane|An Immense guardian is here)" tfMobsubstAstralplaneImmenseGuardian = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An Immense guardian @{Cgreen}(N, 60, astral/bleed)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A collosal body of hardened celestial matter flies rapidy through existence!|A colossal body of hardened celestial matter is here)" tfMobsubstAstralplaneCelestialMatter = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A colossal body of hardened celestial matter @{Cgreen}(N, 65, elemental/electricity)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A huge boulder of glistening ice barrels through space!|A huge boulder of glistening ice is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstAstralplaneIceBoulder = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A huge boulder of glistening ice @{Cgreen}(@{hCwhite}G@{nCgreen}, 65, elemental?/fire/light)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A massive blast of fire tears through existence!|A massive blast of fire is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstAstralplaneBlastOfFire = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A massive blast of fire @{Cgreen}(@{nCred}E@{nCgreen}, 70, elemental/ice)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A humanoid figure stands here, filled with the essence of magic\.( \(invisible\)|)|A warlock of the Gith( \(invisible\)|) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstAstralplaneGithWarlock = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}A warlock of the Gith @{Cgreen}(@{nCred}E@{nCgreen}, 70, magic/bleed)@{n}%{invisTxt}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A githzerai plots his escape plan|An imprisoned githzerai is here)" tfMobsubstAstralplaneImprGithzerai = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An imprisoned githzerai @{Cgreen}(N, 75, unlife/bleed)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A mindflayer lies here, scarred from the torture inflicted by the Gith\.|A tortured mindflayer prisoner is here)" tfMobsubstAstralplaneTorturedMindflayer = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A tortured mindflayer prisoner @{Cgreen}(N, 75, unlife/bleed)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A swirling cluster of particles float about the plane|A cluster of glowing celestial particles is here)" tfMobsubstAstralplaneCluster = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A cluster of glowing celestial particles @{Cgreen}(N, 80, entity/dark)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A humanoid figure clad in splinted armor blocks your way\.|A githyanki guardian is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstAstralplaneGithGuardian = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A githyanki guardian @{Cgreen}(@{nCred}E@{nCgreen}, 80, bleed)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A black knight of the githyanki protects his queen\.|A githyanki protector is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstAstralplaneGithProtector = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A githyanki protector @{Cgreen}(@{nCred}E@{nCgreen}, 80, bleed)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A large floating mass moves slowly about the area\.|A large floating mass is here)" tfMobsubstAstralplaneFloatingMass = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A large floating mass @{Cgreen}(N, 80, elemental/electricity)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A tall figure armored in black observes you quietly\.|A githyanki knight is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstAstralplaneGithKnight = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A githyanki knight @{Cgreen}(@{nCred}E@{nCgreen}, 90, bleed)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A giant red dragon is chained here, his breath heating the furnace\.|The enslaved red dragon is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstAstralplaneRedDragon = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The enslaved red dragon @{Cgreen}(@{nCred}E@{nCgreen}, 95, dragon)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A gish laughs as flame leaps from his hands towards your face\.|An evil gish is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstAstralplaneEvilGish = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An evil gish @{Cgreen}(@{nCred}E@{nCgreen}, 95, bleed)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The evil Mistress of the Gith reaches out to destroy you\.|The evil Mistress of the Gith is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstAstralplaneMistress = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The evil Mistress of the Gith @{Cgreen}(@{nCred}E@{nCgreen}, 95, ???, resist spells?, pkill)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Torture Master of Gith suddenly forms from a cloud of blackness\. \(invisible\)|The Torture Master of the Gith \(invisible\) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstAstralplaneTortureMaster = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Torture Master of the Gith @{Cgreen}(@{nCred}E@{nCgreen}, 100, vampire)@{n} (imp)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(u_n_k_n_o_w_n|A vampiric bat with HUGE wings is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstAstralplaneBat = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A vampiric bat with HUGE wings @{Cgreen}(@{nCred}E@{nCgreen}, 100, immune WEAPON/single-target spells/light?)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Atlantis  -----------------------
/def -p99 -F -mregexp -t"(A sea urchin is growing on a rock here\.|The sea urchin is here)" tfMobsubstAtlantisUrchin = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The sea urchin @{Cgreen}(N, 3, fish)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A brightly-colored fish is swimming around here\.|The bright fish is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstAtlantisBrightfish = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The bright fish @{Cgreen}(@{hCwhite}G@{nCgreen}, 5, fish)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A small fish is swimming around aimlessly here\.|The small fish is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstAtlantisSmallfish = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The small fish @{Cgreen}(@{hCwhite}G@{nCgreen}, 5, fish)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A sea anemone is attached to a rock here\.|The anemone is here)" tfMobsubstAtlantisAnemone = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The anemone @{Cgreen}(N, 6, fish)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A small eel is here, looking for a rock to hide under\.|The eel is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstAtlantisEel = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The eel @{Cgreen}(@{nCred}E@{nCgreen}, 6, snake)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A sea nymph is standing here, looking beautiful\.|The nymph is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstAtlantisSeanymph = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The nymph @{Cgreen}(@{hCwhite}G@{nCgreen}, 7, fairie)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A small stingray is hiding in the sand here\.|The stingray is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstAtlantisStingray = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The stingray @{Cgreen}(@{nCred}E@{nCgreen}, 7, fish)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A seahorse swims by through the water\.|The seahorse is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstAtlantisSeahorse = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The seahorse @{Cgreen}(@{hCwhite}G@{nCgreen}, 8, ---)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A big fish is swimming around here\.|The big fish is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstAtlantisBigfish = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The big fish @{Cgreen}(@{hCwhite}G@{nCgreen}, 10, fish)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An eel is here, glowing in the water like it is electric or something\.|The electric eel is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstAtlantisElectricEel = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The electric eel @{Cgreen}(@{nCred}E@{nCgreen}, 10, snake)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A beautiful mermaid swims by\.|The mermaid is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstAtlantisMermaid = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The mermaid @{Cgreen}(@{hCwhite}G@{nCgreen}, 10, ---)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A sea zombie floats around here\.|The sea zombie is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstAtlantisZombie = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The sea zombie @{Cgreen}(@{nCred}E@{nCgreen}, 10, undead)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A giant eel is here, slithering through the water\.|The giant eel is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstAtlantisGiantEel = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The giant eel @{Cgreen}(@{nCred}E@{nCgreen}, 12, snake)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A huge giant lobster is here, snapping its claws\.|The giant lobster is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstAtlantisLobster = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The giant lobster @{Cgreen}(@{nCred}E@{nCgreen}, 12, fish)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A HUGE giant clam is laying on the bottom here\.|The giant clam is here)" tfMobsubstAtlantisClam = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The giant clam @{Cgreen}(N, 15, fish)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A huge manta ray glides past you\.|The manta is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstAtlantisManta = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The manta @{Cgreen}(@{nCred}E@{nCgreen}, 15, fish)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A strong-looking triton is standing on the bottom here\.|The triton is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstAtlantisTriton = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The triton @{Cgreen}(@{hCwhite}G@{nCgreen}, 15, ---)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A huge octopus is floating around here\.|The octopus is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstAtlantisOctopus = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The octopus @{Cgreen}(@{hCwhite}G@{nCgreen}, 18, fish)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An immense great white shark is looking for food here\.|The great white shark is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstAtlantisWhiteShark = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The great white shark @{Cgreen}(@{nCred}E@{nCgreen}, 20, fish)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A deadly hammerhead shark is prowling the waters here\.|The hammerhead shark is here)" tfMobsubstAtlantisHammerhead = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The hammerhead shark @{Cgreen}(@{nCred}E@{nCgreen}, 20, fish)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A squid is swimming around here\.|The squid is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstAtlantisSquid = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The squid @{Cgreen}(@{nCred}E@{nCgreen}, 20, fish)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A cute dolphin is flipping its tail around here\.|The dolphin is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstAtlantisDolphin = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The dolphin @{Cgreen}(@{hCwhite}G@{nCgreen}, 22, fish)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A giant squid drifts by you\.|The giant squid is here)" tfMobsubstAtlantisGiantSquid = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The giant squid @{Cgreen}(@{nCred}E@{nCgreen}, 25, fish)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The King of the Tritons is sitting here on his throne\.|The triton king is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstAtlantisKing = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The triton king @{Cgreen}(@{hCwhite}G@{nCgreen}, 25, ---)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The velya bares it fangs and attacks!|The velya is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstAtlantisVelya = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The velya @{Cgreen}(@{nCred}E@{nCgreen}, 35, vampire)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An immense blue whale is here\.|The blue whale is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstAtlantisWhale = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The blue whale @{Cgreen}(@{hCwhite}G@{nCgreen}, 40, fish)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"A triton shopkeeper is here, ready to sell you anything.( \(White Aura\)|)" tfMobsubstAtlantisShopkeeper = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The shopkeeper @{Cgreen}(@{hCwhite}G@{nCgreen}, 50, shopkeeper)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"A triton weaponsmith is here, forging a blade.( \(White Aura\)|)" tfMobsubstAtlantisWeaponsmith = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The weaponsmith @{Cgreen}(@{hCwhite}G@{nCgreen}, 50, shopkeeper)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"The nymph mage is standing here, waiting for you to say what you want.( \(White Aura\)|)" tfMobsubstAtlantisNymphmage = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The nymph mage @{Cgreen}(@{hCwhite}G@{nCgreen}, 55, shopkeeper)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Neptunus, the God of the Sea, is sitting here on his throne\. \(hidden\)|Neptunus \(hidden\) is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstAtlantisNeptunus = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Neptunus @{Cgreen}(@{hCwhite}G@{nCgreen}, 80, mythical)@{n} (hide)%{P2}%{PR}%; \
    /endif

; -----------------------  Battlefields  -----------------------
/def -p99 -F -mregexp -t"(A hairless creature scurries around in the darkness\. \(hidden\)|A caveling \(hidden\) is here)(, fighting [^\.!]+.|)" tfMobsubstBattlefieldsCaveling = \
    /if (owner =~ 'Cindy' & mylevel <= 75) \
      /tfshow CONSIDER CAVELING!!!%; \
      consider caveling%; \
    /endif%; \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A caveling @{Cgreen}(N, 58-61, ???)@{n} (hide)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A dirty, smelly lugroki peasant pollutes the air here\.|A homeland peasant is here)" tfMobsubstBattlefieldsPeasant = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A homeland peasant @{Cgreen}(N, 60, lugroki?)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A lugroki with a crude eyepiece scans the horizon\.|A lugroki seeker is here)" tfMobsubstBattlefieldsLSeeker = \
    /if (owner =~ 'Cindy' & mylevel <= 93) \
      /tfshow CONSIDER SEEKER!!!%; \
      consider seeker%; \
    /endif%; \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A lugroki seeker @{Cgreen}(N, 67-83, lugroki?)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A lugroki runner waits here to be dispatched with a message\.|A lugroki runner is here)(, fighting [^\.!]+.|)" tfMobsubstBattlefieldsLRunner = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A lugroki runner @{Cgreen}(N, 72, lugroki)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A youthful lugroki hunts for a foe to scalp\.( \(invisible\)|)|A lugroki bloodling( \(invisible\)|) is here)(, fighting [^\.!]+.|)" tfMobsubstBattlefieldsLBloodling = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (imp/invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}A lugroki bloodling @{Cgreen}(N, 73, lugroki?)@{n}%{invisTxt}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A rank-and-file brettonian guardsman is here to fight the enemy\.|An Alliance guardsman works hurriedly behind the lines here\.|A Brettonian guardsman is here)(, fighting [^\.!]+.|)" tfMobsubstBattlefieldsBrGuardsman = \
    /if (mobsubs) \
      /if ({P1} =~ 'A rank-and-file brettonian guardsman is here to fight the enemy.') \
        /substitute -p %{PL}@{nCyellow}A Brettonian guardsman (fight) @{Cgreen}(N, 79, human)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'An Alliance guardsman works hurriedly behind the lines here.') \
        /substitute -p %{PL}@{nCyellow}A Brettonian guardsman (works) @{Cgreen}(N, 79, human)@{n}%{P2}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}A Brettonian guardsman (fight/works) @{Cgreen}(N, 79, human)@{n}%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(An alliance man-at-arms is prepared to repel any lugroki advance\.|A heavily armoured Brettonian protects the alliance catapults\.|A Brettonian man-at-arms is here)(, fighting [^\.!]+.|)" tfMobsubstBattlefieldsBrMaAPre = \
    /if (mobsubs) \
      /if ({P1} =~ 'An alliance man-at-arms is prepared to repel any lugroki advance.') \
        /substitute -p %{PL}@{nCyellow}A Brettonian man-at-arms (prepared) @{Cgreen}(N, 80, human)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'A heavily armoured Brettonian protects the alliance catapults.') \
        /substitute -p %{PL}@{nCyellow}A Brettonian man-at-arms (protects) @{Cgreen}(N, 80, human)@{n}%{P2}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}A Brettonian man-at-arms (prepared/protects) @{Cgreen}(N, 80, human)@{n}%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(A drow warrior is here, guarding the envoy\.|A drow warrior is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstBattlefieldsDrWar = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A drow warrior @{Cgreen}(@{nCred}E@{nCgreen}, 80, drow-elf?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A lieutenant directs troops to the front lines here\.|A lieutenant of the Alliance rallies his troops on the battlefield\.|A lieutenant of the Brettonian High Command is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstBattlefieldsBrLieuDir = \
    /if (mobsubs) \
      /if ({P1} =~ 'A lieutenant directs troops to the front lines here.') \
        /substitute -p %{PL}@{nCyellow}A lieutenant of the Brettonian High Command (directs) @{Cgreen}(@{hCwhite}G@{nCgreen}, 80, human/pierce)@{n}%{PR}%; \
      /elseif ({P1} =~ 'A lieutenant of the Alliance rallies his troops on the battlefield.') \
        /substitute -p %{PL}@{nCyellow}A lieutenant of the Brettonian High Command (rallies) @{Cgreen}(@{hCwhite}G@{nCgreen}, 80, human/pierce?)@{n}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}A lieutenant of the Brettonian High Command (directs/rallies) @{Cgreen}(@{hCwhite}G@{nCgreen}, 80, human/pierce?)@{n}%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(A small unassuming creature hides amongst the corpses\. \(hidden\)|A lugroki marauder waits behind the lines for an opportunity\. \(hidden\)|A lugroki marauder \(hidden\) is here)(, fighting [^\.!]+.|)" tfMobsubstBattlefieldsLMarauHi = \
    /if (mobsubs) \
      /if ({P1} =~ 'A small unassuming creature hides amongst the corpses. (hide)') \
        /substitute -p %{PL}@{nCyellow}A lugroki marauder (hides) @{Cgreen}(N, 80, lugroki?)@{n} (hide)%{P2}%{PR}%; \
      /elseif ({P1} =~ 'A lugroki marauder waits behind the lines for an opportunity. (hide)') \
        /substitute -p %{PL}@{nCyellow}A lugroki marauder (waits) @{Cgreen}(N, 80, lugroki?)@{n} (hide)%{P2}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}A lugroki marauder (hides/waits) @{Cgreen}(N, 80, lugroki?)@{n} (hide)%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(An apprentice saboteur listens intently to the discussion\.|Sagnat the drow-elf saboteur is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstBattlefieldsSagnat = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Sagnat the drow-elf saboteur @{Cgreen}(@{nCred}E@{nCgreen}, 80, drow-elf?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A captain of the high command confirms targets on the battlefield here\.|A captain of the high command studies the battle\.|A captain of the Brettonian High Command is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstBattlefieldsBrCapCon = \
    /if (mobsubs) \
      /if ({P1} =~ 'A captain of the high command confirms targets on the battlefield here.') \
        /substitute -p %{PL}@{nCyellow}A captain of the Brettonian High Command (confirms) @{Cgreen}(@{hCwhite}G@{nCgreen}, 82, human)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'A captain of the high command studies the battle.') \
        /substitute -p %{PL}@{nCyellow}A captain of the Brettonian High Command (studies) @{Cgreen}(@{hCwhite}G@{nCgreen}, 82, human)@{n}%{P2}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}A captain of the Brettonian High Command (confirms/studies) @{Cgreen}(@{hCwhite}G@{nCgreen}, 82, human)@{n}%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(A seasoned lugroki veteran is here in discussion\.|A lugroki veteran is here)(, fighting [^\.!]+.|)" tfMobsubstBattlefieldsLVeteran = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A lugroki veteran @{Cgreen}(N, 83, lugroki?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A mercenary from foreign lands fights for the alliance here\.( \(invisible\)|)|An Ofcol mercenary( \(invisible\)|) is here)(, fighting [^\.!]+.|)" tfMobsubstBattlefieldsMerc = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (imp/invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}An Ofcol mercenary @{Cgreen}(N, 83, human)@{n}%{invisTxt}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A wild lugroki awaits orders to head into battle\.|A wild and seemingly unstoppable beast charges across the battlefield\.|A lugroki berserker is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstBattlefieldsLBerserker = \
    /if (mobsubs) \
      /if ({P1} =~ 'A wild lugroki awaits orders to head into battle.') \
        /substitute -p %{PL}@{nCyellow}A lugroki berserker (awaits) @{Cgreen}(@{nCred}E@{nCgreen}, 84, lugroki)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'A wild and seemingly unstoppable beast charges across the battlefield.') \
        /substitute -p %{PL}@{nCyellow}A lugroki berserker (charges) @{Cgreen}(@{nCred}E@{nCgreen}, 84, lugroki)@{n}%{P2}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}A lugroki berserker (awaits/charges) @{Cgreen}(@{nCred}E@{nCgreen}, 84, lugroki)@{n}%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(A cunning drow-elf ponders her next mission to the stronghold\.|Vunir the drow-elf saboteur is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstBattlefieldsVunir = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Vunir the drow-elf saboteur @{Cgreen}(@{nCred}E@{nCgreen}, 85, drow-elf?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A wise shaman is standing here boiling exotic ingredients in a pot\.|The lugroki Shaman is here)(, fighting [^\.!]+.|)" tfMobsubstBattlefieldsShaman = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The lugroki Shaman @{Cgreen}(N, 87, lugroki?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A warrior from an advance unit of the lugroki stands here\.|A lugroki raider is here)(, fighting [^\.!]+.|)" tfMobsubstBattlefieldsLRaider = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A lugroki raider @{Cgreen}(N, 88, lugroki)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A powerful battle troll seeks opposing armies to butcher\.|A Battle Troll is here)(, fighting [^\.!]+.|)" tfMobsubstBattlefieldsBTroll = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Battle Troll @{Cgreen}(N, 90, troll)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A drow-elf saboteur is busy plotting here\.|Borlak the drow-elf saboteur is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstBattlefieldsBorlak = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Borlak the drow-elf saboteur @{Cgreen}(@{nCred}E@{nCgreen}, 90, drow-elf?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An envoy from the kingdom of Guallidurth negotiates with the lugroki here\.|The drow-elf Envoy is here)(, fighting [^\.!]+.|)" tfMobsubstBattlefieldsEnvoy = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The drow-elf Envoy @{Cgreen}(N, 92, drow-elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The warlord of the lugroki paces wildly around the room\.|The lugroki Warlord is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstBattlefieldsLWarlord = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The lugroki Warlord @{Cgreen}(@{nCred}E@{nCgreen}, 92, lugroki?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An alliance commander drenched in lugroki blood battles here\.|The Brettonian Battlemaster is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstBattlefieldsBattlemaster = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Brettonian Battlemaster @{Cgreen}(@{hCwhite}G@{nCgreen}, 95, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A gigantic troll covered in siege armour destroy's all in it's path\.|A Siege Troll is here)(, fighting [^\.!]+.|)" tfMobsubstBattlefieldsSiegeTroll = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Siege Troll @{Cgreen}(N, 95, troll?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A bellowing roar is unleashed from the darkness!!! \(hidden\)|The Colossus \(hidden\) is here)(, fighting [^\.!]+.|)" tfMobsubstBattlefieldsColossus = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Colossus @{Cgreen}(N, 100, giant, special-group-blind)@{n} (hide)%{P2}%{PR}%; \
    /endif

; -----------------------  Black Castle  -----------------------
/def -p99 -F -mregexp -t"(A cook is here making dinner\.|The cook servant is here)" tfMobsubstBlackcastleCookServant = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The cook servant @{Cgreen}(N, 30, human)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A soldier stands here guarding\.|The castle guard is here)" tfMobsubstBlackcastleCastleGuard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The castle guard @{Cgreen}(N, 35, human)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An archer is here pointing a bow at you\.|The archer is here)" tfMobsubstBlackcastleArcher = \
    /if (mobsubs & ({P1} != 'The archer is here' | area =~ 'BlackCastle')) \
      /substitute -p %{PL}@{nCyellow}The archer @{Cgreen}(N, 40, human)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A cook is here arranging dinner\.|The cook is here)" tfMobsubstBlackcastleCook = \
    /if (mobsubs & ({P1} != 'The cook is here' | area =~ 'BlackCastle')) \
      /substitute -p %{PL}@{nCyellow}The cook @{Cgreen}(N, 45, human)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A mercenary looks at you, licks his mouth and smiles\.|The mercenary is here)" tfMobsubstBlackcastleMercenary = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The mercenary @{Cgreen}(N, 45, human)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A black skeleton is here\.|The black skeleton is here)" tfMobsubstBlackcastleBlackSkeleton = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The black skeleton @{Cgreen}(N, 50, skeleton)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The captain is here, looking at some maps\.|The captain of the guards is here)" tfMobsubstBlackcastleCaptain = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The captain of the guards @{Cgreen}(N, 55, human)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The commander of the defense forces stands here\.|The commander is here)" tfMobsubstBlackcastleCommander = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The commander @{Cgreen}(N, 60, human)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A hunter uruk orc hides in the shadows\. \(hidden\)|The uruk orc \(hidden\) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstBlackcastleUrukOrc = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The uruk orc @{Cgreen}(@{nCred}E@{nCgreen}, 60, orc)@{n} (hide)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A black knight is here polishing his shield\.|The black knight is here)" tfMobsubstBlackcastleBlackKnight = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The black knight @{Cgreen}(N, 65, insubstantial)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The black wraith is here\.|The black wraith is here)" tfMobsubstBlackcastleWraith = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The black wraith @{Cgreen}(N, 65, insubstantial)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A druid sits here, writing some scrolls\.|The silver druid is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstBlackcastleSilverDruid = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The silver druid @{Cgreen}(@{nCred}E@{nCgreen}, 65, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An archmage is here reading some documents\.|The archmage is here)" tfMobsubstBlackcastleArchmage = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The archmage @{Cgreen}(N, 70, human)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A dark elf bard is here, playing evil sounds on his flute\.|The dark-elf bard is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstBlackcastleBard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The dark-elf bard @{Cgreen}(@{nCred}E@{nCgreen}, 70, drow-elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p100 -F -mregexp -t"(A necromancer stands here in the shadows\.|The necromancer is here)" tfMobsubstBlackcastleNecromancer = \
    /if (mobsubs & ({P1} =~ 'A necromancer stands here in the shadows.' | area =~ 'BlackCastle')) \
      /substitute -p %{PL}@{nCyellow}The necromancer @{Cgreen}(N, 70, human)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Hammershield the barbarian stands here, equipped for combat\.|Hammershield is here)" tfMobsubstBlackcastleHammershield = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Hammershield @{Cgreen}(N, 75, ---)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The prince of evil is here\.|The prince of evil is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstBlackcastlePrinceOfEvil = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The prince of evil @{Cgreen}(@{nCred}E@{nCgreen}, 75, devil)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The undead skeleton king sits here in his throne\.( \(invisible\)|)|The undead king( \(invisible\)|) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstBlackcastleKing = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}The undead king @{Cgreen}(@{nCred}E@{nCgreen}, 80, skeleton, pkill)@{n}%{invisTxt}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A silver dragon stands here breathing fire\.|The silver dragon is here)" tfMobsubstBlackcastleDragon = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The silver dragon @{Cgreen}(N, 85, dragon)@{n}%{PR}%; \
    /endif

; -----------------------  Burning Towers  -----------------------

; -----------------------  Canyon  -----------------------
/def -p99 -F -mregexp -t"(The tiny elemental scurries by doing his master's bidding\.|An elemental servant is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCanyonElemServant = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An elemental servant @{Cgreen}(@{hCwhite}G@{nCgreen}, 2, elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A mountain climber is making the same trek that you are\.|The mountain climber is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCanyonClimber = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The mountain climber @{Cgreen}(@{hCwhite}G@{nCgreen}, 3, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A small eddie current swirls junk around here\.|An eddie is here)" tfMobsubstCanyonEddie = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An eddie @{Cgreen}(N, 7, elemental)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A small rock\.|A small rock is here)" tfMobsubstCanyonRock = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A small rock @{Cgreen}(N, 8, elemental)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A frozen snowflake water elemental\.|A small snowflake is here)" tfMobsubstCanyonSnowflake = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A small snowflake @{Cgreen}(N, 8, elemental)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A small flickering flame elemental\.|A flame is here)" tfMobsubstCanyonFlame = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A flame @{Cgreen}(N, 9, elemental)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A small spark of electricity fizzles here\.|A small spark is here)" tfMobsubstCanyonSmallSpark = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A small spark @{Cgreen}(N, 9, elemental)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A little imp runs along being annoying\. \(hidden\)|A little imp \(hidden\) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstCanyonImp = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A little imp @{Cgreen}(@{nCred}E@{nCgreen}, 10, magical)@{n} (hide)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A sub-atomic particle is too small for you to see\.|A particle is here)" tfMobsubstCanyonParticle = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A particle @{Cgreen}(N, 10, elemental)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A dust cloud blowing by makes you sneeze\.|A dust cloud is here)" tfMobsubstCanyonDustCloud = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A dust cloud @{Cgreen}(N, 11, elemental)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The air is magically misty here\.|An elemental mist is here)" tfMobsubstCanyonMist = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An elemental mist @{Cgreen}(N, 11, elemental)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A mud monster slops around\.|A mud monster is here)" tfMobsubstCanyonMudMonster = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A mud monster @{Cgreen}(N, 12, elemental)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A lava beast spews from place to place\.|A lava beast is here)" tfMobsubstCanyonLavaBeast = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A lava beast @{Cgreen}(N, 13, elemental)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A small puddle of water elemental\.|A puddle is here)" tfMobsubstCanyonPuddle = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A puddle @{Cgreen}(N, 13, elemental)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A small blob of acid aimlessly eats away at the stone\.|A small blob of acid is here)" tfMobsubstCanyonBlob = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A small blob of acid @{Cgreen}(N, 14, elemental)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A small, rather non-descript elemental\.|A small elemental is here)" tfMobsubstCanyonSmallElemental = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A small elemental @{Cgreen}(N, 15, elemental)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A medium-sized elemental\.|A medium elemental is here)" tfMobsubstCanyonMediumElemental = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A medium elemental @{Cgreen}(N, 17, elemental)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A baby rainbow dragon plays among the elements here\.|A baby rainbow dragon is here)" tfMobsubstCanyonDragon = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A baby rainbow dragon @{Cgreen}(N, 21, dragon)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A hungry cyclops snarls at you!|The Cyclops is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstCanyonCyclops = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Cyclops @{Cgreen}(@{nCred}E@{nCgreen}, 22, giant)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An elemental magician seeks magical stones for a spell\.( \(invisible\)|)|An elemental magician( \(invisible\)|) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstCanyonMagician = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}An elemental magician @{Cgreen}(@{nCred}E@{nCgreen}, 22, human)@{n}%{invisTxt}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The illusionist seeks the aid of the elemental forces\.|An illusionist is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstCanyonIllusionist = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An illusionist @{Cgreen}(@{nCred}E@{nCgreen}, 22, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An alchemist wanders by in search of magical herbs\.|An alchemist is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstCanyonAlchemist = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An alchemist @{Cgreen}(@{nCred}E@{nCgreen}, 23, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A large elemental\.|A large elemental is here)" tfMobsubstCanyonLargeElemental = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A large elemental @{Cgreen}(N, 23, elemental)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A warrior of the Rainbow Cult swears his loyalty\.|A rainbow warrior is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCanyonWarrior = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A rainbow warrior @{Cgreen}(@{hCwhite}G@{nCgreen}, 23, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The elemental guardian of the canyon is here\.|The elemental guardian is here)" tfMobsubstCanyonGuardian = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The elemental guardian @{Cgreen}(N, 28, elemental)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Blue Flame burns mysteriously here\.|The Blue Flame is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstCanyonBlueFlame = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Blue Flame @{Cgreen}(@{nCred}E@{nCgreen}, 45, elemental)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Hurricane rages across the sky\.|The Hurricane is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstCanyonHurricane = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Hurricane @{Cgreen}(@{nCred}E@{nCgreen}, 45, elemental)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Ice Bandit strikes cold fear in your heart\.|The Ice Bandit is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstCanyonIceBandit = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Ice Bandit @{Cgreen}(@{nCred}E@{nCgreen}, 45, elemental)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Magneto considers zapping you for the heck of it\.|The Magneto is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstCanyonMagneto = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Magneto @{Cgreen}(@{nCred}E@{nCgreen}, 45, elemental)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Rock Monster considers you in stoney silence\.|The Rock Monster is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstCanyonRockMonster = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Rock Monster @{Cgreen}(@{nCred}E@{nCgreen}, 45, elemental)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Ruler of the air elementals\.|The Air Ruler is here)" tfMobsubstCanyonAirRuler = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Air Ruler @{Cgreen}(N, 60, elemental)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Ruler of the earth elementals\.|The Earth Ruler is here)" tfMobsubstCanyonEarthRuler = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Earth Ruler @{Cgreen}(N, 60, elemental)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Ruler of the fire elementals\.|The Fire Ruler is here)" tfMobsubstCanyonFireRuler = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Fire Ruler @{Cgreen}(N, 60, elemental)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Ruler of the lightning elementals\.|The Lightning Ruler is here)" tfMobsubstCanyonLightningRuler = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Lightning Ruler @{Cgreen}(N, 60, elemental)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Ruler of the water elementals\.|The Water Ruler is here)" tfMobsubstCanyonWaterRuler = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Water Ruler @{Cgreen}(N, 60, elemental)@{n}%{PR}%; \
    /endif

; -----------------------  Catacombs  -----------------------
/set tfMobsubstCatacombsVampFound 0
/def -p99 -F -mregexp -t"(A bat flaps wildly at you!|The vampire is here|A bat is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstCatacombsBat = \
    /if (mobsubs) \
      /if ({P1} =~ 'The vampire is here' | {P3} =~ ' (Red Aura)') \
        /substitute -p %{PL}@{nCyellow}The vampire @{Cgreen}(@{nCred}E@{nCgreen} 15, vampire)@{n}%{P2}%{PR}%; \
        /set tfMobsubstCatacombsVampFound 1%; \
        /repeat -1 1 /set tfMobsubstCatacombsVampFound 0%; \
      /elseif (!tfMobsubstCatacombsVampFound & {P1} !~ 'The bat is here') \
        /substitute -p %{PL}@{nCyellow}A bat/The vampire @{Cgreen}(N/@{nCred}E@{nCgreen}, 5/15, animal/vampire)@{n}%{PR}%; \
        /set tfMobsubstCatacombsVampFound 1%; \
        /repeat -1 1 /set tfMobsubstCatacombsVampFound 0%; \
      /else \
        /substitute -p %{PL}@{nCyellow}A bat @{Cgreen}(N, 5, animal)@{n}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(A templar page in training is here looking mildly confused\.|A templar page is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCatacombsTemplarPage = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A templar page @{Cgreen}(@{hCwhite}G@{nCgreen}, 7, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A spelunker knows his way around these tunnels\.|A spelunker is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCatacombsSpelunker = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A spelunker @{Cgreen}(@{hCwhite}G@{nCgreen}, 8, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A graverobber uncovers dead bodies\.|A graverobber is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstCatacombsGraverobber = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A graverobber @{Cgreen}(@{nCred}E@{nCgreen}, 9, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p100 -F -mregexp -t"(It is here\.|It is here)" tfMobsubstCatacombsIt = \
    /if (mobsubs & ({P1} != 'It is here' | area =~ 'Catacombs')) \
      /substitute -p %{PL}@{nCyellow}It @{Cgreen}(N, 10, insubstantial)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Some mist swirls about you here ... it seems ALIVE!|Some mist is here)" tfMobsubstCatacombsMist = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Some mist @{Cgreen}(N, 10, insubstantial)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A skeletal soldier fights in the battle of the underworld\.|A skeleton is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstCatacombsSkeleton = \
    /if (mobsubs & area =~ 'Catacombs') \
      /substitute -p %{PL}@{nCyellow}A skeleton @{Cgreen}(@{nCred}E@{nCgreen}, 11, skeleton)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A mysterious ghostly wraith forms before your eyes\.|A mysterious wraith is here)" tfMobsubstCatacombsWraith = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A mysterious wraith @{Cgreen}(N, 12, insubstantial)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A templar shouts \"AKK! SLAY THE INFIDEL!\"|A templar is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCatacombsTemplar = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A templar @{Cgreen}(@{hCwhite}G@{nCgreen}, 12, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A templar officer keeps an eye on things here\.|The templar officer is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCatacombsTemplarOfficer = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The templar officer @{Cgreen}(@{hCwhite}G@{nCgreen}, 13, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A blank-faced zombie mage joins the battle\.|Zombie is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstCatacombsZombie = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Zombie @{Cgreen}(@{nCred}E@{nCgreen}, 13, undead)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Eerie shadows fill the room\.|The shadow is here)" tfMobsubstCatacombsShadow = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The shadow @{Cgreen}(N, 14, insubstantial)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The evil necromancer makes undead soldiers from corpses\.|The evil necromancer is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstCatacombsNecromancer = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The evil necromancer @{Cgreen}(@{nCred}E@{nCgreen}, 15, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The grand templar stands here quietly observing your actions|The grand templar is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCatacombsGrandTemplar = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The grand templar @{Cgreen}(@{hCwhite}G@{nCgreen}, 16, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The light shines off a beautiful but dangerous dragon lurking here\.|The prism dragon is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstCatacombsDragon = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The prism dragon @{Cgreen}(@{nCred}E@{nCgreen}, 20, dragon)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(You hear and smell the presense of the darkenbeast\.|The DarkenBeast is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstCatacombsDarkenBeast = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The DarkenBeast @{Cgreen}(@{nCred}E@{nCgreen}, 24, magical)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Cathedral  -----------------------
/def -p99 -F -mregexp -t"(A skeletal human is standing here, looking rather confused\.|The human skeleton is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCathedralHumanSkeleton = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The human skeleton @{Cgreen}(@{hCwhite}G@{nCgreen}, 6, skeleton)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A corpse is standing upright here, wandering these halls\.|The zombie is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCathedralZombie = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The zombie @{Cgreen}(@{hCwhite}G@{nCgreen}, 7, undead)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A strange corpse-like being is here attacking a man in black robes!|A strange corpse-like being is plodding towards the woman!|The ghoul is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCathedralTheGhoul = \
    /if (mobsubs) \
      /if ({P1} =~ 'A strange corpse-like being is here attacking a man in black robes!') \
        /substitute -p %{PL}@{nCyellow}The ghoul (attacking) @{Cgreen}(@{hCwhite}G@{nCgreen}, 8, undead)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'A strange corpse-like being is plodding towards the woman!') \
        /substitute -p %{PL}@{nCyellow}The ghoul (plodding) @{Cgreen}(@{hCwhite}G@{nCgreen}, 8, undead)@{n}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}The ghoul (attacking/plodding) @{Cgreen}(@{hCwhite}G@{nCgreen}, 8, undead)@{n}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(A shadow made of inky blackness moves along the wall towards you\.|The shadow is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstCathedralShadow = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The shadow @{Cgreen}(@{nCred}E@{nCgreen}, 8, insubstantial)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A hideous creature is here, mere skin and bones, howling madly\.|The wight is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstCathedralWight = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The wight @{Cgreen}(@{nCred}E@{nCgreen}, 8, undead)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A strange humanoid shape moves towards you.  It is a wraith!|The wraith is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstCathedralWraith = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The wraith @{Cgreen}(@{nCred}E@{nCgreen}, 8, insubstantial)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A portly ghost is sitting on an ethereal bed, singing softly to himself\.|The ghost of the Abbott is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCathedralAbbott = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The ghost of the Abbott @{Cgreen}(@{hCwhite}G@{nCgreen}, 12, insubstantial)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A man, dressed in black and silver robes, is fighting off some undead!|The man is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstCathedralTheMan = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The man @{Cgreen}(@{nCred}E@{nCgreen}, 13, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A strange humanoid form stands in one corner of the room, singing\.|The banshee is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCathedralBanshee = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The banshee @{Cgreen}(@{hCwhite}G@{nCgreen}, 15, undead)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A woman dressed in dark robes watches the approaching undead in fear\.|Esmerelda the priestess is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstCathedralEsmerelda = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Esmerelda the priestess @{Cgreen}(@{nCred}E@{nCgreen}, 17, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A pale white man dressed in a black stands before you\.|Erich is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstCathedralErich = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Erich @{Cgreen}(@{nCred}E@{nCgreen}, 19, vampire)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A rather large zombie is lumbering about here, quite aimlessly\.|The giant zombie is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCathedralGiantZombie = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The giant zombie @{Cgreen}(@{hCwhite}G@{nCgreen}, 25, undead)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A strange and deformed being stands here tugging on a bell rope\. \(hidden\)|Isaac \(hidden\) is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCathedralIsaac = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Isaac @{Cgreen}(@{hCwhite}G@{nCgreen}, 25, human)@{n} (hide)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(It is on this ledge that Wyrenthoth sits, preening him... itself\.|Wyrenthoth is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstCathedralWyrenthoth = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Wyrenthoth @{Cgreen}(@{nCred}E@{nCgreen}, 27, dragon)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Caverns  -----------------------
/def -p99 -F -mregexp -t"(A Varak-Ki is lying here\.|A Varak-Ki woman is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstCavernsVarakWoman = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Varak-Ki woman @{Cgreen}(@{nCred}E@{nCgreen}, 15, lugroki)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Rock Gnome is standing here\.|A Rock Gnome is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCavernsRGnome = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Rock Gnome @{Cgreen}(@{hCwhite}G@{nCgreen}, 25, large/superlarge)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Varak-Ki is standing here\.|A Varak-Ki is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstCavernsVarakKi = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Varak-Ki @{Cgreen}(@{nCred}E@{nCgreen}, 25, lugroki)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Varak-Ki guard is standing here\.|A Varak-Ki guard is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstCavernsVarakGuard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Varak-Ki guard @{Cgreen}(@{nCred}E@{nCgreen}, 29, lugroki)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Rock Gnome Guard is standing here\.|A Rock Gnome Guard is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCavernsRGnomeGuard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Rock Gnome Guard @{Cgreen}(@{hCwhite}G@{nCgreen}, 30, large/superlarge)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Varak-Ki Thug is sneaking around here\. \(hidden\)|A Varak-Ki Thug \(hidden\) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstCavernsVarakThug = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Varak-Ki Thug @{Cgreen}(@{nCred}E@{nCgreen}, 30, lugroki)@{n} (hide)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Varak-Ki warrior is standing here looking dangerous\.|A Varak-Ki warrior is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstCavernsVarakWarrior = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Varak-Ki warrior @{Cgreen}(@{nCred}E@{nCgreen}, 33, lugroki)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Rock Gnome Warikk is standing here\.|A Rock Gnome Warikk is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCavernsRGnomeWarikk = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Rock Gnome Warikk @{Cgreen}(@{hCwhite}G@{nCgreen}, 37, large/superlarge)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Varak-Ki Alchemist is contemplating a new potion here\.|A Varak-Ki Alchemist is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstCavernsVarakAlchemist = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Varak-Ki Alchemist @{Cgreen}(@{nCred}E@{nCgreen}, 40, lugroki)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Chubby the gnome is standing here polishing his bald spot\.|Chubby the gnome is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCavernsChubby = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Chubby the gnome @{Cgreen}(@{hCwhite}G@{nCgreen}, 45, large/superlarge)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Varak-Ki Warleader is standing here\.|A Varak-Ki Warleader is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstCavernsVarakWarleader = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Varak-Ki Warleader @{Cgreen}(@{nCred}E@{nCgreen}, 51, lugroki)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Gnome Illusionist is standing here, thinking about something irrellevant\.( \(invisible\)|)|A Gnome Illusionist( \(invisible\)|) is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCavernsIllusionist = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}A Gnome Illusionist @{Cgreen}(@{hCwhite}G@{nCgreen}, 55, large/superlarge)@{n}%{invisTxt}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Gnome combat master is standing here\.|The Gnome combat master is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCavernsCombatMaster = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Gnome combat master @{Cgreen}(@{hCwhite}G@{nCgreen}, 62, large/superlarge)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Gnome Boss is standing here\.|The Gnome boss is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCavernsGnomeBoss = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Gnome boss @{Cgreen}(@{hCwhite}G@{nCgreen}, 64, large/superlarge)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A large cloaked man is standing here\. \(invisible\)|The ogre shaman \(invisible\) is here)(, fighting [^\.!]+.|)" tfMobsubstCavernsShaman = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The ogre shaman @{Cgreen}(N, 74, magical)@{n} (imp)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Varak-Ki Tribe Chief is standing here pondering your situation\.|The Varak-Ki Tribe Chief is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstCavernsVarakChief = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Varak-Ki Tribe Chief @{Cgreen}(@{nCred}E@{nCgreen}, 78, lugroki)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Great Black Dragon is lying here digesting his latest meal\.|The Great Black Dragon is resting here\.|The Great Black Dragon is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstCavernsDragon = \
    /if (mobsubs) \
      /if ({P1} =~ 'The Great Black Dragon is resting here.') \
        /substitute -p %{PL}@{nCyellow}The Great Black Dragon @{Cgreen}(@{nCred}E@{nCgreen}, 91, dragon/ice, sitting)@{n}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}The Great Black Dragon @{Cgreen}(@{nCred}E@{nCgreen}, 91, dragon/ice)@{n}%{PR}%; \
      /endif%; \
    /endif

; -----------------------  Ceanyth Dungeons  -----------------------
/def -p99 -F -mregexp -t"(A young prisoner looks wearily at you\.|A prisoner is here)" tfMobsubstCeanythDungeonsYoungPrisoner = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A prisoner @{Cgreen}(N, 60, human)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A skinny man hides in the shadows\.|A innocent young woman is resting here\.|The prisoner is here)" tfMobsubstCeanythDungeonsPrisonerSkinWom = \
    /if (mobsubs) \
      /if ({P1} =~ 'A skinny man hides in the shadows.') \
        /substitute -p %{PL}@{nCyellow}The prisoner (skinny) @{Cgreen}(N, 60, human)@{n}%{PR}%; \
      /elseif ({P1} =~ 'A innocent young woman is resting here.') \
        /substitute -p %{PL}@{nCyellow}The prisoner (woman) @{Cgreen}(N, 60, human)@{n}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}The prisoner (skinny/woman) @{Cgreen}(N, 60, human)@{n}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(An orc merchant is standing here\.|An orc is here)(, fighting [^\.!]+.|)" tfMobsubstCeanythDungeonsMerchantOrc = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An orc @{Cgreen}(N, 65, orc)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A prisoner looks angrily around him\.|An orc fighter is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstCeanythDungeonsOrcFighter = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An orc fighter @{Cgreen}(@{nCred}E@{nCgreen}, 65, orc)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An orc prisoner stands here\.|Orc prisoner is here)" tfMobsubstCeanythDungeonsOrcPrisoner = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Orc prisoner @{Cgreen}(N, 65, orc)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A worn out guard stands watch here\.|A guard is here)(, fighting [^\.!]+.|)" tfMobsubstCeanythDungeonsWornoutGuard = \
    /if (mobsubs & area !~ 'HighLands') \
      /substitute -p %{PL}@{nCyellow}A guard @{Cgreen}(N, 70, troll)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A muscular guard stands watch here\.|An alert guard is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstCeanythDungeonsAlertguard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An alert guard @{Cgreen}(@{nCred}E@{nCgreen}, 75, troll)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An ugly beast lurks here\.|A hairy beast is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstCeanythDungeonsHairybeast = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A hairy beast @{Cgreen}(@{nCred}E@{nCgreen}, 80, lugroki)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A creepy monster stands in front of you\.|A creepy monster is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstCeanythDungeonsCreepymonster = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A creepy monster @{Cgreen}(@{nCred}E@{nCgreen}, 80, lugroki)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Chessboard  -----------------------
/def -p99 -F -mregexp -t"(You see a pawn standing here waiting for orders\.|The Pawn of the (Black|White) Court is here)(, fighting [^\.!]+.|)( \(Red Aura\)| \(White Aura\)|)" tfMobsubstChessboardPawn = \
    /if (mobsubs) \
      /if ({P4} =~ ' (Red Aura)' | {P2} =~ 'Black') \
        /substitute -p %{PL}@{nCyellow}The Pawn of the Black Court @{Cgreen}(@{nCred}E@{nCgreen}, 6, human)@{n}%{P3}%{PR}%; \
      /elseif ({P4} =~ ' (White Aura)' | {P2} =~ 'White') \
        /substitute -p %{PL}@{nCyellow}The Pawn of the White Court @{Cgreen}(@{hCwhite}G@{nCgreen}, 6, human)@{n}%{P3}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}The Pawn of the Black/White Court @{Cgreen}(@{nCred}E@{nCgreen}/@{hCwhite}G@{nCgreen}, 6, human)@{n}%{P3}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(A dark priest stands here\.|The Black Bishop is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstChessboardBlackBishop = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Black Bishop @{Cgreen}(@{nCred}E@{nCgreen}, 24, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A light priest stands here\.|The White Bishop is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstChessboardWhiteBishop = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The White Bishop @{Cgreen}(@{hCwhite}G@{nCgreen}, 24, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(In the corner you see a large, black, stone castle on wheels\.|The Black Rook is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstChessboardBlackRook = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Black Rook @{Cgreen}(@{nCred}E@{nCgreen}, 27, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(In the corner you see a large, white, stone castle on wheels\.|The White Rook is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstChessboardWhiteRook = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The White Rook @{Cgreen}(@{hCwhite}G@{nCgreen}, 27, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Here stands a magnificent knight of the dark realm\.|The Black Knight is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstChessboardBlackKnight = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Black Knight @{Cgreen}(@{nCred}E@{nCgreen}, 40, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Here stands a magnificent knight of the light realm\.|The White Knight is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstChessboardWhiteKnight = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The White Knight @{Cgreen}(@{hCwhite}G@{nCgreen}, 40, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Black Queen stands here\.|The Black Queen is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstChessboardBlackQueen = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Black Queen @{Cgreen}(@{nCred}E@{nCgreen}, 45, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The White Queen stands here\.|The White Queen is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstChessboardWhiteQueen = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The White Queen @{Cgreen}(@{hCwhite}G@{nCgreen}, 45, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Black King stands here\.|The Black King is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstChessboardBlackKing = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Black King @{Cgreen}(@{nCred}E@{nCgreen}, 55, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The White King stands here\.|The White King is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstChessboardWhiteKing = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The White King @{Cgreen}(@{hCwhite}G@{nCgreen}, 55, human)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Ciquala's Lair  -----------------------
/def -p99 -F -mregexp -t"(A lab assistant turns toward you and bares his fangs!|The vampire lab assistant is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstCiqualasLabAss = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The vampire lab assistant @{Cgreen}(@{nCred}E@{nCgreen}, 22, vampire)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(There is something lurking up near the ceiling|The lurker above is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstCiqualasLurker = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The lurker above @{Cgreen}(@{nCred}E@{nCgreen}, 27, magical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A mindless automaton that used to be human is standing here\.|The human automaton is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstCiqualasHumAutomaton = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The human automaton @{Cgreen}(@{nCred}E@{nCgreen}, 30/33/36/39, entity)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Guardian Lich steps out of the shadows and attacks!( \(invisible\)|)|Guardian Lich( \(invisible\)|) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstCiqualasGuardianLich = \
    /if (mobsubs & area =~ 'CiqualasLair') \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}Guardian Lich @{Cgreen}(@{nCred}E@{nCgreen}, 33, undead)@{n}%{invisTxt}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A docile creature stands here, probably from an experiment that failed\.|A docile creature is here)" tfMobsubstCiqualasDocileCreature = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A docile creature @{Cgreen}(N, 35, magical)@{n}%{PR}%; \
    /endif
/set tfMobsubstCiqualaCratesFound 0
/def -p99 -F -mregexp -t"(A crate stands here\.|The black pudding is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstCiqualasPudding = \
    /if (mobsubs & area =~ 'CiqualasLair') \
      /if ({P1} =~ 'The black pudding is here' | {P3} =~ ' (Red Aura)' | tfMobsubstCiqualaCratesFound == 3) \
        /substitute -p %{PL}@{nCyellow}The black pudding @{Cgreen}(@{nCred}E@{nCgreen}, 37, jelly)@{n}%{PR}%; \
        /set tfMobsubstCiqualaCratesFound 5%; \
        /repeat -1 1 /set tfMobsubstCiqualaCratesFound 0%; \
      /else \
        /set tfMobsubstCiqualaCratesFound=$[{tfMobsubstCiqualaCratesFound} + 1]%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(The Lich wonders what you are doing in its crypt\.( \(invisible\)|)|Lich( \(invisible\)|) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstCiqualasLich = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}Lich @{Cgreen}(@{nCred}E@{nCgreen}, 37, undead)@{n}%{invisTxt}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A vampire servant to Ciquala is here, hungering for your blood\.|A vampire servant is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstCiqualasVampServant = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A vampire servant @{Cgreen}(@{nCred}E@{nCgreen}, 37, vampire)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A warped creature as if from a nightmare is here\.|A warped creature from a nightmare is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstCiqualasWarpedCreature = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A warped creature from a nightmare @{Cgreen}(@{nCred}E@{nCgreen}, 40, magical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A blackened creature stands here, ready to cause you excruciating pain\.|The torturer lich is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstCiqualasTorturerLich = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The torturer lich @{Cgreen}(@{nCred}E@{nCgreen}, 41, undead)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An undead guardian screams at you and attacks!( \(invisible\)|)|The undead guardian( \(invisible\)|) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstCiqualasUndeadGuardian = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}The undead guardian @{Cgreen}(@{nCred}E@{nCgreen}, 45, undead)@{n}%{invisTxt}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The vampire is very hungry.  With you here, he won't even have to go out|Vampire( \(invisible\)|) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstCiqualasVampire = \
    /let mobName=@{nCyellow}Vampire @{Cgreen}(@{nCred}E@{nCgreen}, 47, vampire)@{n}%; \
    /if ({P2} =~ " (invisible)") \
      /let invisTxt= (invis)%; \
    /else \
      /let invisTxt=%; \
    /endif%; \
    /if (mobsubs & {P1} !~ "The vampire is very hungry.  With you here, he won't even have to go out") \
      /substitute -p %{PL}%{mobName}%{invisTxt}%{P3}%{PR}%; \
    /elseif (mobsubs) \
      /substitute%; \
      /def -p99 -F -n1 -mregexp -t"hunting for fresh blood tonight\\.( \\(invisible\\)|)( \\(Red Aura\\)|)" tfMobsubstSpecial = \
        /if ({P1} =~ " (invisible)") \
          /let invisTxt= (invis)%%; \
        /else \
          /let invisTxt=%%; \
        /endif%%; \
        /substitute -p %%{PL}%{mobName}%%{invisTxt}%%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Ciquala's undead pet dragon is here, snacking on a fresh corpse\.|Ciquala's undead pet dragon is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstCiqualasPetDragon = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Ciquala's undead pet dragon @{Cgreen}(@{nCred}E@{nCgreen}, 50, dragon)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A gigantic automaton blocks your way\.|A gigantic automaton is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstCiqualasGigAutomaton = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A gigantic automaton @{Cgreen}(N, 50, entity)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A powerful, evil looking lich stands here, Ciquala, the oldest of all the|The lich Ciquala is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstCiqualasLichCiquala = \
    /let mobName=@{nCyellow}The lich Ciquala @{Cgreen}(@{nCred}E@{nCgreen}, 52, undead)@{n}%; \
    /if (mobsubs & {P1} !~ "A powerful, evil looking lich stands here, Ciquala, the oldest of all the") \
      /substitute -p %{PL}%{mobName}%{P2}%{PR}%; \
    /elseif (mobsubs) \
      /substitute%; \
      /def -p99 -F -n1 -mregexp -t"^undead\\.( \\(Red Aura\\)|)" tfMobsubstSpecial = \
        /substitute -p %%{PL}%{mobName}%%{PR}%; \
    /endif

; -----------------------  Circus  -----------------------
/def -p99 -F -mregexp -t"(The knife thrower's assistant is asleep against the target\.|The knife thrower's assistant is here)" tfMobsubstCircusAssistant = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The knife thrower's assistant @{Cgreen}(N, 1, human)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Little Bobby is lost, and is looking for his mommy\.|Little Bobby is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCircusBobby = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Little Bobby @{Cgreen}(@{hCwhite}G@{nCgreen}, 1, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t'(A member of the audience goes "Ooooh!   Ahhhhh!"|A member of the audience is here)' tfMobsubstCircusMember = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A member of the audience @{Cgreen}(N, 1, human)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A red-nosed clown is ready to throw a pie in your face\.|A red-nosed clown is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCircusRNClown = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A red-nosed clown @{Cgreen}(@{hCwhite}G@{nCgreen}, 1, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A small child waits in line for the Big Top\.|A small child is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCircusChild = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A small child @{Cgreen}(@{hCwhite}G@{nCgreen}, 1, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Sword Swallower is in the act of swallowing an entire bastard sword\.|The Sword Swallower is here)" tfMobsubstCircusSwallower = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Sword Swallower @{Cgreen}(N, 1, human)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An animal keeper is here, taking care of the animals\.|An animal keeper is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCircusAnimalKeeper = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An animal keeper @{Cgreen}(@{hCwhite}G@{nCgreen}, 3, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Bobby's mother is here, frantically calling out her son's name\.|Bobby's mother is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCircusBobbysMother = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Bobby's mother @{Cgreen}(@{hCwhite}G@{nCgreen}, 3, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The child's mother stands here, patiently waiting in line\.|The child's mother is here)" tfMobsubstCircusChildsMother = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The child's mother @{Cgreen}(N, 3, human)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A clown with big shoes is trying to get into a small car\.|A clown with big shoes is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCircusBSClown = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A clown with big shoes @{Cgreen}(@{hCwhite}G@{nCgreen}, 3, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Midget is here, doing acrobatics to amuse the crowd\.|A Midget is here, stealing money from the crowd\.|The Midget is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstCircusMidgetAmusing = \
    /if (mobsubs) \
      /if ({P1} =~ 'A Midget is here, doing acrobatics to amuse the crowd.') \
        /substitute -p %{PL}@{nCyellow}The Midget (amusing) @{Cgreen}(@{nCred}E@{nCgreen}, 3, hobbit)@{n}%{PR}%; \
      /elseif ({P1} =~ 'A Midget is here, stealing money from the crowd.') \
        /substitute -p %{PL}@{nCyellow}The Midget (stealing) @{Cgreen}(@{nCred}E@{nCgreen}, 3, hobbit)@{n}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}The Midget (amusing/stealing) @{Cgreen}(@{nCred}E@{nCgreen}, 3, hobbit)@{n}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(A poor white horse is here, about to have a horn implanted in it's head\.|A poor horse is here)" tfMobsubstCircusPoorHorse = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A poor horse @{Cgreen}(N, 3, ---)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A guard dog growls at you, then attacks\.|A guard dog)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstCircusGuardDog = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A guard dog @{Cgreen}(@{nCred}E@{nCgreen}, 4, canine)@{n}%{P2}%{PR}%; \
    /endif
/def -p100 -F -mregexp -t"(A trained horse is here, prancing in anticipation\.|A horse is here)" tfMobsubstCircusTrainedHorse = \
    /if (mobsubs & ({P1} != 'A trained horse is here, prancing in anticipation.' | area =~ 'Circus')) \
      /substitute -p %{PL}@{nCyellow}A horse @{Cgreen}(N, 4, ---)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The knife thrower is getting ready to throw 4 knifes at his assistant\.|The knife thrower is here)" tfMobsubstCircusKnifeThrower = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The knife thrower @{Cgreen}(N, 4, human)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Bearded Lady is here\.|The Bearded Lady is here)" tfMobsubstCircusBeardedLady = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Bearded Lady @{Cgreen}(N, 5, human)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A big clown is getting ready to throw confetti at you\.|A big clown is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCircusBigClown = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A big clown @{Cgreen}(@{hCwhite}G@{nCgreen}, 5, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The child's father is here\.|The child's father is here)" tfMobsubstCircusFather = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The child's father @{Cgreen}(N, 5, human)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Illusionist is here, doing tricks to amaze the crowd\.|The Illusionist is here)" tfMobsubstCircusIllusionist = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Illusionist @{Cgreen}(N, 5, human)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A tightrope walker balances on the wire\.|A tightrope walker is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCircusTRWalker = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A tightrope walker @{Cgreen}(@{hCwhite}G@{nCgreen}, 5, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The trained bear hasn't been fed in a week.  Look out!|A trained bear is here)" tfMobsubstCircusBear = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A trained bear @{Cgreen}(N, 6, animal)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"The cotton candy vendor waits to take your money." tfMobsubstCircusVendor = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The cotton candy vendor @{Cgreen}(@{hCwhite}G@{nCgreen}, 7, shopkeeper)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Ivan the Strongman poses for the crowd\.|Ivan is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCircusIvan = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Ivan @{Cgreen}(@{hCwhite}G@{nCgreen}, 7, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A ferocious Lion leaps from his stand to attack you!|A ferocious Lion is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstCircusLion = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A ferocious Lion @{Cgreen}(@{nCred}E@{nCgreen}, 8, feline)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The lion tamer is putting his head in a lion's mouth\.|The lion tamer is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCircusLionTamer = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The lion tamer @{Cgreen}(@{hCwhite}G@{nCgreen}, 8, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The greedy Circus owner is about to cut into the poor horse\.|The Circus Owner is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstCircusOwner = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Circus Owner @{Cgreen}(@{nCred}E@{nCgreen}, 10, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An elephant nudges you with his trunk, asking for peanuts\.|An elephant is here)" tfMobsubstCircusElephant = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An elephant @{Cgreen}(N, 10, animal)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"The Ringmaster is introducing the next act\." tfMobsubstCircusRingmaster = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Ringmaster @{Cgreen}(N, 10, no-attack)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Binky's chef stands here, ready to carve the turkey\.|Binky's chef is here)(, fighting [^\.!]+.|)" tfMobsubstCircusChef = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Binky's chef @{Cgreen}(N, 18, human)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"The Ticket Clerk is here offering to sell tickets to the big top." tfMobsubstCircusClerk = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Ticket Clerk @{Cgreen}(@{hCwhite}G@{nCgreen}, 31, shopkeeper)@{n}%{PR}%; \
    /endif

; -----------------------  Citadel  -----------------------
/def -p99 -F -mregexp -t"(A horse stands here, minding its own business\.|The horse is here)" tfMobsubstCitadelHorse = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The horse @{Cgreen}(N, 20, ---)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A reveller is having a good time here\.|The reveller is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCitadelReveller = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The reveller @{Cgreen}(@{hCwhite}G@{nCgreen}, 22, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A beautiful elven woman is here, sitting in the bath\.|The bather is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCitadelBather = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The bather @{Cgreen}(@{hCwhite}G@{nCgreen}, 25, elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A guest is resting on the bed\.|The guest is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCitadelGuest = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The guest @{Cgreen}(@{hCwhite}G@{nCgreen}, 25, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p100 -F -mregexp -t"(A servant is here, tidying up the master's quarters\.|The servant is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCitadelServant = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The servant @{Cgreen}(@{hCwhite}G@{nCgreen}, 25, elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The cook is standing here\.|The cook is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCitadelCook = \
    /if (mobsubs & ({P1} != 'The cook is here' | area =~ 'Citadel')) \
      /substitute -p %{PL}@{nCyellow}The cook @{Cgreen}(@{hCwhite}G@{nCgreen}, 30, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A wincher is here, opening the portcullis for approved visitors\.|The wincher is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCitadelWincher = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The wincher @{Cgreen}(@{hCwhite}G@{nCgreen}, 45, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The blacksmith is here repairing weapons and armor\.|The blacksmith is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCitadelBlacksmith = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The blacksmith @{Cgreen}(@{hCwhite}G@{nCgreen}, 50, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A guard is here, asleep on his bed\.|The sleepy guard is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCitadelSleepyGuard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The sleepy guard @{Cgreen}(@{hCwhite}G@{nCgreen}, 52, elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A sentry is here patrolling the battlements\.|The sentry is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCitadelSentry = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The sentry @{Cgreen}(@{hCwhite}G@{nCgreen}, 55, elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An archer is here scanning the horizon for attackers\.|The archer is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCitadelArcher = \
    /if (mobsubs & ({P1} != 'The archer is here' | area =~ 'Citadel')) \
      /substitute -p %{PL}@{nCyellow}The archer @{Cgreen}(@{hCwhite}G@{nCgreen}, 57, elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p100 -F -mregexp -t"(A guard is here patrolling the courtyard\.|The guard is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCitadelGuard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The guard @{Cgreen}(@{hCwhite}G@{nCgreen}, 60, elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A large man dressed in half plate stands here, watching you carefully\.|The elite guard is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCitadelEliteGuard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The elite guard @{Cgreen}(@{hCwhite}G@{nCgreen}, 62, elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A tall statue of a large man dressed in full plate armor stands here\.|The laen golem is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCitadelLaenGolem = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The laen golem @{Cgreen}(@{hCwhite}G@{nCgreen}, 65, entity)@{n}%{P2}%{PR}%; \
    /endif%; \
    /if (pg & autoassist) \
      assist%; \
    /endif
/def -p99 -F -mregexp -t"(A tall, glimmering statue stands here, seeming to watch over the room\.|The mithril golem is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCitadelMithrilGolem = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The mithril golem @{Cgreen}(@{hCwhite}G@{nCgreen}, 65, entity)@{n}%{P2}%{PR}%; \
    /endif%; \
    /if (pg & autoassist) \
      assist%; \
    /endif
/def -p99 -F -mregexp -t"(The Lady of the Citadel stands here, preparing for dinner\.|Lady Nydethiel is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCitadelLady = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Lady Nydethiel @{Cgreen}(@{hCwhite}G@{nCgreen}, 70, elf)@{n}%{P2}%{PR}%; \
    /endif%; \
    attackIfLeaderEtc lady none%; \
    /if (pg & autoassist) \
      assist%; \
    /endif
/def -p99 -F -mregexp -t"(The Lord of the Citadel is here looking at his maps\.|Lord Ceanyth is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCitadelLord = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Lord Ceanyth @{Cgreen}(@{hCwhite}G@{nCgreen}, 80, elf)@{n}%{P2}%{PR}%; \
    /endif%; \
    /if (pg & autoassist) \
      assist%; \
    /endif
/def -p99 -F -t"The * says 'Hey! You're not supposed to be here!'" tfMobsubstCitadeRandagg = \
    /if (pg & autoassist) \
      assist%; \
    /endif

; -----------------------  Citadel of Order  -----------------------
/def -p99 -F -mregexp -t"(A slimy leech is here\.|A slimy leech is here)" tfMobsubstCitadelOOLeech = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A slimy leech @{Cgreen}(N, 5, amphibian)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A hunting falcon sits on it's perch here\.|A hunting falcon is here)" tfMobsubstCitadelOOFalcon = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A hunting falcon @{Cgreen}(N, 10, bird)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A big crocodile is swimming around in the mud here\.|A big crocodil is here)" tfMobsubstCitadelOOCrocodile = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A big crocodile @{Cgreen}(N, 30, animal)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An initiate of the order is hurrying along to get his chores done\.|An initiate of the order is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstCitadelOOInitiate = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An initiate of the order @{Cgreen}(@{nCred}E@{nCgreen}, 36, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Dark Paladin is standing here\.|A Dark Paladin of the first ring is here|A Dark Paladin of the second ring is here|A Dark Paladin of the third ring is here|An evil paladin knight is here|A Dark Paladin of the fourth ring is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstCitadelOOSomeKindOfPaladin = \
    /if (mobsubs) \
      /if ({P1} =~ 'A Dark Paladin is standing here.') \
        /substitute -p %{PL}@{nCyellow}Dark/evil Paladin... @{Cgreen}(@{nCred}E@{nCgreen}, 41-56, human)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'A Dark Paladin of the first ring is here') \
        /substitute -p %{PL}@{nCyellow}A Dark Paladin of the first ring @{Cgreen}(@{nCred}E@{nCgreen}, 41, human)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'A Dark Paladin of the second ring is here') \
        /substitute -p %{PL}@{nCyellow}A Dark Paladin of the second ring @{Cgreen}(@{nCred}E@{nCgreen}, 46, human)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'A Dark Paladin of the third ring is here') \
        /substitute -p %{PL}@{nCyellow}A Dark Paladin of the third ring @{Cgreen}(@{nCred}E@{nCgreen}, 50/51, human)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'An evil paladin knight is here') \
        /substitute -p %{PL}@{nCyellow}An evil paladin knight @{Cgreen}(@{nCred}E@{nCgreen}, 52, human)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'A Dark Paladin of the fourth ring is here') \
        /substitute -p %{PL}@{nCyellow}A Dark Paladin of the fourth ring @{Cgreen}(@{nCred}E@{nCgreen}, 56, human)@{n}%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -msimple -t"in rank. He's been trained as a soldier so he rather powerful built. His eyes " tfMobsubstCitadelOOPaladin3 = \
    tfpromptshow Lvl 51 paladin. Doesn't heal.
/def -p99 -F -mregexp -t"(A bronze Golem is standing guard here\.|A bronze golem is here)" tfMobsubstCitadelOOBronzeGolem = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A bronze golem @{Cgreen}(N, 57, magical)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Paladin knight is standing here\.|A Dark Paladin knight is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstCitadelOODarkPaladinKnight = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Dark Paladin knight @{Cgreen}(@{nCred}E@{nCgreen}, 62, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Evil Paladin knight is standing here\.|A Paladin knight is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstCitadelOOPaladinKnight = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Paladin knight @{Cgreen}(@{nCred}E@{nCgreen}, 65, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A steel Golem is standing guard here\.|A steel golem  is here)" tfMobsubstCitadelOOSteelGolem = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A steel golem @{Cgreen}(N, 68, magical)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Vile Templar is standing here\.|A templar is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstCitadelOOTemplar = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A templar @{Cgreen}(@{nCred}E@{nCgreen}, 71, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Evil Templar guard is standing here\.|The Templar guard is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstCitadelOOTemplarGuard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Templar guard @{Cgreen}(@{nCred}E@{nCgreen}, 75, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(the ghost of Irokis is hovering around in the air\.|The ghost of Irokis is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCitadelOOIrokis = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The ghost of Irokis @{Cgreen}(@{hCwhite}G@{nCgreen}, 87, insubstantial)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Dark Paladin Master-of-Arms is standing here\.|The Dark Paladin Master-of-Arms is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstCitadelOOMasterOfArms = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Dark Paladin Master-of-Arms @{Cgreen}(@{nCred}E@{nCgreen}, 90, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Dark Paladin grand master is standing here\.|The Dark Paladin grand master is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstCitadelOODPGM = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Dark Paladin grand master @{Cgreen}(@{nCred}E@{nCgreen}, 95, human)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Clerists  -----------------------
/def -p99 -F -mregexp -t"(A cook stands here...cooking\.|A cook is here)" tfMobsubstCleristsCook = \
    /if (mobsubs & area =~ 'Clerists') \
      /substitute -p %{PL}@{nCyellow}A cook @{Cgreen}(N, 20, human)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The metalsmith's assistant is scurrying about here\.|The metalsmith's assistant is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCleristsMSAssistant = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The metalsmith's assistant @{Cgreen}(@{hCwhite}G@{nCgreen}, 20, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Piranha viciously snaps it's jaws here\.|A Piranha is here)" tfMobsubstCleristsPiranha = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Piranha @{Cgreen}(N, 20, fish)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Servant stands here serving the meals to the hungry knights\.|A servant is here)" tfMobsubstCleristsServant = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A servant @{Cgreen}(N, 20, human)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Knight stands resolute here\.|The Honour Knight is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCleristsHonourKnight = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Honour Knight @{Cgreen}(@{hCwhite}G@{nCgreen}, 30, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(You see a stable hand tending the horses here\.|A Stable Hand is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCleristsStableHand = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Stable Hand @{Cgreen}(@{hCwhite}G@{nCgreen}, 30, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Knight sits here feeding his face\.|A Dining Knight is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCleristsDiningKnight = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Dining Knight @{Cgreen}(@{hCwhite}G@{nCgreen}, 35, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Squire stands here\.|A Squire is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCleristsSquire = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Squire @{Cgreen}(@{hCwhite}G@{nCgreen}, 35, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(You see a Knight here working on his technique\.|A Training Knight is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCleristsTrainingKnight = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Training Knight @{Cgreen}(@{hCwhite}G@{nCgreen}, 35, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An Imprisoned rogue sits here in his own misery\.|A Rogue is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstCleristsRogue = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Rogue @{Cgreen}(@{nCred}E@{nCgreen}, 40, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Knight of Solamnia stands sentry guard here\.|A Sentry Knight is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCleristsSentryKnight = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Sentry Knight @{Cgreen}(@{hCwhite}G@{nCgreen}, 40, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(You see a War-horse eating grain here\.|A War-horse is here)" tfMobsubstCleristsWarHorse = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A War-horse @{Cgreen}(N, 40, ---)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(You see a Knight of Solamnia sleeping here\.|A Knight of Solamnia is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCleristsKnightOfSol = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Knight of Solamnia @{Cgreen}(@{hCwhite}G@{nCgreen}, 45, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Minotaur sits here disgraced\.|A Minotaur is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstCleristsMinotaur = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Minotaur @{Cgreen}(@{nCred}E@{nCgreen}, 45, ---)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Cleric of Paladine stands here worshipping his god\.|A Cleric of Paladine is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCleristsClericOP = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Cleric of Paladine @{Cgreen}(@{hCwhite}G@{nCgreen}, 50, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Knight of the Crown stands here\.|A Knight of the Crown is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCleristsKnightOTCrown = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Knight of the Crown @{Cgreen}(@{hCwhite}G@{nCgreen}, 50, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Knight of the Sword stands here\.|A Knight of the Sword is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCleristsKnightOTSword = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Knight of the Sword @{Cgreen}(@{hCwhite}G@{nCgreen}, 55, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Unit Commander contemplates here\.|A Unit Commander is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCleristsUnitCommander = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Unit Commander @{Cgreen}(@{hCwhite}G@{nCgreen}, 55, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Tactical Advisor stands here studying the map\.|The Tactical Advisor is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCleristsTacticalAdvisor = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Tactical Advisor @{Cgreen}(@{hCwhite}G@{nCgreen}, 60, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Knight of the Rose stands here\.|A Knight of the Rose is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCleristsKnightOTRose = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Knight of the Rose @{Cgreen}(@{hCwhite}G@{nCgreen}, 65, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Member of the Honour guard stand vigilant here\.|The Honour Guard is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCleristsHonourGuard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Honour Guard @{Cgreen}(@{hCwhite}G@{nCgreen}, 75, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Lord Knight stands here\.|A Lord Knight is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCleristsLordKnight = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Lord Knight @{Cgreen}(@{hCwhite}G@{nCgreen}, 75, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Crazed Blue Dragon circles here\.|A Crazed Blue Dragon is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstCleristsCrazedDragon = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Crazed Blue Dragon @{Cgreen}(@{nCred}E@{nCgreen}, 80, dragon)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Fallen Knight stands guarding the Chamber of Paladine\.|A Fallen Knight is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCleristsFallenKnight = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Fallen Knight @{Cgreen}(@{hCwhite}G@{nCgreen}, 80, undead)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Instructor is here teaching new techniques to his students\.|The Instructor is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCleristsInstructor = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Instructor @{Cgreen}(@{hCwhite}G@{nCgreen}, 80, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Metalsmith bangs away at a piece of molten steel\.|The Metalsmith is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCleristsMetalsmith = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Metalsmith @{Cgreen}(@{hCwhite}G@{nCgreen}, 80, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A knight in shining armour is here, cleaning his sword\.|Sir Jarrod Edgeworth, the Knight of Tears is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCleristsJarrod = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Sir Jarrod Edgeworth, the Knight of Tears @{Cgreen}(@{hCwhite}G@{nCgreen}, 90, QM)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The spirit of Alfred MarKenin wavers before you\.|The spirit of Alfred MarKenin is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCleristsAlfred = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The spirit of Alfred MarKenin @{Cgreen}(@{hCwhite}G@{nCgreen}, 90, insubstantial)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Spirit of Derek Crownguard wavers before you\.|The Spirit of Derek Crownguard is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCleristsDerek = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Spirit of Derek Crownguard @{Cgreen}(@{hCwhite}G@{nCgreen}, 90, insubstantial)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Gunthar Uth Wiston Lord Knight of the Rose stands here\.|Gunthar Uth Wiston is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCleristsGunthar = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Gunthar Uth Wiston @{Cgreen}(@{hCwhite}G@{nCgreen}, 95, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Skye the great blue dragon circles here\.|Skye is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstCleristsSkye = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Skye @{Cgreen}(@{nCred}E@{nCgreen}, 95, dragon)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(You see the Spirit of Sturm Brightblade standing here\.|The Spirit of Sturm Brightblade is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCleristsSturm = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Spirit of Sturm Brightblade @{Cgreen}(@{hCwhite}G@{nCgreen}, 100, insubstantial)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  CohnShar  -----------------------
/def -p99 -F -mregexp -t"A man stands here ready to sell his soul for a buck." tfMobsubstCohnSharShopkeeper = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Shopkeeper @{Cgreen}(N, 1, shopkeeper)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Trader is resting here\.|The trader of fortunes, and misfortunes stands here.)" tfMobsubstCohnSharTheTrader = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Trader @{Cgreen}(N, 1, QM)@{n}%{PR}%; \
    /endif
/set consideredFrog 0
/def -p99 -F -mregexp -t"(u_n_k_n_o_w_n|A Frog is here)" tfMobsubstCohnSharFrog = \
    /if (owner =~ 'Cindy' & mylevel <= 100 & !consideredFrog) \
      /tfshow CONSIDER FROG!!!%; \
      consider frog%; \
      /set consideredFrog 1%; \
    /endif%; \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Frog @{Cgreen}(?, ?, ???)@{n}%{PR}%; \
    /endif
/set consideredGnat 0
/def -p99 -F -mregexp -t"(u_n_k_n_o_w_n|A Gnat is here)" tfMobsubstCohnSharGnat = \
    /if (owner =~ 'Cindy' & mylevel <= 100 & !consideredGnat) \
      /tfshow CONSIDER GNAT!!!%; \
      consider gnat%; \
      /set consideredGnat 1%; \
    /endif%; \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Gnat @{Cgreen}(?, ?, ???)@{n}%{PR}%; \
    /endif
/set consideredLocust 0
/def -p99 -F -mregexp -t"(u_n_k_n_o_w_n|A Locust is here)" tfMobsubstCohnSharLocust = \
    /if (owner =~ 'Cindy' & mylevel <= 87 & !consideredLocust) \
      /tfshow CONSIDER LOCUST!!!%; \
      consider locust%; \
      /set consideredLocust 1%; \
    /endif%; \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Locust @{Cgreen}(N, 1-77, ???)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A sleepy traveller lies here trying to stay awake\.|A sleepy traveller is here)" tfMobsubstCohnSharSleepyTraveller = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A sleepy traveller @{Cgreen}(N, 30, human)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A tired local shopper is here resting\.|A tired shopper is here)" tfMobsubstCohnSharTiredShopper = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A tired shopper @{Cgreen}(N, 30, human)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A tired trader from around here is resting\.|A tired trader is here)" tfMobsubstCohnSharTiredTrader = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A tired trader @{Cgreen}(N, 30, human)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A man who has travelled a huge distance to be here\.|A Distant Trader is here)" tfMobsubstCohnSharDistantTrader = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Distant Trader @{Cgreen}(N, 35, human)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A trader from the east stands here shopping\.|A Eastern Trader is here)" tfMobsubstCohnSharEasternTrader = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Eastern Trader @{Cgreen}(N, 35, human)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A man of egypt stands here trying to trade\.|An Egyptian Trader)" tfMobsubstCohnSharEgyptianTrader = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An Egyptian Trader @{Cgreen}(N, 35, human)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A shopper from around here tries to buy things\.|A Local Shopper is here)" tfMobsubstCohnSharLocalShopper = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Local Shopper @{Cgreen}(N, 35, human)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A trader from the north stands here shopping\.|A Northern Trader is here)" tfMobsubstCohnSharNorthernTrader = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Northern Trader @{Cgreen}(N, 35, human)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A trader from the south stands here shopping\.|A Southern Trader is here)" tfMobsubstCohnSharSouthernTrader = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Southern Trader @{Cgreen}(N, 35, human)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A trader from the west stands here shopping\.|A Western Trader is here)" tfMobsubstCohnSharWesternTrader = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Western Trader @{Cgreen}(N, 35, human)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A sneaky thief hides here in the shadows\. \(hidden\)|A Sneaky Thief \(hidden\) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstCohnSharThief = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Sneaky Thief @{Cgreen}(@{nCred}E@{nCgreen}, 40, human)@{n} (hide)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(u_n_k_n_o_w_n|A warrior stands here looking at antiquity\.|A warrior stands here overseeing the protection of Egypt\.|A warrior stands here protecting the gates of the palace\.|A warrior stands here protecting the palace\.|A warrior lies here resting\.|A Medjai Warrior is here)" tfMobsubstCohnSharWarrior = \
    /if (mobsubs) \
      /if (currentroom =~ 'The Room of a Guard') \
        /substitute -p %{PL}@{nCyellow}A Medjai Warrior (summoned) @{Cgreen}(?, 69, human/iron)@{n}%{PR}%; \
      /elseif ({P1} =~ 'A warrior stands here looking at antiquity.') \
        /substitute -p %{PL}@{nCyellow}A Medjai Warrior (looking) @{Cgreen}(N, 80, human/iron)@{n}%{PR}%; \
      /elseif ({P1} =~ 'A warrior stands here overseeing the protection of Egypt.') \
        /substitute -p %{PL}@{nCyellow}A Medjai Warrior (overseeing) @{Cgreen}(N, 80, human/iron)@{n}%{PR}%; \
      /elseif ({P1} =~ 'A warrior stands here protecting the gates of the palace.') \
        /substitute -p %{PL}@{nCyellow}A Medjai Warrior (prot.gates) @{Cgreen}(N, 80, human/iron)@{n}%{PR}%; \
      /elseif ({P1} =~ 'A warrior stands here protecting the palace.') \
        /substitute -p %{PL}@{nCyellow}A Medjai Warrior (prot.palace) @{Cgreen}(N, 80, human/iron)@{n}%{PR}%; \
      /elseif ({P1} =~ 'A warrior lies here resting.') \
        /substitute -p %{PL}@{nCyellow}A Medjai Warrior (resting) @{Cgreen}(N, 80, human/iron)@{n}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}A Medjai Warrior @{Cgreen}(N, 80, human/iron)@{n}%{PR}%; \
      /endif%; \
    /endif%; \
    /if (currentroom !~ 'The Room of a Guard') \
      attackIfLeaderEtc warrior none%; \
    /endif
/def -p99 -F -msimple -t"A Medjai Warrior is dead! R.I.P." tfMobsubstCohnSharRIPWar = \
    /if (groupleader =~ name & initiator =~ 'none' & autoattack) \
      k warrior%; \
    /endif
/def -p99 -F -mregexp -t"(The captain of the Medjai stands here\.|Ghalotiri, the leader of the Medjai is here)" tfMobsubstCohnSharGhalotiri = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Ghalotiri, the leader of the Medjai @{Cgreen}(N, 95, human?, murder)@{n}%{PR}%; \
      /def -p99 -F -n1 -ag -mregexp -t"...surrounded by sheer beauty." tfMobsubstCohnSharGhalotiriGag%; \
    /endif
/def -p99 -F -mregexp -t"(An ancient pharoah of Egypt stands here\.|Tirises the Pharaoh is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstCohnSharTirises = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Tirises the Pharaoh @{Cgreen}(@{nCred}E@{nCgreen}, 100, pure?, deathspell)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Court  -----------------------
/def -p99 -F -mregexp -t"(The Hemlock is here looking for something to eat\. \(invisible\)|A Hemlock \(invisible\) is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCourtHemlock = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Hemlock @{Cgreen}(@{hCwhite}G@{nCgreen}, 36, human)@{n} (imp)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Aruso is sitting behind his desk trying to get a thread through a|Aruso \(invisible\) is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCourtAruso = \
    /let mobName=@{nCyellow}Aruso @{Cgreen}(@{hCwhite}G@{nCgreen}, 40, human)@{n} (imp)%; \
    /if (mobsubs & {P1} !~ "Aruso is sitting behind his desk trying to get a thread through a") \
      /substitute -p %{PL}%{mobName}%{P2}%{PR}%; \
    /elseif (mobsubs) \
      /substitute%; \
      /def -p99 -F -n1 -mregexp -t"needle\\. \\(invisible\\)( \\(White Aura\\)|)" tfMobsubstSpecial = \
        /substitute -p %%{PL}%{mobName}%%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Astebeth is sitting here, looking nervously around\.|Astebeth is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCourtAstebeth = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Astebeth @{Cgreen}(@{hCwhite}G@{nCgreen}, 40, drow-elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An Insomniac is stumbling around in here trying to keep his head|Insomniac \(invisible\) is here)" tfMobsubstCourtInsomniac = \
    /let mobName=@{nCyellow}Insomniac @{Cgreen}(N, 40, troll)@{n} (imp)%; \
    /if (mobsubs & {P1} !~ "An Insomniac is stumbling around in here trying to keep his head") \
      /substitute -p %{PL}%{mobName}%{PR}%; \
    /elseif (mobsubs) \
      /substitute%; \
      /def -p99 -F -n1 -mregexp -t"^upright\\. \\(invisible\\)" tfMobsubstSpecial = \
        /substitute -p %%{PL}%{mobName}%%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The boozer is standing here leaning against a wall, just about to|The boozer \(invisible\) is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCourtBoozer = \
    /let mobName=@{nCyellow}The boozer @{Cgreen}(@{hCwhite}G@{nCgreen}, 45, drow-elf)@{n} (imp)%; \
    /if (mobsubs & {P1} !~ "The boozer is standing here leaning against a wall, just about to") \
      /substitute -p %{PL}%{mobName}%{P2}%{PR}%; \
    /elseif (mobsubs) \
      /substitute%; \
      /def -p99 -F -n1 -mregexp -t"fall asleep\\. \\(invisible\\)( \\(White Aura\\)|)" tfMobsubstSpecial = \
        /substitute -p %%{PL}%{mobName}%%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A convict is nailed to the wall with 9 inch nails\. \(invisible\)|A convict \(invisible\) is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCourtConvict = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A convict @{Cgreen}(@{hCwhite}G@{nCgreen}, 45, human)@{n} (imp)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Old fellow Jack is standing here trying to pour a drink\.|Old fellow Jack is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCourtJack = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Old fellow Jack @{Cgreen}(@{hCwhite}G@{nCgreen}, 55, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Cahjaani is looking down upon you, considering your every move\. \(invisible\)|Judge Cahjaani \(invisible\) is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCourtCahjaani = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Judge Cahjaani @{Cgreen}(@{hCwhite}G@{nCgreen}, 75, human)@{n} (imp)%{P2}%{PR}%; \
    /endif

; -----------------------  Coven  -----------------------
/def -p99 -F -mregexp -t"(A young girl desperate to be initiated into the coven must wait here\.|A neophyte of the coven is here)" tfMobsubstCovenNeophyte = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A neophyte of the coven @{Cgreen}(N, 30, ---)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An apprentice of the hive busies herself here\.|An apprentice of the evergreen forest is here)" tfMobsubstCovenFApprentice = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An apprentice of the evergreen forest @{Cgreen}(N, 40, ---)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A haggard wench is here reciting incantations\.|A wench of the evergreen forest is here)" tfMobsubstCovenFWench = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A wench of the evergreen forest @{Cgreen}(N, 43, ---)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An elderly woman skilled in witchcraft is busy conjuring here\.|A conjurer of the evergreen forest is here)" tfMobsubstCovenFConjurer = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A conjurer of the evergreen forest @{Cgreen}(N, 47, ---)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An experienced witch dressed in ceremonial clothing calls to her gods here\.|The priestess of the evergreen forest hive is here)" tfMobsubstCovenFPriestess = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The priestess of the evergreen forest hive @{Cgreen}(N, 49, ---)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A young female student of the hive is busy learning spells\.|A student of the sacred earth is here)" tfMobsubstCovenEStudent = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A student of the sacred earth @{Cgreen}(N, 50, ---)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A scarred harridan of the hive mopes about here\.|A harridan of the sacred earth is here)" tfMobsubstCovenEHarridan = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A harridan of the sacred earth @{Cgreen}(N, 53, ---)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A skilled enchantress dressed in brown earthly robes stands here\.|An enchantress of the sacred earth is here)" tfMobsubstCovenEEnchantress = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An enchantress of the sacred earth @{Cgreen}(N, 57, ---)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The ruling priestess of the hive walks around overseeing her brood\.|The priestess of the sacred earth hive is here)" tfMobsubstCovenEPriestess = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The priestess of the sacred earth hive @{Cgreen}(N, 59, ---)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A young graduate of the solar circle hive studies her craft here\.|A graduate of the solar circle is here)" tfMobsubstCovenSGraduate = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A graduate of the solar circle @{Cgreen}(N, 60, ---)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A mean-looking virago is here looking for graduates to bully\.|A virago of the solar circle is here)" tfMobsubstCovenSVirago = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A virago of the solar circle @{Cgreen}(N, 63, ---)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An elderly shrew, adept in the magic of the sun, stands here grinning\.|A shrew of the solar circle is here)" tfMobsubstCovenSShrew = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A shrew of the solar circle @{Cgreen}(N, 67, ---)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The priestess of the hive oversees the witches under her control here\.|The priestess of the solar circle hive is here)" tfMobsubstCovenSPriestess = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The priestess of the solar circle hive @{Cgreen}(N, 69, ---)@{n}%{PR}%; \
    /endif
/set consideredIllM 0
/def -p99 -F -mregexp -t"(u_n_k_n_o_w_n|An illusion of the crescent moon is here)" tfMobsubstCovenIllusionM = \
    /if (owner =~ 'Cindy' & mylevel <= 100 & !consideredIllM) \
      /tfshow CONSIDER ILLUSION/MOON!!!%; \
      consider illusion%; \
      consider moon%; \
      /set consideredIllM 1%; \
    /endif%; \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An illusion of the crescent moon @{Cgreen}(N, ?, ???)@{n}%{PR}%; \
    /endif
/set consideredIllF 0
/def -p99 -F -mregexp -t"(u_n_k_n_o_w_n|An illusion of the evergreen forest is here)" tfMobsubstCovenIllusionF = \
    /if (owner =~ 'Cindy' & mylevel <= 81 & !consideredIllF) \
      /tfshow CONSIDER ILLUSION/FOREST!!!%; \
      consider illusion%; \
      consider forest%; \
      /set consideredIllF 1%; \
    /endif%; \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An illusion of the evergreen forest @{Cgreen}(N, 1-71, ???)@{n}%{PR}%; \
    /endif
/set consideredIllE 0
/def -p99 -F -mregexp -t"(u_n_k_n_o_w_n|An illusion of the sacred earth is here)" tfMobsubstCovenIllusionE = \
    /if (owner =~ 'Cindy' & mylevel <= 82 & !consideredIllE) \
      /tfshow CONSIDER ILLUSION/EARTH!!!%; \
      consider illusion%; \
      consider earth%; \
      /set consideredIllE 1%; \
    /endif%; \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An illusion of the sacred earth @{Cgreen}(N, 69-72, ???)@{n}%{PR}%; \
    /endif
/set consideredIllW 0
/def -p99 -F -mregexp -t"(u_n_k_n_o_w_n|An illusion of the silver winds is here)" tfMobsubstCovenIllusionW = \
    /if (owner =~ 'Cindy' & mylevel <= 82 & !consideredIllW) \
      /tfshow CONSIDER ILLUSION/SILVER!!!%; \
      consider illusion%; \
      consider silver%; \
      /set consideredIllW 1%; \
    /endif%; \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An illusion of the silver winds @{Cgreen}(N, 69-72, ???)@{n}%{PR}%; \
    /endif
/set consideredIllS 0
/def -p99 -F -mregexp -t"(u_n_k_n_o_w_n|An illusion of the solar circle is here)" tfMobsubstCovenIllusionS = \
    /if (owner =~ 'Cindy' & mylevel <= 81 & !consideredIllS) \
      /tfshow CONSIDER ILLUSION/SOLAR!!!%; \
      consider illusion%; \
      consider solar%; \
      /set consideredIllS 1%; \
    /endif%; \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An illusion of the solar circle @{Cgreen}(N, 69-71, ???)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An eager young scholar practices her magic here\.|A scholar of the silver winds is here)" tfMobsubstCovenWScholar = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A scholar of the silver winds @{Cgreen}(N, 70, ---)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An ugly old hag stands around awaiting a scholar's servitude\.|A hag of the silver winds is here)" tfMobsubstCovenWHag = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A hag of the silver winds @{Cgreen}(N, 73, ---)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An expert sorceress stands here performing wonderful magic\.|A sorceress of the silver winds is here)" tfMobsubstCovenWSorceress = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A sorceress of the silver winds @{Cgreen}(N, 77, ---)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A powerful priestess dressed in the robes of the silver winds stands here\.|The priestess of the silver winds hive is here)" tfMobsubstCovenWPriestess = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The priestess of the silver winds hive @{Cgreen}(N, 79, ---)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A young initiate of the hive awaits instruction from her superiors here\.|An initiate of the crescent moon is here)" tfMobsubstCovenMInitiate = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An initiate of the crescent moon @{Cgreen}(N, 80, ---)@{n}%{PR}%; \
    /endif%; \
    attackIfLeaderEtc initiate none
/def -p99 -F -mregexp -t"(An old crone of the hive scrunches her face up at your presence\.|A crone of the crescent moon is here)" tfMobsubstCovenMCrone = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A crone of the crescent moon @{Cgreen}(N, 83, ---)@{n}%{PR}%; \
    /endif%; \
    attackIfLeaderEtc crone none
/def -p99 -F -mregexp -t"(A powerful witch of the hive is busy creating new incantations\.|A witch of the crescent moon is here)" tfMobsubstCovenMWitch = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A witch of the crescent moon @{Cgreen}(N, 87, ---)@{n}%{PR}%; \
    /endif%; \
    attackIfLeaderEtc witch none
/def -p99 -F -mregexp -t"(An astute witch wearing the ceremonial robes of the crescent moon is here\.|The priestess of the crescent moon hive is here)" tfMobsubstCovenMPriestess = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The priestess of the crescent moon hive @{Cgreen}(N, 89, ---)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The beautiful and deadly high-priestess absorbs the pentagrams power here\.|The high-priestess of the witches coven is here)" tfMobsubstCovenHighPriestess = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The high-priestess of the witches coven @{Cgreen}(N, 99, ---)@{n}%{PR}%; \
    /endif

; -----------------------  Crystalmir  -----------------------
/def -p99 -F -mregexp -t"(A small mouse runs across your foot\.|A field mouse is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCrystalmirMouse = \
    /if (mobsubs & area !~ 'Gnome') \
      /substitute -p %{PL}@{nCyellow}A field mouse @{Cgreen}(@{hCwhite}G@{nCgreen}, 4, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A farm worker is here harvesting grain\.|Farm worker is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCrystalmirFarmWorker = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Farm worker @{Cgreen}(@{hCwhite}G@{nCgreen}, 5, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A large rat is here eating grain\.|A large rat is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstCrystalmirRat = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A large rat @{Cgreen}(@{nCred}E@{nCgreen}, 5, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An old worn out winnie the pooh bear is here\.|Old pooh bear is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCrystalmirPoohBear = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Old pooh bear @{Cgreen}(@{hCwhite}G@{nCgreen}, 5, entity)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A fish is swimming merrily by\.\.\.|Strange fish is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCrystalmirStrangeFish = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Strange fish @{Cgreen}(@{hCwhite}G@{nCgreen}, 5, fish)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A small hobgoblin seems to be searching for something\.|Hobgoblin flunky is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstCrystalmirFlunky = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Hobgoblin flunky @{Cgreen}(@{nCred}E@{nCgreen}, 6, lugroki)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A robed figure is standing here\.|Baaz Draconian is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstCrystalmirBaaz = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Baaz Draconian @{Cgreen}(@{nCred}E@{nCgreen}, 7, magical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(there is a barracuda swimming around you...it looks hungry\.\.|Barracuda is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCrystalmirBarracuda = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Barracuda @{Cgreen}(@{hCwhite}G@{nCgreen}, 7, fish)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Farmer's guarddog is here guarding whatever he's suppose to guard\.|Farmers guarddog is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCrystalmirGuardDog = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Farmers guarddog @{Cgreen}(@{hCwhite}G@{nCgreen}, 7, canine)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Farmer is standing here looking after his workers\.\.\.|The Farmer is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCrystalmirFarmer = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Farmer @{Cgreen}(@{hCwhite}G@{nCgreen}, 10, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Fewmaster Toede is here\.|Fewmaster Toede is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstCrystalmirToede = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Fewmaster Toede @{Cgreen}(@{nCred}E@{nCgreen}, 12, amphibian)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A beautiful white stag is here\.|The White Stag is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstCrystalmirStag = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The White Stag @{Cgreen}(@{nCred}E@{nCgreen}, 17, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(There is a very large Turtle dragon here\.|Turtle dragon is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstCrystalmirTurtle = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Turtle dragon @{Cgreen}(@{nCred}E@{nCgreen}, 27, dragon)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Riverwind the Ranger is standing here\.\.|Riverwind is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCrystalmirRiverwind = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Riverwind @{Cgreen}(@{hCwhite}G@{nCgreen}, 30, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Goldmoon is singing a beautiful song here\.|Goldmoon is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstCrystalmirGoldmoon = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Goldmoon @{Cgreen}(@{hCwhite}G@{nCgreen}, 44, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(u_n_k_n_o_w_n|Chaos Entity is here)(, fighting [^\.!]+.|)" tfMobsubstCrystalmirChaosEntity = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Chaos Entity @{Cgreen}(N, 90, entity)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A farmer weeps as he wanders around aimlessly. You should ask if|Archibald Jolten is here)(, fighting [^\.!]+.|)" tfMobsubstCrystalmirJolten = \
    /let mobName=@{nCyellow}Archibald Jolten @{Cgreen}(N, 100, QM)@{n}%; \
    /if (mobsubs & {P1} !~ "A farmer weeps as he wanders around aimlessly. You should ask if") \
      /substitute -p %{PL}%{mobName}%{P2}%{PR}%; \
    /elseif (mobsubs) \
      /substitute%; \
      /def -p99 -F -n1 -mregexp -t"^he needs some help." tfMobsubstSpecial = \
        /substitute -p %%{PL}%{mobName}%%{PR}%; \
    /else \
      /substitute -p @{nCyellow}A farmer @{h} (Archibald J)@{n} weeps... You should ask if%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Gretta the Old Sage rocks back and forward here\.|Gretta the Old Sage is here)(, fighting [^\.!]+.|)" tfMobsubstCrystalmirGretta = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Gretta the Old Sage @{Cgreen}(N, 100, no-attack)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Darkenwood  -----------------------
/def -p99 -F -mregexp -t"(A rat is creeping here in the dark\.|A rat is here)(, fighting [^\.!]+.|)" tfMobsubstDarkenwoodRat = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A rat @{Cgreen}(N, 15, rodent)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A short hairy spider is looking at you!|A spider is here)(, fighting [^\.!]+.|)" tfMobsubstDarkenwoodSpider = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A spider @{Cgreen}(N, 15, spider)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A buzzing insect is here to annoy you\.|An insect is here)(, fighting [^\.!]+.|)" tfMobsubstDarkenwoodInsect = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An insect @{Cgreen}(N, 20, insect)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A small goblin looks at you with malice in his eye\.|A small goblin is here)(, fighting [^\.!]+.|)" tfMobsubstDarkenwoodSmallGoblin = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A small goblin @{Cgreen}(N, 20, goblin)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A snake is slithering soundlessly in the dark\.|A snake is here)(, fighting [^\.!]+.|)" tfMobsubstDarkenwoodSnake = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A snake @{Cgreen}(N, 20, ---)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A nasty looking orange bugbear stares at you\.|A bugbear is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDarkenwoodBugbear = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A bugbear @{Cgreen}(@{nCred}E@{nCgreen}, 25, goblin)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An ugly goblin is standing guard here\.|A goblin guard is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDarkenwoodGoblinGuard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A goblin guard @{Cgreen}(@{nCred}E@{nCgreen}, 25, goblin)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An extra ugly, extra nasty, extra large spider is watching you\.|Iggy is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDarkenwoodIggy = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Iggy @{Cgreen}(@{nCred}E@{nCgreen}, 25, spider)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The cook stands here stirring a pot\.|The cook is here)(, fighting [^\.!]+.|)" tfMobsubstDarkenwoodCook = \
    /if (mobsubs & ({P1} != 'The cook is here' | area =~ 'Darkenwood')) \
      /substitute -p %{PL}@{nCyellow}The cook @{Cgreen}(N, 30, goblin)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A skeleton in the closet\.|Bones is here)(, fighting [^\.!]+.|)" tfMobsubstDarkenwoodSkeleton = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Bones @{Cgreen}(N, 35, skeleton)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A metalic green snake\.( \(invisible\)|) \(hidden\)|Sammy( \(invisible\)|) \(hidden\) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDarkenwoodSammy = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}Sammy @{Cgreen}(@{nCred}E@{nCgreen}, 35, ---)@{n}%{invisTxt} (hide)%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(King Grognok sits on his splintery crate\.\.\.\.\.er\.\.\.\.\.throne\.  He is dressed|King Grognok is here)(, fighting [^\.!]+.|)" tfMobsubstDarkenwoodGrognok = \
    /let mobName=@{nCyellow}King Grognok @{Cgreen}(N, 40, goblin)@{n}%; \
    /if (mobsubs & {P1} !~ "King Grognok sits on his splintery crate.....er.....throne.  He is dressed") \
      /substitute -p %{PL}%{mobName}%{P2}%{PR}%; \
    /elseif (mobsubs) \
      /substitute%; \
      /def -p99 -F -n1 -mregexp -t"^in tattered clothes and looks about as kingly as you do\." tfMobsubstSpecial = \
        /substitute -p %%{PL}%{mobName}%%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Syracue, the bugbear kings adept, stands here working on some potions\.|Syracue is here)(, fighting [^\.!]+.|)" tfMobsubstDarkenwoodSyracue = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Syracue @{Cgreen}(@{nCred}E@{nCgreen}, 40, goblin)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Darkfriends  -----------------------
/def -p99 -F -mregexp -t"(A rattily dressed pilferer is here trying to fit in\.|The pilferer is here)(, fighting [^\.!]+.|)" tfMobsubstDarkfriendsPilferer = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The pilferer @{Cgreen}(N, 25, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A large man covered with a layer of flour is here sipping some soup\.|The Guild chef is here)(, fighting [^\.!]+.|)" tfMobsubstDarkfriendsChef = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Guild chef @{Cgreen}(N, 30, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A gaudily dressed juggler is here tossing sharp objects all about\.|The juggler is here)(, fighting [^\.!]+.|)" tfMobsubstDarkfriendsJuggler = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The juggler @{Cgreen}(N, 30, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An aggravated Guild trainer is here cursing the stupidity of his pupils\.|The Guild trainer is here)(, fighting [^\.!]+.|)" tfMobsubstDarkfriendsTrainer = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Guild trainer @{Cgreen}(N, 35, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A sneak creeps along in shadow, honing his ability to move silently\.|The sneak is here)(, fighting [^\.!]+.|)" tfMobsubstDarkfriendsSneak = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The sneak @{Cgreen}(N, 35, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A shrewd looking clerk with beady eyes and a monstrous nose stands here\.|The clerk is here)(, fighting [^\.!]+.|)" tfMobsubstDarkfriendsClerk = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The clerk @{Cgreen}(N, 40, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A legbreaker, the hired muscle of the Guild, stands here menacingly\.|The legbreaker is here)(, fighting [^\.!]+.|)" tfMobsubstDarkfriendsLegbreaker = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The legbreaker @{Cgreen}(N, 40, orc)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Lieutenant of the Cityguard blushes and tries not to be noticed here\.|The Lieutenant Cityguard is here)(, fighting [^\.!]+.|)" tfMobsubstDarkfriendsLCityguard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Lieutenant Cityguard @{Cgreen}(N, 45, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A merc is hanging around here, looking for trouble\.|The merc is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDarkfriendsMerc = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The merc @{Cgreen}(@{nCred}E@{nCgreen}, 45, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A rogue flashes you a charming smile and continues his game of dice\.|The rogue is here)(, fighting [^\.!]+.|)" tfMobsubstDarkfriendsRogue = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The rogue @{Cgreen}(N, 45, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A shady character is lurking about here, definitely up to no good\.|The shady character is here)(, fighting [^\.!]+.|)" tfMobsubstDarkfriendsShadyChar = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The shady character @{Cgreen}(N, 45, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A smuggler stuffs some glinting objects into his shirt and grins sheepishly\.|The smuggler is here)(, fighting [^\.!]+.|)" tfMobsubstDarkfriendsSmuggler = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The smuggler @{Cgreen}(N, 45, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Vastin the Rogue is standing here\.|Vastin is here)(, fighting [^\.!]+.|)" tfMobsubstDarkfriendsVastin = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Vastin @{Cgreen}(N, 45, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A beardog, part of Guild security, snarls, and leaps at you\.|The beardog is here)(, fighting [^\.!]+.|)" tfMobsubstDarkfriendsBeardog = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The beardog @{Cgreen}(N, 50, canine)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A burglar sits fondly recalling some masterful second-story triumphs\.|The burglar is here)(, fighting [^\.!]+.|)" tfMobsubstDarkfriendsBurglar = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The burglar @{Cgreen}(N, 50, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A fence-of-all-goods is standing here rubbing his hands and grinning\.|The Guild fence is here)(, fighting [^\.!]+.|)" tfMobsubstDarkfriendsFence = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Guild fence @{Cgreen}(N, 50, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A killer turns and looks at you with dangerous fire in his eyes\.|A killer is here)(, fighting [^\.!]+.|)" tfMobsubstDarkfriendsKiller = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A killer @{Cgreen}(N, 50, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A knifer stalks carefully along the trail of its prey\.|A knifer is here)(, fighting [^\.!]+.|)" tfMobsubstDarkfriendsKnifer = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A knifer @{Cgreen}(N, 50, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An assassin leans against the wall and picks his teeth with a dagger\.|The assassin is here)(, fighting [^\.!]+.|)" tfMobsubstDarkfriendsAssassin = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The assassin @{Cgreen}(N, 55, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A DarkFriends assassin slips in and out of the shadows\.|The DarkFriends assassin is here)(, fighting [^\.!]+.|)" tfMobsubstDarkfriendsDFAssassin = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The DarkFriends assassin @{Cgreen}(N, 60, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An awesome illusionary black panther solidifies before you\.\.\.|The huge snarling panther is here)(, fighting [^\.!]+.|)" tfMobsubstDarkfriendsPanther = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The huge snarling panther @{Cgreen}(N, 60, feline)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A DarkFriends bodyguard stands here looking very intimidating\.|The DarkFriends bodyguard is here)(, fighting [^\.!]+.|)" tfMobsubstDarkfriendsBodyguard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The DarkFriends bodyguard @{Cgreen}(N, 65, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A killer of awesome reputation is standing guard here\.|The Nightblade is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDarkfriendsNightblade = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Nightblade @{Cgreen}(@{nCred}E@{nCgreen}, 70, nofight-room)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A dark-elf fence is here, smoking his hookah\.|Zagr K'fel, the dark-elf fence is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDarkfriendsZagr = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Zagr K'fel, the dark-elf fence @{Cgreen}(@{nCred}E@{nCgreen}, 84, QM)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A ravishingly beautiful woman is here, leaning against a shadowy|Evilyn Shae-Veynslith, the Darkeye Assassin is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDarkfriendsEvilyn = \
    /let mobName=@{nCyellow}Evilyn Shae-Veynslith, the Darkeye Assassin @{Cgreen}(@{nCred}E@{nCgreen}, 85, QM)@{n}%; \
    /if (mobsubs & {P1} !~ "A ravishingly beautiful woman is here, leaning against a shadowy") \
      /substitute -p %{PL}%{mobName}%{P2}%{PR}%; \
    /elseif (mobsubs) \
      /substitute%; \
      /def -p99 -F -n1 -mregexp -t"^wall\\.( \\(Red Aura\\)|)" tfMobsubstSpecial = \
        /substitute -p %%{PL}%{mobName}%%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Grandmaster of DarkFriends taps you on the shoulder\.  'Can I help you?'|The Grandmaster of DarkFriends is here)(, fighting [^\.!]+.|)" tfMobsubstDarkfriendsGrandmaster = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Grandmaster of DarkFriends @{Cgreen}(N, 85, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An outlaw of an underground kingdom has sought refuge here|Jaixhin of the Ghenna outlaws is here)(, fighting [^\.!]+.|)" tfMobsubstDarkfriendsJaixhin = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Jaixhin of the Ghenna outlaws @{Cgreen}(N, 100, undead/electricity, immune slash)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Darkspawn  -----------------------
/def -p99 -F -mregexp -t"(a Black worm is here slithering around on the ground\.|A Black worm is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDarkspawnBlackWorm = \
    /if (owner =~ 'Cindy' & mylevel <= 66) \
      /tfshow CONSIDER BLACK/WORM!!!%; \
      consider black%; \
      consider worm%; \
    /endif%; \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Black worm @{Cgreen}(@{nCred}E@{nCgreen}, 51-56, gas)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(a Pink worm crawls out from a small hole in the ground\.|A Pink worm is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDarkspawnPinkWorm = \
    /if (owner =~ 'Cindy' & mylevel <= 66) \
      /tfshow CONSIDER PINK/WORM!!!%; \
      consider pink%; \
      consider worm%; \
    /endif%; \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Pink worm @{Cgreen}(@{nCred}E@{nCgreen}, 51-56, gas)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Something is moving in the shadows, The White worm is here\.|A White worm is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDarkspawnWhiteWorm = \
    /if (owner =~ 'Cindy' & mylevel <= 66) \
      /tfshow CONSIDER WHITE/WORM!!!%; \
      consider white%; \
      consider worm%; \
    /endif%; \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A White worm @{Cgreen}(@{nCred}E@{nCgreen}, 51-56, gas)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(a Large bug is sniffing the air here\.|A Large bug is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDarkspawnLargeBug = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Large bug @{Cgreen}(@{nCred}E@{nCgreen}, 56, insect, immune pierce)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A snail has just found its next meal\.|A Snail is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDarkspawnSnail = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Snail @{Cgreen}(@{nCred}E@{nCgreen}, 56, gas)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(a Mole is here, digging\.|A Mole is here)(, fighting [^\.!]+.|)" tfMobsubstDarkspawnMole = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Mole @{Cgreen}(N, 65, ???)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(a Black rat is quickly advancing towards you!|A Black rat is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDarkspawnBlackRat = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Black rat @{Cgreen}(@{nCred}E@{nCgreen}, 66, rodent)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Something is crawling around in the mud here\.|An Ant worker is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDarkspawnAntWorker = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An Ant worker @{Cgreen}(@{nCred}E@{nCgreen}, 68, ???)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An ant soldier is here, protecting its queen\.|An Ant Soldier is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDarkspawnAntSoldier = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An Ant Soldier @{Cgreen}(@{nCred}E@{nCgreen}, 85, ???)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(a Phase spider is here, drawing energy from its surroundings\.|A Phase spider is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDarkspawnPhaseSpider = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Phase spider @{Cgreen}(@{nCred}E@{nCgreen}, 85, spider)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(a Poisonous Viper is here, poised to strike!|A Poisonous Viper is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDarkspawnPoisonousViper = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Poisonous Viper @{Cgreen}(@{nCred}E@{nCgreen}, 85, snake?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(a Warp spider is here, fading in and out of existence\.|A Warp spider is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDarkspawnWarpSpider = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Warp spider @{Cgreen}(@{nCred}E@{nCgreen}, 85, spider)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(a Black spider is spinning on a web here\.|A Black spider is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDarkspawnBlackSpider = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Black spider @{Cgreen}(@{nCred}E@{nCgreen}, 90, spider?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Mutated rat attacks you!|Lurk is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDarkspawnLurk = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Lurk @{Cgreen}(@{nCred}E@{nCgreen}, 95, pure/light)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(In the dust you notice a crouched shape, Olg is here\.|Olg is here)(, fighting [^\.!]+.|)" tfMobsubstDarkspawnOlg = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Olg @{Cgreen}(N, 95, ???)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Uma is here, searching for Olg\.|Uma is here)(, fighting [^\.!]+.|)" tfMobsubstDarkspawnUma = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Uma @{Cgreen}(N, 95, human/fire, deathspell)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The shadow on the throne is The Queen ant! \(invisible\)|Szeess \(invisible\) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDarkspawnSzeess = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Szeess @{Cgreen}(@{nCred}E@{nCgreen}, 100, ???)@{n} (imp)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The huge Queen spider is here, chanting softly into the air\. \(invisible\)|Tixin'erto \(invisible\) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDarkspawnTixin = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Tixin'erto @{Cgreen}(@{nCred}E@{nCgreen}, 100, ???)@{n} (imp)%{P2}%{PR}%; \
    /endif

; -----------------------  Darkunder  -----------------------
/set consideredParasite 0
/def -p99 -F -mregexp -t"(A disgusting little parasite crawls around looking to feed\.|A parasite is here)(, fighting [^\.!]+.|)" tfMobsubstDarkunderParasite = \
    /if (owner =~ 'Cindy' & mylevel <= 65 & !consideredParasite) \
      /tfshow EXA PARASITE!!!%; \
      /tfshow CONSIDER PARASITE!!!%; \
      /tfshow AND WE MUST LEARN: Align%; \
      exa parasite%; \
      consider parasite%; \
      /set consideredParasite 1%; \
      delay 60 /set consideredParasite 0%; \
    /endif%; \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A parasite @{Cgreen}(?, 1-55, ???)@{n}%{P2}%{PR}%; \
    /endif

/set consideredGrub 0
/def -p99 -F -mregexp -t"(u_n_k_n_o_w_n|A hungry grub is here)(, fighting [^\.!]+.|)" tfMobsubstDarkunderGrub = \
    /if (owner =~ 'Cindy' & mylevel <= 100 & !consideredGrub) \
      /tfshow EXA GRUB!!!%; \
      /tfshow CONSIDER GRUB!!!%; \
      /tfshow AND WE MUST LEARN: Align & short desc%; \
      exa grub%; \
      consider grub%; \
      /set consideredGrub 1%; \
      delay 60 /set consideredGrub 0%; \
    /endif%; \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A hungry grub @{Cgreen}(?, ?-?, ???)@{n}%{P2}%{PR}%; \
    /endif

/set consideredLizardMan 0
/def -p99 -F -mregexp -t"(A reptilian man stands in the shadows with a frightened expression\.|The frightened lizard man is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDarkunderLizardMan = \
    /if (owner =~ 'Cindy' & mylevel <= 64 & !consideredLizardMan) \
      /tfshow CONSIDER LIZARD!!!%; \
      consider lizard%; \
      /set consideredLizardMan 1%; \
      delay 60 /set consideredLizardMan 0%; \
    /endif%; \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The frightened lizard man @{Cgreen}(@{nCred}E@{nCgreen}, 1-55, reptile?)@{n}%{PR}%; \
    /endif

/set consideredSlavetrader 0
/def -p99 -F -mregexp -t"(A slave trader searches for an escape from these dark tunnels\.|A lost slave trader is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDarkunderSlavetrader = \
    /if (owner =~ 'Cindy' & mylevel <= 64 & !consideredSlavetrader) \
      /tfshow CONSIDER TRADER!!!%; \
      consider trader%; \
      /set consideredSlavetrader 1%; \
      delay 60 /set consideredSlavetrader 0%; \
    /endif%; \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A lost slave trader @{Cgreen}(@{nCred}E@{nCgreen}, 1-55, human?)@{n}%{P2}%{PR}%; \
    /endif

/set consideredRoots 0
/def -p99 -F -mregexp -t"(A forest of vines and roots dangle down from the roof of the tunnel\.|The living roots is here)(, fighting [^\.!]+.|)" tfMobsubstDarkunderRoots = \
    /if (owner =~ 'Cindy' & mylevel < 65 & !consideredRoots) \
      /tfshow CONSIDER ROOTS!!!%; \
      consider roots%; \
      /set consideredRoots 1%; \
      delay 60 /set consideredRoots 0%; \
    /endif%; \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The living roots @{Cgreen}(N, 1-55, botanic?)@{n}%{P2}%{PR}%; \
    /endif

/set consideredRevenant 0
/def -p99 -F -mregexp -t"(A revenant wanders alone in the darkness, crying\.|The distressed revenant is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDarkunderRevenant = \
    /if (owner =~ 'Cindy' & mylevel <= 77 & !consideredRevenant) \
      /tfshow CONSIDER REVENANT!!!%; \
      consider revenant%; \
      /set consideredRevenant 1%; \
      delay 60 /set consideredRevenant 0%; \
    /endif%; \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The distressed revenant @{Cgreen}(@{nCred}E@{nCgreen}, 1-67, undead?)@{n}%{P2}%{PR}%; \
    /endif

/set consideredRogue 0
/def -p99 -F -mregexp -t"(A rogue with a fearful expression is sneaking around looking for an exit\.|The scared rogue is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDarkunderRogue = \
    /if (owner =~ 'Cindy' & mylevel <= 77 & !consideredRogue) \
      /tfshow CONSIDER ROGUE!!!%; \
      consider rogue%; \
      /set consideredRogue 1%; \
      delay 60 /set consideredRogue 0%; \
    /endif%; \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The scared rogue @{Cgreen}(@{nCred}E@{nCgreen}, 1-67, human?)@{n}%{P2}%{PR}%; \
    /endif

/set consideredCutpurse 0
/def -p99 -F -mregexp -t"(A dazed and confused cutpurse cowers here\.|A bewildered cutpurse is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDarkunderCutpurse = \
    /if (owner =~ 'Cindy' & mylevel <= 76 & !consideredCutpurse) \
      /tfshow CONSIDER CUTPURSE!!!%; \
      consider cutpurse%; \
      /set consideredCutpurse 1%; \
      delay 60 /set consideredCutpurse 0%; \
    /endif%; \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A bewildered cutpurse @{Cgreen}(@{nCred}E@{nCgreen}, 1-67, human?)@{n}%{P2}%{PR}%; \
    /endif

/set consideredDrowTrader 0
/def -p99 -F -mregexp -t"(This drow trader is afraid of what lurks in these underground tunnels\.|The apprehensive drow trader is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDarkunderDrowTrader = \
    /if (owner =~ 'Cindy' & mylevel <= 77 & !consideredDrowTrader) \
      /tfshow CONSIDER TRADER!!!%; \
      consider trader%; \
      /set consideredDrowTrader 1%; \
      delay 60 /set consideredDrowTrader 0%; \
    /endif%; \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The apprehensive drow trader @{Cgreen}(@{nCred}E@{nCgreen}, 1-67, drow-elf?)@{n}%{P2}%{PR}%; \
    /endif

/set consideredSvirfneblin 0
/def -p99 -F -mregexp -t"(A svirfneblin pleads with you for help escaping this terrifying place\.|The frantic svirfneblin is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDarkunderSvirfneblin = \
    /if (owner =~ 'Cindy' & mylevel <= 76 & !consideredSvirfneblin) \
      /tfshow CONSIDER SVIRFNEBLIN!!!%; \
      consider svirfneblin%; \
      /set consideredSvirfneblin 1%; \
      delay 60 /set consideredSvirfneblin 0%; \
    /endif%; \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The frantic svirfneblin @{Cgreen}(@{nCred}E@{nCgreen}, 1-67, gnome?)@{n}%{P2}%{PR}%; \
    /endif

/set consideredDuergar 0
/def -p99 -F -mregexp -t"(A dark dwarf unexpectedly finds himself in the darkunder\.|A terrified duergar is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDarkunderDuergar = \
    /if (owner =~ 'Cindy' & mylevel <= 93 & !consideredDuergar) \
      /tfshow CONSIDER DUERGAR!!!%; \
      consider duergar%; \
      /set consideredDuergar 1%; \
      delay 60 /set consideredDuergar 0%; \
    /endif%; \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A terrified duergar @{Cgreen}(@{nCred}E@{nCgreen}, 1-84, dwarf?)@{n}%{P2}%{PR}%; \
/endif

/set consideredFloatingEye 0
/def -p99 -F -mregexp -t"(A floating eye drifts around desperate to find a way back to the Underdark\.|A fearful floating eye is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDarkunderFloatingEye = \
    /if (owner =~ 'Cindy' & mylevel <= 93 & !consideredFloatingEye) \
      /tfshow CONSIDER EYE!!!%; \
      consider eye%; \
      /set consideredFloatingEye 1%; \
      delay 60 /set consideredFloatingEye 0%; \
    /endif%; \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A fearful floating eye @{Cgreen}(@{nCred}E@{nCgreen}, 1-84, magical?)@{n}%{P2}%{PR}%; \
    /endif

/set consideredKobold 0
/def -p99 -F -mregexp -t"(A partially-digested kobold staggers around trying to escape its tormentors\.|A partially-digested kobold is here)(, fighting [^\.!]+.|)" tfMobsubstDarkunderKobold = \
    /if (owner =~ 'Cindy' & mylevel <= 93 & !consideredKobold) \
      /tfshow CONSIDER KOBOLD!!!%; \
      consider kobold%; \
      /set consideredKobold 1%; \
      delay 60 /set consideredKobold 0%; \
    /endif%; \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A partially-digested kobold @{Cgreen}(N, 1-84, lugroki?)@{n}%{P2}%{PR}%; \
    /endif

/set consideredEnforcerEye 0
/def -p99 -F -mregexp -t"(A large eye is here, desperately searching for an exit\.|An anxious enforcer eye is here)(, fighting [^\.!]+.|)" tfMobsubstDarkunderEnforcerEye = \
    /if (owner =~ 'Cindy' & mylevel <= 74 & !consideredEnforcerEye) \
      /tfshow CONSIDER ENFORCER/EYE!!!%; \
      consider enforcer%; \
      consider eye%; \
      /set consideredEnforcerEye 1%; \
      delay 60 /set consideredEnforcerEye 0%; \
    /endif%; \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An anxious enforcer eye @{Cgreen}(N, 47-65, magical)@{n}%{P2}%{PR}%; \
    /endif

/def -p99 -F -mregexp -t"(A tiny infant worm crawls around here trying to get its bearings\.|A tiny purple worm is here)(, fighting [^\.!]+.|)" tfMobsubstDarkunderTinyPurpleWorm = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A tiny purple worm @{Cgreen}(N, 51, snake?/electricity?)@{n}%{P2}%{PR}%; \
    /endif

/set consideredNewbornPurpleWorm 0
/def -p99 -F -mregexp -t"(u_n_k_n_o_w_n|A newborn purple worm is here)(, fighting [^\.!]+.|)" tfMobsubstDarkunderNewbornPurpleWorm = \
    /if (owner =~ 'Cindy' & mylevel <= 100 & !consideredNewbornPurpleWorm) \
      /tfshow EXA NEWBORN/WORM!!!%; \
      /tfshow AND WE MUST LEARN: short desc%; \
      exa newborn%; \
      exa worm%; \
      /set consideredNewbornPurpleWorm 1%; \
      delay 60 /set consideredNewbornPurpleWorm 0%; \
    /endif%; \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A newborn purple worm @{Cgreen}(N, 65, snake?/electricity?)@{n}%{P2}%{PR}%; \
    /endif

/def -p99 -F -mregexp -t"(A large swarm of blackflies slowly hovers through the tunnel\.|A swarm of blackflies is here)(, fighting [^\.!]+.|)" tfMobsubstDarkunderBlackflies = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A swarm of blackflies @{Cgreen}(N, 80, insect?)@{n}%{P2}%{PR}%; \
    /endif

/set consideredTrapSpider 0
/def -p99 -F -mregexp -t"(u_n_k_n_o_w_n  \(hidden\)|A trap spider \(hidden\) is here)(, fighting [^\.!]+.|)" tfMobsubstDarkunderTrapSpider = \
    /if (owner =~ 'Cindy' & mylevel <= 90 & mylevel >=55 & !consideredTrapSpider) \
      /tfshow CONSIDER SPIDER!!!%; \
      consider spider%; \
      /tfshow AND WE MUST LEARN: Align & short desc%; \
      /set consideredTrapSpider 1%; \
      delay 60 /set consideredTrapSpider 0%; \
    /endif%; \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A trap spider @{Cgreen}(?, 80+, spider?)@{n} (hide)%{P2}%{PR}%; \
    /endif

/set consideredCentipede 0
/def -p99 -F -mregexp -t"(A large writhing creature with a venomous maw scuttles around here\.|A monstrous centipede is here)(, fighting [^\.!]+.|)" tfMobsubstDarkunderCentipede = \
    /if (owner =~ 'Cindy' & mylevel >= 56 & mylevel <= 92 & !consideredCentipede) \
      /tfshow CONSIDER CENTIPEDE!!!%; \
      consider centipede%; \
      /set consideredCentipede 1%; \
      delay 60 /set consideredCentipede 0%; \
    /endif%; \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A monstrous centipede @{Cgreen}(N, 81-82, dark?)@{n}%{P2}%{PR}%; \
    /endif

/set consideredLightPurpleWorm 0
/def -p99 -F -mregexp -t"(A purple worm, its skin faded through occasional sunlight, slithers here\.|A light purple worm is here)(, fighting [^\.!]+.|)" tfMobsubstDarkunderLightPurpleWorm = \
    /if (owner =~ 'Cindy' & mylevel >= 58 & mylevel <= 93 & !consideredLightPurpleWorm) \
      /tfshow CONSIDER LIGHT/PURPLE/WORM!!!%; \
      consider light%; \
      consider purple%; \
      consider worm%; \
      /set consideredLightPurpleWorm 1%; \
      delay 60 /set consideredLightPurpleWorm 0%; \
    /endif%; \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A light purple worm @{Cgreen}(N, 83-84, snake?/electricity?)@{n}%{P2}%{PR}%; \
    /endif

/def -p99 -F -mregexp -t"(A large worm with dark purple skin slithers around on its belly here|A deep violet worm is here)(, fighting [^\.!]+.|)" tfMobsubstDarkunderDeepVioletWorm = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A deep violet worm @{Cgreen}(N, 85, snake?/fire?)@{n}%{P2}%{PR}%; \
    /endif

/set consideredShadowMoth 0
/def -p99 -F -mregexp -t"(An oversized moth flutters around in the shadows\.|A shadow moth is here)(, fighting [^\.!]+.|)" tfMobsubstDarkunderShadowMoth = \
    /if (owner =~ 'Cindy' & mylevel >= 60 & !consideredShadowMoth) \
      /tfshow CONSIDER MOTH!!!%; \
      consider moth%; \
      /set consideredShadowMoth 1%; \
      delay 60 /set consideredShadowMoth 0%; \
    /endif%; \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A shadow moth @{Cgreen}(N, 85-87, insect?)@{n}%{P2}%{PR}%; \
    /endif

/set consideredImmenseMauveWorm 0
/def -p99 -F -mregexp -t"(u_n_k_n_o_w_n|An immense mauve worm is here)(, fighting [^\.!]+.|)" tfMobsubstDarkunderImmenseMauveWorm = \
    /if (owner =~ 'Cindy' & mylevel >= 60 & !consideredImmenseMauveWorm) \
      /tfshow CONSIDER MAUVE/WORM!!!%; \
      /tfshow AND WE MUST LEARN: Short desc%; \
      consider mauve%; \
      consider worm%; \
      /set consideredImmenseMauveWorm 1%; \
      delay 60 /set consideredImmenseMauveWorm 0%; \
    /endif%; \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An immense mauve worm @{Cgreen}(N, 86-89, snake?/acid?/electricity?)@{n}%{P2}%{PR}%; \
    /endif

/set consideredGiganticIndigoWorm 0
/def -p99 -F -mregexp -t"(An immense worm with an indigo hue is burrowing through the soil here\.|A gigantic indigo worm is here)(, fighting [^\.!]+.|)" tfMobsubstDarkunderGiganticIndigoWorm = \
    /if (owner =~ 'Cindy' & mylevel >= 60 & !consideredGiganticIndigoWorm) \
      /tfshow CONSIDER INDIGO/WORM!!!%; \
      consider indigo%; \
      consider worm%; \
      /set consideredGiganticIndigoWorm 1%; \
      delay 60 /set consideredGiganticIndigoWorm 0%; \
    /endif%; \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A gigantic indigo worm @{Cgreen}(N, 86-89, snake?/electricity?)@{n}%{P2}%{PR}%; \
    /endif

/set consideredEnormousMillipede 0
/def -p99 -F -mregexp -t"(An enormous creature with a sea of legs and two large mandibles burrows here\.|An enormous millipede is here)(, fighting [^\.!]+.|)" tfMobsubstDarkunderEnormousMillipede = \
    /if (owner =~ 'Cindy' & mylevel >= 63 & !consideredEnormousMillipede) \
      /tfshow CONSIDER MILLIPEDE!!!%; \
      consider millipede%; \
      /set consideredEnormousMillipede 1%; \
      delay 60 /set consideredEnormousMillipede 0%; \
    /endif%; \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An enormous millipede @{Cgreen}(N, 88-89, snake?/fire?/electricity?)@{n}%{P2}%{PR}%; \
    /endif

/def -p99 -F -mregexp -t"(A man in dark clothing stalks the tunnels looking for a lone worm to kill\.|A Worm hunter is here)(, fighting [^\.!]+.|)" tfMobsubstDarkunderWormHunter = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Worm hunter @{Cgreen}(N, 95, human)@{n}%{P2}%{PR}%; \
    /endif

/def -p99 -F -mregexp -t"(A young female scientist studying the worm colony seeks your assistance here\.|The Oligochaetologist is here)(, fighting [^\.!]+.|)" tfMobsubstDarkunderOligochaetologist = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Oligochaetologist @{Cgreen}(N, 100, QM)@{n}%{P2}%{PR}%; \
    /endif

/set consideredPrimevalWorm 0
/def -p99 -F -mregexp -t"(An ancient purple worm rests here beside a squirming mass of translucent cocoons\.|The Primeval Worm is here)(, fighting [^\.!]+.|)" tfMobsubstDarkunderPrimevalWorm = \
    /if (owner =~ 'Cindy' & mylevel >= 95 & !consideredPrimevalWorm) \
      /tfshow EXA PRIMEVAL/WORM!!!%; \
      /tfshow CONSIDER PRIMEVAL/WORM!!!%; \
      /tfshow AND WE MUST LEARN: Align%; \
      exa primeval%; \
      exa worm%; \
      consider primeval%; \
      consider worm%; \
      /set consideredPrimevalWorm 1%; \
      delay 60 /set consideredPrimevalWorm 0%; \
    /endif%; \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Primeval Worm @{Cgreen}(?, 120+, snake?/pure?)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Darkwater  -----------------------
/def -p99 -F -mregexp -t"(A small slimy merman is here fidgeting\.|A Merman is here)(, fighting [^\.!]+.|)" tfMobsubstDarkwaterMerman = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Merman @{Cgreen}(N, 25, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An urchin is resting here\.|A little urchin is here\.|An urchin is here)(, fighting [^\.!]+.|)" tfMobsubstDarkwaterUrchin = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An urchin @{Cgreen}(N, 27, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Nautilus searches for food here\.|A Nautilus is here)(, fighting [^\.!]+.|)" tfMobsubstDarkwaterNautilus = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Nautilus @{Cgreen}(N, 29, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An aquatic is resting here\.|A medium-sized aquatic rests here\.|An aquatic is here)(, fighting [^\.!]+.|)" tfMobsubstDarkwaterAquatic = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An aquatic @{Cgreen}(N, 31, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A green tinted argonaut stands here\. \(invisible\)|A green argonaut \(invisible\) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDarkwaterGreenArgonaut = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A green argonaut @{Cgreen}(@{nCred}E@{nCgreen}, 33, human)@{n} (imp)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A blue tinted argonaut works for his masters here\. \(invisible\)|A blue argonaut \(invisible\) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDarkwaterBlueArgonaut = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A blue argonaut @{Cgreen}(@{nCred}E@{nCgreen}, 35, human)@{n} (imp)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A red-scaled argonaut ponders his life here\. \(invisible\)|A red argonaut \(invisible\) is here)(, fighting [^\.!]+.|)" tfMobsubstDarkwaterRedArgonaut = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A red argonaut @{Cgreen}(N, 37, human)@{n} (imp)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An argonaut with black scales glares at you\. \(invisible\)|A black argonaut \(invisible\) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDarkwaterBlackArgonaut = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A black argonaut @{Cgreen}(@{nCred}E@{nCgreen}, 39, human)@{n} (imp)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A giant squid is sitting here\.|A giant squid flails its tentacles around here\.|A giant squid is here)(, fighting [^\.!]+.|)" tfMobsubstDarkwaterSquid = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A giant squid @{Cgreen}(N, 41, fish)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A defender of the argonaut race waits here\.|An Argrok is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDarkwaterArgrok = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An Argrok @{Cgreen}(@{nCred}E@{nCgreen}, 44, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Fabled argonaut charges at you!|A Fabled argonaut is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDarkwaterFabled = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Fabled argonaut @{Cgreen}(@{nCred}E@{nCgreen}, 46, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Argotann intimidates you as you look at him\.|Argotann is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDarkwaterArgotann = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Argotann @{Cgreen}(@{nCred}E@{nCgreen}, 50, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The King of the Argonaut race sits upon his throne here\.|The Argonaut King is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDarkwaterKing = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Argonaut King @{Cgreen}(@{nCred}E@{nCgreen}, 75, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Kracken, creature of mythology, roars here\.|The Kracken is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDarkwaterKracken = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Kracken @{Cgreen}(@{nCred}E@{nCgreen}, 99, acid?)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Daycare  -----------------------
/def -p99 -F -mregexp -t"(An abused and old doll is here\.|An old doll is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDaycareOldDoll = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An old doll @{Cgreen}(@{nCred}E@{nCgreen}, 1, entity)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A spoiled brat is crying here\.|The spoiled brat is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDaycareBrat = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The spoiled brat @{Cgreen}(@{nCred}E@{nCgreen}, 1, dwarf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A cute and fuzzy teddy bear stands here\.|A teddy bearis here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstDaycareTeddyBear = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A teddy bear @{Cgreen}(@{hCwhite}G@{nCgreen}, 1, entity)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A raggedy anne doll is sitting here\.|A raggedy anne doll is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstDaycareRagDoll = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A raggedy anne doll @{Cgreen}(@{hCwhite}G@{nCgreen}, 2, entity)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A young dwarf plays with a toy axe\.|The dwarven youth is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDaycareDwarvenYouth = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The dwarven youth @{Cgreen}(@{nCred}E@{nCgreen}, 3, dwarf, thief!)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A toy soldier is standing here\.|A toy soldier is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDaycareToySoldier = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A toy soldier @{Cgreen}(@{nCred}E@{nCgreen}, 3, entity)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An ugly stuffed bear stands here\.|The ugly teddy bear is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDaycareUglyBear = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The ugly teddy bear @{Cgreen}(@{nCred}E@{nCgreen}, 3, entity)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An old wrinkled nanny stands here, looking over the little ones\.|The nanny is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstDaycareNanny = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The nanny @{Cgreen}(@{hCwhite}G@{nCgreen}, 5, dwarf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An armed guard stands here looking lost\.|The armed guard is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDaycareGuard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The armed guard @{Cgreen}(@{nCred}E@{nCgreen}, 8, dwarf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Mulak the dwarf is here\.|Mulak is here)(, fighting [^\.!]+.|)" tfMobsubstDaycareMulak = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Mulak @{Cgreen}(N, 99, QM)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Dead Man's Cove  -----------------------
/def -p99 -F -mregexp -t"(A ghostly bilge-rat wails as it approaches you\. \(invisible\)|A ghostly bilge-rat \(invisible\) is here)(, fighting [^\.!]+.|)" tfMobsubstDeadmanscoveGhostlyBilgeRat = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A ghostly bilge-rat @{Cgreen}(N, 81, insubstantial)@{n} (imp)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A white ambience surrounds this mutineer\. \(invisible\)|The dead mutineer \(invisible\) is here)(, fighting [^\.!]+.|)" tfMobsubstDeadmanscoveDeadMutineer = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The dead mutineer @{Cgreen}(N, 82, insubstantial)@{n} (imp)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A ghoulish rapscallion drifts around the cove seeking vengeance\. \(invisible\)|A ghoulish rapscallion \(invisible\) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDeadmanscoveGhoulishRapscallion = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A ghoulish rapscallion @{Cgreen}(@{hCred}E@{nCgreen}N, 83, insubstantial)@{n} (imp)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A deceased mariner haunts the cove here\. \(invisible\)|A phantom mariner \(invisible\) is here)(, fighting [^\.!]+.|)" tfMobsubstDeadmanscovePhantomMariner = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A phantom mariner @{Cgreen}(N, 84, insubstantial)@{n} (imp)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The ugly wight of a long-dead seafarer hovers here\. \(invisible\)|A seafarer's wight \(invisible\) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDeadmanscoveSeafarersWight = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A seafarer's wight @{Cgreen}(@{hCred}E@{nCgreen}, 85, insubstantial)@{n} (imp)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The spirit of a dead sailor haunts the wreckage of his vessel\. \(invisible\)|A revenant sailor \(invisible\) is here)(, fighting [^\.!]+.|)" tfMobsubstDeadmanscoveRevenantSailor = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A revenant sailor @{Cgreen}(N, 86, insubstantial)@{n} (imp)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(This careless mariner died from alcohol poisoning rather than a shipwreck\. \(invisible\)|A haunted grog-fiend \(invisible\) is here)(, fighting [^\.!]+.|)" tfMobsubstDeadmanscoveHauntedGrogFiend = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A haunted grog-fiend @{Cgreen}(N, 87, insubstantial)@{n} (imp)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The apparition of a shipwrecked buccaneer roams the cove\. \(invisible\)|A phantasmal buccaneer \(invisible\) is here)(, fighting [^\.!]+.|)" tfMobsubstDeadmanscovePhantasmalBuccaneer = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A phantasmal buccaneer @{Cgreen}(N, 88, insubstantial)@{n} (imp)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A faint green energy accompanies this spectral pirate\. \(invisible\)|A spectral pirate \(invisible\) is here)(, fighting [^\.!]+.|)" tfMobsubstDeadmanscoveSpectralPirate = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A spectral pirate @{Cgreen}(N, 89, insubstantial)@{n} (imp)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Red Beard, one of the most infamous casualties of the cove now haunts it\. \(invisible\) \(hidden\)|The Poltergeist of Red Beard \(invisible\) \(hidden\) is here)(, fighting [^\.!]+.|)" tfMobsubstDeadmanscoveRedBeard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Poltergeist of Red Beard @{Cgreen}(N, 90, insubstantial)@{n} (imp) (hide)%{P2}%{PR}%; \
    /endif

; -----------------------  Demoncity  -----------------------
/def -p99 -F -mregexp -t"(A hothedhel lurks in the shadows\.|The hothedhel is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDemoncityHothedel = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The hothedhel @{Cgreen}(@{nCred}E@{nCgreen}, 6, demon)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A skeleton warrior charges you with an evil scream\.|The skeleton warrior is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDemoncitySkelWarrior = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The skeleton warrior @{Cgreen}(@{nCred}E@{nCgreen}, 12, skeleton)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The narauk attacks you from behind\.|The narauk is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDemoncityNarauk = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The narauk @{Cgreen}(@{nCred}E@{nCgreen}, 13, demon)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Belkor utters a howling sound as he attacks you\.|Belkor is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstDemoncityBelkor = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Belkor @{Cgreen}(@{hCwhite}G@{nCgreen}, 14, feline)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The skeleton jumps at you from behind\.|The skeleton is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDemoncitySkeleton = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The skeleton @{Cgreen}(@{nCred}E@{nCgreen}, 14, skeleton)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A woman is lying on a cushion of cloudy white mist which hovers above|The woman( \(invisible\)|) is here)(, fighting [^\.!]+.|)" tfMobsubstDemoncityWoman = \
    /let mobName=@{nCyellow}The woman @{Cgreen}(N, 20, demon)@{n}%; \
    /if ({P2} =~ " (invisible)") \
      /let invisTxt= (invis)%; \
    /else \
      /let invisTxt=%; \
    /endif%; \
    /if (mobsubs & {P1} !~ "A woman is lying on a cushion of cloudy white mist which hovers above") \
      /substitute -p %{PL}%{mobName}%{invisTxt}%{PR}%; \
    /elseif (mobsubs) \
      /substitute%; \
      /def -p99 -F -n1 -mregexp -t"the floor\\.( \\(invisible\\)|)" tfMobsubstSpecial = \
        /if ({P1} =~ " (invisible)") \
          /let invisTxt= (invis)%%; \
        /else \
          /let invisTxt=%%; \
        /endif%%; \
        /substitute -p %%{PL}%{mobName}%%{invisTxt}%%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The undead priest howls at you: \"INTRUDER!!!\"|The undead priest is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDemoncityUndeadPriest = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The undead priest @{Cgreen}(@{nCred}E@{nCgreen}, 25, undead)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The red sea serpent hisses: \"Oh no! Don't they feed me with anything|The sea serpent is here)(, fighting [^\.!]+.|)" tfMobsubstDemoncitySeaSerpent = \
    /let mobName=@{nCyellow}The sea serpent @{Cgreen}(N, 27, snake)@{n}%; \
    /if (mobsubs & {P1} !~ "The red sea serpent hisses: \"Oh no! Don't they feed me with anything") \
      /substitute -p %{PL}%{mobName}%{P2}%{PR}%; \
    /elseif (mobsubs) \
      /substitute%; \
      /def -p99 -F -n1 -mregexp -t"^but adventurers nowadays. This is getting boring.\\"" tfMobsubstSpecial = \
        /substitute -p %%{PL}%{mobName}%%{P1}%%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A celebdel teleports in and attacks you\.|The celebdel is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDemoncityCelebdel = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The celebdel @{Cgreen}(@{nCred}E@{nCgreen}, 30, demon)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(There is an idol of the god, Solus, in the middle of the room\.|The idol is here)(, fighting [^\.!]+.|)" tfMobsubstDemoncityIdol = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The idol @{Cgreen}(N, 39, entity)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The undead high priest howls at you: \"INTRUDER!!!\"|The undead high priest is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDemoncityHighPriest = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The undead high priest @{Cgreen}(@{nCred}E@{nCgreen}, 43, undead)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The great ordainer, Moloch, attacks you with an evil scream\.|Moloch is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDemoncityMoloch = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Moloch @{Cgreen}(@{nCred}E@{nCgreen}, 45, demon)@{n}%{P2}%{PR}%; \
    /endif
/def -p100 -F -mregexp -t"(u_n_k_n_o_w_n|Moloch is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDemoncityMolochSummon = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Moloch @{Cgreen}(@{nCred}E@{nCgreen}, 45, demon)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Tiilak the Defiler stands here, waiting for a dumb fool to challenge|Tiilak is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstDemoncityTiilak = \
    /let mobName=@{nCyellow}Tiilak @{Cgreen}(@{hCwhite}G@{nCgreen}, 50, ---)@{n}%; \
    /if (mobsubs & {P1} !~ "Tiilak the Defiler stands here, waiting for a dumb fool to challenge") \
      /substitute -p %{PL}%{mobName}%{P2}%{PR}%; \
    /elseif (mobsubs) \
      /substitute%; \
      /def -p99 -F -n1 -mregexp -t"^him\\.( \\(White Aura\\)|)" tfMobsubstSpecial = \
        /substitute -p %%{PL}%{mobName}%%{P1}%%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The black stalker ambushes you\.|The black stalker is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDemoncityStalker = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The black stalker @{Cgreen}(@{nCred}E@{nCgreen}, 60, demon)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The ein flayer whirls its blades and attacks you\.|The ein flayer is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDemoncityEinFlayer = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The ein flayer @{Cgreen}(@{nCred}E@{nCgreen}, 70, entity)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(V'rama Vair attacks you\.|V'rama Vair is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDemoncityVair = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}V'rama Vair @{Cgreen}(@{nCred}E@{nCgreen}, 70, human, summoner)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The eternal witness shouts: \"I saw it all!\"|The eternal witness is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstDemoncityWitness = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The eternal witness @{Cgreen}(@{hCwhite}G@{nCgreen}, 81, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The dead god-king looks at you miserably\.|Ludvaraman is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstDemoncityLudvaraman = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Ludvaraman @{Cgreen}(@{hCwhite}G@{nCgreen}, 95, undead)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Solus, the ancient god, is watching you carefully with intelligent eyes\.|Solus, the ancient god is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDemoncitySolus = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Solus, the ancient god @{Cgreen}(@{nCred}E@{nCgreen}, 100, mythical, summoner)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Desert  -----------------------
/def -p99 -F -mregexp -t"(A young slave sits here staring at you with pleading eyes\.|The slave is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstDesertSlave = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The slave @{Cgreen}(@{hCwhite}G@{nCgreen}, 3, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A small, red scorpion scuttles away at your approach\.|The small scorpion is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDesertSmallScorpion = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The small scorpion @{Cgreen}(@{nCred}E@{nCgreen}, 3, insect)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A brightly colored snake slithers along the sands\.|The coral snake is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDesertCoralSnake = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The coral snake @{Cgreen}(@{nCred}E@{nCgreen}, 4, snake)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A duergar is here mining precious stones with his pick\.|The dark dwarf is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDesertDarkDwarf = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The dark dwarf @{Cgreen}(@{nCred}E@{nCgreen}, 5, dwarf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The raggity dervish walks on aimlessly\. \(hidden\)|The large dervish watches for signs of trouble\. \(hidden\)|The dervish \(hidden\) is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstDesertDervish = \
    /if (mobsubs) \
      /if ({P1} =~ 'The raggity dervish walks on aimlessly. (hide)') \
        /substitute -p %{PL}@{nCyellow}The dervish (raggity) @{Cgreen}(@{nCwhite}G@{nCgreen}, 5, human)@{n} (hide)%{P2}%{PR}%; \
      /elseif ({P1} =~ 'The large dervish watches for signs of trouble. (hide)') \
        /substitute -p %{PL}@{nCyellow}The dervish (large) @{Cgreen}(@{nCwhite}G@{nCgreen}, 8, human)@{n} (hide)%{P2}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}The dervish (raggity/large) @{Cgreen}(@{nCwhite}G@{nCgreen}, 5/8, human)@{n} (hide)%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(A myconoid lumbers along peacefully\.|The myconoid is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstDesertMyconoid = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The myconoid @{Cgreen}(@{nCwhite}G@{nCgreen}, 5, ---)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A very dangerous rabid camel snorts at you\.|The rabid camel is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDesertCamel = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The rabid camel @{Cgreen}(@{nCred}E@{nCgreen}, 5, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A small oasis invites you to dive in\.|The dustdigger is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDesertDustdigger = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The dustdigger @{Cgreen}(@{nCred}E@{nCgreen}, 7, magical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The drider looks at you viciously while it draws it's sword\.|The drider is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDesertDrider = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The drider @{Cgreen}(@{nCred}E@{nCgreen}, 8, spider)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A proud nomad warrior stands here\.|The nomad warrior is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstDesertNomadWarrior = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The nomad warrior @{Cgreen}(@{nCwhite}G@{nCgreen}, 10, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The nomad commander stands here staring suspiciously at you\.|The nomad commander is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstDesertNomadCommander = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The nomad commander @{Cgreen}(@{nCwhite}G@{nCgreen}, 12, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The nomad leader sits silently in prayer\.|The nomad leader is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstDesertNomadLeader = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The nomad leader @{Cgreen}(@{nCwhite}G@{nCgreen}, 14, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A rather large myconoid stands here chanting in a strange tongue\.|The myconoid shaman is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstDesertShaman = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The myconoid shaman @{Cgreen}(@{nCwhite}G@{nCgreen}, 25, ---)@{n}%{P2}%{PR}%; \
    /endif
;Then adds to it, "Prepare to die, have a nice day!" (White Aura)
/def -p99 -F -mregexp -t"(A very large brass dragon steps out of the darkness and says \"Hello\"\.|The brass dragon is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstDesertBrassDragon = \
    /let mobName=@{nCyellow}The brass dragon @{Cgreen}(@{hCwhite}G@{nCgreen}, 35, dragon)@{n}%; \
    /if (mobsubs & {P1} !~ "A very large brass dragon steps out of the darkness and says \"Hello\".") \
      /substitute -p %{PL}%{mobName}%{P2}%{PR}%; \
    /elseif (mobsubs) \
      /substitute%; \
      /def -p99 -F -n1 -mregexp -t"^Then adds to it, \\"Prepare to die, have a nice day!\\"( \\(White Aura\\)|)" tfMobsubstSpecial = \
        /substitute -p %%{PL}%{mobName}%%{P1}%%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A giant, purple sand worm thrusts up out of the sand and attacks!|The giant, purple sand worm is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDesertSandWorm = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The giant, purple sand worm @{Cgreen}(@{nCred}E@{nCgreen}, 46, magical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A pile of bones rises up to form a skeletal dracolich\.|The dracolich is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDesertDracolich = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The dracolich @{Cgreen}(@{nCred}E@{nCgreen}, 50, dragon)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(a desert guide battles through the sandstorms in search of a wondrous city\.|An intrepid navigator is here)(, fighting [^\.!]+.|)" tfMobsubstMiloraiNavi = \
    /set navigatorfound 1%; \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An intrepid navigator @{Cgreen}(N, 100, Ask him 'home')@{n}%{P2}%{PR}%; \
    /else \
      /tfshow Navigator! Ask him 'home'%; \
    /endif

; -----------------------  Desolate Plains  -----------------------
/def -p99 -F -mregexp -t"(The Ni'hachbin warrior is standing here\.|A Ni'hachbin warrior is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDesolateplainsWarrior = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Ni'hachbin warrior @{Cgreen}(@{nCred}E@{nCgreen}, 63, magical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The commander of Natharl'nacna is standing here guarding the great gates\.|Cresh'urim is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDesolateplainsCreshurim = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Cresh'urim @{Cgreen}(@{nCred}E@{nCgreen}, 70, insect)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Carac'rin is standing here in the shadows\. \(hidden\)|Carac'rin \(hidden\) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDesolateplainsCaracrin = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Carac'rin @{Cgreen}(@{nCred}E@{nCgreen}, 85, magical)@{n} (hide)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A large sphere is hovering here, and it has long tentacles\.|Meleth'scor is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDesolateplainsMelethscor = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Meleth'scor @{Cgreen}(@{nCred}E@{nCgreen}, 85, beholder)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A human is standing here trying to hide in the shadows\.|The Plasma dragon is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDesolateplainsPlasmaDragon = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Plasma dragon @{Cgreen}(@{nCred}E@{nCgreen}, 85, dragon)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Pred Yrric is sitting on his throne resting\. \(invisible\)|Pred Yrric \(invisible\) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDesolateplainsPredYrric = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Pred Yrric @{Cgreen}(@{nCred}E@{nCgreen}, 90, mythical/gas)@{n} (imp)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A human shaped form is standing here absorbing all light\. \(invisible\)|Dark Rythsish \(invisible\) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDesolateplainsDarkRythsish = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Dark Rythsish @{Cgreen}(@{nCred}E@{nCgreen}, 95, insubstantial)@{n} (imp)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The high champion of the gods is standing here\.|Demigod is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDesolateplainsDemigod = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Demigod @{Cgreen}(@{nCred}E@{nCgreen}, 100, mythical)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Dragon Cult  -----------------------
/def -p99 -F -mregexp -t"(A virgin weeping about her pending death is here\.|A virgin sacrifice is here)(, fighting [^\.!]+.|)" tfMobsubstDragonCultVirgin = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A virgin sacrifice @{Cgreen}(N, 3, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A receptionist greets you with a knowing grin\.|The receptionist is here)(, fighting [^\.!]+.|)" tfMobsubstDragonCultReceptionist = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The receptionist @{Cgreen}(N, 4, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Marie is here on her break sipping some coffee\.|Marie is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstDragonCultMarie = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Marie @{Cgreen}(@{nCwhite}G@{nCgreen}, 5, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Bob the PR Director greets you with the smile of a used car salesman\.|Bob is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDragonCultBob = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Bob @{Cgreen}(@{nCred}E@{nCgreen}, 8, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Jim the sales Director eyes you like a hungry vulture\.|Jim is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDragonCultJim = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Jim @{Cgreen}(@{nCred}E@{nCgreen}, 8, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Gale the office coordinator bustles around the office\.|Gale is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDragonCultGale = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Gale @{Cgreen}(@{nCred}E@{nCgreen}, 9, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Fred the boss of the office is here smoking a cheap cigar\.|Fred is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDragonCultFred = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Fred @{Cgreen}(@{nCred}E@{nCgreen}, 10, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A minor priest of the cult scuffles along\.|The minor priest is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDragonCultMinorPriest = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The minor priest @{Cgreen}(@{nCred}E@{nCgreen}, 12, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p100 -F -mregexp -t"(A minor priest of the cult is in the bathroom \"doing his duty\"\.\.|The minor priest is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDragonCultMinorPriestBath = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The minor priest (bath) @{Cgreen}(@{nCred}E@{nCgreen}, 12, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A robed priest is alarmed by your presence\.|The robed priest is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDragonCultRobedPriest = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The robed priest @{Cgreen}(@{nCred}E@{nCgreen}, 14, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Zombie hates everything alive, namely you\.|The Zombie is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDragonCultZombie = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Zombie @{Cgreen}(@{nCred}E@{nCgreen}, 15, undead)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The draconian knight sees you and attacks!|The draconian knight is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDragonCultDracKnight = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The draconian knight @{Cgreen}(@{nCred}E@{nCgreen}, 16, magical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The High Priestess is FURIOUS bout your intrusion!|The High Priestess is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDragonCultHighPriestess = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The High Priestess @{Cgreen}(@{nCred}E@{nCgreen}, 18, magical)@{n}%{P2}%{PR}%; \
    /endif
/def -p100 -F -mregexp -t"(The Torturer is here ready to inflict great pain upon you\.|The Torturer is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDragonCultTorturer = \
    /if (mobsubs & ({P1} != 'The Torturer is here' | area =~ 'DragonCult')) \
      /substitute -p %{PL}@{nCyellow}The Torturer @{Cgreen}(@{nCred}E@{nCgreen}, 18, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Black Dragon Wyrmling wants to feed ON YOU\.|The Black Dragon Wyrmling is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDragonCultWyrmling = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Black Dragon Wyrmling @{Cgreen}(@{nCred}E@{nCgreen}, 23, dragon)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Dragons Graveyard  -----------------------
/def -p99 -F -mregexp -t"(The decomposing corpse of a dragon stumbles around here\.|A dracolich is here)(, fighting [^\.!]+.|)" tfMobsubstDragonsGraveyardDracolich = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A dracolich @{Cgreen}(N, 80, dragon)@{n}%{P2}%{PR}%; \
    /endif%; \
    attackIfLeaderEtc dracolich slaydragon
/def -p99 -F -mregexp -t"(An elderly black wyrm, nearing death, staggers around here\.|A Doomed Black Wyrm is here)(, fighting [^\.!]+.|)" tfMobsubstDragonsGraveyardDWyrm = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Doomed Black Wyrm @{Cgreen}(N, 81, dragon)@{n}%{P2}%{PR}%; \
    /endif%; \
    attackIfLeaderEtc wyrm slaydragon
/def -p99 -F -mregexp -t"(A dragon skeleton stands here with smoke seeping from its nasal cavity\.|A skeletal dragon is here)(, fighting [^\.!]+.|)" tfMobsubstDragonsGraveyardSDragon = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A skeletal dragon @{Cgreen}(N, 82, dragon)@{n}%{P2}%{PR}%; \
    /endif%; \
    attackIfLeaderEtc dragon slaydragon
/def -p99 -F -mregexp -t"(A mean-looking Draconian stands guard here\.|The Draconian Attendant is here)(, fighting [^\.!]+.|)" tfMobsubstDragonsGraveyardAttendant = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Draconian Attendant @{Cgreen}(N, 85, magical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A disgusting zombified wyrm stands amidst the skeletons of the graveyard here\.|A Zombie Wyrm is here)(, fighting [^\.!]+.|)" tfMobsubstDragonsGraveyardZWyrm = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Zombie Wyrm @{Cgreen}(N, 86, dragon)@{n}%{P2}%{PR}%; \
    /endif

/def -p99 -F -msimple -t"A dracolich is dead! R.I.P." tfMobsubstDragonsGraveyardRIPDraco = \
    /if (groupleader =~ name & initiator =~ 'none' & autoattack) \
      k dra%; \
    /endif
/def -p99 -F -msimple -t"A Doomed Black Wyrm is dead! R.I.P." tfMobsubstDragonsGraveyardRIPDWyrm = \
    /if (groupleader =~ name & initiator =~ 'none' & autoattack) \
      k dra%; \
    /endif
/def -p99 -F -msimple -t"A skeletal dragon is dead! R.I.P." tfMobsubstDragonsGraveyardRIPSDragon = \
    /if (groupleader =~ name & initiator =~ 'none' & autoattack) \
      k dra%; \
    /endif
/def -p99 -F -msimple -t"The Draconian Attendant is dead! R.I.P." tfMobsubstDragonsGraveyardRIPAttendant = \
    /if (groupleader =~ name & initiator =~ 'none' & autoattack) \
      k dra%; \
    /endif
/def -p99 -F -msimple -t"A Zombie Wyrm is dead! R.I.P." tfMobsubstDragonsGraveyardRIPZWyrm = \
    /if (groupleader =~ name & initiator =~ 'none' & autoattack) \
      k dra%; \
    /endif

; -----------------------  Dragonspyre  -----------------------
/def -p99 -F -mregexp -t"(A Pixie flits about the room|A Pixie is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstDragonspyrePixie = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Pixie @{Cgreen}(@{nCwhite}G@{nCgreen}, 40, fairie)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Pixie Guard stands here, prepared to loose his life for the king\. \(hidden\)|A Pixie Guard \(hidden\) is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstDragonspyrePixieGuard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Pixie Guard @{Cgreen}(@{nCwhite}G@{nCgreen}, 42, fairie, protector)@{n} (hide)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Master Pixie Mage is here ruffling through the King's belongings\.|The Master Pixie Mage is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDragonspyrePixieMage = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Master Pixie Mage @{Cgreen}(@{nCred}E@{nCgreen}, 44, fairie)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Copper Dragon of Time stands before you|The Copper Dragon is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstDragonspyreCopperDragon = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Copper Dragon @{Cgreen}(@{nCwhite}G@{nCgreen}, 45, dragon)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Pixie King looks at you with a merry glint in his eyes and nods|The Pixie King is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstDragonspyrePixieKing = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Pixie King @{Cgreen}(@{nCwhite}G@{nCgreen}, 45, fairie)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The White Dragon of Ice stands before you|The White Dragon is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDragonspyreWhiteDragon = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The White Dragon @{Cgreen}(@{nCred}E@{nCgreen}, 46, dragon)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The translucent Spirit of the Dragon stares at you through uncaring eyes( \(invisible\)|)|The Spirit of the Time Dragon( \(invisible\)|) is here)(, fighting [^\.!]+.|)" tfMobsubstDragonspyreTimeDragon = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}The Spirit of the Time Dragon @{Cgreen}(N, 50, dragon)@{n}%{invisTxt}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The GateKeeper appears to look right through you as he stands at his post\.|The GateKeeper is here)(, fighting [^\.!]+.|)" tfMobsubstDragonspyreGateKeeper = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The GateKeeper @{Cgreen}(N, 50, entity)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The shimmering Spirit of the Dragon freezes you in your steps( \(invisible\)|)|The Spirit of the Ice Dragon( \(invisible\)|) is here)(, fighting [^\.!]+.|)" tfMobsubstDragonspyreIceDragon = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}The Spirit of the Ice Dragon @{Cgreen}(N, 60, dragon)@{n}%{invisTxt}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Eternity Dragon stands before you, it pays you no heed as it stays its everlasting vigil\.|The Eternity Dragon is here)(, fighting [^\.!]+.|)" tfMobsubstDragonspyreEternityDragon = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Eternity Dragon @{Cgreen}(N, 95, dragon)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Dragontail Isle  -----------------------
/def -p99 -F -mregexp -t"(A small rat scurries along, looking for food\.|A small rat is here)(, fighting [^\.!]+.|)" tfMobsubstDragontailRat = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A small rat @{Cgreen}(N, 10, rodent)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A white bird circles over you, looking for food\.( \(invisible\)|)|A seagull( \(invisible\)|) is here)(, fighting [^\.!]+.|)" tfMobsubstDragontailSeagull = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}A seagull @{Cgreen}(N, 50, bird)@{n}%{invisTxt}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A small rabbit sits here in the grass\.( \(invisible\)|)|A wild rabbit( \(invisible\)|) is here)(, fighting [^\.!]+.|)" tfMobsubstDragontailRabbit = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}A wild rabbit @{Cgreen}(N, 50, animal)@{n}%{invisTxt}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A draconian with bright blue scales looks angrily at you\.( \(invisible\)|)|A blue draconian( \(invisible\)|) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDragontailBlueDraconian = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}A blue draconian @{Cgreen}(@{nCred}E@{nCgreen}, 60, magical/silver/mental, immune unlife)@{n}%{invisTxt}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A silvery scaled humanoid with two leathery wings is guarding the gate\.( \(invisible\)|)|A Draconian gatekeeper( \(invisible\)|) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDragontailGatekeeper = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}A Draconian gatekeeper @{Cgreen}(@{nCred}E@{nCgreen}, 60, magical/mental, immune unlife)@{n}%{invisTxt}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A winged draconian glares at you, its orange scales gleaming in the sunlight\.( \(invisible\)|)|An orange draconian( \(invisible\)|) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDragontailOrangeDraconian = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}An orange draconian @{Cgreen}(@{nCred}E@{nCgreen}, 60, magical/silver/mental, immune unlife)@{n}%{invisTxt}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A white draconian stares at you with its glowing red eyes\.( \(invisible\)|)|A white draconian( \(invisible\)|) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDragontailWhiteDraconian = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}A white draconian @{Cgreen}(@{nCred}E@{nCgreen}, 60, magical/silver/mental, immune unlife)@{n}%{invisTxt}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A draconian with yellow scales flexes his muscular arms as you enter\.( \(invisible\)|)|A yellow draconian( \(invisible\)|) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDragontailYellowDraconian = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}A yellow draconian @{Cgreen}(@{nCred}E@{nCgreen}, 60, magical/silver/mental, immune unlife)@{n}%{invisTxt}%{P4}%{PR}%; \
    /endif

/def -p99 -F -mregexp -t"(A skeleton clad in a dark cloak stands here, hatred glowing in its eye sockets\.( \(invisible\)|))( \(Red Aura\)|)" tfMobsubstDragontailAcolyteSkeleton = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}An acolyte of Sarakesh (skeleton) @{Cgreen}(@{nCred}E@{nCgreen}, 80, entity/silver/mental)@{n}%{invisTxt}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A lesser lich of the Sarakeshian order glares at you with its empty eyes\.( \(invisible\)|))( \(Red Aura\)|)" tfMobsubstDragontailAcolyteLich = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}An acolyte of Sarakesh (lich) @{Cgreen}(@{nCred}E@{nCgreen}, 80, entity/silver/mental)@{n}%{invisTxt}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An acolyte of Sarakesh( \(invisible\)|) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDragontailAcolyteEither = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}An acolyte of Sarakesh (skeleton/lich) @{Cgreen}(@{nCred}E@{nCgreen}, 80, entity/silver/mental)@{n}%{invisTxt}%{PR}%; \
    /endif

/def -p99 -F -mregexp -t"(What used to be a cleric of Sarakesh glares at you with hatred\.( \(invisible\)|)|A cleric of Sarakesh( \(invisible\)|) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDragontailCleric = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}A cleric of Sarakesh @{Cgreen}(@{nCred}E@{nCgreen}, 80, entity/silver/mental)@{n}%{invisTxt}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A skeleton clad in the robes of the clergy stands here in prayer\.( \(invisible\)|)|A Lich of Sarakesh( \(invisible\)|) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDragontailLich = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}A Lich of Sarakesh @{Cgreen}(@{nCred}E@{nCgreen}, 85, entity/silver/mental)@{n}%{invisTxt}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A great skeleton clad in full platemail raises his sword as you enter\.( \(invisible\)|)|A Templar of Sarakesh( \(invisible\)|) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDragontailTemplar = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}A Templar of Sarakesh @{Cgreen}(@{nCred}E@{nCgreen}, 85, entity/silver/mental)@{n}%{invisTxt}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(u_n_k_n_o_w_n( \(invisible\)|)|An Emerald Draconian( \(invisible\)|) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDragontailEmeraldDraconian = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}An Emerald Draconian @{Cgreen}(@{nCred}E@{nCgreen}, 90, magical/silver/mental, immune unlife)@{n}%{invisTxt}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(u_n_k_n_o_w_n( \(invisible\)|)|A Ruby Draconian( \(invisible\)|) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDragontailRubyDraconian = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}A Ruby Draconian @{Cgreen}(@{nCred}E@{nCgreen}, 90, magical/silver/mental, immune unlife)@{n}%{invisTxt}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(u_n_k_n_o_w_n( \(invisible\)|)|A Sapphire Draconian( \(invisible\)|) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDragontailSapphireDraconian = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}A Sapphire Draconian @{Cgreen}(@{nCred}E@{nCgreen}, 90, magical/silver/mental, immune unlife)@{n}%{invisTxt}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(u_n_k_n_o_w_n( \(invisible\)|)|A Topaz Draconian( \(invisible\)|) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDragontailTopazDraconian = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}A Topaz Draconian @{Cgreen}(@{nCred}E@{nCgreen}, 90, magical/silver/mental, immune unlife)@{n}%{invisTxt}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Lord Sarakesh looks angry at you as you enter his study\. \(invisible\)|A gargantuan bone-dragon lich looks very angry as you enter his study \(invisible\)|Lord Sarakesh \(invisible\) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDragontailLordSarakesh = \
    /if (mobsubs) \
      /if ({P1} =~ 'Lord Sarakesh looks angry at you as you enter his study. (invisible)') \
        /substitute -p %{PL}@{nCyellow}Lord Sarakesh (1) @{Cgreen}(@{nCred}E@{nCgreen}, 90, mental?)@{n} (imp)%{P2}%{PR}%; \
      /elseif ({P1} =~ 'A gargantuan bone-dragon lich looks very angry as you enter his study (invisible)') \
        /substitute -p %{PL}@{nCyellow}Lord Sarakesh (4) @{Cgreen}(@{nCred}E@{nCgreen}, 100, mental/wood)@{n} (imp)%{P2}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}Lord Sarakesh (1/4) @{Cgreen}(@{nCred}E@{nCgreen}, 90/100, mental? or mental/wood)@{n} (imp)%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(A giant draconian looks at you with hatred\. \(invisible\)|The Draconian Lord Sarakesh \(invisible\) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDragontailDraconianLordSarakesh = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Draconian Lord Sarakesh (2) @{Cgreen}(@{nCred}E@{nCgreen}, 90, mental?)@{n} (imp)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(the Lich or Lord Sarakesh glares icilly at you\. \(invisible\)|The Lich of Lord Sarakesh \(invisible\) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDragontailLichLordSarakesh = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Lich of Lord Sarakesh (3) @{Cgreen}(@{nCred}E@{nCgreen}, 90, crush/wood/silver?)@{n} (imp)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Before you stands a giant black draconian with many scars from battles\.( \(invisible\)|)|The Draconian Jailor( \(invisible\)|) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDragontailJailor = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}The Draconian Jailor @{Cgreen}(@{nCred}E@{nCgreen}, 95, silver/mental, special-cell-telp)@{n}%{invisTxt}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A hairless creature with grey skin glances at you with a pair of empty eyes\.( \(invisible\)|)|An imprisoned bodak( \(invisible\)|) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDragontailBodak = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}An imprisoned bodak @{Cgreen}(@{nCred}E@{nCgreen}, 95, magical/slash/silver/mental)@{n}%{invisTxt}%{P4}%{PR}%; \
    /endif%; \
    /if (area =~ 'DragontailIsle' & name =~ 'Cindy' & pg & wieldedweapon !~ 'reaper') \
      usew slaymagical%; \
    /endif
/def -p99 -F -mregexp -t"(Lord Tarashakan is praying silently here\. \(invisible\)|Lord Tarashakan \(invisible\) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDragontailTarashakan = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Lord Tarashakan @{Cgreen}(@{nCred}E@{nCgreen}, 95, magical/crush/mental)@{n} (imp)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Lady Eleonora of the Dragoncult stands here, holding her lance ready for battle\.|Lady Eleonora is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstDragontailLadyEleonora = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Lady Eleonora @{Cgreen}(@{nCwhite}G@{nCgreen}, 100, no-attack)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A stranded whale lies here helplessly\.( \(invisible\)|)|The Stranded Whale( \(invisible\)|) is here)(, fighting [^\.!]+.|)" tfMobsubstDragontailWhale = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}The Stranded Whale @{Cgreen}(N, 100, pure/ice)@{n}%{invisTxt}%{P4}%{PR}%; \
    /endif

; -----------------------  Drakyri Isle  -----------------------
/def -p99 -F -mregexp -t"(A drakyri assassin merges with the shadows\. \(hidden\)|A drakyri assassin \(hidden\) is here)(, fighting [^\.!]+.|)" tfMobsubstDrakyriAssassin = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A drakyri assassin @{Cgreen}(N, 65, elf)@{n} (hide)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A drakyri knight protector stands here\.|A drakyri knight protector is here)(, fighting [^\.!]+.|)" tfMobsubstDrakyriKnightProtector = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A drakyri knight protector @{Cgreen}(N, 65, elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A drakyri mage protector stands here\.|A drakyri mage protector is here)(, fighting [^\.!]+.|)" tfMobsubstDrakyriMageProtector = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A drakyri mage protector @{Cgreen}(N, 65, elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A drakyri healer stands here\.|A drakyri healer is here)(, fighting [^\.!]+.|)" tfMobsubstDrakyriHealer = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A drakyri healer @{Cgreen}(N, 65, elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A knight stands here watchfully\.|A guardian knight is here)(, fighting [^\.!]+.|)" tfMobsubstDrakyriGuardianKnight = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A guardian knight @{Cgreen}(N, 72, elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A drakyri warrior is here, sparring\.|A sparring warrior is here)(, fighting [^\.!]+.|)" tfMobsubstDrakyriSparringWarrior = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A sparring warrior @{Cgreen}(N, 72, elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A drakyri warrior in training is here, practicing defensive maneuvers\.|A warrior in training is here)(, fighting [^\.!]+.|)" tfMobsubstDrakyriWarriorInTraining = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A warrior in training @{Cgreen}(N, 72, elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A silvery grey cat prowls silently\.|The grey cat is here)(, fighting [^\.!]+.|)" tfMobsubstDrakyriGreyCat = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The grey cat @{Cgreen}(N, 72, feline)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A white cat is here, basking in the light\.|The white cat is here)(, fighting [^\.!]+.|)" tfMobsubstDrakyriWhiteCat = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The white cat @{Cgreen}(N, 72, feline)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A massive grey lion stands here\.|The grey lion is here)(, fighting [^\.!]+.|)" tfMobsubstDrakyriGreyLion = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The grey lion @{Cgreen}(N, 72, feline)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A ghostly form hovers here\.( \(invisible\)|)|The guardian spirit( \(invisible\)|) is standing here\.|The guardian spirit( \(invisible\)|) is here)(, fighting [^\.!]+.|)" tfMobsubstDrakyriGuardianSpirit = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)" | {P4} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}The guardian spirit @{Cgreen}(N, 72, energy, resist WEAPON)@{n}%{invisTxt}%{P5}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(You notice the glint of an arrow aimed at you from the shadows\. \(hidden\)|The hunter \(hidden\) is here)(, fighting [^\.!]+.|)" tfMobsubstDrakyriHunter = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The hunter @{Cgreen}(N, 72, iron/unlife/dark)@{n} (hide)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A shadowy form slips silently through the darkness\. \(hidden\)|The stalker \(hidden\) is here)(, fighting [^\.!]+.|)" tfMobsubstDrakyriStalker = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The stalker @{Cgreen}(N, 72, iron/unlife/dark)@{n} (hide)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A huge white lion prowls here\.|The white lion is here)(, fighting [^\.!]+.|)" tfMobsubstDrakyriWhiteLion = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The white lion @{Cgreen}(N, 72, energy)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A black panther prowls silently\. \(hidden\)|A black panther \(hidden\) is here)(, fighting [^\.!]+.|)" tfMobsubstDrakyriPanther = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A black panther @{Cgreen}(N, 75, feline)@{n} (hide)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The huge form of a shadow black hawk hovers here\. \(hidden\)|A night hawk \(hidden\) is here)(, fighting [^\.!]+.|)" tfMobsubstDrakyriNightHawk = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A night hawk @{Cgreen}(N, 75, bird)@{n} (hide)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A lynx stalks restlessly in the shadows\. \(hidden\)|A shadow lynx \(hidden\) is here)(, fighting [^\.!]+.|)" tfMobsubstDrakyriLynx = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A shadow lynx @{Cgreen}(N, 75, feline)@{n} (hide)%{P2}%{P4}%{P3}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A protective glyph hovers here\.( \(invisible\)|) \(hidden\)|A glyph of warding( \(invisible\)|) \(hidden\) is standing here\.|A glyph of warding( \(invisible\)|) \(hidden\) is here)(, fighting [^\.!]+.|)" tfMobsubstDrakyriGlyphOfWarding = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)" | {P4} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}A glyph of warding @{Cgreen}(N, 75, electricity)@{n}%{invisTxt} (hide)%{P5}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A mage in training is here, mumbling an incantation\.|A mage in training is here)(, fighting [^\.!]+.|)" tfMobsubstDrakyriMageInTraining = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A mage in training @{Cgreen}(N, 75, elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A paladin clad in pure white watches you\.|A white clad paladin is( standing|) here)(\.|)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstDrakyriWhClPaladin = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A white clad paladin @{Cgreen}(@{hCwhite}G@{nCgreen}, 75, elf)@{n}%{P2}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A ghostly form writhes here\.( \(invisible\)|)|A writhing form( \(invisible\)|) is standing here\.|A writhing form( \(invisible\)|) is here)(, fighting [^\.!]+.|)" tfMobsubstDrakyriWrithingForm = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)" | {P4} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}A writhing form @{Cgreen}(N, 75, energy/unlife, resist WEAPON)@{n}%{invisTxt}%{P5}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A hellish guardian stalks here, looking for prey\.|The hellish guardian is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDrakyriHellishGuardian = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The hellish guardian @{Cgreen}(@{nCred}E@{nCgreen}, 75, pure/light)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An assistant rushes around setting up an experiment\.|The lab assistant is( standing|) here)(\.|)(, fighting [^\.!]+.|)" tfMobsubstDrakyriAssistant = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The lab assistant @{Cgreen}(N, 75, elf)@{n}%{P2}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A warped figure screams with fury!|A howling beast is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDrakyriHowlingBeast = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A howling beast @{Cgreen}(@{nCred}E@{nCgreen}, 75, canine)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Mad red eyes glint insanely from the darkness\. \(hidden\)|A demonic figure \(hidden\) is standing here\.|A demonic figure \(hidden\) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDrakyriDemonicFigure = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A demonic figure @{Cgreen}(@{nCred}E@{nCgreen}, 75, pure/light)@{n} (hide)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A wax statue of a sinister black clad figure is here\.|The necromancer is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDrakyriNecromancer = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The necromancer @{Cgreen}(@{nCred}E@{nCgreen}, 75, human, pure/light)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A hulking figure snarls viciously\.|A summoned demon is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDrakyriSummonedDemon = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A summoned demon @{Cgreen}(@{nCred}E@{nCgreen}, 75, pure/light/silver/iron)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A mass of writhing tentacles reaches towards you!|A mass of writhing tentacles is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDrakyriWrithingTentacles = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A mass of writhing tentacles @{Cgreen}(@{nCred}E@{nCgreen}, 75, magical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Warden stands here, guarding the gates\.|The Warden is( standing|) here)(\.|)(, fighting [^\.!]+.|)" tfMobsubstDrakyriWarden = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Warden @{Cgreen}(N, 80, fire/unlife/ice/iron/mental/dark, resist WEAPON)@{n}%{P2}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A snow owl the color of blue ice cocks its head at you\.|Zeion is here)(, fighting [^\.!]+.|)" tfMobsubstDrakyriZeion = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Zeion @{Cgreen}(N, 80, bird/fire)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A drakyri emerges from the shadows\.|Delise is here)(, fighting [^\.!]+.|)" tfMobsubstDrakyriDelise = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Delise @{Cgreen}(N, 82, elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A young drakyri girl hovers here, laughing\.|Dryna is here)(, fighting [^\.!]+.|)" tfMobsubstDrakyriDryna = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Dryna @{Cgreen}(N, 82, elf/crush)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A slender girl stalks in the shadows\.|Nyxi is here)(, fighting [^\.!]+.|)" tfMobsubstDrakyriNyxi = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Nyxi @{Cgreen}(N, 82, elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A slender drakyri girl is here, sparring with her brother\.|Saera is here)(, fighting [^\.!]+.|)" tfMobsubstDrakyriSaera = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Saera @{Cgreen}(N, 82, elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A tall drakyri boy is here, studying\.|Voryl is here)(, fighting [^\.!]+.|)" tfMobsubstDrakyriVoryl = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Voryl @{Cgreen}(N, 82, elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A slender girl watches you from the shadows\.|Loryn is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDrakyriLoryn = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Loryn @{Cgreen}(@{nCred}E@{nCgreen}, 85, elf/pure/light, resist dark/unlife)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A drakyri child is here, playing with polished bones\.|Sorina is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDrakyriSorina = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Sorina @{Cgreen}(@{nCred}E@{nCgreen}, 85, elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A young drakyri man hovers here, studying\.|Chake is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDrakyriChake = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Chake @{Cgreen}(@{nCred}E@{nCgreen}, 85, elf, elf/pure/light, resist dark/unlife)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A white clad youth is here, taking notes\.|Josreke is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstDrakyriJosreke = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Josreke @{Cgreen}(@{hCwhite}G@{nCgreen}, 85, elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A young girl is here, practicing sword maneuvers\.|Rodwen is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstDrakyriRodwen = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Rodwen @{Cgreen}(@{hCwhite}G@{nCgreen}, 85, elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A winged youth fades in and out of view\.|Ykandres is here)(, fighting [^\.!]+.|)" tfMobsubstDrakyriYkandres = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Ykandres @{Cgreen}(N, 85, elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A drakyri girl grins at you impishly\.|Nalyss is here)(, fighting [^\.!]+.|)" tfMobsubstDrakyriNalyss = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Nalyss @{Cgreen}(N, 85, elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A young boy hovers here, concentrating on a spell\.( \(invisible\)|)|Daeman( \(invisible\)|) is here)(, fighting [^\.!]+.|)" tfMobsubstDrakyriDaeman = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}Daeman @{Cgreen}(N, 85, elf)@{n}%{invisTxt}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A tall drakyri boy is here, sparring with his sister\.|Versant is here)(, fighting [^\.!]+.|)" tfMobsubstDrakyriVersant = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Versant @{Cgreen}(N, 87, elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A drakyri lady paces silently\. \(hidden\)|Dyraena \(hidden\) is standing here\.|Dyraena \(hidden\) is here)(, fighting [^\.!]+.|)" tfMobsubstDrakyriDyraena = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Dyraena @{Cgreen}(N, 87, elf)@{n} (hide)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A tall drakyri lady is here, studying herb lore\.|Yllyra is here)(, fighting [^\.!]+.|)" tfMobsubstDrakyriYllyra = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Yllyra @{Cgreen}(N, 87, elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A male drakyri kneels here, weeding\.|Nerr is( standing|) here)(\.|)(, fighting [^\.!]+.|)" tfMobsubstDrakyriNerr = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Nerr @{Cgreen}(N, 87, elf)@{n}%{P2}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A well muscled drakyri man glances up from his work\.|Yeven is( standing|) here)(\.|)(, fighting [^\.!]+.|)" tfMobsubstDrakyriYeven = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Yeven @{Cgreen}(N, 88, elf)@{n}%{P2}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A slender form blends into the shadows\. \(hidden\)|Gydeas \(hidden\) is standing here\.|Gydeas \(hidden\) is here)(, fighting [^\.!]+.|)" tfMobsubstDrakyriGydeas = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Gydeas @{Cgreen}(N, 88, elf)@{n} (hide)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A drakyri paladin kneels here in prayer\.|Lerylke is( standing|) here)(\.|)(, fighting [^\.!]+.|)" tfMobsubstDrakyriLerylke = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Lerylke @{Cgreen}(N, 89, elf, resist dark/unlife)@{n}%{P2}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A female drakyri warrior is here, practicing sword maneuvers\.|Rakael is( standing|) here)(\.|)(, fighting [^\.!]+.|)" tfMobsubstDrakyriRakael = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Rakael @{Cgreen}(N, 89, elf)@{n}%{P2}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A drakyri stalks in the shadows\. \(hidden\)|Ryxis \(hidden\) is standing here\.|Ryxis \(hidden\) is here)(, fighting [^\.!]+.|)" tfMobsubstDrakyriRyxis = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Ryxis @{Cgreen}(N, 88, elf)@{n} (hide)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A black clad figure watches you silently\. \(hidden\)|Katyre \(hidden\) is standing here\.|Katyre \(hidden\) is here)(, fighting [^\.!]+.|)" tfMobsubstDrakyriKatyre = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Katyre @{Cgreen}(N, 90, elf)@{n} (hide)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A drakyri unfurls his wings and snarls at your intrusion\. \(hidden\)|Kranali \(hidden\) is standing here\.|Kranali \(hidden\) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDrakyriKranali = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Kranali @{Cgreen}(@{nCred}E@{nCgreen}, 90, elf/pure/light, resist dark/unlife)@{n} (hide)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A slender drakyri girl is here, reading\.|Lyrene is( standing|) here)(\.|)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstDrakyriLyrene = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Lyrene @{Cgreen}(@{hCwhite}G@{nCgreen}, 90, elf)@{n}%{P2}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A young drakyri lady is here, studying\.|Tyrena is here)(, fighting [^\.!]+.|)(\.|)" tfMobsubstDrakyriTyrena = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Tyrena @{Cgreen}(N, 90, elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A drakyri woman is here, meditating\.|Jorinne is here)(, fighting [^\.!]+.|)(\.|)" tfMobsubstDrakyriJorinne = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Jorinne @{Cgreen}(N, 90, elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A golden haired drakyri is here, practicing\.|Nyxil is( standing|) here)(\.|)(, fighting [^\.!]+.|)" tfMobsubstDrakyriNyxil = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Nyxil @{Cgreen}(N, 90, elf)@{n}%{P2}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A male drakyri hovers here\.|Deis is( standing|) here)(\.|)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstDrakyriDeis = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Deis @{Cgreen}(@{hCwhite}G@{nCgreen}, 91, elf)@{n}%{P2}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A slim form crouches in the shadows\. \(hidden\)|Neraikis of the Myrxes \(hidden\) is here)(, fighting [^\.!]+.|)" tfMobsubstDrakyriNeraikis = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Neraikis of the Myrxes @{Cgreen}(N, 91, elf)@{n} (hide)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A drakyri lord is here, radiating power\.|Ryke of the Xaek is here)(, fighting [^\.!]+.|)" tfMobsubstDrakyriRyke = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Ryke of the Xaek @{Cgreen}(N, 91, elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A drakyri man robed in blue stands here, efficiently taking notes\.|Xanil is here)(, fighting [^\.!]+.|)" tfMobsubstDrakyriXanil = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Xanil @{Cgreen}(N, 91, elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A white clad drakyri lady stands here\.|Nerael of the Noriva is here)(, fighting [^\.!]+.|)" tfMobsubstDrakyriNerael = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Nerael of the Noriva @{Cgreen}(N, 91, elf, resist dark/unlife)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A dark drakyri man stands here, muttering an incantation\.( \(invisible\)|)|Delyrus( \(invisible\)|) is standing here\.|Delyrus( \(invisible\)|) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDrakyriDelyrus = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)" | {P4} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}Delyrus @{Cgreen}(@{nCred}E@{nCgreen}, 91, elf/pure/light, resist dark/unlife)@{n}%{invisTxt}%{P5}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A tall drakyri man stands here\.|Yxanes of the Noriva is here)(, fighting [^\.!]+.|)" tfMobsubstDrakyriYxanes = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Yxanes of the Noriva @{Cgreen}(N, 92, elf, resist dark/unlife)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A female drakyri hovers here\.|Rexena is( standing|) here)(\.|)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstDrakyriRexena = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Rexena @{Cgreen}(@{hCwhite}G@{nCgreen}, 92, elf/fire)@{n}%{P2}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A slender drakyri hovers here\.|Roweni is( standing|) here)(\.|)(, fighting [^\.!]+.|)" tfMobsubstDrakyriRoweni = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Roweni @{Cgreen}(N, 92, elf)@{n}%{P2}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A powerful drakyri lady watches warily\.|Dyana of the Xaek is here)(, fighting [^\.!]+.|)" tfMobsubstDrakyriDyana = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Dyana of the Xaek @{Cgreen}(N, 92, elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Wary silver eyes gleam from the darkness\. \(hidden\)|Jaena of the Myrxes \(hidden\) is here)(, fighting [^\.!]+.|)" tfMobsubstDrakyriJaena = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Jaena of the Myrxes @{Cgreen}(N, 92, elf)@{n} (hide)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A black clad drakyri watches you\.|Dreyva is( standing|) here)(\.|)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDrakyriDreyva = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Dreyva @{Cgreen}(@{nCred}E@{nCgreen}, 92, elf/pure/light, resist dark/unlife, deathspell)@{n}%{P2}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A commanding drakyri lady stands here\.|Janalis is( standing|) here)(\.|)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDrakyriJanalis = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Janalis @{Cgreen}(@{nCred}E@{nCgreen}, 93, elf/pure/light, resist dark/unlife, deathspell)@{n}%{P2}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A drakyri lady stands here, involved in an experiment\.|Dyrli is( standing|) here)(\.|)(, fighting [^\.!]+.|)" tfMobsubstDrakyriDyrli = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Dyrli @{Cgreen}(N, 93, elf)@{n}%{P2}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A drakyri stands here, radiating an aura of command\.|Kaele is( standing|) here)(\.|)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstDrakyriKaele = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Kaele @{Cgreen}(@{hCwhite}G@{nCgreen}, 93, elf)@{n}%{P2}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A tall winged man in black is here\.|Toryan of the Reykaris is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDrakyriToryan = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Toryan of the Reykaris @{Cgreen}(@{nCred}E@{nCgreen}, 94, elf/pure/light, resist dark/unlife, deathspell)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A beautiful winged lady gazes out over the city\.|Denylis of the Treniste is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstDrakyriDenylis = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Denylis of the Treniste @{Cgreen}(@{hCwhite}G@{nCgreen}, 94, elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A darkly handsome drakyri lord regards you curiously\.|Noriek of the Deriki is here)(, fighting [^\.!]+.|)" tfMobsubstDrakyriNoriek = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Noriek of the Deriki @{Cgreen}(N, 94, elf/pierce)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A drakyri lord in gleaming white raises an eyebrow at your intrusion\.|Dosandre of the Treniste is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstDrakyriDosandre = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Dosandre of the Treniste @{Cgreen}(@{hCwhite}G@{nCgreen}, 95, elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A winged lady in shimmering blue robes stands here, working on something\.|Lechandre of the Deriki is here)(, fighting [^\.!]+.|)" tfMobsubstDrakyriLechandre = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Lechandre of the Deriki @{Cgreen}(N, 95, elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A raven haired drakyri lady stands here, radiating evil\.|Rachal of the Reykaris is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDrakyriRachal = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Rachal of the Reykaris @{Cgreen}(@{nCred}E@{nCgreen}, 95, elf?, deathspell)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Guardian watches you measuringly\.|The Guardian is( standing|) here)(\.|)(, fighting [^\.!]+.|)" tfMobsubstDrakyriGuardian = \
    /if (mobsubs & area =~ 'Drakyri') \
      /substitute -p %{PL}@{nCyellow}The Guardian @{Cgreen}(N, 96, fire)@{n}%{P2}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A powerful drakyri warrior stands here\.|The Fist is( standing|) here)(\.|)(, fighting [^\.!]+.|)" tfMobsubstDrakyriFist = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Fist @{Cgreen}(N, 97, elf, resist WEAPON)@{n}%{P2}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A powerful drakyri priest is here, haloed in white light\.|The Hand is here)(, fighting [^\.!]+.|)" tfMobsubstDrakyriHand = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Hand @{Cgreen}(N, 97, elf/fire/energy, resist unlife/dark)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The shadows are deep here\. \(hidden\)|The Shadow \(hidden\) is here)(, fighting [^\.!]+.|)" tfMobsubstDrakyriShadow = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Shadow @{Cgreen}(N, 97, elf)@{n} (hide)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A sinister knight clad in black stands here\.|The Claw is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDrakyriClaw = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Claw @{Cgreen}(@{nCred}E@{nCgreen}, 98, elf/pure/light, immune dark/unlife, pkill)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A powerful drakyri mage stands here, surrounded by an aura of heat\.|The Flame is here)(, fighting [^\.!]+.|)" tfMobsubstDrakyriFlame = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Flame @{Cgreen}(N, 98, elf/ice)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A drakyri paladin stands here, glowing with divine power\.|The Shield is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstDrakyriShield = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Shield @{Cgreen}(@{hCwhite}G@{nCgreen}, 98, elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A slender drakyri stands here, emanating power\.( \(invisible\)|) \(hidden\)|The Laerkai Master( \(invisible\)|) \(hidden\) is standing here\.|The Laerkai Master( \(invisible\)|) \(hidden\) is here)(, fighting [^\.!]+.|)" tfMobsubstDrakyriMaster = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)" | {P4} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}The Laerkai Master @{Cgreen}(N, 99, ???)@{n}%{invisTxt} (hide)%{P5}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A goblin made of steel and copper is sorting goods in the shelves\.|Blenok the mechanical goblin is here)(, fighting [^\.!]+.|)" tfMobsubstDrakyriBlenok = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Blenok the mechanical goblin @{Cgreen}(N, 100, QM)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"A frail old man smiles mysteriously at you." tfMobsubstDrakyriFrailOldMan = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A frail old man @{Cgreen}(N, 100, shopkeeper)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Shifting grey light pervades the room\.( \(invisible\)|)|The Mediator( \(invisible\)|) is here)(, fighting [^\.!]+.|)" tfMobsubstDrakyriMediator = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}The Mediator @{Cgreen}(N, 100, energy?, mana shielded, specials)@{n}%{P4}%{PR}%; \
    /endif

; -----------------------  Drow City  -----------------------
/def -p99 -F -mregexp -t"(The chained goblin slave looks quite abused\.|An abused Goblin Slave is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDrowGoblinSlave = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An abused Goblin Slave @{Cgreen}(@{nCred}E@{nCgreen}, 5, ---)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The captive fairy is chained here awaiting her future as a slave\.|The Captive Fairy is here)(, fighting [^\.!]+.|)" tfMobsubstDrowFairy = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Captive Fairy @{Cgreen}(N, 7, fairie)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A drow scout wanders among the commoners to provide protection\.|The Drow Scout is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDrowScout = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Drow Scout @{Cgreen}(@{nCred}E@{nCgreen}, 10, drow-elf, immune ice)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(This drow magician is here protecting the home of his noble employer\.|A Drow magician is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDrowMagician = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Drow magician @{Cgreen}(@{nCred}E@{nCgreen}, 15, drow-elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(This noble warrior is the beloved consort of (Anhara|Jenaria|Mandara|Sharana)\.|(Anhara|Jenaria|Mandara|Sharana)'s Consort is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDrowConsort = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}%{P2}'s Consort @{Cgreen}(@{nCred}E@{nCgreen}, 15, drow-elf)@{n}%{P3}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A drow student warrior is here practicing his moves\.|Warrior Student is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDrowWarriorStudent = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Warrior Student @{Cgreen}(@{nCred}E@{nCgreen}, 15, drow-elf, immune pure/light/ice)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The drow slaver walks silently around the room watching his prizes being sold\.|Drow Slaver is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDrowSlaver = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Drow Slaver @{Cgreen}(@{nCred}E@{nCgreen}, 20, drow-elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A minor priestess of Lolth is performing a ceremony of devotion here\.|Minor Priestess of Lolth is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDrowPriestess = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Minor Priestess of Lolth @{Cgreen}(@{nCred}E@{nCgreen}, 17, drow-elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An angry spider attacks you for destroying its web\.|An Angry Spider is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDrowAngrySpider = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An Angry Spider @{Cgreen}(@{nCred}E@{nCgreen}, 25, spider)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The drow musician stands here entertaining Anhara's guests\.|Drow Musician is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDrowMusician = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Drow Musician @{Cgreen}(@{nCred}E@{nCgreen}, 25, drow-elf, immune pure/light/ice, mana shielded)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Anhara's pet spider is sleeping peacefully looking quite sated\.|Anhara's Pet Spider is( standing| sleeping|) here)(\.|)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDrowPetSpider = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Anhara's Pet Spider @{Cgreen}(@{nCred}E@{nCgreen}, 28, spider)@{n}%{P2}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The smithy stands here creating a new weapon\.|The Smithy is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDrowSmithy = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Smithy @{Cgreen}(@{nCred}E@{nCgreen}, 30, drow-elf, immune pure/ice)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The master cleric watches over his students\.|Drow Master of Healing is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDrowMoHealing = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Drow Master of Healing @{Cgreen}(@{nCred}E@{nCgreen}, 31, drow-elf, immune pure/light/ice)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Drow Master of Magic is here testing his student's skill\.|Drow Master of Magic is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDrowMoMagic = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Drow Master of Magic @{Cgreen}(@{nCred}E@{nCgreen}, 31, drow-elf, immune pure/light/ice)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The drow master is here observing his students\.|Drow Master of War is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDrowMoWar = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Drow Master of War @{Cgreen}(@{nCred}E@{nCgreen}, 31, drow-elf, immune pure/light/ice)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The old alchemist is hard at work in her lab making a new elixir\.|The Old Drow Alchemist is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDrowAlchemist = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Old Drow Alchemist @{Cgreen}(@{nCred}E@{nCgreen}, 31, drow-elf, immune pure/light/ice)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Lolth's chosen weaponsmaster stands here awaiting his final challenge\.|The weaponsmaster is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDrowWeaponsmaster = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The weaponsmaster @{Cgreen}(@{nCred}E@{nCgreen}, 33, drow-elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Jeniara looks up in surprise as you enter her room\.|Jenaria is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDrowJenaria = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Jenaria @{Cgreen}(@{nCred}E@{nCgreen}, 34, drow-elf, immune pure/light/ice)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Mandara, the noble mistress of this house glares at you\.|Mandara is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDrowMandara = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Mandara @{Cgreen}(@{nCred}E@{nCgreen}, 34, drow-elf, immune pure/light/ice)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Sharana looks at you and smiles in a very unnerving manner\.|Sharana is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDrowSharana = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Sharana @{Cgreen}(@{nCred}E@{nCgreen}, 34, drow-elf, immune pure/light/ice)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A yochlol forms out of a swirling mist\.|The yochlol is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDrowYochlol = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The yochlol @{Cgreen}(@{nCred}E@{nCgreen}, 35, mythical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Anhara the matron mother of the city awaits your challenge\.|Anhara is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDrowAnhara = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Anhara @{Cgreen}(@{nCred}E@{nCgreen}, 37, drow-elf, immune pure/light/ice)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Druid Forest  -----------------------
/def -p99 -F -mregexp -t"(A haggard-looking slave is here, baking bread\.|The slave is here)(, fighting [^\.!]+.|)" tfMobsubstDruidForestSlave = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The slave @{Cgreen}(N, 1, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A poor peasant is here, hoping you will give him some food\.|The peasant is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstDruidForestPeasant = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The peasant @{Cgreen}(@{nCwhite}G@{nCgreen}, 3, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A plump sanglier is standing here, pawing at the dirt\.|The sanglier is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstDruidForestSanglier = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The sanglier @{Cgreen}(@{nCwhite}G@{nCgreen}, 3, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A well-to-do villager is here, doing his daily shopping\.|The villager is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstDruidForestVillager = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The villager @{Cgreen}(@{nCwhite}G@{nCgreen}, 7, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A brawny Gallic warrior is standing here, guarding the village\.|The Gallic warrior is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstDruidForestWarrior = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Gallic warrior @{Cgreen}(@{nCwhite}G@{nCgreen}, 10, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A druid stands here, helping the villagers\.|A druid is here, picking mistletoe\.|The Druid is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstDruidForestDruid = \
    /if (mobsubs) \
      /if ({P1} =~ 'A druid stands here, helping the villagers.') \
        /substitute -p %{PL}@{nCyellow}The Druid (helping) @{Cgreen}(@{nCwhite}G@{nCgreen}, 12, human)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'A druid is here, picking mistletoe.') \
        /substitute -p %{PL}@{nCyellow}The Druid (picking) @{Cgreen}(@{nCwhite}G@{nCgreen}, 12, human)@{n}%{P2}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}The Druid (helping/picking) @{Cgreen}(@{nCwhite}G@{nCgreen}, 12, human)@{n}%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(The Mage of the village is here, making magic items\.|The Druid Mage is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstDruidForestMage = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Druid Mage @{Cgreen}(@{nCwhite}G@{nCgreen}, 15, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Village Chief sits here on his throne\.|The Village Chief is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstDruidForestChief = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Village Chief @{Cgreen}(@{nCwhite}G@{nCgreen}, 18, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Grand Druid of the Village is here, practicing magic\.|The Grand Druid is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstDruidForestGrandDruid = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Grand Druid @{Cgreen}(@{nCwhite}G@{nCgreen}, 20, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Druid Mage's Apprentice is here, showing you the shop's selection\.|The apprentice is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstDruidForestApprentice = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The apprentice @{Cgreen}(@{nCwhite}G@{nCgreen}, 30, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Armourer shows you his fine selection of armor\.|The Armourer is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstDruidForestArmourer = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Armourer @{Cgreen}(@{nCwhite}G@{nCgreen}, 30, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Baker wipes off his hands and asks you what you would like\.|The Baker is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstDruidForestBaker = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Baker @{Cgreen}(@{nCwhite}G@{nCgreen}, 30, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A tall K'ta'viiri is guarding the forest\.|Lord Eowaran the banished K'ta'viiri druid is here)(, fighting [^\.!]+.|)" tfMobsubstDruidForestLord = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Lord Eowaran the banished K'ta'viiri druid @{Cgreen}(N, 100, QM)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Dunheim  -----------------------
/def -p99 -F -mregexp -t"(A multicoloured bird is flying around here\.|A multicoloured bird is standing here\.|A multicoloured bird is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstDunheimBird = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A multicoloured bird @{Cgreen}(@{nCwhite}G@{nCgreen}, 5, bird)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A rabbit sits here\.|A rabbit is here)(, fighting [^\.!]+.|)" tfMobsubstDunheimRabbit = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A rabbit @{Cgreen}(N, 5, canine)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A small squirrel climbs the trees around you\.|A small squirrel is here)(, fighting [^\.!]+.|)" tfMobsubstDunheimSquirrel = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A small squirrel @{Cgreen}(N, 7, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A gardener is here keeping the garden in perfect condition\.|A gardener is here)(, fighting [^\.!]+.|)" tfMobsubstDunheimGardener = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A gardener @{Cgreen}(N, 10, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p101 -F -mregexp -t"(A servant is here, ready to serve.|A servant is here)(, fighting [^\.!]+.|)" tfMobsubstDunheimServant = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A servant @{Cgreen}(N, 10, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A deer looks up as you come close\.|A deer is here)(, fighting [^\.!]+.|)" tfMobsubstDunheimDeer = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A deer @{Cgreen}(N, 14, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A boar pokes around in the dirt\.|A boar is here)(, fighting [^\.!]+.|)" tfMobsubstDunheimBoar = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A boar @{Cgreen}(N, 20, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A man is strapped to a rack here\.|A monk is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstDunheimMonk = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A monk @{Cgreen}(@{nCwhite}G@{nCgreen}, 20, human, MIRACLE)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A man is chained to the wall here\.|A prisoner is standing here\.|A prisoner is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDunheimPrisoner = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A prisoner @{Cgreen}(@{nCred}E@{nCgreen}, 20, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A hermit sits next to the campfire\.|The hermit is standing here\.|The hermit is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstDunheimHermit = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The hermit @{Cgreen}(@{nCwhite}G@{nCgreen}, 20, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A castle guard walks by\.|A castle guard is here)(, fighting [^\.!]+.|)" tfMobsubstDunheimGuard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A castle guard  @{Cgreen}(N, 30, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A nobleman is here, visiting the Lord\.|A nobleman is here)(, fighting [^\.!]+.|)" tfMobsubstDunheimNobleman = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A nobleman @{Cgreen}(N, 30, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p97 -F -mregexp -t"(A archer is here practising with his bow\.|An archer is here)(, fighting [^\.!]+.|)" tfMobsubstDunheimArcher = \
    /if (mobsubs & ({P1} =~ 'A archer is here practising with his bow.' | area =~ 'Dunheim')) \
      /substitute -p %{PL}@{nCyellow}An archer @{Cgreen}(N, 30, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A courtier wanders around, praising their mighty leader and Lord\.|The courtier is sitting here\.|The courtier sits here, close to the Lord\.|A courtier is here)(, fighting [^\.!]+.|)" tfMobsubstDunheimCourtier = \
    /if (mobsubs) \
      /if ({P1} =~ 'A courtier wanders around, praising their mighty leader and Lord.') \
        /substitute -p %{PL}@{nCyellow}A courtier (wanders) @{Cgreen}(N, 32, human)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'The courtier is sitting here.' | {P1} =~ 'The courtier sits here, close to the Lord.') \
        /substitute -p %{PL}@{nCyellow}A courtier (sits) @{Cgreen}(N, 35, human)@{n}%{P2}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}A courtier (wanders/sits) @{Cgreen}(N, 32/35, human)@{n}%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(A busy cook is preparing the dinner\. \(invisible\)|A cook \(invisible\) is here)(, fighting [^\.!]+.|)" tfMobsubstDunheimCook = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A cook @{Cgreen}(N, 35, human)@{n} (imp)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A strong looking guard stands here guarding the front gate|A gateguard is here)(, fighting [^\.!]+.|)" tfMobsubstDunheimGateguard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A gateguard @{Cgreen}(N, 40, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A devil runs around working with the room\.|A small devil is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDunheimDevil = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A small devil @{Cgreen}(@{nCred}E@{nCgreen}, 40, devil?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A watchman stands here, eyeing the horizon\.|A watchman is here)(, fighting [^\.!]+.|)" tfMobsubstDunheimWatchman = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A watchman @{Cgreen}(N, 40, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A maid is here protecting the Lady\.|A maid is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstDunheimMaid = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A maid @{Cgreen}(@{nCwhite}G@{nCgreen}, 45, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A large, peaceful wolf is looking at you with the saddest eyes you've ever seen\.|Ceng, the friend of Eowaran is here)(, fighting [^\.!]+.|)" tfMobsubstDunheimCeng = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Ceng, the friend of Eowaran @{Cgreen}(N, 45, canine)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A large creature from hell stands here.|The Darkmage's servant is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDunheimDarkmageServant = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Darkmage's servant @{Cgreen}(@{nCred}E@{nCgreen}, 50, devil)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The jailor is sitting here\.|The jailor is here)(, fighting [^\.!]+.|)" tfMobsubstDunheimJailor = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The jailor @{Cgreen}(N, 50, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A large bear is sleeping here\.|A large bear is standing here\.|A large bear is here)(, fighting [^\.!]+.|)" tfMobsubstDunheimBear = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A large bear @{Cgreen}(N, 50, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The captain of the guard stands here practising his forms\.|The captain of the guard is here)(, fighting [^\.!]+.|)" tfMobsubstDunheimCaptain = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The captain of the guard @{Cgreen}(N, 60, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Some dark matter hovers in the air\.|A dark dot is here)(, fighting [^\.!]+.|)" tfMobsubstDunheimDot = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A dark dot @{Cgreen}(N, 60, insubstantial?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A large green statue stands here\.( \(invisible\)|)|A jade statue( \(invisible\)|) is here circling around in the air\.|A jade statue( \(invisible\)|) is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstDunheimStatue = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)" | {P4} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}A jade statue @{Cgreen}(@{nCwhite}G@{nCgreen}, 70, magical)@{n}%{invisTxt}%{P5}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A mass of arms and legs throws itself at you\.|u_n_k_n_o_w_n after battle|The dark torturer is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDunheimTorturer = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The dark torturer @{Cgreen}(@{nCred}E@{nCgreen}, 85, insubstantial?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Lord of the land sits on the throne\.|Lord Dareil is( sitting|) here)(\.|)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstDunheimLord = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Lord Dareil @{Cgreen}(@{nCwhite}G@{nCgreen}, 80, human)@{n}%{P2}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Lady of the land sits here with her maids\.|Lady Sarah is here)(, fighting [^\.!]+.|)( \(Whited Aura\)|)" tfMobsubstDunheimLady = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Lady Sarah @{Cgreen}(@{nCwhite}G@{nCgreen}, 85, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A large man sits here\.|The Evil Darkmage is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDunheimDarkmage = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Evil Darkmage @{Cgreen}(@{nCred}E@{nCgreen}, 95, human, mana shielded)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Aramon the Castle defender stands here\.( \(invisible\)|)|Aramon( \(invisible\)|) is here)(, fighting [^\.!]+.|)" tfMobsubstDunheimAramon = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}Aramon @{Cgreen}(N, 100, human?)@{n}%{invisTxt}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A tear-stained little girl looks at you with mournful eyes\.|Gwenyln, daughter of Amothus is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstDunheimGwenyln = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Gwenyln, daughter of Amothus @{Cgreen}(@{nCwhite}G@{nCgreen}, 100, human)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Dwarven Kingdom  -----------------------
/def -p99 -F -mregexp -t"(A dwarven peon is awaiting help here\.|The dwarven peon is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstDwarvenKingdomPeon = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The dwarven peon @{Cgreen}(@{nCwhite}G@{nCgreen}, 3, dwarf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A dwarven mineworker is here\.|A dwarven mineworker is here)(, fighting [^\.!]+.|)" tfMobsubstDwarvenKingdomMineworker = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A dwarven mineworker @{Cgreen}(N, 4, dwarf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A dwarven mining worker is here\.|Dwarf worker is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstDwarvenKingdomWorker = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Dwarf worker @{Cgreen}(@{nCwhite}G@{nCgreen}, 4, dwarf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The dwarven doctor is here\.|The dwarven doctor is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstDwarvenKingdomDoctor = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The dwarven doctor @{Cgreen}(@{nCwhite}G@{nCgreen}, 4, dwarf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A dwarven mine leader is here\.|A dwarven mine leader is here)(, fighting [^\.!]+.|)" tfMobsubstDwarvenKingdomLeader = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A dwarven mine leader @{Cgreen}(N, 6, dwarf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A barrack guard is here\.|The barrack's guard is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstDwarvenKingdomBarracksGuard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The barrack's guard @{Cgreen}(@{nCwhite}G@{nCgreen}, 6, dwarf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A grinning dwarf is here\.|The dwarf is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstDwarvenKingdomGrinningDwarf = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The dwarf @{Cgreen}(@{nCwhite}G@{nCgreen}, 9, dwarf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An unwanted son is here\. You feel sorry for the guy\.|The unwanted son is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstDwarvenKingdomSon = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The unwanted son @{Cgreen}(@{nCwhite}G@{nCgreen}, 9, dwarf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An unwanted daughter is here\. You feel sorry for her\.|The unwanted daughter is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstDwarvenKingdomDaughter = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The unwanted daughter @{Cgreen}(@{nCwhite}G@{nCgreen}, 10, dwarf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(There is a giant snake here\.|The giant snake is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDwarvenKingdomSnake = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The giant snake @{Cgreen}(@{nCred}E@{nCgreen}, 15, snake)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A man in waiting is here\. He looks nervous and unsure of himself\.|The man in waiting is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstDwarvenKingdomManInWaiting = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The man in waiting @{Cgreen}(@{nCwhite}G@{nCgreen}, 15, dwarf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A wraith is awaiting your first move here\.|A wraith is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDwarvenKingdomWraith = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A wraith @{Cgreen}(@{nCred}E@{nCgreen}, 17, insubstantial)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A dwarven guard is here\.|Dwarf guard is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstDwarvenKingdomDwarfGuard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Dwarf guard @{Cgreen}(@{nCwhite}G@{nCgreen}, 20/30, dwarf, protector)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A giant is here\.|The giant is here)(, fighting [^\.!]+.|)" tfMobsubstDwarvenKingdomGiant = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The giant @{Cgreen}(N, 25, giant)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A giant lizard is here\.|The giant lizard is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstDwarvenKingdomLizard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The giant lizard @{Cgreen}(@{nCwhite}G@{nCgreen}, 25, snake)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The dwarven queen stands here\.|Dwarf queen is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstDwarvenKingdomQueen = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Dwarf queen @{Cgreen}(@{nCwhite}G@{nCgreen}, 70, dwarf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A mazekeeper is here\.|The mazekeeper is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstDwarvenKingdomMazekeeper = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The mazekeeper @{Cgreen}(@{nCred}E@{nCgreen}, 71, dwarf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Granite Head, the baker, is waiting for a customer here\.|Granite Head the baker is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstDwarvenKingdomGranite = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Granite Head the baker @{Cgreen}(@{nCwhite}G@{nCgreen}, 99, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(There is the Hide & Tooth storekeeper standing here, waiting patiently\.|The Hide & Tooth storekeeper is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstDwarvenKingdomHideTooth = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Hide & Tooth storekeeper @{Cgreen}(@{nCwhite}G@{nCgreen}, 99, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Guttnubblet Rockhocker stands here, hocking rocks\.|Guttnubblet Rockhocker is here)(, fighting [^\.!]+.|)" tfMobsubstDwarvenKingdomGuttnubblet = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Guttnubblet Rockhocker @{Cgreen}(N, 100, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  EarthSea  -----------------------
/def -p99 -F -mregexp -t"(A Human Slave is here, hard at work\.|A Human Slave is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstEarthSeaSlave = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Human Slave @{Cgreen}(@{nCred}E@{nCgreen}, 30, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Fool is here, making fun of you\.|The Draconian Fool is here)(, fighting [^\.!]+.|)" tfMobsubstEarthSeaFool = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Draconian Fool @{Cgreen}(N, 30, magical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Dragon Hatchling is here, chewing on a bone\.|The Dragon Hatchling is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstEarthSeaHatchling = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Dragon Hatchling @{Cgreen}(@{nCred}E@{nCgreen}, 40, dragon)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Concubine is resting here\.|A Concubine is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstEarthSeaConcubine = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Concubine @{Cgreen}(@{nCred}E@{nCgreen}, 50, magical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Draconian zombie is here, staring at nothing in particular\.|A Draconian zombie is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstEarthSeaZombie = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Draconian zombie @{Cgreen}(@{nCred}E@{nCgreen}, 55, undead)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Phase Dragon is darting around the room\.|The Phase Dragon is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstEarthSeaPhaseDragon = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Phase Dragon @{Cgreen}(@{nCred}E@{nCgreen}, 60, dragon)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Bodyguard is here, staring at you menacingly\.|A Bodyguard is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstEarthSeaBodyguard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Bodyguard @{Cgreen}(@{nCred}E@{nCgreen}, 70, magical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The nineheaded hydra is here, blocking the doorway\.|A large hydra is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstEarthSeaHydra = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A large hydra @{Cgreen}(@{nCred}E@{nCgreen}, 70, dragon)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(u_n_k_n_o_w_n|The Great White Dragon is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstEarthSeaWhiteDragon = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Great White Dragon @{Cgreen}(@{nCred}E@{nCgreen}, 70, dragon)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Draconian is standing here\.|The Draconian is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstEarthSeaDraconian = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Draconian @{Cgreen}(@{nCred}E@{nCgreen}, 75, magical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Man is here, studying some books\.|A Powerful Mage is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstEarthSeaMage = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Powerful Mage @{Cgreen}(@{nCred}E@{nCgreen}, 80, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(u_n_k_n_o_w_n|The Dragon Master is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstEarthSeaMaster = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Dragon Master @{Cgreen}(@{nCred}E@{nCgreen}, 80, magical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(u_n_k_n_o_w_n|The Great Red Dragon is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstEarthSeaRedDragon = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Great Red Dragon @{Cgreen}(@{nCred}E@{nCgreen}, 80, dragon)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Draconian is here, deep in thought\.|The Holy Draconian is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstEarthSeaHoly = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Holy Draconian @{Cgreen}(@{nCred}E@{nCgreen}, 80, magical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Black Dragon is here, laughing at your insolence\.|The Great Black Dragon is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstEarthSeaBlackDragon = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Great Black Dragon @{Cgreen}(@{nCred}E@{nCgreen}, 90, dragon)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Draconian wearing fine clothes is here, pondering his greatness\.|The Draconian King is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstEarthSeaKing = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Draconian King @{Cgreen}(@{nCred}E@{nCgreen}, 90, magical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Female Draconian sits, here, looking very important\.|The Draconian Queen is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstEarthSeaQueen = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Draconian Queen @{Cgreen}(@{nCred}E@{nCgreen}, 90, magical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Ged, The Wizard Of Earthsea, peers at you as you enter this room\.|Ged is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstEarthSeaGed = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Ged @{Cgreen}(@{nCred}E@{nCgreen}, 95, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(u_n_k_n_o_w_n|The Ancient Green Dragon is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstEarthSeaGreenDragon = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Ancient Green Dragon @{Cgreen}(@{nCred}E@{nCgreen}, 97, dragon)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Elven Lands  -----------------------
/def -p99 -F -mregexp -t"(A young duck is here, fluttering about in the pond\.|A duck is here)(, fighting [^\.!]+.|)" tfMobsubstElvenLandsDuck = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A duck @{Cgreen}(N, 10, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An elven child is here chasing after butterflies\.|An elven child is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstElvenLandsChild = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An elven child @{Cgreen}(@{nCwhite}G@{nCgreen}, 15, elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An elf is here planting flowers, he doesn't seem to notice you\.\.\.|An elven gardener is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstElvenLandsGardener = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An elven gardener @{Cgreen}(@{nCwhite}G@{nCgreen}, 25, elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A stout looking elven council member is here making decisions\.|A stout looking elven council member is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstElvenLandsCouncilMember = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A stout looking elven council member @{Cgreen}(@{nCwhite}G@{nCgreen}, 30, elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A sturn elven sorcerer is here practicing his art\.|A sturn elven sorcerer is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstElvenLandsSorcerer = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A sturn elven sorcerer @{Cgreen}(@{nCwhite}G@{nCgreen}, 30, elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An elven druid is here, tending to the plants and wildlife\.|An elven druid is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstElvenLandsDruid = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An elven druid @{Cgreen}(@{nCwhite}G@{nCgreen}, 30, elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An elven lady of the cross is here, praying the creator\.|An elven lady of the cross is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstElvenLandsCrossLady = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An elven lady of the cross @{Cgreen}(@{nCwhite}G@{nCgreen}, 30, elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A focused elven archer is here, aiming his bow\.|A focused elven archer is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstElvenLandsArcher = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A focused elven archer @{Cgreen}(@{nCwhite}G@{nCgreen}, 35, elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A resting elf visitor is here, admiring the hut\.|A resting visitor is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstElvenLandsRestingVisitor = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A resting visitor @{Cgreen}(@{nCwhite}G@{nCgreen}, 35, elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A stoic elven defender is here, protecting the towers\.|A stoic elven defender is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstElvenLandsDefender = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A stoic elven defender @{Cgreen}(@{nCwhite}G@{nCgreen}, 35, elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An elven lady of the sword wanders through the kingdom\.|An elven lady of the sword is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstElvenLandsSwordLady = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An elven lady of the sword @{Cgreen}(@{nCwhite}G@{nCgreen}, 35, elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A slender elven visitor is here, walking through the gardens in awe\.|An elven visitor is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstElvenLandsVisitor = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An elven visitor @{Cgreen}(@{nCwhite}G@{nCgreen}, 35, elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A beautiful elven ranger is here scouting the garden\.|An elven ranger is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstElvenLandsRanger = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An elven ranger @{Cgreen}(@{nCwhite}G@{nCgreen}, 37, elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A dwarven explorer is here, searching the elven mountains for treasure\.|A dwarven explorer is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstElvenLandsExplorer = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A dwarven explorer @{Cgreen}(@{nCwhite}G@{nCgreen}, 39, elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A solid looking elven warlord is here, brandishing a sword\.|A solid looking elven warlord is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstElvenLandsWarlord = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A solid looking elven warlord @{Cgreen}(@{nCwhite}G@{nCgreen}, 39, elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A sturdy elven noble is here, travelling between towers\.|An elven noble is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstElvenLandsNoble = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An elven noble @{Cgreen}(@{nCwhite}G@{nCgreen}, 39, elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A small elven philosopher is here, debating and contemplating\.|A small elven philosopher is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstElvenLandsPhilosopher = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A small elven philosopher @{Cgreen}(@{nCwhite}G@{nCgreen}, 40, elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Damen the drow elf is here, conjuring spells of darkness\.|Damen the drow elf is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstElvenLandsDamen = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Damen the drow elf @{Cgreen}(@{nCred}E@{nCgreen}, 40, drow-elf, resist WEAPON)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(King Valentine, lord of the elven lands is here smiling\.|King Valentine is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstElvenLandsKing = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}King Valentine @{Cgreen}(@{nCwhite}G@{nCgreen}, 50, elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Peradorn, keeper of the garden is here planning\.|Peradorn, keeper of the garden is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstElvenLandsPeradorn = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Peradorn, keeper of the garden @{Cgreen}(@{nCwhite}G@{nCgreen}, 50, elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Prince Belindaor is standing here, looking astute\.|Prince Belindaor is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstElvenLandsPrince = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Prince Belindaor @{Cgreen}(@{nCwhite}G@{nCgreen}, 50, elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Queen Leodore is here, standing gracefully\.|Queen Leodore is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstElvenLandsQueen = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Queen Leodore @{Cgreen}(@{nCwhite}G@{nCgreen}, 50, elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The elven swordsmaster awaits instruction from his king\.|Swordsmaster Pennidor is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstElvenLandsPennidor = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Swordsmaster Pennidor @{Cgreen}(@{nCwhite}G@{nCgreen}, 55, elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Grand Elven Sorcerer, Belindor is floating here\.|The Grand Elven Sorcerer, Belindor is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstElvenLandsBelindor = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Grand Elven Sorcerer, Belindor @{Cgreen}(@{nCwhite}G@{nCgreen}, 70, elf)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Elven Valley  -----------------------
/def -p99 -F -mregexp -t"(An old hermit sits here, smoking a pipe\.|An old hermit is here)(, fighting [^\.!]+.|)" tfMobsubstElvenValleyHermit = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An old hermit @{Cgreen}(N, 3, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A wolf is here, looking for small prey\.|A wolf is here)(, fighting [^\.!]+.|)" tfMobsubstElvenValleyWolf = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A wolf @{Cgreen}(N, 4, canine)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A rather large dog is here, wandering the valley\.|A cooshee is here)(, fighting [^\.!]+.|)" tfMobsubstElvenValleyCooshee = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A cooshee @{Cgreen}(N, 5, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A valley elf scout wanders the valley, searching for intruders like you!|A valley elf scout is here)(, fighting [^\.!]+.|)" tfMobsubstElvenValleyScout = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A valley elf scout @{Cgreen}(N, 6, elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An antelope is here, peacefully munching on grass\.|An antelope is here)(, fighting [^\.!]+.|)" tfMobsubstElvenValleyAntelope = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An antelope @{Cgreen}(N, 6, elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A valley elf is here, doing her duties\.|A female valley elf wanders here, skirting between the tall grasses\.|A valley elf wanders here, cautious of your intrusion\.|A valley elf is here)(, fighting [^\.!]+.|)" tfMobsubstElvenValleyElf = \
    /if (mobsubs) \
      /if ({P1} =~ 'A valley elf is here, doing her duties.') \
        /substitute -p %{PL}@{nCyellow}A valley elf (duties) @{Cgreen}(N, 6, elf)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'A female valley elf wanders here, skirting between the tall grasses.') \
        /substitute -p %{PL}@{nCyellow}A valley elf (female) @{Cgreen}(N, 8, elf)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'A valley elf wanders here, cautious of your intrusion.') \
        /substitute -p %{PL}@{nCyellow}A valley elf (male) @{Cgreen}(N, 8, elf)@{n}%{P2}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}A valley elf (duties/female/male) @{Cgreen}(N, 6/8/8, elf)@{n}%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(A valley elf sentry stands here, then noticing you, attacks quickly!|A valley elf sentry is here)(, fighting [^\.!]+.|)" tfMobsubstElvenValleySentry = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A valley elf sentry @{Cgreen}(N, 7, elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The demon skeleton steps out of the shadows and attacks!|The demon skeleton is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstElvenValleySkeleton = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The demon skeleton @{Cgreen}(@{nCred}E@{nCgreen}, 7, skeleton)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The demon zombie advances upon you and attacks!|The demon zombie is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstElvenValleyZombie = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The demon zombie @{Cgreen}(@{nCred}E@{nCgreen}, 10, undead)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A valley elf elder is here, studying\.  She notices you\.|A valley elf elder is here, studying\.  He notices you\.|A valley elf elder is here)(, fighting [^\.!]+.|)" tfMobsubstElvenValleyElder = \
    /if (mobsubs) \
      /if ({P1} =~ 'A valley elf elder is here, studying.  She notices you.') \
        /substitute -p %{PL}@{nCyellow}A valley elf elder (F) @{Cgreen}(N, 15, elf)@{n}%{P2}%{PR}%; \
        /def -F -n1 -msimple -ag -t"A valley elf elder says 'Your arrogance will be your end, human.'"%; \
      /elseif ({P1} =~ 'A valley elf elder is here, studying.  He notices you.') \
        /substitute -p %{PL}@{nCyellow}A valley elf elder (M) @{Cgreen}(N, 15, elf)@{n}%{P2}%{PR}%; \
        /def -F -n1 -msimple -ag -t"A valley elf elder shouts 'You have intruded wrongly.  Be prepared to die!'"%; \
      /else \
        /substitute -p %{PL}@{nCyellow}A valley elf elder (F/M) @{Cgreen}(N, 15, elf)@{n}%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(A lesser demon appears suddenly and attacks!|The lesser demon is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstElvenValleyLesserDemon = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The lesser demon @{Cgreen}(@{nCred}E@{nCgreen}, 15, demon)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A big beast with many heads, each breathing fire, stares at you with malice\.|The pyrohydra is here)(, fighting [^\.!]+.|)" tfMobsubstElvenValleyPyrohydra = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The pyrohydra @{Cgreen}(N, 20, dragon)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An old mage busies himself with some chemicals\.|Talemon is here)(, fighting [^\.!]+.|)" tfMobsubstElvenValleyTalemon = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Talemon @{Cgreen}(N, 25, elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A huge guardian daemon is here, watching the treasure\.|The guardian daemon is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstElvenValleyGuardianDaemon = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The guardian daemon @{Cgreen}(@{nCred}E@{nCgreen}, 25, demon)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Elven Village  -----------------------
/def -p99 -F -mregexp -t"(An Elven Guard is playing cards at the table\.|The Elven guard is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstElvenVillageGuardPlaying = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Elven guard (playing) @{Cgreen}(@{nCwhite}G@{nCgreen}, 10, elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An Elven Guard is walking around, protecting the villagers\.|The Elven guard is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstElvenVillageGuardWalking = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Elven guard (walking) @{Cgreen}(@{nCwhite}G@{nCgreen}, 10, elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An Elven Soldier is standing here guarding the path\.|The Elven soldier is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstElvenVillageSoldier = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Elven soldier @{Cgreen}(@{nCwhite}G@{nCgreen}, 10, elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An old Druid is standing on the hill chanting an arcane spell\.|The old Druid is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstElvenVillageDruid = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The old Druid @{Cgreen}(@{nCwhite}G@{nCgreen}, 10, elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An Elven Guardian is standing here guarding the portal\.|The Elven guardian is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstElvenVillageGuardian = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Elven guardian @{Cgreen}(@{nCwhite}G@{nCgreen}, 19, elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An Elf named Quintor is here counting money behind the counter\.|The Elf named Quintor is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstElvenVillageQuintor = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Elf named Quintor @{Cgreen}(@{nCwhite}G@{nCgreen}, 23, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Large Elven armoursmith is walking around behind the counter\.|The Elven armoursmith is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstElvenVillageArmoursmith = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Elven armoursmith @{Cgreen}(@{nCwhite}G@{nCgreen}, 23, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A fat Elf is standing behind the bar taking orders\.|The Elven bartender is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstElvenVillageBartender = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Elven bartender @{Cgreen}(@{nCwhite}G@{nCgreen}, 23, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Tiny Elven mage is floating behind the counter\.|The Elven mage is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstElvenVillageMage = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Elven mage @{Cgreen}(@{nCwhite}G@{nCgreen}, 23, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A nice-looking Elf is standing in the reception\.|The Elven receptionist is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstElvenVillageReceptionist = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Elven receptionist @{Cgreen}(@{nCwhite}G@{nCgreen}, 23, nofight-room)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Large Elven weaponsmith is walking behind the counter\.|The Elven weaponsmith is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstElvenVillageWeaponsmith = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Elven weaponsmith @{Cgreen}(@{nCwhite}G@{nCgreen}, 23, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Huge Fire Elemental is standing here burning everything\.|A Huge Fire Elemental is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstElvenVillageElemental = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Huge Fire Elemental @{Cgreen}(@{nCwhite}G@{nCgreen}, 25, elemental)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A lazy-looking Elf lies on his bed snoring loudly\.|The Chief of the elven guard is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstElvenVillageChief = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Chief of the elven guard @{Cgreen}(@{nCwhite}G@{nCgreen}, 25, elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A wise alchemist searches for an adventurer for hire|Kofar the lonely alchemist is here)(, fighting [^\.!]+.|)" tfMobsubstElvenVillageKofar = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Kofar the lonely alchemist @{Cgreen}(N, 51, QM)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An elven Champion is standing here looking at the trophies\.|The Champion is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstElvenVillageChampion = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Champion @{Cgreen}(@{nCwhite}G@{nCgreen}, 99, elf)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Enchanted Forest  -----------------------
/def -p99 -F -mregexp -t"(A black beetle is here, though barely noticable\.|A black beetle is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstEnchantedForestBeetle = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A black beetle @{Cgreen}(@{nCred}E@{nCgreen}, 2, insect)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A carrion crawler devours a corpse\.|A carrion crawler is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstEnchantedForestCarrionCrawler = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A carrion crawler @{Cgreen}(@{nCred}E@{nCgreen}, 2, insect)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A goat that dwells in the mountains jumps from cliff to cliff\.|A mountain goat is here)(, fighting [^\.!]+.|)" tfMobsubstEnchantedForestGoat = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A mountain goat @{Cgreen}(N, 9, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A spikey hedgehog wanders around in the undergrowth\.|The spikey hedgehog is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstEnchantedForestHedgehog = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The spikey hedgehog @{Cgreen}(@{nCred}E@{nCgreen}, 9, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A giant bear cub is stretching its paws lazily and then yawns at you\.|A giant bear cub is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstEnchantedForestBearCub = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A giant bear cub @{Cgreen}(@{nCwhite}G@{nCgreen}, 10, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A brownie hides in the undergrowth\.|The brownie is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstEnchantedForestBrownie = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The brownie @{Cgreen}(@{nCwhite}G@{nCgreen}, 10, fairie)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A little sprite is buzzing in your ear and flapping its wings\.|A little sprite is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstEnchantedForestSprite = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A little sprite @{Cgreen}(@{nCwhite}G@{nCgreen}, 12, fairie)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A pysk runs around the trees\.|A pysk is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstEnchantedForestPysk = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A pysk @{Cgreen}(@{nCwhite}G@{nCgreen}, 12, fairie)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A satyr is here, dancing\.|The satyr is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstEnchantedForestSatyr = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The satyr @{Cgreen}(@{nCwhite}G@{nCgreen}, 15, ---)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A giant porcupine shows you its spikes\.|The giant porcupine is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstEnchantedForestPorcupine = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The giant porcupine @{Cgreen}(@{nCred}E@{nCgreen}, 16, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A centaur looks at you then runs off into the forest\.|A centaur is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstEnchantedForestCentaur = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A centaur @{Cgreen}(@{nCwhite}G@{nCgreen}, 17, magical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A giant squirrel is here, running back and forth high up in the trees\.|The giant squirrel is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstEnchantedForestSquirrel = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The giant squirrel @{Cgreen}(@{nCred}E@{nCgreen}, 18, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A large satyr plays beautifully on its pan flute\.|The large satyr is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstEnchantedForestLargeSatyr = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The large satyr @{Cgreen}(@{nCred}E@{nCgreen}, 20, ---)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A korred dances in wild frenzy\.|The korred is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstEnchantedForestKorred = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The korred @{Cgreen}(@{nCwhite}G@{nCgreen}, 20, ---)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A nymph queen smiles at you\.|The nymph queen is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstEnchantedForestNymphQueen = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The nymph queen @{Cgreen}(@{nCwhite}G@{nCgreen}, 22, fairie)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A dryad peers at you invitingly with soft her soft blue eyes\.|The dryad is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstEnchantedForestDryad = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The dryad @{Cgreen}(@{nCwhite}G@{nCgreen}, 23, fairie)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A giant bear growls angrily at you\.|The giant bear is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstEnchantedForestBear = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The giant bear @{Cgreen}(@{nCwhite}G@{nCgreen}, 24, animal, special-stun)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A blue faerie dragon greets you with a nice, pleasant smile\.\.\.|A blue faerie dragon is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstEnchantedForestBlueDragon = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A blue faerie dragon @{Cgreen}(@{nCred}E@{nCgreen}, 25, dragon)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An apprentice druid is here, picking flowers\.|An apprentice druid is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstEnchantedForestAppDruid = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An apprentice druid @{Cgreen}(@{nCwhite}G@{nCgreen}, 25, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A wood elven ranger stands before you\.|The elven ranger is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstEnchantedForestRanger = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The elven ranger @{Cgreen}(@{nCwhite}G@{nCgreen}, 25, elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A pegasus stands here, flapping its wings\.|The pegasus is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstEnchantedForestPegasus = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The pegasus @{Cgreen}(@{nCwhite}G@{nCgreen}, 27, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A black faerie dragon greets you with a nice, pleasant smile\.\.\.|A black faerie dragon is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstEnchantedForestBlackDragon = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A black faerie dragon @{Cgreen}(@{nCwhite}G@{nCgreen}, 30, dragon)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A giant badger is here\.|The giant badger is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstEnchantedForestBadger = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The giant badger @{Cgreen}(@{nCwhite}G@{nCgreen}, 35, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A giant boar is here, frustrated by your presence\.|The giant boar is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstEnchantedForestBoar = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The giant boar @{Cgreen}(@{nCwhite}G@{nCgreen}, 38, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An unicorn is here, guarding the forest\.|The unicorn is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstEnchantedForestUnicorn = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The unicorn @{Cgreen}(@{nCwhite}G@{nCgreen}, 40, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An Old, Old Druid, with a long white beard, is here, tending to the forest\.|An old druid, with a long white beard is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstEnchantedForestOldDruid = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An old druid, with a long white beard @{Cgreen}(@{nCwhite}G@{nCgreen}, 68, human, special-transform)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(u_n_k_n_o_w_n|The huge worm is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstEnchantedForestWorm = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The huge worm @{Cgreen}(@{nCwhite}G@{nCgreen}, 68, snake)@{n}%{P2}%{PR}%; \
    /endif
/def -F -msimple -t"...slowly transforming into The huge worm." tfMobsubstEnchantedForestWorm2 = \
    /substitute -p ...slowly transforming into The huge worm. @{Cgreen}(@{nCwhite}G@{nCgreen}, 68, snake)@{n}
/def -p99 -F -mregexp -t"(u_n_k_n_o_w_n|The giant rhino is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstEnchantedForestRhino = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The giant rhino @{Cgreen}(@{nCwhite}G@{nCgreen}, 68, animal?)@{n}%{P2}%{PR}%; \
    /endif
/def -F -msimple -t"...slowly transforming into The giant rhino." tfMobsubstEnchantedForestRhino2 = \
    /substitute -p ...slowly transforming into The giant rhino. @{Cgreen}(@{nCwhite}G@{nCgreen}, 68, animal?)@{n}
/def -p99 -F -mregexp -t"(u_n_k_n_o_w_n|The darkenbeast is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstEnchantedForestDarkenbeast = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The darkenbeast @{Cgreen}(@{nCwhite}G@{nCgreen}, 68, magical?)@{n}%{P2}%{PR}%; \
    /endif
/def -F -msimple -t"...slowly transforming into The darkenbeast." tfMobsubstEnchantedForestDarkenbeast2 = \
    /substitute -p ...slowly transforming into The darkenbeast. @{Cgreen}(@{nCwhite}G@{nCgreen}, 68, magical?)@{n}
/def -p99 -F -mregexp -t"(An old man stands here, tending to the undergrowth\.|The great grand druid is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstEnchantedForestGreatGrandDruid = \
    /if (mobsubs) \
      /if (exitlist =~ 'East') \
        /substitute -p %{PL}@{nCyellow}The great grand druid (w) @{Cgreen}(@{nCwhite}G@{nCgreen}, 71, human?, special-transform)@{n}%{P2}%{PR}%; \
      /elseif (exitlist =~ 'North') \
        /substitute -p %{PL}@{nCyellow}The great grand druid (s) @{Cgreen}(@{nCwhite}G@{nCgreen}, 73, human, special-transform)@{n}%{P2}%{PR}%; \
      /elseif (exitlist =~ 'West') \
        /substitute -p %{PL}@{nCyellow}The great grand druid (e) @{Cgreen}(@{nCwhite}G@{nCgreen}, 77, human?, special-transform)@{n}%{P2}%{PR}%; \
      /elseif (exitlist =~ 'South') \
        /substitute -p %{PL}@{nCyellow}The great grand druid (n) @{Cgreen}(@{nCwhite}G@{nCgreen}, 80, human?, special-transform)@{n}%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(u_n_k_n_o_w_n|The giant fire lizard is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstEnchantedForestFireLizard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The giant fire lizard @{Cgreen}(@{nCwhite}G@{nCgreen}, 71?, ???)@{n}%{P2}%{PR}%; \
    /endif
/def -F -msimple -t"...slowly transforming into The giant fire lizard." tfMobsubstEnchantedForestFireLizard2 = \
    /substitute -p ...slowly transforming into The giant fire lizard. @{Cgreen}(@{nCwhite}G@{nCgreen}, 71?, ???)@{n}
/def -p99 -F -mregexp -t"(u_n_k_n_o_w_n|The huge owlbear is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstEnchantedForestOwlbear = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The huge owlbear @{Cgreen}(@{nCwhite}G@{nCgreen}, 71?, ???)@{n}%{P2}%{PR}%; \
    /endif
/def -F -msimple -t"...slowly transforming into The huge owlbear." tfMobsubstEnchantedForestOwlbear2 = \
    /substitute -p ...slowly transforming into The huge owlbear. @{Cgreen}(@{nCwhite}G@{nCgreen}, 71?, ???)@{n}
/def -p99 -F -mregexp -t"(u_n_k_n_o_w_n|The giant vulture is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstEnchantedForestVulture = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The giant vulture @{Cgreen}(@{nCwhite}G@{nCgreen}, 71?, ???)@{n}%{P2}%{PR}%; \
    /endif
/def -F -msimple -t"...slowly transforming into The giant vulture." tfMobsubstEnchantedForestVulture2 = \
    /substitute -p ...slowly transforming into The giant vulture. @{Cgreen}(@{nCwhite}G@{nCgreen}, 71?, ???)@{n}
/def -p99 -F -mregexp -t"(u_n_k_n_o_w_n|The dire wolf is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstEnchantedForestDireWolf = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The dire wolf @{Cgreen}(@{nCwhite}G@{nCgreen}, 73?, ???)@{n}%{P2}%{PR}%; \
    /endif
/def -F -msimple -t"...slowly transforming into The dire wolf." tfMobsubstEnchantedForestDireWolf2 = \
    /substitute -p ...slowly transforming into The dire wolf. @{Cgreen}(@{nCwhite}G@{nCgreen}, 73?, ???)@{n}
/def -p99 -F -mregexp -t"(u_n_k_n_o_w_n|The giant anaconda is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstEnchantedForestAnaconda = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The giant anaconda @{Cgreen}(@{nCwhite}G@{nCgreen}, 73, ???)@{n}%{P2}%{PR}%; \
    /endif
/def -F -msimple -t"...slowly transforming into The giant anaconda." tfMobsubstEnchantedForestAnaconda2 = \
    /substitute -p ...slowly transforming into The giant anaconda. @{Cgreen}(@{nCwhite}G@{nCgreen}, 73, ???)@{n}
/def -p99 -F -mregexp -t"(u_n_k_n_o_w_n|The pterandon is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstEnchantedForestPterandon = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The pterandon @{Cgreen}(@{nCwhite}G@{nCgreen}, 73?, ???)@{n}%{P2}%{PR}%; \
    /endif
/def -F -msimple -t"...slowly transforming into The pterandon." tfMobsubstEnchantedForestPterandon2 = \
    /substitute -p ...slowly transforming into The pterandon. @{Cgreen}(@{nCwhite}G@{nCgreen}, 73?, ???)@{n}
/def -p99 -F -mregexp -t"(u_n_k_n_o_w_n|The yeti is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstEnchantedForestYeti = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The yeti @{Cgreen}(@{nCwhite}G@{nCgreen}, 77?, ???)@{n}%{P2}%{PR}%; \
    /endif
/def -F -msimple -t"...slowly transforming into The yeti." tfMobsubstEnchantedForestYeti2 = \
    /substitute -p ...slowly transforming into The yeti. @{Cgreen}(@{nCwhite}G@{nCgreen}, 77?, ???)@{n}
/def -p99 -F -mregexp -t"(u_n_k_n_o_w_n|The remorhaz is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstEnchantedForestRemorhaz = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The remorhaz @{Cgreen}(@{nCwhite}G@{nCgreen}, 77?, ???)@{n}%{P2}%{PR}%; \
    /endif
/def -F -msimple -t"...slowly transforming into The remorhaz." tfMobsubstEnchantedForestRemorhaz2 = \
    /substitute -p ...slowly transforming into The remorhaz. @{Cgreen}(@{nCwhite}G@{nCgreen}, 77?, ???)@{n}
/def -p99 -F -mregexp -t"(u_n_k_n_o_w_n|The roc is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstEnchantedForestRoc = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The roc @{Cgreen}(@{nCwhite}G@{nCgreen}, 77?, ???)@{n}%{P2}%{PR}%; \
    /endif
/def -F -msimple -t"...slowly transforming into The roc." tfMobsubstEnchantedForestRoc2 = \
    /substitute -p ...slowly transforming into The roc. @{Cgreen}(@{nCwhite}G@{nCgreen}, 77?, ???)@{n}
/def -p99 -F -mregexp -t"(u_n_k_n_o_w_n|The u_n_k_n_o_w_n is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstEnchantedForestUnknownA = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The u_n_k_n_o_w_n @{Cgreen}(@{nCwhite}G@{nCgreen}, 80?, ???)@{n}%{P2}%{PR}%; \
    /endif
/def -F -msimple -t"...slowly transforming into The u_n_k_n_o_w_n." tfMobsubstEnchantedForestUnknownA2 = \
    /substitute -p ...slowly transforming into The u_n_k_n_o_w_n. @{Cgreen}(@{nCwhite}G@{nCgreen}, 80?, ???)@{n}
/def -p99 -F -mregexp -t"(u_n_k_n_o_w_n|The u_n_k_n_o_w_n is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstEnchantedForestUnknownB = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The u_n_k_n_o_w_n @{Cgreen}(@{nCwhite}G@{nCgreen}, 80?, ???)@{n}%{P2}%{PR}%; \
    /endif
/def -F -msimple -t"...slowly transforming into The u_n_k_n_o_w_n." tfMobsubstEnchantedForestUnknownB2 = \
    /substitute -p ...slowly transforming into The u_n_k_n_o_w_n. @{Cgreen}(@{nCwhite}G@{nCgreen}, 80?, ???)@{n}
/def -p99 -F -mregexp -t"(u_n_k_n_o_w_n|The u_n_k_n_o_w_n is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstEnchantedForestUnknownC = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The u_n_k_n_o_w_n @{Cgreen}(@{nCwhite}G@{nCgreen}, 80?, ???)@{n}%{P2}%{PR}%; \
    /endif
/def -F -msimple -t"...slowly transforming into The u_n_k_n_o_w_n." tfMobsubstEnchantedForestUnknownC2 = \
    /substitute -p ...slowly transforming into The u_n_k_n_o_w_n. @{Cgreen}(@{nCwhite}G@{nCgreen}, 80?, ???)@{n}
/def -p99 -F -mregexp -t"(An umber hulk is here\. \(hidden\)|The umber hulk \(hidden\) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstEnchantedForestHulk = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The umber hulk @{Cgreen}(@{nCred}E@{nCgreen}, 75, magical)@{n} (hide)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A huge, redwood tree is here, slowly moving its animated roots\.|The huge redwood tree is here)(, fighting [^\.!]+.|)" tfMobsubstEnchantedForestRedwood = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The huge redwood tree @{Cgreen}(N, 78, botanic)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Dozens of glowing, amber eyes peer at you in the dark, steaming from rage\. \(hidden\)|A hydra with twelve heads \(hidden\) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstEnchantedForestHydra = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A hydra with twelve heads @{Cgreen}(@{nCred}E@{nCgreen}, 82, dragon)@{n} (hide)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A treant spreads its roots over the ground\.|A treant is here)(, fighting [^\.!]+.|)" tfMobsubstEnchantedForestTreant = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A treant @{Cgreen}(N, 85, botanic)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A huge red dragon lies on a huge hoard of treasures, sleeping\. \(hidden\)|A great red wyrm \(hidden\) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstEnchantedForestWyrm = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A great red wyrm @{Cgreen}(@{nCred}E@{nCgreen}, 85, dragon, noflee)@{n} (hide)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A tarrasque stands here, eating anything nearby\.|The Tarrasque is here)(, fighting [^\.!]+.|)" tfMobsubstEnchantedForestTarrasque = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Tarrasque @{Cgreen}(N, 95, mythical, noflee)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Enclave  -----------------------
/def -p99 -F -mregexp -t"(A small rabbit nibbles at a leaf here\.|A rabbit is here)(, fighting [^\.!]+.|)" tfMobsubstEnclaveRabbit = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A rabbit @{Cgreen}(N, 1, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A squirrel spots you and runs around a tree!|A squirrel is here)(, fighting [^\.!]+.|)" tfMobsubstEnclaveSquirrel = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A squirrel @{Cgreen}(N, 1, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A deer looks at you with fear in its eyes\.|A deer is here)(, fighting [^\.!]+.|)" tfMobsubstEnclaveDeer = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A deer @{Cgreen}(N, 3, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An orc child frantically searches for her mother\.|An orc child is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstEnclaveOrcChile = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An orc child @{Cgreen}(@{nCwhite}G@{nCgreen}, 3, ---)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An elven child casts his fishing pole into the river\.|The elven child is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstEnclaveElvenChild = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The elven child @{Cgreen}(@{nCwhite}G@{nCgreen}, 3, elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An orc woman stands here, frightened of you\.|A pregnant orc woman tries to stand to flee from you\.|An orc woman is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstEnclaveOrcWoman = \
    /if (mobsubs) \
      /if ({P1} =~ 'An orc woman stands here, frightened of you.') \
        /substitute -p %{PL}@{nCyellow}An orc woman (stands) @{Cgreen}(@{nCred}E@{nCgreen}, 5, ---)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'A pregnant orc woman tries to stand to flee from you.') \
        /substitute -p %{PL}@{nCyellow}An orc woman (pregnant) @{Cgreen}(@{nCred}E@{nCgreen}, 5, ---)@{n}%{P2}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}An orc woman (stands/pregnant) @{Cgreen}(@{nCred}E@{nCgreen}, 5, ---)@{n}%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(A mutant orc lies here, barely alive\.|A horribly mutated orc stands here, gibbering\.|The mutant orc is here)(, fighting [^\.!]+.|)" tfMobsubstEnclaveMutantOrc = \
    /if (mobsubs) \
      /if ({P1} =~ 'A mutant orc lies here, barely alive.') \
        /substitute -p %{PL}@{nCyellow}The mutant orc (lies) @{Cgreen}(N, 6, ---)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'A horribly mutated orc stands here, gibbering.') \
        /substitute -p %{PL}@{nCyellow}The mutant orc (stands) @{Cgreen}(N, 6, ---)@{n}%{P2}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}The mutant orc (lies/stands) @{Cgreen}(N, 6, ---)@{n}%{P2}%{PR}%; \
     /endif%; \
   /endif
/def -p99 -F -mregexp -t"(An orc hunter looks at you with hateful eyes\.|The orc hunter is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstEnclaveOrcHunter = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The orc hunter @{Cgreen}(@{nCred}E@{nCgreen}, 7, ---)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An orc chief growls at you!|The orc chief is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstEnclaveChief = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The orc chief @{Cgreen}(@{nCred}E@{nCgreen}, 10, ---)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A mutant\.\.\.thing tries to get you, but cannot move into range!|A mutant thing is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstEnclaveAMutant = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A mutant thing @{Cgreen}(@{nCred}E@{nCgreen}, 12, magical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A mutant\.\.\.thing rushes at you!|The mutant thing is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstEnclaveTheMutant = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The mutant thing @{Cgreen}(@{nCred}E@{nCgreen}, 12, magical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An elven wizard is here\.  He looks angry\.|Elstar is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstEnclaveElstar = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Elstar @{Cgreen}(@{nCred}E@{nCgreen}, 15, elf)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Estuary  -----------------------
/def -p99 -F -mregexp -t"(A purple shore crab peers around before snapping its pincers at you\.|A purple shore crab is here)(, fighting [^\.!]+.|)" tfMobsubstEstuaryPurpleShoreCrab = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A purple shore crab @{Cgreen}(N, 5, fish)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A gull flaps its wings and makes a loud squarking sound\.|A gull is here)(, fighting [^\.!]+.|)" tfMobsubstEstuaryGull = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A gull @{Cgreen}(N, 9, bird)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An orange toad hops between various small pools of water\.|An orange toad is here)(, fighting [^\.!]+.|)" tfMobsubstEstuaryOrangeToad = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An orange toad @{Cgreen}(N, 6, amphibian)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A cockle picker walks around looking for cockles\.|A cockle picker is here)(, fighting [^\.!]+.|)" tfMobsubstEstuaryCocklePicker = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A cockle picker @{Cgreen}(N, 35, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A sand crab scuttles around with its pincers in the air\.|A sand crab is here)(, fighting [^\.!]+.|)" tfMobsubstEstuarySandCrab = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A sand crab @{Cgreen}(N, 3, fish)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(You only just spot this crayfish because of its muddy appearance\.|A crayfish is here)(, fighting [^\.!]+.|)" tfMobsubstEstuaryCrayfish = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A crayfish @{Cgreen}(N, 2, fish)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A pelican struts around here occasionally bobbing its head in the water\.|A pelican is here)(, fighting [^\.!]+.|)" tfMobsubstEstuaryPelican = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A pelican @{Cgreen}(N, 13, bird)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A river turtle moves slowly here trying not to be noticed\.|A river turtle is here)(, fighting [^\.!]+.|)" tfMobsubstEstuaryRiverTurtle = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A river turtle @{Cgreen}(N, 7, amphibian)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An albatross is busy cleaning its feathers\.|An albatross is here)(, fighting [^\.!]+.|)" tfMobsubstEstuaryAlbatross = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An albatross @{Cgreen}(N, 14-17, bird)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A shrimp looks lost here\.|A shrimp is here)(, fighting [^\.!]+.|)" tfMobsubstEstuaryShrimp = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A shrimp @{Cgreen}(N, 2, fish)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A gannet opens its beak and fills its face with fish\.|A gannet is here)(, fighting [^\.!]+.|)" tfMobsubstEstuaryGannet = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A gannet @{Cgreen}(N, 12, bird)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A great blue heron blooms its feathers majestically\.|A great blue heron is here)(, fighting [^\.!]+.|)" tfMobsubstEstuaryGreatBlueHeron = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A great blue heron @{Cgreen}(N, 10, bird)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A marsh frog hops around amongst the long wet reeds\.|A marsh frog is here)(, fighting [^\.!]+.|)" tfMobsubstEstuaryMarshFrog = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A marsh frog @{Cgreen}(N, 4, amphibian)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A thief, camouflaged amongst the reeds, hides out here\. \(hidden\)|A marsh thief \(hidden\) is here)(, fighting [^\.!]+.|)" tfMobsubstEstuaryMarshThief = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A marsh thief @{Cgreen}(N, 42, human, thief)@{n} (hide)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A snarling werewolf stands here\.|The Werewolf of Maurique is here)(, fighting [^\.!]+.|)" tfMobsubstEstuaryWerewolf = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Werewolf of Maurique @{Cgreen}(N, 102, canine)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A troubled man stands here, pained by what he has become\.|Maurique is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstEstuaryMaurique = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Maurique @{Cgreen}(@{nCwhite}G@{nCgreen}, 34-90, no-attack)@{n}%{P2}%{PR}%; \
    /endif



; -----------------------  Faery Forest  -----------------------
/def -p99 -F -mregexp -t"(A tiny little faery flits around before your eyes\.|A tiny faery is here)(, fighting [^\.!]+.|)" tfMobsubstFaeryForestTinyFaery = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A tiny faery @{Cgreen}(N, 1, fairie)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An elderly woman with a welcoming smile rocks away beside the fireplace\.|The wise old granny is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstFaeryForestGranny = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The wise old granny @{Cgreen}(@{nCwhite}G@{nCgreen}, 2, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A happy pink faery sings as it flies around here\.|A playful pink faery is here)(, fighting [^\.!]+.|)" tfMobsubstFaeryForestPinkFaery = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A playful pink faery @{Cgreen}(N, 3, fairie)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A wild horse neighs at you and retreats slowly\.|A wild horse is here)(, fighting [^\.!]+.|)" tfMobsubstFaeryForestHorse = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A wild horse @{Cgreen}(N, 3, ---, mountable)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A chirpy red faery plays around in the forest\.|A chirpy red faery is here)(, fighting [^\.!]+.|)" tfMobsubstFaeryForestRedFaery = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A chirpy red faery @{Cgreen}(N, 4, fairie)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An exceptionally bright faery flies around here\.|A brightly glowing faery is here)(, fighting [^\.!]+.|)" tfMobsubstFaeryForestGlowingFaery = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A brightly glowing faery @{Cgreen}(N, 5, fairie)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(You see a tiny frightened gnome here, peering around nervously\. \(invisible\)|A shy forest gnome \(invisible\) is here)(, fighting [^\.!]+.|)" tfMobsubstFaeryForestGnome = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A shy forest gnome @{Cgreen}(N, 5, gnome)@{n} (imp)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A fiesty fire red faery teases you mercilessly\.|A fiesty fire red faery is here)(, fighting [^\.!]+.|)" tfMobsubstFaeryForestFiestyFaery = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A fiesty fire red faery @{Cgreen}(N, 6, fairie)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An angry faery circles around and bumps into you\.|An angry orange faery is here)(, fighting [^\.!]+.|)" tfMobsubstFaeryForestAngryFaery = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An angry orange faery @{Cgreen}(N, 7, fairie)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A wise old owl is here, perched on a small limb over the hut\.|A large owl is here)(, fighting [^\.!]+.|)" tfMobsubstFaeryForestOwl = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A large owl @{Cgreen}(N, 8, bird)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A wood elf rests here against the wall, tapping his foot and whistling\.|A wood elf is here)(, fighting [^\.!]+.|)" tfMobsubstFaeryForestWoodElf = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A wood elf @{Cgreen}(N, 10, elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A plump green toad stands here trying to catch flies from the river\.|Mr Toad is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstFaeryForestToad = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Mr Toad @{Cgreen}(@{nCwhite}G@{nCgreen}, 50, QM)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An old wise oak tree welcomes your approach\.|The old oak tree is here)(, fighting [^\.!]+.|)" tfMobsubstFaeryForestTree = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The old oak tree @{Cgreen}(N, 60, special)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The shopkeeper of the lodge hurries around behind his counter\.|The lodge shopkeeper is here)(, fighting [^\.!]+.|)" tfMobsubstFaeryForestShopkeeper = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The lodge shopkeeper @{Cgreen}(N, 100, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Feverish Swamps  -----------------------
/def -p99 -F -mregexp -t"(A swarm of mosquitos is buzzing around here\.|The mosquito swarm is here)(, fighting [^\.!]+.|)" tfMobsubstFeverishSwampsSwarm = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The mosquito swarm @{Cgreen}(N, 15, insect)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A lizardman is here, minding his own business\.|A lizardman warrior is here guarding\.|A lizardman hunter is here, stalking at his prey\.|The lizardman is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstFeverishSwampsLizardman = \
    /if (mobsubs) \
      /if ({P1} =~ 'A lizardman is here, minding his own business.') \
        /substitute -p %{PL}@{nCyellow}The lizardman (minding) @{Cgreen}(@{nCred}E@{nCgreen}, 20, lizardman)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'A lizardman warrior is here guarding.') \
        /substitute -p %{PL}@{nCyellow}The lizardman (warrior) @{Cgreen}(@{nCred}E@{nCgreen}, 27, lizardman)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'A lizardman hunter is here, stalking at his prey.') \
        /substitute -p %{PL}@{nCyellow}The lizardman (hunter) @{Cgreen}(@{nCred}E@{nCgreen}, 30, lizardman)@{n}%{P2}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}The lizardman (minding/warrior/hunter) @{Cgreen}(@{nCred}E@{nCgreen}, 20/27/30, lizardman)@{n}%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(A giant sized snake is lying here\.|The anaconda is here)(, fighting [^\.!]+.|)" tfMobsubstFeverishSwampsAnaconda = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The anaconda @{Cgreen}(N, 25, snake)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An alligator female is here guarding her eggs\.|The alligator is here)(, fighting [^\.!]+.|)" tfMobsubstFeverishSwampsAlligator = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The alligator @{Cgreen}(N, 27, reptile)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A gigantic twoheaded black snake is chained to a pole\.|The twoheaded mamba is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstFeverishSwampsMamba = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The twoheaded mamba @{Cgreen}(@{nCred}E@{nCgreen}, 40, snake)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An lizardman is standing here on guard duty\.|The elite lizarman guardian is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstFeverishSwampsEliteLizardman = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The elite lizarman guardian @{Cgreen}(@{nCred}E@{nCgreen}, 60, lizardman)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Fire Elemental Plain  -----------------------
/def -p99 -F -mregexp -t"(A Small Fire Elemental is burning here\.|A Small Fire Elemental is here)(, fighting [^\.!]+.|)" tfMobsubstElementalPlainSmallElemental = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Small Fire Elemental @{Cgreen}(N, 20, elemental)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Fire Elemental is burning here\.|A Fire Elemental is here)(, fighting [^\.!]+.|)" tfMobsubstElementalPlainElemental = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Fire Elemental @{Cgreen}(N, 30, elemental)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Hell Hound attacks you\.|A Hell Hound is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstElementalPlainHellHound = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Hell Hound @{Cgreen}(@{nCred}E@{nCgreen}, 30, magical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Large Fire Elemental is burning here\.|A Large Fire Elemental is here)(, fighting [^\.!]+.|)" tfMobsubstElementalPlainLargeElemental = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Large Fire Elemental @{Cgreen}(N, 45, elemental)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An Angry Fire Giant attacks you\.|Fire Giant is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstElementalPlainFireGiant = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Fire Giant @{Cgreen}(@{nCred}E@{nCgreen}, 55, giant/ice)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An Angry Royal Fire Giant Guard attacks you\.|Royal Fire Giant Guard is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstElementalPlainRoyalGiant = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Royal Fire Giant Guard @{Cgreen}(@{nCred}E@{nCgreen}, 58, giant/ice)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An Angry Fire Giant King attacks you\.|Fire Giant King is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstElementalPlainKing = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Fire Giant King @{Cgreen}(@{nCred}E@{nCgreen}, 95, giant/ice, summoner)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Fishing Village  -----------------------
/def -p99 -F -mregexp -t"(A small boy is here, playing with some fishing utilities|A small boy is here)(, fighting [^\.!]+.|)" tfMobsubstFishingVillageSmallBoy = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A small boy @{Cgreen}(N, 15, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A small girl is here, playing with some friends\.|A small girl is here)(, fighting [^\.!]+.|)" tfMobsubstFishingVillageSmallGirl = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A small girl @{Cgreen}(N, 15, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A teenage boy is here, refusing to do anything that has to do with fishing\.|A teenage boy is here)(, fighting [^\.!]+.|)" tfMobsubstFishingVillageTeenageBoy = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A teenage boy @{Cgreen}(N, 25, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A teenage girl is here, looking at boys|A teenage girl is here)(, fighting [^\.!]+.|)" tfMobsubstFishingVillageTeenageGirl = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A teenage girl @{Cgreen}(N, 25, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A woman is here, cleaning fish|A fisherman's wife is here)(, fighting [^\.!]+.|)" tfMobsubstFishingVillageWife = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A fisherman's wife @{Cgreen}(N, 35, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A fisherman is here, tending to his tools\.|A fisherman is here)(, fighting [^\.!]+.|)" tfMobsubstFishingVillageFisherman = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A fisherman @{Cgreen}(N, 39, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Will is here, looking sad for losing his shop\.|Will, the fisherman is here)(, fighting [^\.!]+.|)" tfMobsubstFishingVillageWill = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Will, the fisherman @{Cgreen}(N, 85, human)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Galaxy  -----------------------
/def -p99 -F -mregexp -t"(A poor mudder, lost in this place\.|A poor mudder is here)(, fighting [^\.!]+.|)" tfMobsubstGalaxyMudder = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A poor mudder @{Cgreen}(N, 4, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A baby draco is crawling on the Draco's body\.|A baby draco is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGalaxyBabyDraco = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A baby draco @{Cgreen}(@{nCred}E@{nCgreen}, 9, mythical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A speedy comet is waiting to crush your head in\.|A speedy comet is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGalaxyComet = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A speedy comet @{Cgreen}(@{nCred}E@{nCgreen}, 10, magical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A young nebula, waiting to become a star\.|A young nebula is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstGalaxyNebula = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A young nebula @{Cgreen}(@{nCwhite}G@{nCgreen}, 10, magical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Pleiades are here, weeping for the loss of their sisters\.|The Pleiades is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstGalaxyPleiades = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Pleiades @{Cgreen}(@{nCwhite}G@{nCgreen}, 11, mythical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An enormous, red supergiant is forced to protect the galaxy\.|A red supergiant is here)(, fighting [^\.!]+.|)" tfMobsubstGalaxySupergiant = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A red supergiant @{Cgreen}(N, 15, magical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A tiny white dwarf is trying to sneak away from duty\.|A white dwarf is here)(, fighting [^\.!]+.|)" tfMobsubstGalaxyDwarf = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A white dwarf @{Cgreen}(N, 15, magical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Gemini is hiding from his brother, grinning evilly at you\.|Gemini is looking for his brother; have you seen him\?|Gemini is here)(, fighting [^\.!]+.|)( \(Red Aura\)| \(White Aura\)|)" tfMobsubstGalaxyGemini = \
    /if (mobsubs) \
      /if ({P1} =~ 'Gemini is hiding from his brother, grinning evilly at you.' | {P3} =~ ' (Red Aura)') \
        /substitute -p %{PL}@{nCyellow}Gemini (hiding) @{Cgreen}(@{nCred}E@{nCgreen}, 15, mythical)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'Gemini is looking for his brother; have you seen him?' | {P3} =~ ' (White Aura)') \
        /substitute -p %{PL}@{nCyellow}Gemini (looking) @{Cgreen}(@{nCwhite}G@{nCgreen}, 22, mythical)@{n}%{P2}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}Gemini (hiding/looking) @{Cgreen}(@{nCred}E@{nCgreen}/@{nCwhite}G@{nCgreen}, 15/22, mythical)@{n}%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(The wild pegasus is grazing peacefully\.|The wild Pegasus is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstGalaxyPegasus = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The wild Pegasus @{Cgreen}(@{nCwhite}G@{nCgreen}, 17, mythical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A huge nebula is here, resembling a horsehead\.|A horsehead nebula is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGalaxyHorsehead = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A horsehead nebula @{Cgreen}(@{nCred}E@{nCgreen}, 18, magical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The poor Andromeda is chained to the wall, suffering \.\.\.|Poor Andromeda is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstGalaxyAndromeda = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Poor Andromeda @{Cgreen}(@{nCwhite}G@{nCgreen}, 18, mythical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Orion is still hunting for Scorpio\.|Orion the hunter is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstGalaxyOrion = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Orion the hunter @{Cgreen}(@{nCwhite}G@{nCgreen}, 19, mythical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Mighty Hercules is working hard on his extra Labours for the Gods\.|The mighty Hercules is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstGalaxyHercules = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The mighty Hercules @{Cgreen}(@{nCwhite}G@{nCgreen}, 19, mythical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The beautiful Aquarius is standing here, holding THE vessel\.|Aquarius is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstGalaxyAquarius = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Aquarius @{Cgreen}(@{nCwhite}G@{nCgreen}, 22, mythical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Aries is sitting here, welcoming you\.|Aries is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstGalaxyAries = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Aries @{Cgreen}(@{nCwhite}G@{nCgreen}, 22, mythical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Cancer the crab is here, hoarding the treasure away from you\.|Cancer is here)(, fighting [^\.!]+.|)" tfMobsubstGalaxyCancer = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Cancer @{Cgreen}(N, 22, mythical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Capricorn is here, feeling bored \.\.\. he wants a fight!|Capricorn is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstGalaxyCapricorn = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Capricorn @{Cgreen}(@{nCwhite}G@{nCgreen}, 22, mythical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Leo the lion is roaring at you, ready for a strike!|Leo is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGalaxyLeo = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Leo @{Cgreen}(@{nCred}E@{nCgreen}, 22, mythical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Libra, the fair and just, is staring at you, weighing up the sins of your past\.|Libra is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstGalaxyLibra = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Libra @{Cgreen}(@{nCwhite}G@{nCgreen}, 22, mythical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Pisces the fish, is jealous of your approach\.\.\.|Pisces the fish is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGalaxyPiscesFish = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Pisces the fish @{Cgreen}(@{nCred}E@{nCgreen}, 22, mythical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Pisces the mermaid is sitting here, waiting for your help\.|Pisces the mermaid is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstGalaxyPiscesMermaid = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Pisces the mermaid @{Cgreen}(@{nCwhite}G@{nCgreen}, 22, mythical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Sagittarius the centaur is waiting to let go of his well aimed arrow \.\.\.|Sagittarius is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstGalaxySagittarius = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Sagittarius @{Cgreen}(@{nCwhite}G@{nCgreen}, 22, mythical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Scorpio is moving his tail towards you, waiting to put an end to some mortals\.|Scorpio is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGalaxyScorpio = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Scorpio @{Cgreen}(@{nCred}E@{nCgreen}, 22, mythical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Taurus wants to leave, but has been forced to stay as a guardian here\.|Taurus is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGalaxyTaurus = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Taurus @{Cgreen}(@{nCred}E@{nCgreen}, 22, mythical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Virgo is sitting here, winking at you suggestively \.\.\. you are alarmed!|Virgo is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstGalaxyVirgo = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Virgo @{Cgreen}(@{nCwhite}G@{nCgreen}, 22, mythical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The gigantic Head of Draco lurks out from beneath and prepares to roast you\.|The Head of Draco is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGalaxyDracoHead = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Head of Draco @{Cgreen}(@{nCred}E@{nCgreen}, 25, mythical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Cassiopeia, the queen of the Universe, is sitting on her throne\.|Cassiopeia the Queen is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstGalaxyCassiopeia = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Cassiopeia the Queen @{Cgreen}(@{nCwhite}G@{nCgreen}, 26, mythical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Ursa Major the bear is the last defense against any intruders\.|Ursa Major the bear is here)(, fighting [^\.!]+.|)" tfMobsubstGalaxyUrsaMajor = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Ursa Major the bear @{Cgreen}(N, 27, mythical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A beautiful white star smiles at you\.|A beautiful star is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstGalaxyBeautifulStar = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A beautiful star @{Cgreen}(@{nCwhite}G@{nCgreen}, 28, magical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Polaris, the polar star, who commands the whole Universe, stands before you!( \(invisible\)|)|Polaris, the polar star( \(invisible\)|) is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstGalaxyPolaris = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}Polaris, the polar star @{Cgreen}(@{nCwhite}G@{nCgreen}, 30, mythical)@{n}%{invisTxt}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Cepheus, the king of the Universe, is sitting on his throne\.|Cepheus the King is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstGalaxyCepheus = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Cepheus the King @{Cgreen}(@{nCwhite}G@{nCgreen}, 36, mythical)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Garden of Angels  -----------------------
/def -p99 -F -mregexp -t"(A small, shy angel looks up at you and giggles|An angel of virtue is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstGardenOfAngelsVirtue = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An angel of virtue @{Cgreen}(@{nCwhite}G@{nCgreen}, 10, magical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An innocent little angel flies about here|An angel is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstGardenOfAngelsAngel = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An angel @{Cgreen}(@{nCwhite}G@{nCgreen}, 14, magical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A seraphim of the celestial order is here|A seraphim is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstGardenOfAngelsSeraphim = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A seraphim @{Cgreen}(@{nCwhite}G@{nCgreen}, 16, magical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A principality is flying around here|A principality of the nine orders is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstGardenOfAngelsPrincipality = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A principality of the nine orders @{Cgreen}(@{nCwhite}G@{nCgreen}, 18, magical, mana shielded)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A power of the order is here|A power of the order is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstGardenOfAngelsPower = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A power of the order @{Cgreen}(@{nCwhite}G@{nCgreen}, 20, magical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An angel flies about above your head|An angel of dominations is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstGardenOfAngelsDominations = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An angel of dominations @{Cgreen}(@{nCwhite}G@{nCgreen}, 25, magical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An angelic throne looks mischevious here|A throne of the order is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstGardenOfAngelsThrone = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A throne of the order @{Cgreen}(@{nCwhite}G@{nCgreen}, 30, magical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A cherubim of the angel order tries to hide here|A cherubim is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstGardenOfAngelsCherubim = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A cherubim @{Cgreen}(@{nCwhite}G@{nCgreen}, 35, magical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A powerful looking angel smiles radiantly at you|An archangel of the order is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstGardenOfAngelsArchangel = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An archangel of the order @{Cgreen}(@{nCwhite}G@{nCgreen}, 50, magical)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Ghenna  -----------------------
/def -p99 -F -mregexp -t"(A dwarf is lying here, stunned\. \(hidden\)|The Dwarf \(hidden\) is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstGhennaDwarf = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Dwarf @{Cgreen}(@{nCwhite}G@{nCgreen}, 1, dwarf)@{n} (hide)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A wimpy little dragon is standing here, looking at you with deep blue|The Dragonet is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstGhennaDragonet = \
    /let mobName=@{nCyellow}The Dragonet @{Cgreen}(@{nCwhite}G@{nCgreen}, 25, dragon)@{n}%; \
    /if (mobsubs & {P1} =~ 'The Dragonet is here') \
      /substitute -p %{PL}%{mobName}%{P2}%{PR}%; \
    /elseif (mobsubs) \
      /substitute%; \
      /def -p99 -F -n1 -mregexp -t"^eyes\\.( \\(White Aura\\)|)" tfMobsubstSpecial = \
        /substitute -p %%{PL}%{mobName}%%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A citizen of Ghenna stands here\.|A citizen of Ghenna is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstGhennaCitizen = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A citizen of Ghenna @{Cgreen}(@{nCwhite}G@{nCgreen}, 30, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A large plant that reeks of carrion stands here stinking up the place\.|A Man-Eating plant is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGhennaPlant = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Man-Eating plant @{Cgreen}(@{nCred}E@{nCgreen}, 30, botanic)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Leonardo wanders in search of the ideal woman\.|Leonardo is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGhennaLeonardo = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Leonardo @{Cgreen}(@{nCred}E@{nCgreen}, 30, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An old lady \(who is obviously lost\) is trying to sell you some makeup|The Avon lady is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstGhennaAvonLady = \
    /let mobName=@{nCyellow}The Avon lady @{Cgreen}(@{nCwhite}G@{nCgreen}, 30, human)@{n}%; \
    /if (mobsubs & {P1} =~ 'The Avon lady is here') \
      /substitute -p %{PL}%{mobName}%{P2}%{PR}%; \
    /elseif (mobsubs) \
      /substitute%; \
      /def -p99 -F -n1 -mregexp -t"^here\\.( \\(White Aura\\)|)" tfMobsubstSpecial = \
        /substitute -p %%{PL}%{mobName}%%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The biggest cockroach you have ever seen is standing here, looking down|The cockroach is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGhennaCockroach = \
    /let mobName=@{nCyellow}The cockroach @{Cgreen}(@{nCred}E@{nCgreen}, 30, insect)@{n}%; \
    /if (mobsubs & {P1} =~ 'The cockroach is here') \
      /substitute -p %{PL}%{mobName}%{P2}%{PR}%; \
    /elseif (mobsubs) \
      /substitute%; \
      /def -p99 -F -n1 -mregexp -t"^at you\\.( \\(red Aura\\)|)" tfMobsubstSpecial = \
        /substitute -p %%{PL}%{mobName}%%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A big, stupid Orc is lumbering through here\.|The Orc is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGhennaOrc = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Orc @{Cgreen}(@{nCred}E@{nCgreen}, 30, lugroki)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A young, innocent looking woman is sitting here reading a magazine\.|The prostitute is( sitting|) here)(\.|)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstGhennaProstitute = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The prostitute @{Cgreen}(@{nCwhite}G@{nCgreen}, 30, human)@{n}%{P2}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A toothless whore is sitting here on the bed, inviting you to join her\.|The whore is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGhennaWhore = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The whore @{Cgreen}(@{nCred}E@{nCgreen}, 30, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Bullywug is standing here, ready to defend his master\'s lair\. \(hidden\)|The Bullywug \(hidden\) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGhennaBullywug = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Bullywug @{Cgreen}(@{nCred}E@{nCgreen}, 32, amphibian)@{n} (hide)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A claw fingered arm protruding from the wall|The claw fingered arm is here)(, fighting [^\.!]+.|)" tfMobsubstGhennaArm = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The claw fingered arm @{Cgreen}(N, 35, nofight-room)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A claw toed foot protruding from the wall|The claw toed foot is here)(, fighting [^\.!]+.|)" tfMobsubstGhennaFoot = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The claw toed foot @{Cgreen}(N, 35, nofight-room)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A tall Bugbear stands here, poised for action\.|The Bugbear is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGhennaBugbear = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Bugbear @{Cgreen}(@{nCred}E@{nCgreen}, 38, ---)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Derro is standing here, barking orders\.|The Derro is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGhennaDerro = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Derro @{Cgreen}(@{nCred}E@{nCgreen}, 40, dwarf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A multi-mouthed pseudopod of great girth is standing here\.|The Argos is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGhennaArgos = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Argos @{Cgreen}(@{nCred}E@{nCgreen}, 42, jelly, pkill)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A doll sits here leaning against the wall, forgotten by the child who|The Doll Golem is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstGhennaDollGolem = \
    /let mobName=@{nCyellow}The Doll Golem @{Cgreen}(@{nCwhite}G@{nCgreen}, 42, entity)@{n}%; \
    /if (mobsubs & {P1} =~ 'The Doll Golem is here') \
      /substitute -p %{PL}%{mobName}%{P2}%{PR}%; \
    /elseif (mobsubs) \
      /substitute%; \
      /def -p99 -F -n1 -mregexp -t"^owns it\\.( \\(White Aura\\)|)" tfMobsubstSpecial = \
        /substitute -p %%{PL}%{mobName}%%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Broken One stands here looking gruesome\.|A Broken One is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGhennaBrokenOne = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Broken One @{Cgreen}(@{nCred}E@{nCgreen}, 45, magical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Roger, the elven apostle is looking for evil guys to kill here\. \(hidden\)|Roger the dodger \(hidden\) is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstGhennaRoger = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Roger the dodger @{Cgreen}(@{nCwhite}G@{nCgreen}, 45, elf)@{n} (hide)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A twisted pile of cloth and bones lies here\. \(hidden\)|The barrow wight \(hidden\) is here)(, fighting [^\.!]+.|)" tfMobsubstGhennaBarrowWight = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The barrow wight @{Cgreen}(N, 45, insubstantial)@{n} (hide)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An errant Elf is here, looking for denizens of evil\.|The errant Elf is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstGhennaErrantElf = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The errant Elf @{Cgreen}(@{nCwhite}G@{nCgreen}, 45, elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Gorgimera roars at your entrance, and ATTACKS!!! \(invisible\)|The Gorgimera \(invisible\) is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstGhennaGorgimera = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Gorgimera @{Cgreen}(@{nCwhite}G@{nCgreen}, 45, magical)@{n} (imp)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A woman sits here on the bed, with her back to you\.|The Medusa is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGhennaMedusa = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Medusa @{Cgreen}(@{nCred}E@{nCgreen}, 45, magical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The groaning spirit of a long-dead woman floats here\.|The Banshee is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGhennaBanshee = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Banshee @{Cgreen}(@{nCred}E@{nCgreen}, 48, insubstantial)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Deepspawn is standing here, ready to kill you\.|The Deepspawn is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGhennaDeepspawn = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Deepspawn @{Cgreen}(@{nCred}E@{nCgreen}, 48, magical, pkill)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Shamus, the wandering liege, wants to protect you from the evil here\.|Shamus is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstGhennaShamus = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Shamus @{Cgreen}(@{nCwhite}G@{nCgreen}, 50, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(There is a barkeep standing here, waiting to take your order\.|The barkeep is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGhennaBarkeep = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The barkeep @{Cgreen}(@{nCred}E@{nCgreen}, 50, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Maedar stands here in the darkness smacking his lips\.|The Maedar is here|The Maedar master is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstGhennaMaedar = \
    /if (mobsubs) \
      /if ({P1} =~ 'The Maedar is here') \
        /substitute -p %{PL}@{nCyellow}The Maedar @{Cgreen}(@{nCred}E@{nCgreen}, 50, ---)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'The Maedar master is here') \
        /substitute -p %{PL}@{nCyellow}The Maedar master @{Cgreen}(@{nCred}E@{nCgreen}, 65, ---)@{n}%{P2}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}The Maedar/The Maedar master @{Cgreen}(@{nCred}E@{nCgreen}, 50/65, ---)@{n}%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(A Genie is levitating here with an evil grin on his face\. \(invisible\)|The Efreeti \(invisible\) is here)(, fighting [^\.!]+.|)" tfMobsubstGhennaEfreeti = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Efreeti @{Cgreen}(N, 55, elemental, VAPE eq!)@{n} (imp)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A broad shouldered man lies prostrate here, apparently praying\.|The Ghenna Swordmaster is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGhennaSwordmaster = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Ghenna Swordmaster @{Cgreen}(@{nCred}E@{nCgreen}, 55, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Death Knight stands here, lowering at you\.( \(invisible\)|)|The Death Knight( \(invisible\)|) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGhennaDeathKnight = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}The Death Knight @{Cgreen}(@{nCred}E@{nCgreen}, 60, entity)@{n}%{invisTxt}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A large statue of a humanoid male has been cut out of the granite here\.( \(invisible\)|)|The stone golem( \(invisible\)|) is here)(, fighting [^\.!]+.|)" tfMobsubstGhennaStoneGolem = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}The stone golem @{Cgreen}(N, 60, entity)@{n}%{invisTxt}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An ugly woman clad in studded black leather turns toward you and shouts,|The Dominatrix is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGhennaDominatrix = \
    /let mobName=@{nCyellow}The Dominatrix @{Cgreen}(@{nCred}E@{nCgreen}, 65, human)@{n}%; \
    /if (mobsubs & {P1} =~ 'The Dominatrix is here') \
      /substitute -p %{PL}%{mobName}%{P2}%{PR}%; \
    /elseif (mobsubs) \
      /substitute%; \
      /def -p99 -F -n1 -mregexp -t"^\\"Down on your knees, maggot!!\\"( \\(Red Aura\\)|)" tfMobsubstSpecial = \
        /substitute -p %%{PL}%{mobName}%%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A large snake sits here, munching on a human body\.|The Deep Dragon is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGhennaDeepDragon = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Deep Dragon @{Cgreen}(@{nCred}E@{nCgreen}, 75, dragon, VAPE eq!)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(a cloaked creature stalks here\. \(invisible\)|The cloaked Ghast \(invisible\) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGhennaCloakedGhast = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The cloaked Ghast @{Cgreen}(@{nCred}E@{nCgreen}, 100, human/fire)@{n} (imp)%{P2}%{PR}%; \
    /endif

; -----------------------  Giants  -----------------------
/def -p99 -F -mregexp -t"(A valley giant is here throwing rocks around\.|A valley giant is here)(, fighting [^\.!]+.|)" tfMobsubstGiantsValley = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A valley giant @{Cgreen}(N, 58, giant)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A field giant slowly ambles around kicking stones as it goes\.|A field giant is here)(, fighting [^\.!]+.|)" tfMobsubstGiantsField = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A field giant @{Cgreen}(N, 60, giant)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A giant humanoid who lives in the hills is standing here\.|A hill giant is here)(, fighting [^\.!]+.|)" tfMobsubstGiantsHill = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A hill giant @{Cgreen}(N, 61, giant)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A giant of the plains slowly turns its head in your direction\.|A plains giant is here)(, fighting [^\.!]+.|)" tfMobsubstGiantsPlains = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A plains giant @{Cgreen}(N, 62, giant)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A muscular mountain giant is here lifting boulders\.|A mountain giant is here)(, fighting [^\.!]+.|)" tfMobsubstGiantsMountain = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A mountain giant @{Cgreen}(N, 63, giant)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A tall giant covered in reeds, emerges from the lake\.|A lake giant is here)(, fighting [^\.!]+.|)" tfMobsubstGiantsLake = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A lake giant @{Cgreen}(N, 64, giant)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A large green giant strolls through the forest here\.|A forest giant is here)(, fighting [^\.!]+.|)" tfMobsubstGiantsForest = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A forest giant @{Cgreen}(N, 65, giant)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A hairless cave giant with pale, dirty skin stands here grunting\.|A cave giant is here)(, fighting [^\.!]+.|)" tfMobsubstGiantsCave = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A cave giant @{Cgreen}(N, 67, giant)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A giant humanoid covered in moss and grass is standing around here\.|A moss giant is here)(, fighting [^\.!]+.|)" tfMobsubstGiantsMoss = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A moss giant @{Cgreen}(N, 68, giant)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A large giant is here wading through the marsh\.|A marsh giant is here)(, fighting [^\.!]+.|)" tfMobsubstGiantsMarsh = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A marsh giant @{Cgreen}(N, 69, giant)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A nocturnal giant with powerful limbs and dark skin is walking around here\.|A night giant is here)(, fighting [^\.!]+.|)" tfMobsubstGiantsNight = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A night giant @{Cgreen}(N, 70, giant, special-night-presence)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Alcyoneus, the chief giant of these lands, walks around observing events\.|Alcyoneus is here)(, fighting [^\.!]+.|)" tfMobsubstGiantsAlcyoneusE = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Alcyoneus @{Cgreen}(N, 90, giant)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A giant shopkeeper stands here selling a variety of goods\.|A giant shopkeeper is here)(, fighting [^\.!]+.|)" tfMobsubstGiantsShopkeeper = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A giant shopkeeper @{Cgreen}(N, 100, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Gnome  -----------------------
/def -p99 -F -mregexp -t"(A small mouse runs across your foot\.|A field mouse is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstGnomeMouse = \
    /if (mobsubs & area =~ 'Gnome') \
      /substitute -p %{PL}@{nCyellow}A field mouse @{Cgreen}(@{nCwhite}G@{nCgreen}, 1, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A gnome child is playing around here\.|A gnome child is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstGnomeChild = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A gnome child @{Cgreen}(@{nCwhite}G@{nCgreen}, 3, gnome)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A gnome prisoner is here resting in the straw\.|A gnome prisoner is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstGnomePrisoner = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A gnome prisoner @{Cgreen}(@{nCwhite}G@{nCgreen}, 3, gnome)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A human prisoner is here resting in the straw\.|A human prisoner is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstGnomeHumanPrisoner = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A human prisoner @{Cgreen}(@{nCwhite}G@{nCgreen}, 3, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A hobgoblin soldier stands here\.|The hobgoblin soldier is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGnomeHobSoldier = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The hobgoblin soldier @{Cgreen}(@{nCred}E@{nCgreen}, 3, lugroki)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A large rat runs up to you and nibbles on your boots\.|A large rat is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGnomeLargeRat = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A large rat @{Cgreen}(@{nCred}E@{nCgreen}, 4, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A black bat hangs from the ceiling\.|A black bat is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGnomeBlackBat = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A black bat @{Cgreen}(@{nCred}E@{nCgreen}, 5, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A gnome woman is standing here, trying to look beautiful\.|A gnome woman is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstGnomeWoman = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A gnome woman @{Cgreen}(@{nCwhite}G@{nCgreen}, 5, gnome)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A hermit crab crawls towards you\.|A hermit crab is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGnomeCrab = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A hermit crab @{Cgreen}(@{nCred}E@{nCgreen}, 5, amphibian)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A hobgoblin miner stands here looking for gold\.|A hobgoblin miner is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGnomeHobMiner = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A hobgoblin miner @{Cgreen}(@{nCred}E@{nCgreen}, 5, lugroki)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A giant rat growls at you and prepares to attack\.|A giant rat is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGnomeGiantRat = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A giant rat @{Cgreen}(@{nCred}E@{nCgreen}, 6, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A gnome man is walking here, on his way to work\.|A gnome man is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstGnomeMan = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A gnome man @{Cgreen}(@{nCred}E@{nCgreen}, 6, gnome)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A scientist wanders around deep in thought\.|A gnome scientist is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstGnomeScientist = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A gnome scientist @{Cgreen}(@{nCwhite}G@{nCgreen}, 7, gnome)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A hobgoblin cook stands here cooking something\.|The cook is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGnomeHobCook = \
    /if (mobsubs & ({P1} != 'The cook is here' | area =~ 'Gnome')) \
      /substitute -p %{PL}@{nCyellow}The cook @{Cgreen}(@{nCred}E@{nCgreen}, 7, lugroki)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A hobgoblin bodyguard guards the king with his life\.|The hobgoblin bodyguard is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGnomeHobBodyguard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The hobgoblin bodyguard @{Cgreen}(@{nCred}E@{nCgreen}, 7, lugroki)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A zombie gnome shuffles his way towards you\.|The zombie gnome is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGnomeZombie = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The zombie gnome @{Cgreen}(@{nCred}E@{nCgreen}, 7, undead)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A gnome guard stands here guarding something\.|A gnome guard is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstGnomeGuard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A gnome guard @{Cgreen}(@{nCwhite}G@{nCgreen}, 8, gnome)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A small troll grunts as he takes a swing at you\.|A small troll is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGnomeSmallTroll = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A small troll @{Cgreen}(@{nCred}E@{nCgreen}, 8, troll)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A treasurer is here counting out money\.|The treasurer is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGnomeTreasurer = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The treasurer @{Cgreen}(@{nCred}E@{nCgreen}, 10, lugroki)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(There is a great king here, sitting in his throne\.|The king of the hobgoblins is( sitting|) here)(\.|)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGnomeHobKing = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The king of the hobgoblins @{Cgreen}(@{nCred}E@{nCgreen}, 12, lugroki)@{n}%{P2}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A giant troll lumbers around\.|The troll is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGnomeTroll = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The troll @{Cgreen}(@{nCred}E@{nCgreen}, 14, troll)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A powerful looking gnome stands here wearing ornate clothes\.|The chief gnome is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstGnomeChief = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The chief gnome @{Cgreen}(@{nCwhite}G@{nCgreen}, 15, gnome)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The fire bat flames brightly and prepares to attack\.|The fire bat is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGnomeFireBat = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The fire bat @{Cgreen}(@{nCred}E@{nCgreen}, 18, magical)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Goblik  -----------------------
/def -p99 -F -mregexp -t"(A small goblik is here, agreeing with everything its warlord says\.|Weef, the sycophantic goblik retainer is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGoblikWeef = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Weef, the sycophantic goblik retainer @{Cgreen}(@{nCred}E@{nCgreen}, 1, lugroki)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A large armored ant is wandering around here\.|A giant war ant is here)(, fighting [^\.!]+.|)" tfMobsubstGoblikWarAnt = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A giant war ant @{Cgreen}(N, 5, insect)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A goblik herald is standing here, bearing a large warbanner\.|A goblik herald is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGoblikHerald = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A goblik herald @{Cgreen}(@{nCred}E@{nCgreen}, 5, no-attack)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A goblik scout is here, mapping out the region\.|A goblik scout is here, searching for enemy tracks\.|A goblik scout is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGoblikScout = \
    /if (mobsubs) \
      /if ({P1} =~ 'A goblik scout is here, mapping out the region.') \
        /substitute -p %{PL}@{nCyellow}A goblik scout (mapping) @{Cgreen}(@{nCred}E@{nCgreen}, 5, lugroki)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'A goblik scout is here, searching for enemy tracks.') \
        /substitute -p %{PL}@{nCyellow}A goblik scout (searching) @{Cgreen}(@{nCred}E@{nCgreen}, 5, lugroki)@{n}%{P2}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}A goblik scout (mapping/searching) @{Cgreen}(@{nCred}E@{nCgreen}, 5, lugroki)@{n}%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(A goblik is here, organizing the scouting activities\.|Ootr, the goblik scout master is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGoblikOotr = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Ootr, the goblik scout master @{Cgreen}(@{nCred}E@{nCgreen}, 6, lugroki)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A goblik worker is here, taking a break\.|A goblik worker rushes by with a heavy load of lumber\.|A goblik worker is busily securing another section of wall\.|A goblik worker is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGoblikWorker = \
    /if (mobsubs) \
      /if ({P1} =~ 'A goblik worker is here, taking a break.') \
        /substitute -p %{PL}@{nCyellow}A goblik worker (break) @{Cgreen}(@{nCred}E@{nCgreen}, 7, lugroki)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'A goblik worker rushes by with a heavy load of lumber.') \
        /substitute -p %{PL}@{nCyellow}A goblik worker (lumber) @{Cgreen}(@{nCred}E@{nCgreen}, 7, lugroki)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'A goblik worker is busily securing another section of wall.') \
        /substitute -p %{PL}@{nCyellow}A goblik worker (securing) @{Cgreen}(@{nCred}E@{nCgreen}, 7, lugroki)@{n}%{P2}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}A goblik worker (break/lumber/securing) @{Cgreen}(@{nCred}E@{nCgreen}, 7, lugroki)@{n}%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(A large spider is here, guarding the battlements\.|A giant warspider is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGoblikSpider = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A giant warspider @{Cgreen}(@{nCred}E@{nCgreen}, 8, insect)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A goblik is here, overseeing the fortification of the warcamp\.|Snarg, the goblik surveyor is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGoblikSnarg = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Snarg, the goblik surveyor @{Cgreen}(@{nCred}E@{nCgreen}, 9, lugroki)@{n}%{P2}%{PR}%; \
    /endif
/def -p100 -F -mregexp -t"(A goblik guard is here, scanning the distant horizon\.|A goblik watchtower guard is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGoblikWatchtowerGuard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A goblik watchtower guard @{Cgreen}(@{nCred}E@{nCgreen}, 10, lugroki)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A goblik archer is here, patrolling the battlements\.|A goblik archer is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGoblikArcher = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A goblik archer @{Cgreen}(@{nCred}E@{nCgreen}, 12, lugroki)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A goblik guard stands here at the gates\.|A goblik gate guard is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGoblikGateGuard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A goblik gate guard @{Cgreen}(@{nCred}E@{nCgreen}, 14, lugroki)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A goblik guard is here, almost falling asleep\.|A goblik guard stands here at its post\.|A goblik guard is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGoblikGuard = \
    /if (mobsubs) \
      /if ({P1} =~ 'A goblik guard is here, almost falling asleep.') \
        /substitute -p %{PL}@{nCyellow}A goblik guard (falling) @{Cgreen}(@{nCred}E@{nCgreen}, 14, lugroki)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'A goblik guard stands here at its post.') \
        /substitute -p %{PL}@{nCyellow}A goblik guard (post) @{Cgreen}(@{nCred}E@{nCgreen}, 14, lugroki)@{n}%{P2}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}A goblik guard (falling/post) @{Cgreen}(@{nCred}E@{nCgreen}, 14, lugroki)@{n}%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(A goblik skirmisher is here, pitching a tent\.|A goblik skirmisher is here, waiting in line for some food\.|A goblik skirmisher is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGoblikSkirmisher = \
    /if (mobsubs) \
      /if ({P1} =~ 'A goblik skirmisher is here, pitching a tent.') \
        /substitute -p %{PL}@{nCyellow}A goblik skirmisher (pitching) @{Cgreen}(@{nCred}E@{nCgreen}, 16, lugroki)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'A goblik skirmisher is here, waiting in line for some food.') \
        /substitute -p %{PL}@{nCyellow}A goblik skirmisher (waiting) @{Cgreen}(@{nCred}E@{nCgreen}, 16, lugroki)@{n}%{P2}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}A goblik skirmisher (pitching/waiting) @{Cgreen}(@{nCred}E@{nCgreen}, 16, lugroki)@{n}%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(A goblik marauder is here, setting up a campfire\.|A goblik marauder is here, honing its battle techniques\.|A goblik marauder is sleeping here\.|A goblik marauder is here, waiting in line for its meal\.|A goblik marauder is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGoblikMarauder = \
    /if (mobsubs) \
      /if ({P1} =~ 'A goblik marauder is here, setting up a campfire.') \
        /substitute -p %{PL}@{nCyellow}A goblik marauder (campfire) @{Cgreen}(@{nCred}E@{nCgreen}, 18, lugroki)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'A goblik marauder is here, honing its battle techniques.') \
        /substitute -p %{PL}@{nCyellow}A goblik marauder (honing) @{Cgreen}(@{nCred}E@{nCgreen}, 18, lugroki)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'A goblik marauder is sleeping here.') \
        /substitute -p %{PL}@{nCyellow}A goblik marauder (sleeping) @{Cgreen}(@{nCred}E@{nCgreen}, 18, lugroki)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'A goblik marauder is here, waiting in line for its meal.') \
        /substitute -p %{PL}@{nCyellow}A goblik marauder (waiting) @{Cgreen}(@{nCred}E@{nCgreen}, 18, lugroki)@{n}%{P2}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}A goblik marauder @{Cgreen}(@{nCred}E@{nCgreen}, 18, lugroki)@{n}%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(A goblik berserker is sitting here, eating its meal\.|A goblik berserker glares around with a wild look in its eyes\.|A goblik berserker is here, preparing for battle\.|A goblik berserker is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGoblikBerserker = \
    /if (mobsubs) \
      /if ({P1} =~ 'A goblik berserker is sitting here, eating its meal.') \
        /substitute -p %{PL}@{nCyellow}A goblik berserker (eating) @{Cgreen}(@{nCred}E@{nCgreen}, 20, lugroki)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'A goblik berserker glares around with a wild look in its eyes.') \
        /substitute -p %{PL}@{nCyellow}A goblik berserker (glares) @{Cgreen}(@{nCred}E@{nCgreen}, 20, lugroki)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'A goblik berserker is here, preparing for battle.') \
        /substitute -p %{PL}@{nCyellow}A goblik berserker (preparing) @{Cgreen}(@{nCred}E@{nCgreen}, 20, lugroki)@{n}%{P2}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}A goblik berserker (eating/glares/preparing) @{Cgreen}(@{nCred}E@{nCgreen}, 20, lugroki)@{n}%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(A heavily armoured goblik guard stands here at its post\.|A goblik tent guard is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGoblikTentGuard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A goblik tent guard @{Cgreen}(@{nCred}E@{nCgreen}, 20, lugroki)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A stout goblik warrior sits by the campfire, sharpening its sword\.|Dromk, the burly goblik warrior is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGoblikDromk = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Dromk, the burly goblik warrior @{Cgreen}(@{nCred}E@{nCgreen}, 20, lugroki)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A grungy goblik cook is here, serving gruel\.|Geech, the greasy goblik cook is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGoblikgeech = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Geech, the greasy goblik cook @{Cgreen}(@{nCred}E@{nCgreen}, 20, lugroki)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A goblik strategist is here, looking over the battle plans\.|Kmod, the goblik strategist is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGoblikKmod = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Kmod, the goblik strategist @{Cgreen}(@{nCred}E@{nCgreen}, 20, lugroki)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A goblik advisor stands here in the shadows\.|Smezz, the goblik advisor is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGoblikSmezz = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Smezz, the goblik advisor @{Cgreen}(@{nCred}E@{nCgreen}, 20, lugroki)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A disfigured goblik warrior is warming its hands by the campfire\.|Zlomb, the scarred goblik warrior is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGoblikZlomb = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Zlomb, the scarred goblik warrior @{Cgreen}(@{nCred}E@{nCgreen}, 20, lugroki)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A large goblik warlord is here, planning its next conquest\.|Rtorg, the goblik warlord is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGoblikRtorg = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Rtorg, the goblik warlord @{Cgreen}(@{nCred}E@{nCgreen}, 25, lugroki)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Goblin Caves  -----------------------
/def -p99 -F -mregexp -t"(A poor defenseless creature is here, urging you to look at it\.|Captive of the Goblins is here)(, fighting [^\.!]+.|)" tfMobsubstGoblinCavesCaptive = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Captive of the Goblins @{Cgreen}(N, 1, ???)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An Ancient Wizard stands here as to prevent you from entering the caves\.|An Ancient Wizard is here)(, fighting [^\.!]+.|)" tfMobsubstGoblinCavesWizard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An Ancient Wizard @{Cgreen}(N, 10, elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Loyal soldier to the Goblin King stands at attention here\.|Goblin Soldier is here)(, fighting [^\.!]+.|)" tfMobsubstGoblinCavesSoldier = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Goblin Soldier @{Cgreen}(N, 10, ---)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Captain of the Goblin Soldiers stands here\.|Captain of the Goblin Soldiers is here)(, fighting [^\.!]+.|)" tfMobsubstGoblinCavesCaptain = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Captain of the Goblin Soldiers @{Cgreen}(N, 17, ---)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Sentry to the Goblin Caves stands at attention here\.|The Sentry to the Goblin Caves is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstGoblinCavesSentry = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Sentry to the Goblin Caves @{Cgreen}(@{nCwhite}G@{nCgreen}, 19, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Goblin King is here ordering you to kneel\.|Goblin King is here)(, fighting [^\.!]+.|)" tfMobsubstGoblinCavesKing = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Goblin King @{Cgreen}(N, 25, ---)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Gorm  -----------------------
/def -p99 -F -mregexp -t"(u_n_k_n_o_w_n( \(invisible\)|)|Kirvon the mage apprentice( \(invisible\)|) is sitting here\.|Kirvon the mage apprentice( \(invisible\)|) is here)(, fighting [^\.!]+.|)" tfMobsubstGormKirvon = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)" | {P4} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}Kirvon the mage apprentice @{Cgreen}(N, 1, no-attack)@{n}%{invisTxt}%{P4}%{P5}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(a gorm mage is standing here\.|A gorm mage is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGormMage = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A gorm mage @{Cgreen}(@{nCred}E@{nCgreen}, 65, troll/poison)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(a gorm priestess is standing here.|A gorm priestess is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstGormPriestess = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A gorm priestess @{Cgreen}(@{nCwhite}G@{nCgreen}, 67, troll/poison)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(u_n_k_n_o_w_n \(invisible\)|A small beast \(invisible\) is standing here\.|A small beast \(invisible\) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGormBeast = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A small beast @{Cgreen}(@{nCred}E@{nCgreen}, 67, animal/fire/poison)@{n} (imp)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A gorm warrior is standing here\.|A Gorm warrior is standing here\.|A gorm warrior is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGormWarrior = \
    /if (mobsubs) \
      /if ({P1} =~ 'A Gorm warrior is standing here.') \
        /substitute -p %{PL}@{nCyellow}A gorm warrior (inside) @{Cgreen}(@{nCred}E@{nCgreen}, 72, troll/poison)@{n}%{P2}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}A gorm warrior @{Cgreen}(@{nCred}E@{nCgreen}, 72, troll/poison)@{n}%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(A dragon guard is standing on his post here\.|A dragon guard is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGormGuard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A dragon guard @{Cgreen}(@{nCred}E@{nCgreen}, 75, human/poison)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(u_n_k_n_o_w_n \(invisible\)|The beastmaster \(invisible\) is standing here\.|The beastmaster \(invisible\) is resting here\.|The beastmaster \(invisible\) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGormBeastmaster = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The beastmaster @{Cgreen}(@{nCred}E@{nCgreen}, 75, animal/fire/poison)@{n} (imp)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The hedgehog is standing here \(invisible\)|The hedgehog \(invisible\) is standing here\.|The hedgehog \(invisible\) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGormHedgehog = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The hedgehog @{Cgreen}(@{nCred}E@{nCgreen}, 75, animal/poison)@{n} (imp)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The statue is standing here \(invisible\)|The statue \(invisible\) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGormStatue = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The statue @{Cgreen}(@{nCred}E@{nCgreen}, 75, magical/poison)@{n} (imp)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Master Chef is preparing food here. \(invisible\) \(hidden\)|The Master Chef \(invisible\) \(hidden\) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGormChef = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Master Chef @{Cgreen}(@{nCred}E@{nCgreen}, 78, troll/poison)@{n} (imp) (hide)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(King Gorm is here watching his kingdom \(invisible\)|King Gorm \(invisible\) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGormKing = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}King Gorm @{Cgreen}(@{nCred}E@{nCgreen}, 95, troll/poison)@{n} (imp)%{P2}%{PR}%; \
    /endif

; -----------------------  Grasslands  -----------------------
/def -p99 -F -mregexp -t"(A wild stallion is here rearing up for battle\.|A wild stallion is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGrasslandsStallion = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A wild stallion @{Cgreen}(@{nCred}E@{nCgreen}, 10, ---)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A giraffe is here eating leaves off the top of a tree\. \(hidden\)|A giraffe \(hidden\) is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstGrasslandsGiraffe = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A giraffe @{Cgreen}(@{nCwhite}G@{nCgreen}, 11, animal)@{n} (hide)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A bulky elephant is resting here in the shade\.|An elephant is here)(, fighting [^\.!]+.|)" tfMobsubstGrasslandsElephant = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An elephant @{Cgreen}(N, 12, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A buffalo proudly stands before you muching some grass\.|A buffalo is here)(, fighting [^\.!]+.|)" tfMobsubstGrasslandsBuffalo = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A buffalo @{Cgreen}(N, 13, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A tiger silently glides across the plains here, searching for food\. \(hidden\)|A fierce tiger \(hidden\) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGrasslandsTiger = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A fierce tiger @{Cgreen}(@{nCred}E@{nCgreen}, 15, feline)@{n} (hide)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A head hunter stands here wiping the blood from his knife\.|A head hunter is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGrasslandsHunter = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A head hunter @{Cgreen}(@{nCred}E@{nCgreen}, 15, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Shlad, the adventurer is here looking over his map\.( \(invisible\)|)|Shlad, the adventurer( \(invisible\)|) is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstGrasslandsShlad = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}Shlad, the adventurer @{Cgreen}(@{nCwhite}G@{nCgreen}, 18, human)@{n}%{invisTxt}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The master head hunter eyes you suspiciously\.|The master head hunter is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGrasslandsMasterHunter = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The master head hunter @{Cgreen}(@{nCred}E@{nCgreen}, 18, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The medicine man stands here mixing up some kind of potion\.|The medicine man is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGrasslandsMedicineMan = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The medicine man @{Cgreen}(@{nCred}E@{nCgreen}, 20, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Tannin, the dragon master, stands here looking you over carefully\.|Tannin, the dragon master is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGrasslandsTannin = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Tannin, the dragon master @{Cgreen}(@{nCred}E@{nCgreen}, 25, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A small green dragon is here, snarling ferociously at you\.|Small green dragon is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGrasslandsDragon = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Small green dragon @{Cgreen}(@{nCred}E@{nCgreen}, 28, dragon)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Graveyard  -----------------------
/def -p99 -F -mregexp -t"(Some giant weeds are creeping across the floor|Some giant cave weeds spring up out of the ground and is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGraveyardCaveWeeds = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Some giant cave weeds... @{Cgreen}(@{nCred}E@{nCgreen}, 30, botanic)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A bony skeleton is here\.|The bony skeleton is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGraveyardBonySkeleton = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The bony skeleton @{Cgreen}(@{nCred}E@{nCgreen}, 30, skeleton)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A ghoul is here staring at you hungrily\.|The ghoul is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGraveyardGhoul = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The ghoul @{Cgreen}(@{nCred}E@{nCgreen}, 30, undead)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A half-decomposed body is lying in the corner here|The half-decomposed body is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGraveyardBody = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The half-decomposed body @{Cgreen}(@{nCred}E@{nCgreen}, 30, undead)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Mig-Go is walking around here|The Mi-Go is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGraveyardMiGo = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Mi-Go @{Cgreen}(@{nCred}E@{nCgreen}, 30, botanic)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A rock slug is slowly creeping along, leaving a slime trail behind it|The rock slug is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGraveyardRockSlug = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The rock slug @{Cgreen}(@{nCred}E@{nCgreen}, 30, jelly)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An undead zombie sits here munching on something\.\.\.|The undead zombie is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGraveyardZombie = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The undead zombie @{Cgreen}(@{nCred}E@{nCgreen}, 30, undead)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(You spot a wraith advancing towards you from the shadows\.|The wraith is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGraveyardWraith = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The wraith @{Cgreen}(@{nCred}E@{nCgreen}, 30, insubstantial)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The mad etcher is sitting here babbling to himself and working on the wall|The mad etcher is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstGraveyardEtcher = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The mad etcher @{Cgreen}(@{nCwhite}G@{nCgreen}, 40, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A nightgaunt is standing here|The nightgaunt is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGraveyardNightgaunt = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The nightgaunt @{Cgreen}(@{nCred}E@{nCgreen}, 40, insubstantial)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The spectral wife of the etcher is very faintly floating here|The spectral etchers wife is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstGraveyardWife = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The spectral etchers wife @{Cgreen}(@{nCwhite}G@{nCgreen}, 40, undead)@{n}%{P2}%{PR}%; \
    /endif
/def -p100 -F -mregexp -t"(The hunting horror is here in wait of an unwary traveler\.\.\.|The hunting horror is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGraveyardHorror = \
    /if (mobsubs & ({P1} =~ 'The hunting horror is here in wait of an unwary traveler...' | area =~ 'Graveyard')) \
      /substitute -p %{PL}@{nCyellow}The hunting horror @{Cgreen}(@{nCred}E@{nCgreen}, 50, insubstantial)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An X'ist flesh eater is sitting here munching on some coffin remains|The X'ist flesh eater is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGraveyardXist = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The X'ist flesh eater @{Cgreen}(@{nCred}E@{nCgreen}, 50, demon)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A bat-like lizard rears its head in anger\.|A pyrolisk is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGraveyardPyrolisk = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A pyrolisk @{Cgreen}(@{nCred}E@{nCgreen}, 55, demon)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Snapper Joe is standing here leering at you chillingly|Snapper Joe is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGraveyardJoe = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Snapper Joe @{Cgreen}(@{nCred}E@{nCgreen}, 60, demon)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Priest of all good stands here solemnly speaking words of praise\.|The Priest is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstGraveyardPriest = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Priest @{Cgreen}(@{nCwhite}G@{nCgreen}, 60, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The spirit of King Crotus is floating here lazing above the floor|The spirit of King Crotus is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstGraveyardCrotus = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The spirit of King Crotus @{Cgreen}(@{nCwhite}G@{nCgreen}, 60, insubstantial)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A dark elf eyes you coldly, death in his eyes\.|Rebure the Drow Assassin is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGraveyardRebure = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Rebure the Drow Assassin @{Cgreen}(@{nCred}E@{nCgreen}, 70, drow-elf, murder)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Ghost of Cristis the Kind is here, floating around aimlessly\.|The Ghost of Cristis the Kind is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstGraveyardCristis = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Ghost of Cristis the Kind @{Cgreen}(@{nCwhite}G@{nCgreen}, 70, insubstantial)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Count Dracula is here hiding his face from your light source\.|Count Dracula is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGraveyardDracula = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Count Dracula @{Cgreen}(@{nCred}E@{nCgreen}, 95, vampire)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Guallidurth  -----------------------
/def -p99 -F -mregexp -t"(A dot is here, fluttering about the room\. \(hidden\)|A dot \(hidden\) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGuallidurthDot = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A dot @{Cgreen}(@{nCred}E@{nCgreen}, 1, magical)@{n} (hide)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(You sense a hidden life form in the room\.|The Dot is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGuallidurthTheDot = \
    /if (mobsubs & race =~ 'Ktv' & area =~ 'Guallidurth') \
      /substitute -p %{PL}@{nCyellow}The Dot @{Cgreen}(@{nCred}E@{nCgreen}, 55-64, magical, ULTRA-hide)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A small dark spider is here, looking at you with all his eyes|A small dark spider is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGuallidurthSpider = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A small dark spider @{Cgreen}(@{nCred}E@{nCgreen}, 60, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A drow assassin is here, hiding in the shadows\.( \(invisible\)|) \(hidden\)|A drow assassin( \(invisible\)|) \(hidden\) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGuallidurthAssassin = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}A drow assassin @{Cgreen}(@{nCred}E@{nCgreen}, 75, drow-elf, murder)@{n}%{invisTxt} (hide)%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A drow stands here, holding a fine ebony bow\.|A drow archer is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGuallidurthArcher = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A drow archer @{Cgreen}(@{nCred}E@{nCgreen}, 75-76, drow-elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A drow guard is here, sleeping in his bed\.|A drow guard is here, playing cards\.|A drow is here, guarding the hallways\.|A drow guard is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGuallidurthGuard = \
    /if (mobsubs & area !~ 'Shadowdwell') \
      /if ({P1} =~ 'A drow guard is here, sleeping in his bed.') \
        /substitute -p %{PL}@{nCyellow}A drow guard (sleeping) @{Cgreen}(@{nCred}E@{nCgreen}, 80, drow-elf)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'A drow guard is here, playing cards.') \
        /substitute -p %{PL}@{nCyellow}A drow guard (playing) @{Cgreen}(@{nCred}E@{nCgreen}, 80, drow-elf)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'A drow is here, guarding the hallways.') \
        /substitute -p %{PL}@{nCyellow}A drow guard (guarding) @{Cgreen}(@{nCred}E@{nCgreen}, 80, drow-elf)@{n}%{P2}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}A drow guard (sleeping/playing/guarding) @{Cgreen}(@{nCred}E@{nCgreen}, 80, drow-elf)@{n}%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(A drow warrior is here, training\.|A drow warrior is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGuallidurthWarrior = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A drow warrior @{Cgreen}(@{nCred}E@{nCgreen}, 80, drow-elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A huge drow stands there, guarding the gates\. \(invisible\)|The gate guard of Guallidurth \(invisible\) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGuallidurthGateGuard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The gate guard of Guallidurth @{Cgreen}(@{nCred}E@{nCgreen}, 80, drow-elf, noflee)@{n} (imp)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A sturdy drow wearing the royal emblem stands here, guarding the door\.|The Royal Doorguard is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGuallidurthRoyalDoorguard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Royal Doorguard @{Cgreen}(@{nCred}E@{nCgreen}, 85, drow-elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A huge drow is here, clad in the finest azur and silver armor|A royal guard is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGuallidurthRoyalGuard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A royal guard @{Cgreen}(@{nCred}E@{nCgreen}, 90, drow-elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A very large drow is here, dressed in black and gold armor\.|A drow elite guard is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGuallidurthEliteGuard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A drow elite guard @{Cgreen}(@{nCred}E@{nCgreen}, 90, drow-elf)@{n}%{P2}%{PR}%; \
    /endif%; \
    /if (groupleader =~ name & initiator =~ 'none' & autoattack & mobsinroom == 0 & !fighting) \
      /set mobsinroom 1%; \
      /if (autoassist) \
        assist%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(A small drow is here, criticizing his students\.|A drow instructor is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGuallidurthInstructor = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A drow instructor @{Cgreen}(@{nCred}E@{nCgreen}, 90, drow-elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The golem is here, guarding the king\.( \(invisible\)|)|The golem( \(invisible\)|) is here)(, fighting [^\.!]+.|)" tfMobsubstGuallidurthGolem = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (imp/invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}The golem @{Cgreen}(N, 90, ???)@{n}%{invisTxt}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A drow priestess is here, kneeling in prayer to Lloth \(invisible\)|A priestess of Lloth \(invisible\) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGuallidurthPriestess = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A priestess of Lloth @{Cgreen}(@{nCred}E@{nCgreen}, 92, drow-elf, mana shielded, summoner)@{n} (imp)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A noble drow woman is standing here\.|The queen of Guallidurth is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGuallidurthQueen = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The queen of Guallidurth @{Cgreen}(@{nCred}E@{nCgreen}, 95, drow-elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(u_n_k_n_o_w_n( \(invisible\)|)|King Kenafin Aleval of Guallidurth( \(invisible\)|) is sitting here\.|King Kenafin Aleval of Guallidurth( \(invisible\)|) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGuallidurthKing = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)" | {P4} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}King Kenafin Aleval of Guallidurth @{Cgreen}(@{nCred}E@{nCgreen}, 100, drow-elf, murder)@{n}%{P5}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A man sits here in an armchair, reading a book\.( \(invisible\)|) \(hidden\)|Pardus, the Ancient Vampire( \(invisible\)|) \(hidden\) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGuallidurthPardus = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}Pardus, the Ancient Vampire @{Cgreen}(@{nCred}E@{nCgreen}, 100, vampire, specials)@{n}%{invisTxt} (hide)%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An old drow is here, looking very tired and weary\.|The Elderly Drow Herald is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGuallidurthHerald = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Elderly Drow Herald @{Cgreen}(@{nCred}E@{nCgreen}, 100, QM)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A large humanoid with an ox-head is here, chewing on a bone\.|The Minotaur is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGuallidurthMinotaur = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Minotaur @{Cgreen}(@{nCred}E@{nCgreen}, 100, pure/light/energy/WEAPON)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The spirit of Pardus is here, floating back and forth in the catacombs\. \(invisible\) \(hidden\)|The spirit of Pardus \(invisible\) \(hidden\) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGuallidurthSpiritOfPardus = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The spirit of Pardus @{Cgreen}(@{nCred}E@{nCgreen}, 100, insubstantial, assassinate)@{n} (imp) (hide)%{P2}%{PR}%; \
    /endif

/def -p99 -F -msimple -t"A drow guard is dead! R.I.P." tfMobsubstGuallidurthRIPGua = \
    /if (groupleader =~ name & initiator =~ 'none' & autoattack & area !~ 'Shadowdwell') \
      k drow%; \
    /endif
/def -p99 -F -msimple -t"A drow instructor is dead! R.I.P." tfMobsubstGuallidurthRIPInstructor = \
    /if (groupleader =~ name & initiator =~ 'none' & autoattack) \
      k warrior%; \
    /endif
/def -p99 -F -msimple -t"A drow warrior is dead! R.I.P." tfMobsubstGuallidurthRIPWarrior = \
    /if (groupleader =~ name & initiator =~ 'none' & autoattack) \
      k warrior%; \
    /endif
/def -p99 -F -msimple -t"A drow archer is dead! R.I.P." tfMobsubstGuallidurthRIPArcher = \
    /if (groupleader =~ name & initiator =~ 'none' & autoattack) \
      k warrior%; \
    /endif
/def -p99 -F -msimple -t"A royal guard is dead! R.I.P." tfMobsubstGuallidurthRIPRGuard = \
    /if (groupleader =~ name & initiator =~ 'none' & autoattack) \
      k drow%; \
    /endif

; -----------------------  Gypsy Village  -----------------------
/def -p99 -F -mregexp -t"(A Gypsy is here, picking berries\.|A Gypsy is singing and walking along\.|;A Gypsy kid is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstGypsyKid = \
    /if (mobsubs) \
      /if ({P1} =~ 'A Gypsy is here, picking berries.') \
        /substitute -p %{PL}@{nCyellow}A Gypsy kid (picking) @{Cgreen}(@{nCwhite}G@{nCgreen}, 1, human)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'A Gypsy is singing and walking along.') \
        /substitute -p %{PL}@{nCyellow}A Gypsy kid (singing) @{Cgreen}(@{nCwhite}G@{nCgreen}, 1, human)@{n}%{P2}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}A Gypsy kid (picking/singing) @{Cgreen}(@{nCwhite}G@{nCgreen}, 1, human)@{n}%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(The small mouse tries to hide from you\.|The small mouse is here)(, fighting [^\.!]+.|)" tfMobsubstGypsyMouse = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The small mouse @{Cgreen}(N, 1, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A young gypsy runs by you\.|A young gypsy is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstGypsyYoung = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A young gypsy @{Cgreen}(@{nCwhite}G@{nCgreen}, 3, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Barnabus Gypsy is building something here\.|Barnabus Gypsy is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstGypsyBarnabus = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Barnabus Gypsy @{Cgreen}(@{nCwhite}G@{nCgreen}, 3, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Father Gypsy is here, mumbling something to himself\.|Father Gypsy is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstGypsyFather = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Father Gypsy @{Cgreen}(@{nCwhite}G@{nCgreen}, 3, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Jonathan Gypsy is here\.|Jonathan Gypsy is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstGypsyJonathan = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Jonathan Gypsy @{Cgreen}(@{nCwhite}G@{nCgreen}, 3, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Sammy Gypsy is walking by\.|Sammy Gypsy is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstGypsySammy = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Sammy Gypsy @{Cgreen}(@{nCwhite}G@{nCgreen}, 3, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Old Gypsy is lifting weights here\.|The Old Gypsy is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstGypsyOld = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Old Gypsy @{Cgreen}(@{nCwhite}G@{nCgreen}, 3, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Veronica Gypsy is here, looking beautiful\.|Veronica Gypsy is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstGypsyVeronica = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Veronica Gypsy @{Cgreen}(@{nCwhite}G@{nCgreen}, 3, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The tiny rabid rat tries to bite you!!!|The rabid rat is here)(, fighting [^\.!]+.|)" tfMobsubstGypsyRat = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The rabid rat @{Cgreen}(N, 6, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Spot is here, licking himself\.|Spot the cat is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGypsySpot = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Spot the cat @{Cgreen}(@{nCred}E@{nCgreen}, 8, ---)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A giant maggot pushes towards you\.|The giant maggot is here)(, fighting [^\.!]+.|)" tfMobsubstGypsyMaggot = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The giant maggot @{Cgreen}(N, 8, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Grandpa Gypsy is practicing magic here\.|Grandpa Gypsy is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstGypsyGrandpa = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Grandpa Gypsy @{Cgreen}(@{nCwhite}G@{nCgreen}, 10, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The evil Gypsy is here, cursing you out!|The evil Gypsy is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGypsyEvil = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The evil Gypsy @{Cgreen}(@{nCred}E@{nCgreen}, 10, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The small teeth of the Wolverine bury into your flesh\.|The wolverine is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGypsyWolverine = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The wolverine @{Cgreen}(@{nCred}E@{nCgreen}, 10, canine)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An old sailor sits nearby\.|The old sailor is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGypsySailor = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The old sailor @{Cgreen}(@{nCred}E@{nCgreen}, 15, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Barmaid is ready to take your order\.|The Barmaid is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstGypsyBarmaid = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Barmaid @{Cgreen}(@{nCwhite}G@{nCgreen}, 30, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Gypsy Witch stands here, brewing up concoctions to sell\.|The Gypsy Witch is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstGypsyWitch = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Gypsy Witch @{Cgreen}(@{nCred}E@{nCgreen}, 100, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Haarvenu  -----------------------
/def -p99 -F -mregexp -t"(A Haarvenu warrior stands here, guarding the doors\.|The Guardian of the Halls is here)(, fighting [^\.!]+.|)" tfMobsubstHaarvenuGuardian = \
    /if (owner =~ 'Cindy') \
      /tfshow Try: plain, slash, crush, pierce, norm, large, superlarge, energy, magic, (poison), acid, dark, unlife, fire, ice, iron, mental, gas, bleed, earth, electricity, silver, stun, water, air, wood%; \
    /endif%; \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Guardian of the Halls @{Cgreen}(N, 90, pure/light, noflee)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A mage clad in bloodstained robes stands here, crying tears of blood\.|A Haarvenu Blood Mage is here)(, fighting [^\.!]+.|)" tfMobsubstHaarvenuBloodMage = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Haarvenu Blood Mage @{Cgreen}(N, 90, NOT immune energy/mental)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A cloaked figure stands here, looking weak and frail\.|A Haarvenu Death Mage is here)(, fighting [^\.!]+.|)" tfMobsubstHaarvenuDeathMage = \
    /if (owner =~ 'Cindy') \
      /tfshow Try: plain, slash, crush, pierce, norm, pure, light, large, superlarge, energy, magic, poison, acid, dark, unlife, ice, iron, mental, gas, bleed, earth, electricity, silver, stun, water, air, wood%; \
    /endif%; \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Haarvenu Death Mage @{Cgreen}(N, 89-90, immune fire)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A tall robed man is here, toying with the elements\.|A Haarvenu Elemental Mage is here)(, fighting [^\.!]+.|)" tfMobsubstHaarvenuElementalMage = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Haarvenu Elemental Mage @{Cgreen}(N, 90, NOT immune energy/mental)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Emerging from the shadows is a robed figure with pale skin and black eyes\. \(hidden\)|A Haarvenu Shadow Mage \(hidden\) is here)(, fighting [^\.!]+.|)" tfMobsubstHaarvenuShadowMage = \
    /if (owner =~ 'Cindy') \
      /tfshow Try: plain, slash, crush, pierce, norm, pure, light, large, superlarge, energy, magic, poison, acid, dark, unlife, fire, ice, iron, mental, gas, bleed, earth, electricity, silver, stun, water, air, wood%; \
    /endif%; \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Haarvenu Shadow Mage @{Cgreen}(N, 90, ???)@{n} (hide)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A zombie shuffles along, dead skin hanging from its rotting flesh\. \(hidden\)|The Zombie of a Haarvenu Warrior \(hidden\) is here)(, fighting [^\.!]+.|)" tfMobsubstHaarvenuZombie = \
    /if (owner =~ 'Cindy') \
      /tfshow Try: slash, crush, pierce, norm, pure, light, large, superlarge, energy, magic, poison, acid, dark, unlife, fire, ice, iron, mental, gas, bleed, earth, electricity, silver, stun, water, air, wood%; \
    /endif%; \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Zombie of a Haarvenu Warrior @{Cgreen}(N, 89-90, undead?)@{n} (hide)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(u_n_k_n_o_w_n|the hound of dark arrives from the .*|The hound of dark is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstHaarvenuHoundOfDark = \
    /if (owner =~ 'Cindy') \
      /tfshow Try: DARK (pblind), plain, slash, crush, pierce, norm, large, superlarge, energy, magic, poison, acid, dark, unlife, fire, ice, iron, gas, bleed, earth, electricity, silver, stun, water, air, wood%; \
    /endif%; \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The hound of dark @{Cgreen}(@{nCred}E@{nCgreen}, 90-91, vuln pure/light, HUNTER)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(u_n_k_n_o_w_n|the hound of light arrives from the .*|The hound of light is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstHaarvenuHoundOfLight = \
    /if (owner =~ 'Cindy') \
      /tfshow ALIGN? Try: plain, slash, crush, pierce, norm, large, superlarge, energy, magic, poison, acid, unlife, fire, ice, iron, gas, bleed, earth, electricity, silver, stun, water, air, wood%; \
    /endif%; \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The hound of light @{Cgreen}(@{nCred}?@{nCgreen}, 90, vuln pure/light, HUNTER)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A giant creature assembled from severed limbs stands before you in a pool of blood\.|Itindar is here)(, fighting [^\.!]+.|)" tfMobsubstHaarvenuItindar = \
    /if (owner =~ 'Cindy') \
      /tfshow Try: plain, slash, crush, pierce, norm, pure, (light), large, superlarge, energy, magic, poison, acid, dark, unlife, fire, (ice), iron, mental, gas, bleed, earth, electricity, silver, stun, water, air, wood%; \
    /endif%; \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Itindar @{Cgreen}(N, 100, ???)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Haon-Dor  -----------------------
/def -p99 -F -mregexp -t"(A fat worm scurries around, looking for food\.|A fat worm is here)(, fighting [^\.!]+.|)" tfMobsubstHaonDorWorm = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A fat worm @{Cgreen}(N, 3, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A large, black wolf is here, glaring hungrily at you\.|The large, black wolf is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstHaonDorBlackWolf = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The large, black wolf @{Cgreen}(@{nCred}E@{nCgreen}, 3, canine)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A large, grey wolf is here, glaring hungrily at you\.|The large, grey wolf is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstHaonDorGreyWolf = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The large, grey wolf @{Cgreen}(@{nCred}E@{nCgreen}, 3, canine)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A ferocious warg is here, snarling angrily at you\.|The ferocious warg is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstHaonDorFerociousWarg = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The ferocious warg @{Cgreen}(@{nCred}E@{nCgreen}, 5, canine)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A vicious warg is here, snarling angrily at you\.|The vicious warg is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstHaonDorViciousWarg = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The vicious warg @{Cgreen}(@{nCred}E@{nCgreen}, 5, canine)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Shargugh the Forest Brownie is here, grinning broadly at you\.( \(invisible\)|)|Shargugh( \(invisible\)|) is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHaonDorShargugh = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}Shargugh @{Cgreen}(@{nCwhite}G@{nCgreen}, 10, fairie)@{n}%{invisTxt}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(the elder druid is here \.\.\.he looks very upset about your presence in his home\.|The Elder Druid is here)(, fighting [^\.!]+.|)" tfMobsubstHaonDorDruid = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Elder Druid @{Cgreen}(N, 17, elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A huge green dragon is here, its narrow yellow eyes glowing with rage\.|The huge, green dragon is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstHaonDorDragon = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The huge, green dragon @{Cgreen}(@{nCred}E@{nCgreen}, 21, dragon)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A horde of skeletons are standing here\.|A horde of skeletons is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstHaonDorHorde = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A horde of skeletons @{Cgreen}(@{nCred}E@{nCgreen}, 45, demon)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Kazham the evil warlock is standing looking over his army of skeletons\.|Kazham the warlock is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstHaonDorKazham = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Kazham the warlock @{Cgreen}(@{nCred}E@{nCgreen}, 51, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A huge, ancient tree towers above you\.|A huge, ancient tree is here)(, fighting [^\.!]+.|)" tfMobsubstHaonDorTree = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A huge, ancient tree @{Cgreen}(N, 80, botanic)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A huge, ancient oak tree looks down on you from above\.|A huge, ancient oak tree is here)(, fighting [^\.!]+.|)" tfMobsubstHaonDorOakTree = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A huge, ancient oak tree @{Cgreen}(@{nCred}E@{nCgreen}, 95, botanic)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Haunted Keep  -----------------------
/def -p99 -F -mregexp -t"(A furry little gopher scurries about merrily\.|A furry little gopher is here)(, fighting [^\.!]+.|)" tfMobsubstHauntedKeepGopher = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A furry little gopher @{Cgreen}(N, 5, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A skeleton stands about, cackling insanely at a seemingly nonexistant being\.|The skeleton is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstHauntedKeepSkeleton = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The skeleton @{Cgreen}(@{nCred}E@{nCgreen}, 5, skeleton)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The shuffling zombie is standing here\.|The zombie is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstHauntedKeepZombie = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The zombie @{Cgreen}(@{nCred}E@{nCgreen}, 8, undead)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A shackled spirit lies about, suffering from its own surreal wounds\.|A shackled spirit is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstHauntedKeepSpirit = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A shackled spirit @{Cgreen}(@{nCred}E@{nCgreen}, 8, entity)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A mummy stands tall here, looking for something to maim\.|The mummy is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstHauntedKeepMummy = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The mummy @{Cgreen}(@{nCred}E@{nCgreen}, 10, undead)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A ghost floats here with axe-in-hand, a dasteredly grin crosses his face\.|A ghastly executioner is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstHauntedKeepExecutioner = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A ghastly executioner @{Cgreen}(@{nCred}E@{nCgreen}, 13, entity)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A putrid, rotting corpse stumbles around\.|A rotting corpse is here)(, fighting [^\.!]+.|)" tfMobsubstHauntedKeepCorpse = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A rotting corpse @{Cgreen}(N, 17, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A ghost wearing a chef's hat wavers about here\.|Ghost of the portly cook is here)(, fighting [^\.!]+.|)" tfMobsubstHauntedKeepCook = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Ghost of the portly cook @{Cgreen}(N, 31, insubstantial)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Herd Area  -----------------------
/def -p99 -F -mregexp -t"(A calf is here, just learning to stand on wobbly legs\.|A calf is here)(, fighting [^\.!]+.|)" tfMobsubstHerdAreaCalf = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A calf @{Cgreen}(N, 1, no-attack)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A kid goat is here, not worth killing\.|A kid goat is here)(, fighting [^\.!]+.|)" tfMobsubstHerdAreaKidGoat = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A kid goat @{Cgreen}(N, 1, no-attack)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A small mouse is scurrying through the grass.|A small mouse is here)(, fighting [^\.!]+.|)" tfMobsubstHerdAreaMouse = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A small mouse @{Cgreen}(N, 1, rodent)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A small rabbit hops around, knibbling on some grass\.|A small rabbit is here)(, fighting [^\.!]+.|)" tfMobsubstHerdAreaRabbit = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A small rabbit @{Cgreen}(N, 2, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A cow is here, quietly munching her cud\.|A brown cow is here)(, fighting [^\.!]+.|)" tfMobsubstHerdAreaCow = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A brown cow @{Cgreen}(N, 3, ---)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A nanny goat is here, toting a large udder\.|A nanny goat is here)(, fighting [^\.!]+.|)" tfMobsubstHerdAreaNannyGoat = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A nanny goat @{Cgreen}(N, 3, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A small grey wolf sneaks around looking for a meal\.|A small grey wolf is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstHerdAreaWolf = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A small grey wolf @{Cgreen}(@{nCred}E@{nCgreen}, 3, canine)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A billy goat is here, chewing on a tin can\.|A billy goat is here)(, fighting [^\.!]+.|)" tfMobsubstHerdAreaBillyGoat = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A billy goat @{Cgreen}(N, 4, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A child runs around the house, playing games\.|A herder's child is here)(, fighting [^\.!]+.|)" tfMobsubstHerdAreaChild = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A herder's child @{Cgreen}(N, 4, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A cowherder is here, watching over the herd\.|A cowherder is here)(, fighting [^\.!]+.|)" tfMobsubstHerdAreaCowherder = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A cowherder @{Cgreen}(N, 5, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A goatherder is here, watching over the cheesemakers\.|A goatherder is here)(, fighting [^\.!]+.|)" tfMobsubstHerdAreaGoatherder = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A goatherder @{Cgreen}(N, 6, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The herder's mother stands here, making dinner for the family\.|The herder's mother is here)(, fighting [^\.!]+.|)" tfMobsubstHerdAreaMother = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The herder's mother @{Cgreen}(N, 6, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The father of the herder's sits here, smoking a pip in a rocking chair\.|The herder's father is( sitting|) here)(\.|)(, fighting [^\.!]+.|)" tfMobsubstHerdAreaFather = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The herder's father @{Cgreen}(N, 10, human)@{n}%{P2}%{P4}%{PR}%; \
    /endif

; -----------------------  Highlands  -----------------------
/def -p99 -F -mregexp -t"(The sheep is eating grass\.|A sheep is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHighlandsSheep = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A sheep @{Cgreen}(@{nCwhite}G@{nCgreen}, 10, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Barbarian stinks and sweats\.|A Barbarian is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstHighlandsBarbarian = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Barbarian @{Cgreen}(@{nCred}E@{nCgreen}, 14, lugroki)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Frog jumps about a bit\.|A gigantic frog is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstHighlandsFrog = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A gigantic frog @{Cgreen}(@{nCred}E@{nCgreen}, 15, amphibian)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The warrior looks at you\.|A barbarian warrior is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstHighlandsBarbWarr = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A barbarian warrior @{Cgreen}(@{nCred}E@{nCgreen}, 16, lugroki)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The keeper greets you\.|The Keeper of the Tower is here)(, fighting [^\.!]+.|)" tfMobsubstHighlandsKeeper = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Keeper of the Tower @{Cgreen}(N, 16, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p98 -F -mregexp -t"(A guard is here\.|A guard is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstHighlandsGuard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A guard @{Cgreen}(@{nCred}E@{nCgreen}, 17, lugroki)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The guard is standing still like a marble bust\.|A Barbarian Guard is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstHighlandsBarbGuard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Barbarian Guard @{Cgreen}(@{nCred}E@{nCgreen}, 18, lugroki)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The cleric doesnt notice you\.|The Lord's Cleric Boldar is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstHighlandsBoldar = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Lord's Cleric Boldar @{Cgreen}(@{nCred}E@{nCgreen}, 18, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The mage eyes you conspiciously\.|The Lord's Mage Mardonna is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstHighlandsMardonna = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Lord's Mage Mardonna @{Cgreen}(@{nCred}E@{nCgreen}, 18, elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A fire elemental is here\.|A Fire Elemental is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstHighlandsElemental = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Fire Elemental @{Cgreen}(@{nCred}E@{nCgreen}, 20, elemental, VAPE eq!)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A small Nessy is relaxing here\.|Nessy's Child is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHighlandsChild = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Nessy's Child @{Cgreen}(@{nCwhite}G@{nCgreen}, 20, dragon)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Wife is looking at a cracked mirror\.|The wife of the Lord is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstHighlandsWife = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The wife of the Lord @{Cgreen}(@{nCred}E@{nCgreen}, 20, lugroki)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The barbarian is waiting for you to do something\.|An Elite barbarian is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstHighlandsEliteBarb = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An Elite barbarian @{Cgreen}(@{nCred}E@{nCgreen}, 21, lugroki)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Nessy grins.|Nessy is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHighlandsNessy = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Nessy @{Cgreen}(@{nCwhite}G@{nCgreen}, 24, dragon)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The highlander walks by and greets you\.|A Highlander is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHighlandsHighlander = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Highlander @{Cgreen}(@{nCwhite}G@{nCgreen}, 25, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Lord has the words to kill you on his lips\.|The Barbarian Lord is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstHighlandsLord = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Barbarian Lord @{Cgreen}(@{nCred}E@{nCgreen}, 25, lugroki)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Slayer isn't aware of your presence\.|The Holy Slayer is here)(, fighting [^\.!]+.|)" tfMobsubstHighlandsSlayer = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Holy Slayer @{Cgreen}(N, 35, insubstantial)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  High Tower  -----------------------
/def -p99 -F -mregexp -t"(Edgar the Human Swordpupil is standing here, muttering to himself\.|Edgar is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHighTowerEdgar = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Edgar @{Cgreen}(@{nCwhite}G@{nCgreen}, 1, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A large, trained Wolf is here\.|The Wolf is here)(, fighting [^\.!]+.|)" tfMobsubstHighTowerWolf = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Wolf @{Cgreen}(N, 4, canine)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A cityguard stands here\.|The Cityguard is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHighTowerCityguard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Cityguard @{Cgreen}(@{nCwhite}G@{nCgreen}, 8, human, protector)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A vicious creature leaps out of the shadows and attacks!!!|The Guardian of the riches is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstHighTowerGuardianRiches = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Guardian of the riches @{Cgreen}(@{nCred}E@{nCgreen}, 25, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A straw broom is here leaning against the wall|A broom is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHighTowerBroom = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A broom @{Cgreen}(@{nCwhite}G@{nCgreen}, 30, entity)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A pair of disembodied hands floats in the air here|A pair of disembodied hands is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstHighTowerHands = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A pair of disembodied hands @{Cgreen}(@{nCred}E@{nCgreen}, 30, entity)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A shadow guardian screams a challenge and attacks|A shadow guardian is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstHighTowerShadowGuardian = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A shadow guardian @{Cgreen}(@{nCred}E@{nCgreen}, 30, insubstantial)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A large kitten is here growling in terror\.|A large kitten is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHighTowerKitten = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A large kitten @{Cgreen}(@{nCwhite}G@{nCgreen}, 35, feline)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A pair of disembodied eyes floats here glaring at you|A pair of disembodied eyes is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstHighTowerEyes = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A pair of disembodied eyes @{Cgreen}(@{nCred}E@{nCgreen}, 35, entity)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An ugly witch is here scrying out secrets|An ugly witch is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstHighTowerWitch = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An ugly witch @{Cgreen}(@{nCred}E@{nCgreen}, 35, ---)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The cook's assistant is here assisting the cook|The cook's assistant is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstHighTowerAssistant = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The cook's assistant @{Cgreen}(@{nCred}E@{nCgreen}, 38, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A young mage wanders about, oblivious to all|A mage is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHighTowerAMage = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A mage @{Cgreen}(@{nCwhite}G@{nCgreen}, 40, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A scribe is here working on some manuscripts|A scribe is here working diligently on some translations|A scribe is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHighTowerScribe = \
    /if (mobsubs) \
      /if ({P1} =~ 'A scribe is here working on some manuscripts') \
        /substitute -p %{PL}@{nCyellow}A scribe (manuscripts) @{Cgreen}(@{nCwhite}G@{nCgreen}, 40, human)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'A scribe is here working diligently on some translations') \
        /substitute -p %{PL}@{nCyellow}A scribe (translations) @{Cgreen}(@{nCwhite}G@{nCgreen}, 40, human)@{n}%{P2}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}A scribe (manuscripts/translations) @{Cgreen}(@{nCwhite}G@{nCgreen}, 40, human)@{n}%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p100 -F -mregexp -t"(A student of spells is here looking quite bored|A student is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHighTowerAStudent = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A student @{Cgreen}(@{nCwhite}G@{nCgreen}, 40, human)@{n}%{P2}%{PR}%; \
    /endif

/def -p99 -F -mregexp -t"(A student of spells has fallen asleep at her desk here( \(invisible\)|))( \(Red Aura\)|)" tfMobsubstHighTowerStudentOfSpellsAsleep = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}A student of spells (asleep) @{Cgreen}(@{nCwhite}G@{nCgreen}, 40, human)@{n}%{invisTxt}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A student of spells is here trying to master invisibility( \(invisible\)|))( \(Red Aura\)|)" tfMobsubstHighTowerStudentOfSpellsTrying = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}A student of spells (trying) @{Cgreen}(@{nCwhite}G@{nCgreen}, 40, human)@{n}%{invisTxt}%{PR}%; \
    /endif
/def -p98 -F -mregexp -t"(A student of spells( \(invisible\)|) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstHighTowerStudentOfSpellsEither = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}A student of spells (asleep/trying) @{Cgreen}(@{nCwhite}G@{nCgreen}, 40, human)@{n}%{invisTxt}%{PR}%; \
    /endif

/def -p99 -F -mregexp -t"(A young apprentice is here mumbling words of magic to himself|A young apprentice is sleeping here|A young apprentice is here teasing a cornered kitten|A young apprentice is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHighTowerYoungApprentice = \
    /if (mobsubs) \
      /if ({P1} =~ 'A young apprentice is here mumbling words of magic to himself') \
        /substitute -p %{PL}@{nCyellow}A young apprentice (mumbling) @{Cgreen}(@{nCwhite}G@{nCgreen}, 40, human)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'A young apprentice is sleeping here') \
        /substitute -p %{PL}@{nCyellow}A young apprentice (sleeping) @{Cgreen}(@{nCwhite}G@{nCgreen}, 40, human)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'A young apprentice is here teasing a cornered kitten') \
        /substitute -p %{PL}@{nCyellow}A young apprentice (teasing) @{Cgreen}(@{nCwhite}G@{nCgreen}, 42, human)@{n}%{P2}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}A young apprentice (mumbling/sleeping/teasing) @{Cgreen}(@{nCwhite}G@{nCgreen}, 40/42, human)@{n}%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(A young apprentice magic user is here doing magical studies|A young apprentice magic user is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHighTowerYoungAppMUser = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A young apprentice magic user @{Cgreen}(@{nCwhite}G@{nCgreen}, 40, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A young mage is here learning hand to hand combat|A young mage is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHighTowerYoungmage = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A young mage @{Cgreen}(@{nCwhite}G@{nCgreen}, 40, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An animated skeleton screams silently and attacks|An animated skeleton is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstHighTowerAnimSkeleton = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An animated skeleton @{Cgreen}(@{nCred}E@{nCgreen}, 40, skeleton)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A visiting mage is here snoring away in peaceful slumber|The mage is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHighTowerVisitingMage = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The mage @{Cgreen}(@{nCwhite}G@{nCgreen}, 40, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An undead giant lumbers towards you|An undead giant is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstHighTowerUndGiant = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An undead giant @{Cgreen}(@{nCred}E@{nCgreen}, 45, undead)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A prisoner is chained to the wall here|The prisoner is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHighTowerPrisoner = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The prisoner @{Cgreen}(@{nCwhite}G@{nCgreen}, 45, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A black cat with its fur up hisses at you \(hidden\)|A black cat \(hidden\) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstHighTowerBlackCat = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A black cat @{Cgreen}(@{nCred}E@{nCgreen}, 50, feline)@{n} (hide)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A large calico cat is here\.|A calico cat is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHighTowerCalicoCat = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A calico cat @{Cgreen}(@{nCwhite}G@{nCgreen}, 50, feline)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An well crafted sword lies on the work table here|A dancing sword is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstHighTowerSword = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A dancing sword @{Cgreen}(@{nCred}E@{nCgreen}, 50, human)@{n}%{P2}%{PR}%; \
    /endif

/def -p99 -F -mregexp -t"(A spell teacher is here relaxing( \(invisible\)|))( \(White Aura\)|)" tfMobsubstHighTowerSpellTeacherRelaxing = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}A spell teacher (relaxing) @{Cgreen}(@{nCwhite}G@{nCgreen}, 50, human)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A spell teacher screams at your interuption and attacks( \(invisible\)|))( \(White Aura\)|)" tfMobsubstHighTowerSpellTeacherScreams = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}A spell teacher (screams) @{Cgreen}(@{nCwhite}G@{nCgreen}, 50, human)@{n}%{invisTxt}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A spell teacher( \(invisible\)|) is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHighTowerSpellTeacherEither = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}A spell teacher (relaxing/screams) @{Cgreen}(@{nCwhite}G@{nCgreen}, 50, human)@{n}%{invisTxt}%{P3}%{PR}%; \
    /endif

/def -p99 -F -mregexp -t"(A wooden golem stands a silent vigil here, guarding the stairs|A wooden golem is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHighTowerWoodenGolem = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A wooden golem @{Cgreen}(@{nCwhite}G@{nCgreen}, 50, entity)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An aged wizard is sleeping here|An aged wizard is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHighTowerAgedWizard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An aged wizard @{Cgreen}(@{nCwhite}G@{nCgreen}, 50, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The instructor screams at your interuption and attacks you( \(invisible\)|)|An instructor of magic( \(invisible\)|) is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHighTowerInstructorOfMagic = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}An instructor of magic @{Cgreen}(@{nCwhite}G@{nCgreen}, 50, human)@{n}%{invisTxt}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Ezmerelda the cook is here stirring a large pot of something|Ezmerelda is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstHighTowerEzmerelda = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Ezmerelda @{Cgreen}(@{nCred}E@{nCgreen}, 50, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Librarian has fallen asleep at his desk here|The Librarian is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHighTowerLibrarian = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Librarian @{Cgreen}(@{nCwhite}G@{nCgreen}, 50, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The master's apprentice leaps to halt your passage|The master's apprentice is here)(, fighting [^\.!]+.|)" tfMobsubstHighTowerMastApp = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The master's apprentice @{Cgreen}(N, 50, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The scribe's assistant is here folding parchments|The scribe's assistant is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHighTowerScribesAss = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The scribe's assistant @{Cgreen}(@{nCwhite}G@{nCgreen}, 50, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A cloth golem wanders around here|A cloth golem is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHighTowerClothGolem = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A cloth golem @{Cgreen}(@{nCwhite}G@{nCgreen}, 55, entity)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A black robed apprentice jumps from the shadows and attacks \(hidden\)|A black robed apprentice \(hidden\) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstHighTowerBlRoApp = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A black robed apprentice @{Cgreen}(@{nCred}E@{nCgreen}, 55, human)@{n} (hide)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A white cat is here preening its fur \(hidden\)|A white cat \(hidden\) is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHighTowerWhiteCat = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A white cat @{Cgreen}(@{nCwhite}G@{nCgreen}, 55, feline)@{n} (hide)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A clay golem stands guard here|A clay golem is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHighTowerClayGolem = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A clay golem @{Cgreen}(@{nCwhite}G@{nCgreen}, 60, entity)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A granite golem stands here waiting to do its master's bidding|A granite golem is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHighTowerGraniteGolem = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A granite golem @{Cgreen}(@{nCwhite}G@{nCgreen}, 60, entity)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A grey cat is lounging lazily here( \(invisible\)|) \(hidden\)|A grey cat( \(invisible\)|) \(hidden\) is here)(, fighting [^\.!]+.|)" tfMobsubstHighTowerGreyCat = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}A grey cat @{Cgreen}(N, 60, feline)@{n}%{invisTxt} (hide)%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A white robed apprentice screams at your desecration of goodness|A white robed apprentice is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHighTowerWhRoApp = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A white robed apprentice @{Cgreen}(@{nCwhite}G@{nCgreen}, 60, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An old wizard is here making a speech( \(invisible\)|)|A wizard( \(invisible\)|) is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHighTowerAWizard = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}A wizard @{Cgreen}(@{nCwhite}G@{nCgreen}, 60, human)@{n}%{invisTxt}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Jailor is here enjoying a comfortable nap|The Jailor is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHighTowerJailor = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Jailor @{Cgreen}(@{nCwhite}G@{nCgreen}, 60, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The master charmer utters the words, 'uuuzzldctz'( \(invisible\)|)|The master charmer( \(invisible\)|) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstHighTowerMasterCharmer = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}The master charmer @{Cgreen}(@{nCred}E@{nCgreen}, 60, human)@{n}%{invisTxt}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The master spell binder is here re-charging a blackened wand|The master spell binder is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstHighTowerMasterSpBind = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The master spell binder @{Cgreen}(@{nCred}E@{nCgreen}, 60, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The master summoner is here holding gateways open to other planes( \(invisible\)|)|The master summoner( \(invisible\)|) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstHighTowerMasterSummoner = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}The master summoner @{Cgreen}(@{nCred}E@{nCgreen}, 60, human)@{n}%{invisTxt}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A flesh golem stands guard here|A flesh golem is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHighTowerFleshGolem = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A flesh golem @{Cgreen}(@{nCwhite}G@{nCgreen}, 65, entity)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The battle mistress is here teaching the fine uses of a dagger( \(invisible\)|)|The battle mistress( \(invisible\)|) is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHighTowerBattleMistress = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}The battle mistress @{Cgreen}(@{nCwhite}G@{nCgreen}, 65, human)@{n}%{invisTxt}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A bronze golem stands here shining in the light|A bronze golem is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstHighTowerBronzeGolem = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A bronze golem @{Cgreen}(@{nCred}E@{nCgreen}, 70, entity)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A huge diamond golem is standing guard here|The diamond golem is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHighTowerDiamondGolem = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The diamond golem @{Cgreen}(@{nCwhite}G@{nCgreen}, 70, entity)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Mad Alchemist babbles something un-comprehensible and attacks|The Mad Alchemist is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHighTowerMadAlchemist = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Mad Alchemist @{Cgreen}(@{nCwhite}G@{nCgreen}, 70, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An enormous multi-colored three-headed dragon growls at you|The master of illusions is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHighTowerMastOfIll = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The master of illusions @{Cgreen}(@{nCwhite}G@{nCgreen}, 70, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The master of Neutrality stands here contemplating the balance of the universe|The master of Neutrality is here)(, fighting [^\.!]+.|)" tfMobsubstHighTowerMasterOfNeutr = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The master of Neutrality @{Cgreen}(N, 70, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The master of the black robes is here plotting vile deeds|The master of the black robes is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstHighTowerMasterOfTheBlRob = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The master of the black robes @{Cgreen}(@{nCred}E@{nCgreen}, 70, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Necromancer is here raising undead servants|The Necromancer is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstHighTowerNecromancer = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Necromancer @{Cgreen}(@{nCred}E@{nCgreen}, 70, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The master of goodness is here frowning at your intrusion|The master of goodness is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHighTowerMasterOfGoodn = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The master of goodness @{Cgreen}(@{nCwhite}G@{nCgreen}, 75, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The master scribe is here looking a little upset( \(invisible\)|)|The master scribe( \(invisible\)|) is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHighTowerMasterScribe = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}The master scribe @{Cgreen}(@{nCwhite}G@{nCgreen}, 77, human)@{n}%{invisTxt}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An adamantite golem stands here looking very dangerous|An adamantite golem is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHighTowerAdamantiteGolem = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An adamantite golem @{Cgreen}(@{nCwhite}G@{nCgreen}, 80, entity)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The golem maker is here chiseling some stone|The golem maker is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHighTowerGolemMaker = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The golem maker @{Cgreen}(@{nCwhite}G@{nCgreen}, 80, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An old mage is here, wondering where all his students went\.|Professor Gazinki is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHighTowerGazinki = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Professor Gazinki @{Cgreen}(@{nCwhite}G@{nCgreen}, 84, QM)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Grand Mistress of Magic is sitting here|The Grand Mistress is here)(, fighting [^\.!]+.|)" tfMobsubstHighTowerMistress = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Grand Mistress @{Cgreen}(N, 85, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Enchanter is here placing a dweomer upon well made sword|The Enchanter is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstHighTowerEnchanter = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Enchanter @{Cgreen}(@{nCred}E@{nCgreen}, 85, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Archmage Quimon is sitting here\.|Quimon is here)(, fighting [^\.!]+.|)" tfMobsubstHighTowerQuimon = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Quimon @{Cgreen}(N, 99, QM)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Strick is here levitating drinks to his customers\.|Strick the bartender is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHighTowerStrick = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Strick the bartender @{Cgreen}(@{nCwhite}G@{nCgreen}, 100, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Tatorious the wizard is here counting his earnings|Tatorious is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHighTowerTatorious = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Tatorious @{Cgreen}(@{nCwhite}G@{nCgreen}, 100, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Hobgoblin Camps  -----------------------
/def -p99 -F -mregexp -t"(A hobgoblin forager wanders around here.|A Hobgoblin Forager is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstHobgoblinCampsForager = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Hobgoblin Forager @{Cgreen}(@{nCred}E@{nCgreen}, 25, goblin)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(an anxious recruit|A Hobgoblin Recruit is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstHobgoblinCampsRecruit = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Hobgoblin Recruit @{Cgreen}(@{nCred}E@{nCgreen}, 25, goblin)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(a villager walks along the path|A Hobgoblin Villager is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstHobgoblinCampsVillager = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Hobgoblin Villager @{Cgreen}(@{nCred}E@{nCgreen}, 25, goblin)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(the stonemason is reinforcing the fort|A Hobgoblin Stonemason is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstHobgoblinCampsStonemason = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Hobgoblin Stonemason @{Cgreen}(@{nCred}E@{nCgreen}, 30, goblin)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(a worker is standing here wondering what to do next|A Hobgoblin Worker is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstHobgoblinCampsWorker = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Hobgoblin Worker @{Cgreen}(@{nCred}E@{nCgreen}, 30, goblin)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A beast is grazing here\.|A Beast is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstHobgoblinCampsBeast = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Beast @{Cgreen}(@{nCred}E@{nCgreen}, 33, goblin)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(the archer is taking target practice|A Hobgoblin Archer is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstHobgoblinCampsArcher = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Hobgoblin Archer @{Cgreen}(@{nCred}E@{nCgreen}, 33, goblin)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(the carpenter is fastening the timbers|A Hobgoblin Carpenter is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstHobgoblinCampsCarpenter = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Hobgoblin Carpenter @{Cgreen}(@{nCred}E@{nCgreen}, 33, goblin)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(the axeman is making short work of his training targets|A Hobgoblin Axeman is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstHobgoblinCampsAxeman = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Hobgoblin Axeman @{Cgreen}(@{nCred}E@{nCgreen}, 35, goblin)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(the guard is watching for intruders|A Hobgoblin Guard is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstHobgoblinCampsGuard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Hobgoblin Guard @{Cgreen}(@{nCred}E@{nCgreen}, 35, goblin)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(the longswordsman is slashing through his targets|A Hobgoblin Longswordsman is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstHobgoblinCampsLongswordsman = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Hobgoblin Longswordsman @{Cgreen}(@{nCred}E@{nCgreen}, 35, goblin)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(the shortswordsman is practicing his piercing|A Hobgoblin Shortswordsman is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstHobgoblinCampsShortswordsman = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Hobgoblin Shortswordsman @{Cgreen}(@{nCred}E@{nCgreen}, 35, goblin)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(the beastrider is ready to saddle-up|A Hobgoblin Beastrider is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstHobgoblinCampsBeastrider = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Hobgoblin Beastrider @{Cgreen}(@{nCred}E@{nCgreen}, 40, goblin)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(a berserker is looking for something to kill, maim, or mutilate|A Hobgoblin Berserker is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstHobgoblinCampsBerserker = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Hobgoblin Berserker @{Cgreen}(@{nCred}E@{nCgreen}, 40, goblin)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(the imperial guard is training to protect the king|A Hobgoblin Imperial Guard is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstHobgoblinCampsImperialGuard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Hobgoblin Imperial Guard @{Cgreen}(@{nCred}E@{nCgreen}, 40, goblin)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(the spy is sneaking around|A Hobgoblin Spy is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstHobgoblinCampsSpy = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Hobgoblin Spy @{Cgreen}(@{nCred}E@{nCgreen}, 40, goblin)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(the master is teaching the spy trainees his craft|A Hobgoblin Master is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstHobgoblinCampsMaster = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Hobgoblin Master @{Cgreen}(@{nCred}E@{nCgreen}, 45, goblin)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(the overseer is making sure the fort is completed|A Hobgoblin Overseer is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstHobgoblinCampsOverseer = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Hobgoblin Overseer @{Cgreen}(@{nCred}E@{nCgreen}, 45, goblin)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(the trainer is working with the recruits|A Hobgoblin Trainer is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstHobgoblinCampsTrainer = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Hobgoblin Trainer @{Cgreen}(@{nCred}E@{nCgreen}, 45, goblin)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Holy Grove  -----------------------
/def -p99 -F -mregexp -t"(A small bunny is here, poking from bush to bush\.|A small bunny is here)(, fighting [^\.!]+.|)" tfMobsubstHolyGroveBunny = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A small bunny @{Cgreen}(N, 2, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A small snake slithers between the grass\.|A harmless snake is here)(, fighting [^\.!]+.|)" tfMobsubstHolyGroveSnake = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A harmless snake @{Cgreen}(N, 4, snake)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A doe is here, munching on grass\.|A doe is here)(, fighting [^\.!]+.|)" tfMobsubstHolyGroveDoe = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A doe @{Cgreen}(N, 5, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p100 -F -mregexp -t"(A deer is here, staring back at you\.|A deer is here)(, fighting [^\.!]+.|)" tfMobsubstHolyGroveDeer = \
    /if (mobsubs & ({P1} !~ 'A deer is here' | area =~ 'HolyGrove')) \
      /substitute -p %{PL}@{nCyellow}A deer @{Cgreen}(N, 6, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A large deer stag is here, protecting his territory\.|A stag is here)(, fighting [^\.!]+.|)" tfMobsubstHolyGroveStag = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A stag @{Cgreen}(N, 8, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A druid is here in meditation\.|A druid is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHolyGroveDruid = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A druid @{Cgreen}(@{nCwhite}G@{nCgreen}, 10, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A druidess is here, peering at you\.|A druidess is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHolyGroveDruidess = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A druidess @{Cgreen}(@{nCwhite}G@{nCgreen}, 10, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An elder druid stands here, watching the local flora and wildlife\.|An elder druid is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHolyGroveElderDruid = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An elder druid @{Cgreen}(@{nCwhite}G@{nCgreen}, 13, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An elder druidess stands here, watching the local fauna and feeding rabbits\.|An elder druidess is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHolyGroveElderDruidess = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An elder druidess @{Cgreen}(@{nCwhite}G@{nCgreen}, 13, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The old Hierophant of the holy grove is here, gathering hollies\.|The old Hierophant of the holy grove is here, gathering ivy\.|The Hierophant is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHolyGroveHierophant = \
    /if (mobsubs) \
      /if ({P1} =~ 'The old Hierophant of the holy grove is here, gathering hollies.') \
        /substitute -p %{PL}@{nCyellow}The Hierophant (hollies) @{Cgreen}(@{nCwhite}G@{nCgreen}, 20, human)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'The old Hierophant of the holy grove is here, gathering ivy.') \
        /substitute -p %{PL}@{nCyellow}The Hierophant (ivy) @{Cgreen}(@{nCwhite}G@{nCgreen}, 20, human)@{n}%{P2}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}The Hierophant (hollies/ivy) @{Cgreen}(@{nCwhite}G@{nCgreen}, 20, human)@{n}%{P2}%{PR}%; \
      /endif%; \
    /endif

; -----------------------  Dharynn's Huge Forest  -----------------------
/def -p99 -F -mregexp -t"(A fox cub warms itself against its mother\.|The fox cub is here)(, fighting [^\.!]+.|)" tfMobsubstHugeForestFoxCub = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The fox cub @{Cgreen}(N, 1, canine)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A little mouse scurries under a gigantic root upon noticing you\.|The mouse is here)(, fighting [^\.!]+.|)" tfMobsubstHugeForestMouse = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The mouse @{Cgreen}(N, 1, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A pigeon flies circles the trees\. \(invisible\)|The pigeon \(invisible\) is here)(, fighting [^\.!]+.|)" tfMobsubstHugeForestPigeon = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The pigeon @{Cgreen}(N, 1, bird)@{n} (imp)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A newly-hatched sparrow squawks to be fed\.|The newly-hatched sparrow is here)(, fighting [^\.!]+.|)" tfMobsubstHugeForestNHSparrow = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The newly-hatched sparrow @{Cgreen}(N, 1, bird)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A little sparrow is singing beautifully\.|The sparrow is here)(, fighting [^\.!]+.|)" tfMobsubstHugeForestSparrow = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The sparrow @{Cgreen}(N, 1, bird)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A black bear cub attempts to catch a fly\.|The black bear cub is here)(, fighting [^\.!]+.|)" tfMobsubstHugeForestBlBCub = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The black bear cub @{Cgreen}(N, 2, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A brown bear cub attempts to catch a fly\.|The brown bear cub is here)(, fighting [^\.!]+.|)" tfMobsubstHugeForestBrBCub = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The brown bear cub @{Cgreen}(N, 2, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A fox scurries off behind a tree\.|The fox is here)(, fighting [^\.!]+.|)" tfMobsubstHugeForestFox = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The fox @{Cgreen}(N, 2, canine)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A frog jumps on through the forest\.|The frog is here)(, fighting [^\.!]+.|)" tfMobsubstHugeForestFrog = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The frog @{Cgreen}(N, 2, amphibian)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A lynx cub follows its parents, eager to learn\.|The lynx cub is here)(, fighting [^\.!]+.|)" tfMobsubstHugeForestLynxCub = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The lynx cub @{Cgreen}(N, 2, feline)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A wolf cub plays with its mother\.|The wolf cub is here)(, fighting [^\.!]+.|)" tfMobsubstHugeForestWolfCub = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The wolf cub @{Cgreen}(N, 2, canine)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A capercaillie mocks in the dirt\.|The capercaillie is here)(, fighting [^\.!]+.|)" tfMobsubstHugeForestCapercaillie = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The capercaillie @{Cgreen}(N, 3, bird)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A deer's tingling eyes softly peers your way\.|The deer is here)(, fighting [^\.!]+.|)" tfMobsubstHugeForestDeer = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The deer @{Cgreen}(N, 3, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An otter beats against a tree, ignoring you\.|The otter is here)(, fighting [^\.!]+.|)" tfMobsubstHugeForestOtter = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The otter @{Cgreen}(N, 3, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A reindeer stamps with its hooves on the ground\.|The reindeer is here)(, fighting [^\.!]+.|)" tfMobsubstHugeForestReindeer = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The reindeer @{Cgreen}(N, 3, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A wild horse neighs and rears at your appearance\.|The wild horse is here)(, fighting [^\.!]+.|)" tfMobsubstHugeForestWildHorse = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The wild horse @{Cgreen}(N, 3, ---)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A blackcock looks for someone to mate with\.|The blackcock is here)(, fighting [^\.!]+.|)" tfMobsubstHugeForestBlackcock = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The blackcock @{Cgreen}(N, 4, bird)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A ermine grits its teeth warningly\.|The ermine is here)(, fighting [^\.!]+.|)" tfMobsubstHugeForestErmine = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The ermine @{Cgreen}(N, 4, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A greyhen strutts around proudly\.|The greyhen is here)(, fighting [^\.!]+.|)" tfMobsubstHugeForestGreyhen = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The greyhen @{Cgreen}(N, 4, bird)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A mink is here, and its fur shimmers beautifully in the sunlight\.|The mink is here)(, fighting [^\.!]+.|)" tfMobsubstHugeForestMink = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The mink @{Cgreen}(N, 4, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An elk is here, struggling through the forest\.|The elk is here)(, fighting [^\.!]+.|)" tfMobsubstHugeForestElk = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The elk @{Cgreen}(N, 5, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A falcon sits on a treelimb, resting easily\.|The falcon is here)(, fighting [^\.!]+.|)" tfMobsubstHugeForestFalcon = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The falcon @{Cgreen}(N, 5, bird)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A hawk circles above you, peering hungrily\.|The hawk is here)(, fighting [^\.!]+.|)" tfMobsubstHugeForestHawk = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The hawk @{Cgreen}(N, 5, bird)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A lynx seems to be tracking something down\.|The lynx is here)(, fighting [^\.!]+.|)" tfMobsubstHugeForestLynx = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The lynx @{Cgreen}(N, 5, feline)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A badger digs in the dirt\.|The badger is here)(, fighting [^\.!]+.|)" tfMobsubstHugeForestBadger = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The badger @{Cgreen}(N, 6, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A beaver slaps its tail against a fallen tree\.|The beaver is here)(, fighting [^\.!]+.|)" tfMobsubstHugeForestBeaver = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The beaver @{Cgreen}(N, 6, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A toad croaks loudly\.|The toad is here)(, fighting [^\.!]+.|)" tfMobsubstHugeForestToad = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The toad @{Cgreen}(N, 6, amphibian)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A black bear growls with obvious hostility\.|The black bear is here)(, fighting [^\.!]+.|)" tfMobsubstHugeForestBlackBear = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The black bear @{Cgreen}(N, 7, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A brown bear growls with obvious hostility\.|The brown bear is here)(, fighting [^\.!]+.|)" tfMobsubstHugeForestBrownBear = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The brown bear @{Cgreen}(N, 7, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An eagle pierces through the air, in search for its next meal\.|The eagle is here)(, fighting [^\.!]+.|)" tfMobsubstHugeForestEagle = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The eagle @{Cgreen}(N, 7, bird)@{n}%{P2}%{PR}%; \
    /endif
/def -p100 -F -mregexp -t"(A snake slithers in the undergrowth\.|The snake is here)(, fighting [^\.!]+.|)" tfMobsubstHugeForestSnake = \
    /if (mobsubs & ({P1} !~ 'The snake is here' | area =~ 'HugeForest')) \
      /substitute -p %{PL}@{nCyellow}The snake @{Cgreen}(N, 7, snake)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A wild boar lowers its tusks, ready to charge\.|The wild boar is here)(, fighting [^\.!]+.|)" tfMobsubstHugeForestWildBoar = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The wild boar @{Cgreen}(N, 7, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A wild dog barks loudly\.|The wild dog is here)(, fighting [^\.!]+.|)" tfMobsubstHugeForestWildDog = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The wild dog @{Cgreen}(N, 7, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A wolf licks its lips, upon your appearance\.|The wolf is here)(, fighting [^\.!]+.|)" tfMobsubstHugeForestWolf = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The wolf @{Cgreen}(N, 7, canine)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A wolverine howls to the moon\.|The wolverine is here)(, fighting [^\.!]+.|)" tfMobsubstHugeForestWolverine = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The wolverine @{Cgreen}(N, 7, canine)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A poacher sneaks around, trying to find a prey\. \(invisible\)|The poacher \(invisible\) is here)(, fighting [^\.!]+.|)" tfMobsubstHugeForestPoacher = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The poacher @{Cgreen}(N, 8, human)@{n} (imp)%{P2}%{PR}%; \
    /endif

; -----------------------  Humblin  -----------------------
/def -p99 -F -mregexp -t"(A frisky brown rabbit bounces across the glen\.|A little brown rabbit is here)(, fighting [^\.!]+.|)" tfMobsubstHumblinBrownRabbit = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A little brown rabbit @{Cgreen}(N, 1, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A small white rabbit hops around you playfully\.|A little white rabbit is here)(, fighting [^\.!]+.|)" tfMobsubstHumblinWhiteRabbit = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A little white rabbit @{Cgreen}(N, 1, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A little chicken is here, pecking at some seeds\.|A small chicken is here)(, fighting [^\.!]+.|)" tfMobsubstHumblinChicken = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A small chicken @{Cgreen}(N, 1, bird)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A puny runt pig cowers in the corner of the pen\.|An anemic little runt pig is here)(, fighting [^\.!]+.|)" tfMobsubstHumblinAnemicPig = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An anemic little runt pig @{Cgreen}(N, 1, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A stubby little duck waddles around, quacking gregariously\.|A fat duck is here)(, fighting [^\.!]+.|)" tfMobsubstHumblinDuck = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A fat duck @{Cgreen}(N, 2, bird)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A hobbit trapper is here, checking his traps\.|A hobbit trapper is here, setting a snare\.|A hobbit trapper is here)(, fighting [^\.!]+.|)" tfMobsubstHumblinTrapper = \
    /if (mobsubs) \
      /if ({P1} =~ 'A hobbit trapper is here, checking his traps.') \
        /substitute -p %{PL}@{nCyellow}A hobbit trapper (checking) @{Cgreen}(N, 2, hobbit)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'A hobbit trapper is here, setting a snare.') \
        /substitute -p %{PL}@{nCyellow}A hobbit trapper (setting) @{Cgreen}(N, 2, hobbit)@{n}%{P2}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}A hobbit trapper (checking/setting) @{Cgreen}(N, 2, hobbit)@{n}%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(A cute grey bunny has found refuge here in the grove\.|A small grey rabbit is here, munching on some carrots\.|A small grey rabbit is here, nibbling on a leaf of lettuce\.|A little grey rabbit is here)(, fighting [^\.!]+.|)" tfMobsubstHumblinGreyRabbit = \
    /if (mobsubs) \
      /if ({P1} =~ 'A cute grey bunny has found refuge here in the grove.') \
        /substitute -p %{PL}@{nCyellow}A little grey rabbit (bunny) @{Cgreen}(N, 2, animal)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'A small grey rabbit is here, munching on some carrots.') \
        /substitute -p %{PL}@{nCyellow}A little grey rabbit (munching) @{Cgreen}(N, 2, animal)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'A small grey rabbit is here, nibbling on a leaf of lettuce.') \
        /substitute -p %{PL}@{nCyellow}A little grey rabbit (nibbling) @{Cgreen}(N, 2, animal)@{n}%{P2}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}A little grey rabbit (bunny/munching/nibbling) @{Cgreen}(N, 2, animal)@{n}%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(A silly goose honks and flaps its wings at you\.|A curious goose is here)(, fighting [^\.!]+.|)" tfMobsubstHumblinGoose = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A curious goose @{Cgreen}(N, 3, bird)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A hobbit farmer is here, checking the produce\.|A hobbit farmer is here, tending to the crop\.|A hobbit farmer is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHumblinFarmer = \
    /if (mobsubs) \
      /if ({P1} =~ 'A hobbit farmer is here, checking the produce.') \
        /substitute -p %{PL}@{nCyellow}A hobbit farmer (checking) @{Cgreen}(@{nCwhite}G@{nCgreen}, 3, hobbit)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'A hobbit farmer is here, tending to the crop.') \
        /substitute -p %{PL}@{nCyellow}A hobbit farmer (tending) @{Cgreen}(@{nCwhite}G@{nCgreen}, 3, hobbit)@{n}%{P2}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}A hobbit farmer (checking/tending) @{Cgreen}(@{nCwhite}G@{nCgreen}, 3, hobbit)@{n}%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(A frustrated hobbit trapper is here, grumbling about rabbits\.|Elmore Fodd, the rabbit trapper is here)(, fighting [^\.!]+.|)" tfMobsubstHumblinElmore = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Elmore Fodd, the rabbit trapper @{Cgreen}(N, 3, hobbit)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A small black sheep is here, grazing peacefully|A little black sheep is here)(, fighting [^\.!]+.|)" tfMobsubstHumblinBlackSheep = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A little black sheep @{Cgreen}(N, 4, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A small white sheep is here, munching on a mouthful of grass\.|A little white sheep is here)(, fighting [^\.!]+.|)" tfMobsubstHumblinWhiteSheep = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A little white sheep @{Cgreen}(N, 4, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A plump turkey runs up to you and starts gobbling wildly\.|A perturbed turkey is here)(, fighting [^\.!]+.|)" tfMobsubstHumblinTurkey = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A perturbed turkey @{Cgreen}(N, 4, bird)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A little pony is here, furrowing the fields for seeding\.|A small plow pony is here)(, fighting [^\.!]+.|)" tfMobsubstHumblinPony = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A small plow pony @{Cgreen}(N, 4, ---)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A small hobbit child is here, playing with her dolls\.|A small hobbit child is here, playing with his toys\.|A hobbit child is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHumblinChild = \
    /if (mobsubs) \
      /if ({P1} =~ 'A small hobbit child is here, playing with her dolls.') \
        /substitute -p %{PL}@{nCyellow}A hobbit child (dolls) @{Cgreen}(@{nCwhite}G@{nCgreen}, 5, hobbit)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'A small hobbit child is here, playing with his toys.') \
        /substitute -p %{PL}@{nCyellow}A hobbit child (toys) @{Cgreen}(@{nCwhite}G@{nCgreen}, 5, hobbit)@{n}%{P2}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}A hobbit child (dolls/toys) @{Cgreen}(@{nCwhite}G@{nCgreen}, 5, hobbit)@{n}%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(A hobbit shepherd is here, reciting horrible poetry\.|Jethro Tallfellow, the poetic hobbit shepherd is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHumblinJethro = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Jethro Tallfellow, the poetic hobbit shepherd @{Cgreen}(@{nCwhite}G@{nCgreen}, 5, hobbit)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A slack-jawed hobbit farmer is here, surveying the plot\.|Kleetus Jomes, the slack-jawed hobbit yokel is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHumblinKleetus = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Kleetus Jomes, the slack-jawed hobbit yokel @{Cgreen}(@{nCwhite}G@{nCgreen}, 5, hobbit)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A pig is here, rolling in the mud\.|A muddy pig is here)(, fighting [^\.!]+.|)" tfMobsubstHumblinPig = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A muddy pig @{Cgreen}(N, 6, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A little black cow is here, grazing contentedly\.|A small black cow is here)(, fighting [^\.!]+.|)" tfMobsubstHumblinBlackCow = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A small black cow @{Cgreen}(N, 6, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A little brown cow is here, chewing on its cud\.|A small brown cow is here)(, fighting [^\.!]+.|)" tfMobsubstHumblinBrownCow = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A small brown cow @{Cgreen}(N, 6, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A small hobbit villager smiles cheerfully as she strolls by\.|A small hobbit villager whistles merrily as he ambles by\.|A hobbit commoner is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHumblinCommoner = \
    /if (mobsubs) \
      /if ({P1} =~ 'A small hobbit villager smiles cheerfully as she strolls by.') \
        /substitute -p %{PL}@{nCyellow}A hobbit commoner (smiles) @{Cgreen}(@{nCwhite}G@{nCgreen}, 7, hobbit)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'A small hobbit villager whistles merrily as he ambles by.') \
        /substitute -p %{PL}@{nCyellow}A hobbit commoner (whistles) @{Cgreen}(@{nCwhite}G@{nCgreen}, 7, hobbit)@{n}%{P2}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}A hobbit commoner (smiles/whistles) @{Cgreen}(@{nCwhite}G@{nCgreen}, 7, hobbit)@{n}%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(A hobbit commoner purchases some fresh food\.|A hobbit shopper is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHumblinShopper = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A hobbit shopper @{Cgreen}(@{nCwhite}G@{nCgreen}, 7, hobbit)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A hobbit stands behind a wooden booth, hawking his wares\.|A hobbit vendor is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHumblinVendor = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A hobbit vendor @{Cgreen}(@{nCwhite}G@{nCgreen}, 7, hobbit)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A small bull stands here, eyeing you belligerently\.|A little black bull is here)(, fighting [^\.!]+.|)" tfMobsubstHumblinBull = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A little black bull @{Cgreen}(N, 7, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A portly hobbit stokes the hearth with some firewood\.|A hobbit father is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHumblinFather = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A hobbit father @{Cgreen}(@{nCwhite}G@{nCgreen}, 8, hobbit)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A cheery hobbit is here, cooking a delicious meal\.|A hobbit mother is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHumblinMother = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A hobbit mother @{Cgreen}(@{nCwhite}G@{nCgreen}, 8, hobbit)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An elderly hobbit sits here by the fire, telling old war tales\.|An old grandfather hobbit is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHumblinGrandfather = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An old grandfather hobbit @{Cgreen}(@{nCwhite}G@{nCgreen}, 8, hobbit)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An old hobbit sits here in a rocking chair, knitting a scarf\.|An old grandmother hobbit is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHumblinGrandmother = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An old grandmother hobbit @{Cgreen}(@{nCwhite}G@{nCgreen}, 8, hobbit)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A hobbit apprentice is busy helping run the bakery\.|A baker's apprentice is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHumblinBakApp = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A baker's apprentice @{Cgreen}(@{nCwhite}G@{nCgreen}, 10, hobbit)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A hobbit apprentice is here, helping around in the workshop\.|A bowyer's apprentice is here|A fletcher's apprentice is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHumblinBoFlApp = \
    /if (mobsubs) \
      /if ({P1} =~ "A bowyer's apprentice is here") \
        /substitute -p %{PL}@{nCyellow}A bowyer's apprentice @{Cgreen}(@{nCwhite}G@{nCgreen}, 10, hobbit)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ "A fletcher's apprentice is here") \
        /substitute -p %{PL}@{nCyellow}A fletcher's apprentice @{Cgreen}(@{nCwhite}G@{nCgreen}, 10, hobbit)@{n}%{P2}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}A bowyer's/fletcher's apprentice @{Cgreen}(@{nCwhite}G@{nCgreen}, 10, hobbit)@{n}%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(A hobbit kneels here in solemn prayer\.|A hobbit worshipper is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHumblinWorshipper = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A hobbit worshipper @{Cgreen}(@{nCwhite}G@{nCgreen}, 10, hobbit)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A hobbit apprentice is busy helping run the mill\.|A miller's apprentice is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHumblinMillApp = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A miller's apprentice @{Cgreen}(@{nCwhite}G@{nCgreen}, 10, hobbit)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A hobbit apprentice is busy helping run the tannery\.|A tanner's apprentice is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHumblinTanApp = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A tanner's apprentice @{Cgreen}(@{nCwhite}G@{nCgreen}, 10, hobbit)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A hobbit worker busily fashions steel reinforcement bolts\.|Amos Jakobson, the son of Jakob Jakobson is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHumblinAmos = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Amos Jakobson, the son of Jakob Jakobson @{Cgreen}(@{nCwhite}G@{nCgreen}, 10, hobbit)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A hobbit worker is here, building temporary wooden supports\.|Ezra Jakobson, the son of Jakob Jakobson is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHumblinEzra = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Ezra Jakobson, the son of Jakob Jakobson @{Cgreen}(@{nCwhite}G@{nCgreen}, 10, hobbit)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An old hobbit worker is here, hoisting a wall frame into place\.|Jakob Jakobson, the barn raising hobbit is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHumblinJakob = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Jakob Jakobson, the barn raising hobbit @{Cgreen}(@{nCwhite}G@{nCgreen}, 10, hobbit)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A hobbit worker helps position the placement of a barn wall\.|Jebediah Jakobson, the son of Jakob Jakobson is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHumblinJebediah = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Jebediah Jakobson, the son of Jakob Jakobson @{Cgreen}(@{nCwhite}G@{nCgreen}, 10, hobbit)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A hobbit druidess is here, preparing for an animistic ritual\.|A hobbit druidess is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHumblinDruidess = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A hobbit druidess @{Cgreen}(@{nCwhite}G@{nCgreen}, 12, hobbit)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An armoured hobbit is here, watching over the village\.|A hobbit guard is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHumblinGuard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A hobbit guard @{Cgreen}(@{nCwhite}G@{nCgreen}, 12, hobbit)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A fat hobbit miller is here, talking nonsensically to himself\.|Bobbob Dillum, the blabbering hobbit miller is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHumblinBobbob = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Bobbob Dillum, the blabbering hobbit miller @{Cgreen}(@{nCwhite}G@{nCgreen}, 12, hobbit)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An old hobbit bowyer is here, crafting a fine short bow\.|Bupkus Goggins, the rheumatic hobbit bowyer is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHumblinBupkus = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Bupkus Goggins, the rheumatic hobbit bowyer @{Cgreen}(@{nCwhite}G@{nCgreen}, 12, hobbit)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A stocky hobbit is here, curing leathers with various tannins\.|Cobble van Daleskipper, the hobbit tanner is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHumblinCobble = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Cobble van Daleskipper, the hobbit tanner @{Cgreen}(@{nCwhite}G@{nCgreen}, 12, hobbit)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An amusing hobbit bard is here, singing about wild horses\.|Durrow Linstones, the hobbit bard is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHumblinDurrow = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Durrow Linstones, the hobbit bard @{Cgreen}(@{nCwhite}G@{nCgreen}, 12, hobbit)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A hobbit breadmistress is here, displaying her sweet buns\.|Kia Softfoot, the hobbit breadmistress is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHumblinKia = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Kia Softfoot, the hobbit breadmistress @{Cgreen}(@{nCwhite}G@{nCgreen}, 12, hobbit)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An irritated hobbit fletcher is here, trying to make an arrow\.|Wilbur Bonkfist, the irascible hobbit fletcher is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHumblinWilbur = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Wilbur Bonkfist, the irascible hobbit fletcher @{Cgreen}(@{nCwhite}G@{nCgreen}, 12, hobbit)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An old hobbit animist is here, conducting a druidic ritual\.|Woodwob Greenheart, the hobbit animist is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHumblinWoodwob = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Woodwob Greenheart, the hobbit animist @{Cgreen}(@{nCwhite}G@{nCgreen}, 14, hobbit)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An old hobbit lounges here, reminiscing of past adventures\.|Mulwig Knotheels, the retired hobbit wayfarer is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHumblinMulwig = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Mulwig Knotheels, the retired hobbit wayfarer @{Cgreen}(@{nCwhite}G@{nCgreen}, 15, QM)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A stout hobbit sits at a desk, reading and writing documents\.|Theodorus Tubblewick, the Shiriff of Humblin is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstHumblinTheodorus = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Theodorus Tubblewick, the Shiriff of Humblin @{Cgreen}(@{nCwhite}G@{nCgreen}, 15, hobbit)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The killer bee tries to sting you!|The Killer Bee is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstHumblinBee = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Killer Bee @{Cgreen}(@{nCred}E@{nCgreen}, 51, insect)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Ice Area  -----------------------
/def -p99 -F -mregexp -t"(A Royal Servant is here, wandering around aimlessly\.|A Royal Servant is here)(, fighting [^\.!]+.|)" tfMobsubstIceAreaServant = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Royal Servant @{Cgreen}(N, 30, ---)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Wise Man sits here, meditating\.|A Wise Man is here)(, fighting [^\.!]+.|)" tfMobsubstIceAreaWiseMan = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Wise Man @{Cgreen}(N, 40, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An Ice Lizard Guard stands here, guarding his area\.|An Ice Lizard Guard is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstIceAreaGuard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An Ice Lizard Guard @{Cgreen}(@{nCwhite}G@{nCgreen}, 40, ---, protector)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Ice Lizard Prince stands here admiring himself\.|The Ice Lizard Prince is here)(, fighting [^\.!]+.|)" tfMobsubstIceAreaPrince = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Ice Lizard Prince @{Cgreen}(N, 40, ---)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Ice Sphinx stands here, purring contently\.|The Ice Sphinx is here)(, fighting [^\.!]+.|)" tfMobsubstIceAreaIceSphinx = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Ice Sphinx @{Cgreen}(N, 40, bird)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(;The Mastadon stands here, looking rather massive\. \(hidden\)|The Mastadon \(hidden\) is here)(, fighting [^\.!]+.|)" tfMobsubstIceAreaMastadon = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Mastadon @{Cgreen}(N, 40, ---/fire)@{n} (hide)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Frost Giant stands here, viewing the mountains\.|A Frost Giant is here)(, fighting [^\.!]+.|)" tfMobsubstIceAreaFrostGiant = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Frost Giant @{Cgreen}(N, 45, giant)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Hippogriff attacks your weak party!|A Hippogriff is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstIceAreaHippogriff = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Hippogriff @{Cgreen}(@{nCred}E@{nCgreen}, 45, bird)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An Ice Hulk is here, and doesn't look too happy about your presence.|An Ice Hulk is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstIceAreaIceHulk = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An Ice Hulk @{Cgreen}(@{nCred}E@{nCgreen}, 45, magical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An Ice Minotaur looks down on you and waves goodbye to you\.|An Ice Minotaur is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstIceAreaMinotaur = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An Ice Minotaur @{Cgreen}(@{nCred}E@{nCgreen}, 45, ---)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Ice Lizard Princess stands here, gloating with royalty\.|The Ice Lizard Princess is here)(, fighting [^\.!]+.|)" tfMobsubstIceAreaPrincess = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Ice Lizard Princess @{Cgreen}(N, 45, ---)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Frost Ogre stands here, grinning to himself\.|A Frost Ogre is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstIceAreaOgre = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Frost Ogre @{Cgreen}(@{nCred}E@{nCgreen}, 50, lugroki)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Ancient White Dragon emerges from his cave and attacks!|The Ancient White Dragon is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstIceAreaWhiteDragon = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Ancient White Dragon @{Cgreen}(@{nCred}E@{nCgreen}, 50, dragon)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Remorhaz rises out of his sleep and attacks!|The Remorhaz is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstIceAreaRemorhaz = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Remorhaz @{Cgreen}(@{nCred}E@{nCgreen}, 55, dragon)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Ancient Ice Dragon hides here, waiting for his next meal\.|The Ancient Ice Dragon is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstIceAreaIceDragon = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Ancient Ice Dragon @{Cgreen}(@{nCred}E@{nCgreen}, 60, dragon)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Ice Lizard Queen is here, smiling at you\.|The Ice Lizard Queen is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstIceAreaQueen = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Ice Lizard Queen @{Cgreen}(@{nCred}E@{nCgreen}, 65, ---)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Ice Lizard King is here, ordering you to bow to him\.|The Ice Lizard King is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstIceAreaKing = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Ice Lizard King @{Cgreen}(@{nCred}E@{nCgreen}, 70, ---)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Ice Castle  -----------------------
/def -p99 -F -mregexp -t"(An Icicle is hanging from the roof here\. \(invisible\)|An Icicle \(invisible\) is here)(, fighting [^\.!]+.|)" tfMobsubstIceCastleIcicle = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An Icicle @{Cgreen}(N, 5, magical)@{n} (imp)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The paper boy is standing here screaming out news\.|The Paper Boy is here)(, fighting [^\.!]+.|)" tfMobsubstIceCastlePaperBoy = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Paper Boy @{Cgreen}(N, 25, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A large polar bear is here looking for food \(invisible\)|The Polar Bear \(invisible\) is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstIceCastlePolarBear = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Polar Bear @{Cgreen}(@{nCwhite}G@{nCgreen}, 39, animal)@{n} (imp)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Snowman is here juggling snowballs\. \(invisible\)|The Snowman \(invisible\) is here)(, fighting [^\.!]+.|)" tfMobsubstIceCastleSnowman = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Snowman @{Cgreen}(N, 45, insubstantial)@{n} (imp)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Guard made of solid ice is standing here|The Guard of Ice is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstIceCastleGuardOfIce = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Guard of Ice @{Cgreen}(@{nCred}E@{nCgreen}, 55, human/fire)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Guardian is standing here|The Guardian of the Stair is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstIceCastleGuardian = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Guardian of the Stair @{Cgreen}(@{nCred}E@{nCgreen}, 55, magical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Guard made of solid ice is standing here|The Ice Guard is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstIceCastleIceGuard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Ice Guard @{Cgreen}(@{nCred}E@{nCgreen}, 60, human/fire)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A beam of light catches your eyes\.|The dancing lightbeam is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstIceCastleLightbeam = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The dancing lightbeam @{Cgreen}(@{nCred}E@{nCgreen}, 85, magical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A strong looking man is standing here and is dressed entirely in ice\.|King Aryan is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstIceCastleKing = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}King Aryan @{Cgreen}(@{nCwhite}G@{nCgreen}, 95, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A very beatiful lady dressed in flowers is here \(invisible\)|The Lady of Summer \(invisible\) is standing here\.|The Lady of Summer \(invisible\) is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstIceCastleLady = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Lady of Summer @{Cgreen}(@{nCwhite}G@{nCgreen}, 95, botanic)@{n} (imp)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Spring is here defrosting all the ice\.|The Spring Ruler is( standing|) here)(\.|)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstIceCastleSpringRuler = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Spring Ruler @{Cgreen}(@{nCwhite}G@{nCgreen}, 95, botanic)@{n}%{P2}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An ugly looking witch is leering at you\.|The Evil Witch of Greyscale is( standing|) here)(\.|)(, fighting [^\.!]+.|)(\.|)( \(Red Aura\)|)" tfMobsubstIceCastleWitch = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Evil Witch of Greyscale @{Cgreen}(@{nCred}E@{nCgreen}, 95, magical)@{n}%{P2}%{P4}%{PR}%; \
    /endif

; -----------------------  Ice Caves  -----------------------
/def -p99 -F -mregexp -t"(A few chunks of ice lies here on the floor\.|Some ice cubes is here)(, fighting [^\.!]+.|)" tfMobsubstIceCavesIceCubes = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Some ice cubes @{Cgreen}(N, 7, entity)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A slimy blood snake slithers around in the darkness\. \(hidden\)|A blood snake \(hidden\) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstIceCavesSnake = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A blood snake @{Cgreen}(@{nCred}E@{nCgreen}, 10, snake)@{n} (hide)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A murderous black penguin waddles around in the snow and filth\.|A killer penguin is here)(, fighting [^\.!]+.|)" tfMobsubstIceCavesPenguin = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A killer penguin @{Cgreen}(N, 13, bird)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A large shaggy brown bear is here, gnawing on some bones\.|A brown bear is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstIceCavesBear = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A brown bear @{Cgreen}(@{nCred}E@{nCgreen}, 15, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A crazy wild man, howling a blood-curling scream, runs toward you\.|A wild man is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstIceCavesWildMan = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A wild man @{Cgreen}(@{nCred}E@{nCgreen}, 15, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A large sluggish creature wanders around the cave\.|An ice sloth is here)(, fighting [^\.!]+.|)" tfMobsubstIceCavesSloth = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An ice sloth @{Cgreen}(N, 15, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A frozen corpse shuffles about in the snow\.|A snow zombie is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstIceCavesZombie = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A snow zombie @{Cgreen}(@{nCred}E@{nCgreen}, 20, undead)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A large fuzzy snowman is here, moping around\.|A snowman is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstIceCavesSnowman = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A snowman @{Cgreen}(@{nCred}E@{nCgreen}, 20, entity)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A large iceman is here, blending into the surroundings\.|An iceman is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstIceCavesIceman = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An iceman @{Cgreen}(@{nCred}E@{nCgreen}, 23, entity)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A towering man of ice sits here overseeing his subjects\.|The ice king is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstIceCavesKing = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The ice king @{Cgreen}(@{nCred}E@{nCgreen}, 25, elemental)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A towering bundle of fur stands here grinning\. \(hidden\)|The yeti \(hidden\) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstIceCavesYeti = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The yeti @{Cgreen}(@{nCred}E@{nCgreen}, 27, lugroki)@{n} (hide)%{P2}%{PR}%; \
    /endif

; -----------------------  Ice Wall  -----------------------
/def -p99 -F -mregexp -t"(The kid stares at you with an innocent look in his eye\.( \(invisible\)|)|Kid( \(invisible\)|) is here)(, fighting [^\.!]+.|)" tfMobsubstIceWallKid = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}Kid @{Cgreen}(N, 20, human)@{n}%{invisTxt}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The puppy dog comes running and licks your face\.|Puppy Dog is here)(, fighting [^\.!]+.|)" tfMobsubstIceWallPuppyDog = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Puppy Dog @{Cgreen}(N, 20, canine)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Thanoi is standing here|Thanoi( \(invsible\)|) is here)(, fighting [^\.!]+.|)( \(invsible\)|)" tfMobsubstIceWallThanoi = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Thanoi @{Cgreen}(N, 35, magical)@{n}%{P2}%{P4}%{P3}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Aurak Draconian rushes to attack you\.|An Aurak Draconian is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstIceWallAurakDraconian = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An Aurak Draconian @{Cgreen}(@{nCred}E@{nCgreen}, 40, magical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The harbor guard watches your every move|Harbor Guard( \(invsible\)|) is here)(, fighting [^\.!]+.|)( \(invsible\)|)" tfMobsubstIceWallHarborGuard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Harbor Guard @{Cgreen}(N, 40, human)@{n}%{P2}%{P4}%{P3}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Baaz Draconian removes his hood and attacks you\.|A Baaz Draconian is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstIceWallBaazDraconian = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Baaz Draconian @{Cgreen}(@{nCred}E@{nCgreen}, 43, magical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Bozak Draconian begins to mumble words of magic at your approach\.|A Bozak Draconian is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstIceWallBozakDraconian = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Bozak Draconian @{Cgreen}(@{nCred}E@{nCgreen}, 45, magical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An enraged Indian's fan attacks you\.|Indian's fan is here)(, fighting [^\.!]+.|)" tfMobsubstIceWallIndiansFan = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Indian's fan @{Cgreen}(N, 45, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Kapak Draconian licks his weapon and attacks\.|A Kapak Draconian is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstIceWallKapakDraconian = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Kapak Draconian @{Cgreen}(@{nCred}E@{nCgreen}, 47, magical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The backgroud melts into an image of a Sivak Draconian\.|A Sivak Draconian is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstIceWallSivakDraconian = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Sivak Draconian @{Cgreen}(@{nCred}E@{nCgreen}, 50, magical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An Ice Minotaur is enraged that you have entered his lair\.|Ice Minotaur is here)(, fighting [^\.!]+.|)" tfMobsubstIceWallIceMinotaur = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Ice Minotaur @{Cgreen}(@{nCred}E@{nCgreen}, 50, ---)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The remorhaz hatchling snarls its defiance at you!|The remorhaz hatchling is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstIceWallHatchling = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The remorhaz hatchling @{Cgreen}(@{nCred}E@{nCgreen}, 55, dragon)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Reverend Beverage is here tapping his personal keg\.|Reverend Beverage is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstIceWallReverendBeverage = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Reverend Beverage @{Cgreen}(@{nCwhite}G@{nCgreen}, 60, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Feal Thas is standing here ready to attack\.|Feal Thas is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstIceWallFealThas = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Feal Thas @{Cgreen}(@{nCred}E@{nCgreen}, 70, elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Mist here creeps along the floor\.|The Mist is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstIceWallMist = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Mist @{Cgreen}(@{nCred}E@{nCgreen}, 75, insubstantial)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Chief Wahoo is standing here with a shit eating grin on his face|Chief Wahoo is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstIceWallChiefWahoo = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Chief Wahoo @{Cgreen}(@{nCwhite}G@{nCgreen}, 80, human, summoner)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Remorhaz is standing here drooling at your presence\.( \(invisible\)|)|Remorhaz( \(invisible\)|) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstIceWallRemorhaz = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}Remorhaz @{Cgreen}(@{nCred}E@{nCgreen}, 80, dragon)@{n}%{invisTxt}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Sleet peers at you through glassy eyes\.|Sleet is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstIceWallSleet = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Sleet @{Cgreen}(@{nCred}E@{nCgreen}, 80, dragon, special-freeze)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Impact  -----------------------
/def -p99 -F -mregexp -t"(A large insect buzzes around around your head angrily\.|A large flying insect is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstImpactInsect = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A large flying insect @{Cgreen}(@{nCred}E@{nCgreen}, 10, insect)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A rotten hand is here, flying in the air\.|A rotten hand is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstImpactHand = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A rotten hand @{Cgreen}(@{nCred}E@{nCgreen}, 10, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A smelly foot stinks up the room\.|A smelly foot is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstImpactFoot = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A smelly foot @{Cgreen}(@{nCred}E@{nCgreen}, 10, undead)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A small bug is here, trying to hide\.|A small bug is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstImpactBug = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A small bug @{Cgreen}(@{nCred}E@{nCgreen}, 12, insect)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Some dark material is lying on the floor\.|Some dark material is here)(, fighting [^\.!]+.|)" tfMobsubstImpactMaterial = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Some dark material @{Cgreen}(N, 13, entity)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(an evil bat is here, hanging in the plants\.( \(invisible\)|)|A murderous bat( \(invisible\)|) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstImpactBat = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}A murderous bat @{Cgreen}(@{nCred}E@{nCgreen}, 14, rodent)@{n}%{invisTxt}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A big creature is shambling around here aimlessly\.|A big creature is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstImpactBigCreature = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A big creature @{Cgreen}(@{nCred}E@{nCgreen}, 15, magical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A carnivorous plant is growing here in the dark\.|A carnivorous plant is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstImpactPlant = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A carnivorous plan @{Cgreen}(@{nCred}E@{nCgreen}, 15, botanic)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A huge eye with bat wings flies around in circles, the whole time staring at you\.|A huge eye is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstImpactHugeEye = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A huge eye @{Cgreen}(@{nCred}E@{nCgreen}, 15, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A jumping stone sits here menacingly\.|A jumping stone is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstImpactJumpingStone = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A jumping stone @{Cgreen}(@{nCred}E@{nCgreen}, 15, demon)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A slithering green snake is resting here\.|A slithering green snake is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstImpactSnake = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A slithering green snake @{Cgreen}(@{nCred}E@{nCgreen}, 22, reptile)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(a heavy lizard is resting here\.|A heavy lizard is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstImpactLizard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A heavy lizard @{Cgreen}(@{nCred}E@{nCgreen}, 25, fire)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(a black haired beast is standing here\.|A black haired beast is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstImpactBeast = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A black haired beast @{Cgreen}(@{nCred}E@{nCgreen}, 30, reptile)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(an Evil watchman is here guarding the hole\.|A Watchman of the Dark is standing here\.|A Watchman of the Dark is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstImpactWatchman = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Watchman of the Dark @{Cgreen}(@{nCred}E@{nCgreen}, 30, human?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Master Brain is resting here\.|The Master Brain is here circling around in the air\.|The Master Brain is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstImpactBrain = \
    /let mobName=@{nCyellow}The Master Brain @{Cgreen}(@{nCred}E@{nCgreen}, 39, ???)@{n}%; \
    /if (mobsubs) \
      /if ({P1} =~ "The Master Brain is resting here.") \
        /substitute%; \
        /def -p99 -F -n1 -mregexp -t"An evil thought is here floating in the air, surrounding all the cave\\.( \\(Red Aura\\)|)" tfMobsubstSpecial = \
        /substitute -p %%{PL}%{mobName}%%{PR}%; \
      /else \
        /substitute -p %{PL}%{mobName}%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(a glowing white angel is here, floating in the air\.|A bright angel is here)(, fighting [^\.!]+.|)" tfMobsubstImpactAngel = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A bright angel @{Cgreen}(N, 100, human)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Inferno  -----------------------
/def -p99 -F -mregexp -t"(A Feot is snooping around here looking for edibles\.|A Feot is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstInfernoFeot = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Feot @{Cgreen}(@{nCred}E@{nCgreen}, 36, magical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Grulch is poking in the dirt trying to find some food\.|A Grulch is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstInfernoGrulch = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Grulch @{Cgreen}(@{nCred}E@{nCgreen}, 43, demon)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A rotting head of a ugly creature is floating in the air here\.|A dead rotten head is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstInfernoRottenHead = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A dead rotten head @{Cgreen}(@{nCred}E@{nCgreen}, 55, undead)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A berserking ghoul is here wrecking the place\.|The rampaging ghoul is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstInfernoGhoul = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The rampaging ghoul @{Cgreen}(@{nCred}E@{nCgreen}, 60, undead)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The weary soul of a once great person floats back and forth|A lost soul( \(invisible\)|) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstInfernoLostSoul = \
    /let mobName=@{nCyellow}A lost soul @{Cgreen}(@{nCred}E@{nCgreen}, 63, undead)@{n}%; \
    /if (mobsubs & {P1} !~ "The weary soul of a once great person floats back and forth") \
      /if ({P2} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}%{mobName}%{invisTxt}%{P3}%{PR}%; \
    /elseif (mobsubs) \
      /substitute%; \
      /def -p99 -F -n1 -mregexp -t"here\\.( \\(invisible\\)|)( \\(Red Aura\\)|)" tfMobsubstSpecial = \
        /if ({P1} =~ " (invisible)") \
          /let invisTxt= (invis)%%; \
        /else \
          /let invisTxt=%%; \
        /endif%%; \
        /substitute -p %%{PL}%{mobName}%%{invisTxt}%%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An awful looking pile of demonic flesh shambles towards a|A SprecC demon is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstInfernoSprecC = \
    /let mobName=@{nCyellow}A SprecC demon @{Cgreen}(@{nCred}E@{nCgreen}, 67, demon)@{n}%; \
    /if (mobsubs & {P1} =~ 'A SprecC demon is here') \
      /substitute -p %{PL}%{mobName}%{P2}%{PR}%; \
    /elseif (mobsubs) \
      /substitute%; \
      /def -p99 -F -n1 -mregexp -t"^corner\\.( \\(Red Aura\\)|)" tfMobsubstSpecial = \
        /substitute -p %%{PL}%{mobName}%%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A filthy-looking demon with torn up wings sits here, looking|A fallen angel( \(invisible\)|) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstInfernoFallenAngel = \
    /let mobName=@{nCyellow}A fallen angel @{Cgreen}(@{nCred}E@{nCgreen}, 70, demon)@{n}%; \
    /if (mobsubs & {P1} !~ "A filthy-looking demon with torn up wings sits here, looking") \
      /if ({P2} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}%{mobName}%{invisTxt}%{P3}%{PR}%; \
    /elseif (mobsubs) \
      /substitute%; \
      /def -p99 -F -n1 -mregexp -t"forlorn\\.( \\(invisible\\)|)( \\(Red Aura\\)|)" tfMobsubstSpecial = \
        /if ({P1} =~ " (invisible)") \
          /let invisTxt= (invis)%%; \
        /else \
          /let invisTxt=%%; \
        /endif%%; \
        /substitute -p %%{PL}%{mobName}%%{invisTxt}%%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A devil of the lower ranks is pacing back and forth\.|The minor devil is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstInfernoMinorDevil = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The minor devil @{Cgreen}(@{nCred}E@{nCgreen}, 72, devil)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A large self confident looking devil is standing here\.\.\. watching|The major devil( \(invisible\)|) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstInfernoMajorDevil = \
    /let mobName=@{nCyellow}The major devil @{Cgreen}(@{nCred}E@{nCgreen}, 78, devil, resist iron)@{n}%; \
    /if (mobsubs & {P1} !~ "A large self confident looking devil is standing here... watching") \
      /if ({P2} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}%{mobName}%{invisTxt}%{P3}%{PR}%; \
    /elseif (mobsubs) \
      /substitute%; \
      /def -p99 -F -n1 -mregexp -t"you!( \\(invisible\\)|)( \\(Red Aura\\)|)" tfMobsubstSpecial = \
        /if ({P1} =~ " (invisible)") \
          /let invisTxt= (invis)%%; \
        /else \
          /let invisTxt=%%; \
        /endif%%; \
        /substitute -p %%{PL}%{mobName}%%{invisTxt}%%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A huge sentry looms over you|A huge sentry is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstInfernoSentry = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A huge sentry @{Cgreen}(@{nCred}E@{nCgreen}, 93, dragon)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An elvish looking character is doing his best to hide here\. \(hidden\)|Nerfarim the elf ranger \(hidden\) is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstInfernoNerfarim = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Nerfarim the elf ranger @{Cgreen}(@{nCwhite}G@{nCgreen}, 99, elf, resist WEAPON, vest-irvs)@{n} (hide) (NOT INVIS??)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Jirikai watches you carefully as you approach\.( \(invisible\)|)|Jirikai the Methuselah( \(invisible\)|) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstInfernoJirikai = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}Jirikai the Methuselah @{Cgreen}(@{nCred}E@{nCgreen}, 100, vampire)@{n}%{invisTxt}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(King Toric, the ruler of Inferno snarls furiously as you cower before him\.|King Toric is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstInfernoToric = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}King Toric @{Cgreen}(@{nCred}E@{nCgreen}, 100, dragon)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Inglestone  -----------------------
/def -p99 -F -mregexp -t"(A chicken is wandering the streets here|The chicken is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstInglestoneChicken = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The chicken @{Cgreen}(@{nCred}E@{nCgreen}, 5, bird)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A dwarven child stands here looking for something to do|A lonely dwarven child is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstInglestoneLonelyChild = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A lonely dwarven child @{Cgreen}(@{nCwhite}G@{nCgreen}, 14, dwarf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A dwarven child plays happily here|A dwarven child is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstInglestoneChild = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A dwarven child @{Cgreen}(@{nCwhite}G@{nCgreen}, 15, dwarf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A dwarven shopper wanders around looking for bargains|A dwarven shopper is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstInglestoneShopper = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A dwarven shopper @{Cgreen}(@{nCwhite}G@{nCgreen}, 23, dwarf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A dwarven squire goes about his daily chores|A dwarven squire is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstInglestoneSquire = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A dwarven squire @{Cgreen}(@{nCwhite}@{nCgreen}, 23, dwarf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A fat dwarf stands here stuffing himself with roasted chicken|A fat dwarf is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstInglestoneFatDwarf = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A fat dwarf @{Cgreen}(@{nCwhite}G@{nCgreen}, 23, dwarf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A dwarven citizen rushes through the streets|A dwarven citizen is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstInglestoneCitizen = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A dwarven citizen @{Cgreen}(@{nCwhite}G@{nCgreen}, 25, dwarf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(a mountain goblin stands here|A mountain goblin is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstInglestoneMountainGoblin = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A mountain goblin @{Cgreen}(@{nCred}E@{nCgreen}, 25, lugroki)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A dwarven courier moves quickly through the streets|The dwarven courier is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstInglestoneCourier = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The dwarven courier @{Cgreen}(@{nCwhite}G@{nCgreen}, 27, dwarf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A dwarven peddler stands his displaying his goods|The dwarven peddler is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstInglestonePeddler = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The dwarven peddler @{Cgreen}(@{nCwhite}G@{nCgreen}, 27, dwarf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A bloodworm drone flails about on the floor|A bloodworm flails about on the floor|A bloodworm is here)(, fighting [^\.!]+.|)" tfMobsubstInglestoneBloodworm = \
    /if (mobsubs) \
      /if ({P1} =~ 'A bloodworm drone flails about on the floor') \
        /substitute -p %{PL}@{nCyellow}A bloodworm (drone) @{Cgreen}(N, 30, snake)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'A bloodworm flails about on the floor') \
        /substitute -p %{PL}@{nCyellow}A bloodworm (flails) @{Cgreen}(N, 30, snake)@{n}%{P2}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}A bloodworm (drone/flails) @{Cgreen}(N, 30, snake)@{n}%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(A drow mercenary casually stands here|A drow mercenary is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstInglestoneDrowMerc = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A drow mercenary @{Cgreen}(@{nCred}E@{nCgreen}, 35, lugroki)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A dwarven dishwasher looks at you happily|A dwarven dishwasher is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstInglestoneDishwasher = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A dwarven dishwasher @{Cgreen}(@{nCwhite}G@{nCgreen}, 35, dwarf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A dwarven guard stands here looking at you curiously|A dwarven guard walks the streets here looking for intruders|A heavily armoured dwarven guard is here)(, fighting [^\.!]+.|)" tfMobsubstInglestoneArmouredGuard = \
    /if (mobsubs) \
      /if ({P1} =~ 'A dwarven guard stands here looking at you curiously') \
        /substitute -p %{PL}@{nCyellow}A heavily armoured dwarven guard (curio) @{Cgreen}(N, 35, dwarf)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'A dwarven guard walks the streets here looking for intruders') \
        /substitute -p %{PL}@{nCyellow}A heavily armoured dwarven guard (intru) @{Cgreen}(N, 35, dwarf)@{n}%{P2}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}A heavily armoured dwarven guard (curio/intru) @{Cgreen}(N, 35, dwarf)@{n}%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(A dwarven warrior is here walking the streets|A dwarven warrior is here)(, fighting [^\.!]+.|)" tfMobsubstInglestoneDwarvenWarrior = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A dwarven warrior @{Cgreen}(N, 36, dwarf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A apprentice rogue sneaks around looking for bloodworms to backstab|A rogue apprentice is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstInglestoneRogueApp = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A rogue apprentice @{Cgreen}(@{nCred}E@{nCgreen}, 36, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A warlock apprentice goes about his daily chores|A warlock apprentice is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstInglestoneWarlockApp = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A warlock apprentice @{Cgreen}(@{nCred}E@{nCgreen}, 36, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An orcish fighter stands here peering around nervously|An orcish fighter is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstInglestoneOrcishFighter = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An orcish fighter @{Cgreen}(@{nCred}E@{nCgreen}, 36, lugroki)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A dwarven cook stands here peering at you|The dwarven cook is here)(, fighting [^\.!]+.|)" tfMobsubstInglestoneCook = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The dwarven cook @{Cgreen}(@{nCwhite}G@{nCgreen}, 40, no-attack)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A wicked looking half-orc warrior stands here|A half-orc warrior is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstInglestoneHalforcWarrior = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A half-orc warrior @{Cgreen}(@{nCred}E@{nCgreen}, 42, lugroki)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A regal looking dwarven captain stands here|A heavily armoured dwarven guard captain is here)(, fighting [^\.!]+.|)" tfMobsubstInglestoneCaptain = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A heavily armoured dwarven guard captain @{Cgreen}(N, 42, dwarf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An ogre stands here looking for something to pummel into the rock |An ogre is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstInglestoneAnOgre = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An ogre @{Cgreen}(@{nCred}E@{nCgreen}, 50, lugroki)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A dwarven champion is here blocking your way east|The dwarven champion tries to stop you from reaching the stairs!|The Dwarven champion is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstInglestoneDwarvenChamp = \
    /if (mobsubs) \
      /if ({P1} =~ 'A dwarven champion is here blocking your way east') \
        /substitute -p %{PL}@{nCyellow}The Dwarven champion (blocking) @{Cgreen}(N, 50, dwarf)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'The dwarven champion tries to stop you from reaching the stairs!' | {P3} =~ ' (White Aura)') \
        /substitute -p %{PL}@{nCyellow}The Dwarven champion (stop) @{Cgreen}(@{nCwhite}G@{nCgreen}, 60, dwarf)@{n}%{P2}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}The Dwarven champion (blocking/stop) @{Cgreen}(N/@{nCwhite}G@{nCgreen}, 50/60, dwarf)@{n}%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(A large brown troll stands here smacking its lips at you|A large brown troll is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstInglestoneTroll = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A large brown troll @{Cgreen}(@{nCred}E@{nCgreen}, 50, troll)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A mountain giant stands here looking around stupidly|A big gray mountain giant is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstInglestoneMountainGiant = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A big gray mountain giant @{Cgreen}(@{nCred}E@{nCgreen}, 55, lugroki)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A half-ogre stands here swinging his lips from side to side|A half-ogre with a huge set of lips is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstInglestoneHalfOgre = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A half-ogre with a huge set of lips @{Cgreen}(@{nCred}E@{nCgreen}, 55, lugroki)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A large spider clings to you and tries to suck the life from your veins!|A huge vampiric spider is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstInglestoneSpider = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A huge vampiric spider @{Cgreen}(@{nCred}E@{nCgreen}, 60, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The \*HUGE\* bloodworm queen fills the room|A bloodworm queen is here)(, fighting [^\.!]+.|)" tfMobsubstInglestoneQueen = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A bloodworm queen @{Cgreen}(N, 60, snake)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A large half-giant sergeant sits here in chair of stone|The half-giant sergeant is sitting here\.|The half-giant sergeant is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstInglestoneHGSergeant = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The half-giant sergeant @{Cgreen}(@{nCred}E@{nCgreen}, 60, lugroki)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A half-giant fighter stands here glaring everything, even you!|A half-giant fighter is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstInglestoneHGFighter = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A half-giant fighter @{Cgreen}(@{nCred}E@{nCgreen}, 61, lugroki)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Chaos Knight stands here commanding his troops|A Chaos Knight is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstInglestoneChaosKnight = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Chaos Knight @{Cgreen}(@{nCred}E@{nCgreen}, 75, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(a Dwarven high champion patrols the hall looking for intruders|Dwarven high champion is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstInglestoneHighChamp = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Dwarven high champion @{Cgreen}(@{nCwhite}G@{nCgreen}, 75, dwarf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(a Dwarven warrior priest stands here|Dwarven warrior priest is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstInglestoneWarriorPriest = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Dwarven warrior priest @{Cgreen}(@{nCwhite}G@{nCgreen}, 80, dwarf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Chaos Knight Sergeant stands here pondering the boulders situation|A Chaos Knight Sergeant is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstInglestoneCKSergeant = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Chaos Knight Sergeant @{Cgreen}(@{nCred}E@{nCgreen}, 85, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Chaos Rogue leans against the wall smiling evilly|The Chaos Rogue is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstInglestoneChaosRogue = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Chaos Rogue @{Cgreen}(@{nCred}E@{nCgreen}, 90, human?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Dark Priest of Chaos stands here|The Dark Priest of Chaos is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstInglestoneDarkPriest = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Dark Priest of Chaos @{Cgreen}(@{nCred}E@{nCgreen}, 90, human?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Warlock of Chaos stands glaring at you|The Warlock of Chaos is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstInglestoneWarlockOfChaos = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Warlock of Chaos @{Cgreen}(@{nCred}E@{nCgreen}, 90, human?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Korr, the Overlord of Chaos stands here grinning wickedly\.|Korr, the Overlord of Chaos is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstInglestoneKorr = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Korr, the Overlord of Chaos @{Cgreen}(@{nCred}E@{nCgreen}, 91, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The mighty King Rok Thunderhammer glares at you|King Rok Thunderhammer is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstInglestoneKingRok = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}King Rok Thunderhammer @{Cgreen}(@{nCwhite}G@{nCgreen}, 92, dwarf)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Juargan  -----------------------
/def -p99 -F -mregexp -t"(A small dwarf is here, on the watch for Duergar\.|A small dwarf is here mining at the tunnel walls\.|The small dwarf is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstJuarganSmallDwarf = \
    /if (mobsubs) \
      /if ({P1} =~ 'A small dwarf is here, on the watch for Duergar.') \
        /substitute -p %{PL}@{nCyellow}The small dwarf (on watch) @{Cgreen}(@{nCwhite}G@{nCgreen}, 5, dwarf)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'A small dwarf is here mining at the tunnel walls.') \
        /substitute -p %{PL}@{nCyellow}The small dwarf (mining) @{Cgreen}(@{nCwhite}G@{nCgreen}, 7, dwarf)@{n}%{P2}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}The small dwarf (on watch/mining) @{Cgreen}(@{nCwhite}G@{nCgreen}, 5/7, dwarf)@{n}%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(A repulsive Duergar is here, biting at its own arm\.|The duergar dwarf is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstJuarganDuergar = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The duergar dwarf @{Cgreen}(@{nCred}E@{nCgreen}, 8, dwarf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A small dwarf is here, dressed in a makeshift suit of armor\.|The dwarf guard is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstJuarganGuard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The dwarf guard @{Cgreen}(@{nCwhite}G@{nCgreen}, 10, dwarf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A small dwarf sits here trying to grow a new rock\.|Yentle the dwarf is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstJuarganYentle = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Yentle the dwarf @{Cgreen}(@{nCwhite}G@{nCgreen}, 10, dwarf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A small dwarven spirit is at unrest here\.|A dwarven spirit is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstJuarganSpirit = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A dwarven spirit @{Cgreen}(@{nCred}E@{nCgreen}, 15, insubstantial)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The dreaded rock worm has blasted through the rock wall, its jaws open wide!|The dreaded rock worm is here)(, fighting [^\.!]+.|)" tfMobsubstJuarganRockWorm = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The dreaded rock worm @{Cgreen}(N, 20, snake)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Juargan the Dwarven King sits here upon his throne, looking out over his gardens\.|Juargan the Dwarven King is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstJuarganKing = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Juargan the Dwarven King @{Cgreen}(@{nCwhite}G@{nCgreen}, 27, dwarf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A ancient and partially decayed dwarf lies here ever so silent\.|Grimdale the ancient king is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstJuarganGrimdale = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Grimdale the ancient king @{Cgreen}(@{nCred}E@{nCgreen}, 27, dwarf)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Kaltor  -----------------------
/def -p99 -F -mregexp -t"(A Fugitive watches you warily\.|The Fugitive is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstKaltorFugitive = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Fugitive @{Cgreen}(@{nCred}E@{nCgreen}, 63, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Black flames lick about the corpse shuffling around here\.|The Flaming Corpse is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstKaltorFlamingCorpse = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Flaming Corpse @{Cgreen}(@{nCred}E@{nCgreen}, 66, magical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Serpent hovers here, hissing angrily at you\.|A Black Serpent is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstKaltorSerpent = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Black Serpent @{Cgreen}(@{nCred}E@{nCgreen}, 67, snake)@{n}%{P2}%{PR}%; \
    /endif
/def -p100 -F -mregexp -t"(A skeleton is here lying in a coffin\.|The Skeleton is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstKaltorSkeleton = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Skeleton @{Cgreen}(@{nCred}E@{nCgreen}, 70, skeleton/silver)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A gibbering Priest huddles in the corner\.|The Insane Priest is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKaltorPriest = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Insane Priest @{Cgreen}(@{nCwhite}G@{nCgreen}, 75, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A blackened skeleton stands here impassively\.|The Charred Skeleton is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstKaltorCharred = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Charred Skeleton @{Cgreen}(@{nCred}E@{nCgreen}, 85/100, magical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A horribly decayed figure reaches for you hungrily\.|Balgroth the Lich-King is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstKaltorBalgroth = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Balgroth the Lich-King @{Cgreen}(@{nCred}E@{nCgreen}, 100, undead?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The incandescant warrior Kaltar stands in chains before you\.|Kaltar the Paladin-King is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKaltorKaltar = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Kaltar the Paladin-King @{Cgreen}(@{nCwhite}G@{nCgreen}, 100, human)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Karandras  -----------------------
/def -p99 -F -mregexp -t"(A little porker of a pig is trotting around here looking lost\.|A fat pig is here)(, fighting [^\.!]+.|)" tfMobsubstKarandrasPig = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A fat pig @{Cgreen}(N, 1, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A little child skips around with boundless joy\.|A playful child is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKarandrasChild = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A playful child @{Cgreen}(@{nCwhite}G@{nCgreen}, 1, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A dog is here, digging through the trash in the gutter\.|A stray dog is here)(, fighting [^\.!]+.|)" tfMobsubstKarandrasDog = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A stray dog @{Cgreen}(N, 1, canine)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The animist bartender is here to serve you a natural refreshment\.|The Bartender of the Animists Guild is here)(, fighting [^\.!]+.|)" tfMobsubstKarandrasBartenderAn = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Bartender of the Animists Guild @{Cgreen}(N, 1, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A retired nightblade grins as you enter the bar, hoping to serve you an ale\.|The Bartender of the Nightblades Guild is here)(, fighting [^\.!]+.|)" tfMobsubstKarandrasBartenderNb = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Bartender of the Nightblades Guild @{Cgreen}(N, 1, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A godly bartender is here, ready to serve you wine\.|The Bartender of the Templars Guild is here)(, fighting [^\.!]+.|)" tfMobsubstKarandrasBartenderTe = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Bartender of the Templars Guild @{Cgreen}(N, 1, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The warlock bartender is here, ready to serve you a powerful drink\.|The Bartender of the Warlocks Guild is here)(, fighting [^\.!]+.|)" tfMobsubstKarandrasBartenderWl = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Bartender of the Warlocks Guild @{Cgreen}(N, 1, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A ginger cat slowly stalks a nearby rodent\.|The ginger cat is here)(, fighting [^\.!]+.|)" tfMobsubstKarandrasCat = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The ginger cat @{Cgreen}(N, 1, feline)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Guardian Golem stands here, guarding the entrance to the animists guild\.|The Guardian Golem of the Animists Guild is here)(, fighting [^\.!]+.|)" tfMobsubstKarandrasGolemAn = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Guardian Golem of the Animists Guild @{Cgreen}(N, 1, nofight-room)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Guardian Golem stands here, guarding the entrance to the fighters guild\.|The Guardian Golem of the Fighters Guild is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKarandrasGolemFi = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Guardian Golem of the Fighters Guild @{Cgreen}(N, 1, nofight-room)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Guardian Golem stands here, guarding the entrance to the magicians guild\.|The Guardian Golem of the Magicians Guild is here)(, fighting [^\.!]+.|)" tfMobsubstKarandrasGolemMa = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Guardian Golem of the Magicians Guild @{Cgreen}(N, 1, nofight-room)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Guardian Golem stands here, guarding the entrance to the nightblades guild\.|The Guardian Golem of the Nightblades Guild is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstKarandrasGolemNb = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Guardian Golem of the Nightblades Guild @{Cgreen}(@{nCred}E@{nCgreen}, 1, nofight-room)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Guardian Golem stands here, guarding the entrance to the priests guild\.|The Guardian Golem of the Priests Guild is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKarandrasGolemPr = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Guardian Golem of the Priests Guild @{Cgreen}(N, 1, nofight-room)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Guardian Golem stands here, guarding the entrance to the templars guild\.|The Guardian Golem of the Templars Guild is here)(, fighting [^\.!]+.|)" tfMobsubstKarandrasGolemTe = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Guardian Golem of the Templars Guild @{Cgreen}(N, 1, nofight-room)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Guardian Golem stands here, guarding the entrance to the thieves guild\.|The Guardian Golem of the Thieves Guild is here)(, fighting [^\.!]+.|)" tfMobsubstKarandrasGolemTh = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Guardian Golem of the Thieves Guild @{Cgreen}(N, 1, nofight-room)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Guardian Golem stands here, guarding the entrance to the warlocks guild\.|The Guardian Golem of the Warlocks Guild is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstKarandrasGolemWl = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Guardian Golem of the Warlocks Guild @{Cgreen}(@{nCred}E@{nCgreen}, 1, nofight-room)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Your guildmaster stands here, ready to train you\.|The guildmaster is here, ready to test your skills\.|The guildmaster is here, prepared to train you\.|Your guildmaster is here, to test your skills\.|The guildmaster is here, prepared to test your stealth\.|The guildmaster is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstKarandrasGuildmaster = \
    /if (mobsubs) \
      /if ({P1} =~ 'Your guildmaster stands here, ready to train you.') \
        /substitute -p %{PL}@{nCyellow}The guildmaster (An) @{Cgreen}(N, 1, nofight-room)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'The guildmaster is here, ready to test your skills.') \
        /substitute -p %{PL}@{nCyellow}The guildmaster (Te) @{Cgreen}(N, 1, nofight-room)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'The guildmaster is here, prepared to train you.') \
        /substitute -p %{PL}@{nCyellow}The guildmaster (Wl) @{Cgreen}(N, 1, nofight-room)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'Your guildmaster is here, to test your skills.') \
        /substitute -p %{PL}@{nCyellow}The guildmaster (Ma,Pr,Ro,Fi) @{Cgreen}(N, 100, nofight-room)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'The guildmaster is here, prepared to test your stealth.') \
        /substitute -p %{PL}@{nCyellow}The guildmaster (Nb) @{Cgreen}(@{nCred}E@{nCgreen}, 100, nofight-room)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ '') \
        /substitute -p %{PL}@{nCyellow}The guildmaster @{Cgreen}(N, 1/100, nofight-room)@{n}%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(A janitor is walking around, cleaning up\.|The Janitor is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKarandrasJanitor = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Janitor @{Cgreen}(@{nCwhite}G@{nCgreen}, 1, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A pigeon is walking around here, nodding it's head as it goes\.|The pigeon is here)(, fighting [^\.!]+.|)" tfMobsubstKarandrasPigeon = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The pigeon @{Cgreen}(N, 1, bird)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A pilgrim is standing here, looking for the way to the temple\.|A pilgrim walks by here, on his way to the temple\.|A pilgrim is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKarandrasPilgrim = \
    /if (mobsubs) \
      /if ({P1} =~ 'A pilgrim is standing here, looking for the way to the temple.') \
        /substitute -p %{PL}@{nCyellow}A pilgrim (standing) @{Cgreen}(@{nCwhite}G@{nCgreen}, 2, human)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'A pilgrim walks by here, on his way to the temple.') \
        /substitute -p %{PL}@{nCyellow}A pilgrim (walks) @{Cgreen}(@{nCwhite}G@{nCgreen}, 2, human)@{n}%{P2}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}A pilgrim (standing/walks) @{Cgreen}(@{nCwhite}G@{nCgreen}, 2, human)@{n}%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(A little duck waddles around here quacking as it goes\.|The duck is here)(, fighting [^\.!]+.|)" tfMobsubstKarandrasDuck = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The duck @{Cgreen}(N, 2, bird)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A large white swan flaps it's wings and honks\.|The swan is here)(, fighting [^\.!]+.|)" tfMobsubstKarandrasSwan = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The swan @{Cgreen}(N, 2, bird)@{n}%{P2}%{PR}%; \
    /endif
;[22:47:59] Lacrimosa told you '% tfMobsubstKarandrasSpirit: Warning: "%(inv" substitution in expression is legal, but can be confusing.'
;[22:48:15] Lacrimosa told you 'Try using "{(i}" instead.'
/def -p99 -F -mregexp -t"(The spirit of ([A-z]+) is here floating in the air\.)( \(White Aura\)| \(Red Aura\)|)" tfMobsubstKarandrasSpirit = \
    /if (mobsubs & {P2} =~ name) \
      /if (align =~ 'G') \
        /substitute -p %{PL}@{nCyellow}A spirit @{Cgreen}(@{nCwhite}G@{nCgreen}, 2, newbie helper)@{n}%{PR}%; \
      /elseif (align =~ 'E') \
        /substitute -p %{PL}@{nCyellow}A spirit @{Cgreen}(@{nCred}E@{nCgreen}, 2, newbie helper)@{n}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}A spirit @{Cgreen}(N, 2, newbie helper)@{n}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(An amiable citizen of the fair city of Karandras stands here\.|A citizen of Karandras is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKarandrasCitizen = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A citizen of Karandras @{Cgreen}(@{nCwhite}G@{nCgreen}, 3, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A traveller pauses here, marvelling in the beauty of the city\.|A weary traveller rests here, taking a break from his journey\.|A traveller is here)(, fighting [^\.!]+.|)" tfMobsubstKarandrasTraveller = \
    /if (mobsubs) \
      /if ({P1} =~ 'A traveller pauses here, marvelling in the beauty of the city.') \
        /substitute -p %{PL}@{nCyellow}A traveller (pauses) @{Cgreen}(N, 4, human)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'A weary traveller rests here, taking a break from his journey.') \
        /substitute -p %{PL}@{nCyellow}A traveller (rests) @{Cgreen}(N, 4, human)@{n}%{P2}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}A traveller (pauses/rests) @{Cgreen}(N, 4, human)@{n}%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(A riding horse is tied here, awaiting its owner\.|The riding horse is here)(, fighting [^\.!]+.|)" tfMobsubstKarandrasHorse = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The riding horse @{Cgreen}(N, 4, ---, mountable)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A secretary sits here behind a desk, writing correspondence\.|A secretary is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKarandrasSecretary = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A secretary @{Cgreen}(@{nCwhite}G@{nCgreen}, 5, no-attack)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An senior citizen of Karandras is pottering about here\.|A senior citizen of Karandras is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKarandrasSenCitizen = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A senior citizen of Karandras @{Cgreen}(@{nCwhite}G@{nCgreen}, 5, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A little scamp is hanging around here causing mischief\.|The little scamp is here)(, fighting [^\.!]+.|)" tfMobsubstKarandrasScamp = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The little scamp @{Cgreen}(N, 6, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A patron of the bar is here, talking about his experiences\.|A patron is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKarandrasPatron = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A patron @{Cgreen}(@{nCwhite}G@{nCgreen}, 7, no-attack)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A large bearded man stands behind the bar serving drinks\.|The bearded bartender is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKarandrasBeardedBart = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The bearded bartender @{Cgreen}(@{nCwhite}G@{nCgreen}, 7, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A beggar stands here asking for your spare money\.|The beggar is here)(, fighting [^\.!]+.|)" tfMobsubstKarandrasBeggar = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The beggar @{Cgreen}(N, 7, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A drunk spins until he is dizzy and no longer able to walk straight\.|The drunk is here)(, fighting [^\.!]+.|)" tfMobsubstKarandrasDrunk = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The drunk @{Cgreen}(N, 8, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p98 -F -mregexp -t"(A militia guard is here, watching out for trouble\.|A militia guard is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKarandrasMilitiaGuard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A militia guard @{Cgreen}(@{nCwhite}G@{nCgreen}, 10, human, protector)@{n}%{P2}%{PR}%; \
    /endif
/def -p98 -F -mregexp -t"(An archer stands guard here, observing events both inside and outside the city\.|An archer is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKarandrasArcher = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An archer @{Cgreen}(@{nCwhite}G@{nCgreen}, 10, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A sneaky pickpocket is here trying to go unseen\.|The pickpocket is here)(, fighting [^\.!]+.|)" tfMobsubstKarandrasPickpocket = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The pickpocket @{Cgreen}(N, 12, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A bard is here recalling local tales to anyone who wants to listen\.|A local bard is here)(, fighting [^\.!]+.|)" tfMobsubstKarandrasBard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A local bard @{Cgreen}(N, 13, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A city guard stands here, keeping an eye on the crowds\.|A city guard is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKarandrasCityGuard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A city guard @{Cgreen}(@{nCwhite}G@{nCgreen}, 15, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An explorer from a distant land gathers his thoughts on the city here\.|The explorer is here)(, fighting [^\.!]+.|)" tfMobsubstKarandrasExplorer = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The explorer @{Cgreen}(N, 17, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An adventurer of Orhan casually looks around here\.|The adventurer is here)(, fighting [^\.!]+.|)" tfMobsubstKarandrasAdventurer = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The adventurer @{Cgreen}(N, 18, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A tower guard stands here, watching out for attackers\.|A tower guard is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKarandrasTowerGuard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A tower guard @{Cgreen}(@{nCwhite}G@{nCgreen}, 20, human, special-protect)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An attendant is here, helping the high priest minister to the pilgrims\.|An attendant to the temple is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKarandrasAttendant = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An attendant to the temple @{Cgreen}(@{nCwhite}G@{nCgreen}, 25, nofight-room)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A guide from the Karandras Tourist Center is here to assist you\.|The Tourist Guide is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKarandrasGuide = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Tourist Guide @{Cgreen}(@{nCwhite}G@{nCgreen}, 25, guide)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A tough mercenary stands in the shadows, waiting to be hired\.|The mercenary is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstKarandrasMercenary = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The mercenary @{Cgreen}(@{nCred}E@{nCgreen}, 22, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A member of the Karandras criminal underworld loiters around here\. \(hidden\)|The villain \(hidden\) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstKarandrasVillain = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The villain @{Cgreen}(@{nCred}E@{nCgreen}, 23, human)@{n} (hide)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A gate guard stands here, watching the gate\.|A gate guard is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKarandrasGateGuard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A gate guard @{Cgreen}(@{nCwhite}G@{nCgreen}, 25, human, protector)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A wall guard is here, watching the outside world through the slits\.|A wall guard is here)(, fighting [^\.!]+.|)" tfMobsubstKarandrasWallGuard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A wall guard @{Cgreen}(N, 25, human, protector)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Potionbrewer, a devoted Apprentice of the Wizard, is working here\.|The Potion-Brewing Apprentice is here)(, fighting [^\.!]+.|)" tfMobsubstKarandraspotionbrewer = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Potion-Brewing Apprentice @{Cgreen}(N, 25, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An Apprentice of the Wizard is standing here preparing Scrolls for sale in the|The Scroll-Scribing Apprentice is here)(, fighting [^\.!]+.|)" tfMobsubstKarandrasScrollApp = \
    /let mobName=@{nCyellow}The Scroll-Scribing Apprentice @{Cgreen}(N, 25, human)@{n}%; \
    /if (mobsubs & {P1} =~ "The Scroll-Scribing Apprentice is here") \
      /substitute -p %{PL}%{mobName}%{P2}%{PR}%; \
    /elseif (mobsubs) \
      /substitute%; \
      /def -p99 -F -n1 -mregexp -t"^shop\\. He seems totally absorbed by his work\\." tfMobsubstSpecial = \
        /substitute -p %%{PL}%{mobName}%%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A high guard wanders here, looking for signs of trouble\.|A high guard is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKarandrasHighGuard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A high guard @{Cgreen}(@{nCwhite}G@{nCgreen}, 30, human, protector)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A traveling hobbit rests here, searching for a legendary hobbit\.|A hobbit traveler is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKarandrasHobbitTraveler = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A hobbit traveler @{Cgreen}(@{nCwhite}G@{nCgreen}, 35, no-attack)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A lone adventurer is here, regaining strength\.|A lone adventurer is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKarandrasLoneAdv = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A lone adventurer @{Cgreen}(@{nCwhite}G@{nCgreen}, 35, no-attack)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A scout from a far away land is here, packing up his things\.|A scout is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKarandrasScout = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A scout @{Cgreen}(@{nCwhite}G@{nCgreen}, 35, no-attack)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A troll bounty hunter is here, looking for trolls that deserve to die\.|A troll bounty hunter is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKarandrasTrollHunter = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A troll bounty hunter @{Cgreen}(@{nCwhite}G@{nCgreen}, 35, no-attack)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An elite guard stands here, guarding the city hall\.|An elite guard stands here, guarding his post\.|An elite guard is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKarandrasEliteGuard = \
    /if (mobsubs) \
      /if ({P1} =~ 'An elite guard stands here, guarding the city hall.') \
        /substitute -p %{PL}@{nCyellow}An elite guard (city hall) @{Cgreen}(@{nCwhite}G@{nCgreen}, 35, human)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'An elite guard stands here, guarding his post.') \
        /substitute -p %{PL}@{nCyellow}An elite guard (post) @{Cgreen}(@{nCwhite}G@{nCgreen}, 35, human)@{n}%{P2}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}An elite guard (city hall/post) @{Cgreen}(@{nCwhite}G@{nCgreen}, 35, human)@{n}%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(The governor of the warrior and templar guilds rests in his chair\.|The governor of the Fighters guilds is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKarandrasGovernorFi = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The governor of the Fighters guilds @{Cgreen}(@{nCwhite}G@{nCgreen}, 40, nofight-room)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The governor of the priest and animist guilds knew you were coming\.|The governor of the Magician guilds is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKarandrasGovernorMa = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The governor of the Magician guilds @{Cgreen}(@{nCwhite}G@{nCgreen}, 40, nofight-room)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The governor of the priest and animist guilds is here, meditating\.|The governor of the Priest guilds is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKarandrasGovernorPr = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The governor of the Priest guilds @{Cgreen}(@{nCwhite}G@{nCgreen}, 40, nofight-room)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The governor of the thief and nightblade guilds studies you carefully\.|The governor of the Thieves guilds is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKarandrasGovernorTh = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The governor of the Thieves guilds @{Cgreen}(@{nCwhite}G@{nCgreen}, 40, nofight-room)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Captain of the City Guard sits here, looking over reports\.|The Guard Captain is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKarandrasGuardCaptain = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Guard Captain @{Cgreen}(@{nCwhite}G@{nCgreen}, 50, nofight-room, special-jail-offender)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Librarian, - now roaming in the guise of a Chimpanzee due to some obscure|The Chimpanzee Librarian is here)(, fighting [^\.!]+.|)" tfMobsubstKarandrasLibrarianChimp = \
    /let mobName=@{nCyellow}The Chimpanzee Librarian @{Cgreen}(N, 51, ---)@{n}%; \
    /if (mobsubs & {P1} =~ "The Chimpanzee Librarian is here") \
      /substitute -p %{PL}%{mobName}%{P2}%{PR}%; \
    /elseif (mobsubs) \
      /substitute%; \
      /def -p99 -F -n1 -mregexp -t"^outburst of raw magical power, is littering the floor with banana peels\\." tfMobsubstSpecial = \
        /substitute -p %%{PL}%{mobName}%%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Gnarled and Crumbled old Mother of the Wizard is moving aimlessly around|The Wrinkled Old Mother of the Wizard is here)(, fighting [^\.!]+.|)" tfMobsubstKarandrasMother = \
    /let mobName=@{nCyellow}The Wrinkled Old Mother of the Wizard @{Cgreen}(N, 55, human)@{n}%; \
    /if (mobsubs & {P1} =~ "The Wrinkled Old Mother of the Wizard is here") \
      /substitute -p %{PL}%{mobName}%{P2}%{PR}%; \
    /elseif (mobsubs) \
      /substitute%; \
      /def -F -n1 -msimple -ag -t"doing the things you don't really understand why old hags do when they get a"%; \
      /def -p99 -F -n1 -mregexp -t"^broom in their hand\\." tfMobsubstSpecial = \
        /substitute -p %%{PL}%{mobName}%%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The high priest of the cathedral is here, taking care of the unfortunate\.|The high priest is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKarandrasHighPriest = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The high priest @{Cgreen}(@{nCwhite}G@{nCgreen}, 60, nofight-room)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(the Wizard is standing here, uttering strange syllables and gesturing|The Master Conjurer is here)(, fighting [^\.!]+.|)" tfMobsubstKarandrasConjurer = \
    /let mobName=@{nCyellow}The Master Conjurer @{Cgreen}(N, 60, human)@{n}%; \
    /if (mobsubs & {P1} =~ "The Master Conjurer is here") \
      /substitute -p %{PL}%{mobName}%{P2}%{PR}%; \
    /elseif (mobsubs) \
      /substitute%; \
      /def -p99 -F -n1 -mregexp -t"^wildly in an attempt to pull some major conjuring stunt \\.\\.\\." tfMobsubstSpecial = \
        /substitute -p %%{PL}%{mobName}%%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Karandras jail officer eyes your movements like a hawk\.|The Karandras Jail Officer is here)(, fighting [^\.!]+.|)" tfMobsubstKarandrasJailOfficer = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Karandras Jail Officer @{Cgreen}(N, 70, human, special-pay)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Hammer, the veteran adventurer is standing here singing merrily\.|Hammer, the Veteran is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKarandrasHammer = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Hammer, the Veteran @{Cgreen}(@{nCwhite}G@{nCgreen}, 70, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Mayor is here, thinking about how to improve the city\.|The Mayor is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKarandrasMayor = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Mayor @{Cgreen}(@{nCwhite}G@{nCgreen}, 70, no-attack)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A shady looking bartender sneaks around behind the bar\.|A villainous bartender is here)(, fighting [^\.!]+.|)" tfMobsubstKarandrasVillBart = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A villainous bartender @{Cgreen}(N, 99, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Uncle Juan is here ready to take your order\.|Uncle Juan is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKarandrasJuan = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Uncle Juan @{Cgreen}(@{nCwhite}G@{nCgreen}, 99, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Blue Navigator with his compass, is standing here\.|A Blue Navigator is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKarandrasBlueNav = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Blue Navigator @{Cgreen}(@{nCwhite}G@{nCgreen}, 100, navigator)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Green Navigator with his compass, is standing here\.|A Green Navigator is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKarandrasGreenNav = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Green Navigator @{Cgreen}(@{nCwhite}G@{nCgreen}, 100, navigator)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Red Navigator with his compass, is standing here\.|A Red Navigator is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKarandrasRedNav = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Red Navigator @{Cgreen}(@{nCwhite}G@{nCgreen}, 100, navigator)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Algoth, the meta wizard, stands here, ready to help you improve yourself\.|Algoth, the meta wizard is here)(, fighting [^\.!]+.|)" tfMobsubstKarandrasAlgoth = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Algoth, the meta wizard @{Cgreen}(N, 100, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Allanon, a faithful priest of Karandras meditates here in worship\.|Allanon the Priest is here)(, fighting [^\.!]+.|)" tfMobsubstKarandrasAllanon = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Allanon the Priest @{Cgreen}(N, 100, no-attack)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An ancient guardian is here, keeping an eye on the battles\.|An ancient guardian is here)(, fighting [^\.!]+.|)" tfMobsubstKarandrasGuardian = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An ancient guardian @{Cgreen}(N, 100, nofight-room)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Braveheart the Lion is here circling around in the air\.|Braveheart the Lion is here)(, fighting [^\.!]+.|)" tfMobsubstKarandrasBraveheart = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Braveheart the Lion @{Cgreen}(N, 100, no-attack)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Gryshk is standing here, daring you to take his challenge\.|Gryshk the Questmaster is here)(, fighting [^\.!]+.|)" tfMobsubstKarandrasGryshk = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Gryshk the Questmaster @{Cgreen}(N, 100, QM)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Halvdan the Quest shopkeeper is here, ready to sell you his merchandise\.|Halvdan the Quest shopkeeper is here)(, fighting [^\.!]+.|)" tfMobsubstKarandrasHalvdan = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Halvdan the Quest shopkeeper @{Cgreen}(N, 100, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Irmgarde stands here, polishing a blade waiting for you to decide\.|Irmgarde is here)(, fighting [^\.!]+.|)" tfMobsubstKarandrasIrmgarde = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Irmgarde @{Cgreen}(N, 100, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Leowyn is here, waiting for you to decide on a purchase\.|Leowyn is here)(, fighting [^\.!]+.|)" tfMobsubstKarandrasLeowyn = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Leowyn @{Cgreen}(N, 100, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Lionheart the Brave is here circling around in the air\.|Lionheart the Brave is here)(, fighting [^\.!]+.|)" tfMobsubstKarandrasLionheart = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Lionheart the Brave @{Cgreen}(N, 100, no-attack)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Palomir, the owner of this establishment, wanders over to help\.|Palomir is here)(, fighting [^\.!]+.|)" tfMobsubstKarandrasPalomir = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Palomir @{Cgreen}(N, 100, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Sheila, the secretary for the CR office, is here to take your request\.|Sheila is here)(, fighting [^\.!]+.|)" tfMobsubstKarandrasSheila = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Sheila @{Cgreen}(N, 100, nofight-room)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The auctioneer stands in the front of the room calling out bids\.|The auctioneer is here)(, fighting [^\.!]+.|)" tfMobsubstKarandrasAuctioneer = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The auctioneer @{Cgreen}(N, 100, nofight-room)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The baker puts a loaf of bread in the oven then turns to help you\.|The baker is here)(, fighting [^\.!]+.|)" tfMobsubstKarandrasBaker = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The baker @{Cgreen}(N, 100, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A muscular bartender stands behind the bar, built as solid as rock\.|The Bartender of the Fighters Guild is here)(, fighting [^\.!]+.|)" tfMobsubstKarandrasBartenderFi = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Bartender of the Fighters Guild @{Cgreen}(N, 100, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The bartender stands behind the bar, levitating drinks\.|The Bartender of the Magicians Guild is here)(, fighting [^\.!]+.|)" tfMobsubstKarandrasBartenderMa = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Bartender of the Magicians Guild @{Cgreen}(N, 100, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The bartender of the clergy stands behind the bar, ready to help you\.|The Bartender of the Priests Guild is here)(, fighting [^\.!]+.|)" tfMobsubstKarandrasBartenderPr = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Bartender of the Priests Guild @{Cgreen}(N, 100, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The bartender stands behind the bar, eyeing up your money pouch\.|The Bartender of the Thieves Guild is here)(, fighting [^\.!]+.|)" tfMobsubstKarandrasBartenderTh = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Bartender of the Thieves Guild @{Cgreen}(N, 100, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The boatswain offers to help you pick a good boat\.|The boatswain is here)(, fighting [^\.!]+.|)" tfMobsubstKarandrasBoatswain = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The boatswain @{Cgreen}(N, 100, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The brewer takes a sip of his latest batch then offers to sell you some\.|The brewer is here)(, fighting [^\.!]+.|)" tfMobsubstKarandrasBrewer = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The brewer @{Cgreen}(N, 100, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The cartographer is busy copying maps behind the counter\.|The cartographer is here)(, fighting [^\.!]+.|)" tfMobsubstKarandrasCartographer = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The cartographer @{Cgreen}(N, 100, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The grocer busies himself making sure the food is fresh\.|The grocer is here)(, fighting [^\.!]+.|)" tfMobsubstKarandrasGrocer = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The grocer @{Cgreen}(N, 100, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A skilled animist is here, prepared to sell you armours\.|The armourer offers to help you find what you need\.|The armourer of the guild awaits new recruits to equip\.|The armourer of the nightblades guild awaits new members to equip\.|The guild armourer is ready to outfit you in assassins garb\.|A muscular paladin is here, ready to sell you armours\.|An armor-clad warlock is here, ready to sell you armor|The guild armourer is here)(, fighting [^\.!]+.|)" tfMobsubstKarandras = \
    /if (mobsubs) \
      /if ({P1} =~ 'A skilled animist is here, prepared to sell you armours.') \
        /substitute -p %{PL}@{nCyellow}The guild armourer (An) @{Cgreen}(N, 100, shopkeeper)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'The armourer offers to help you find what you need.') \
        /substitute -p %{PL}@{nCyellow}The guild armourer (Fi/Pr) @{Cgreen}(N, 100, shopkeeper)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'The armourer of the guild awaits new recruits to equip.') \
        /substitute -p %{PL}@{nCyellow}The guild armourer (Ma) @{Cgreen}(N, 100, shopkeeper)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'The armourer of the nightblades guild awaits new members to equip.') \
        /substitute -p %{PL}@{nCyellow}The guild armourer (Nb) @{Cgreen}(N, 100, shopkeeper)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'The guild armourer is ready to outfit you in assassins garb.') \
        /substitute -p %{PL}@{nCyellow}The guild armourer (Ro) @{Cgreen}(N, 100, shopkeeper)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'A muscular paladin is here, ready to sell you armours.') \
        /substitute -p %{PL}@{nCyellow}The guild armourer (Te) @{Cgreen}(N, 100, shopkeeper)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'An armor-clad warlock is here, ready to sell you armor') \
        /substitute -p %{PL}@{nCyellow}The guild armourer (Wl) @{Cgreen}(N, 100, shopkeeper)@{n}%{P2}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}The guild armourer @{Cgreen}(N, 100, shopkeeper)@{n}%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(The guild librarian is here, cleaning the bookshelves\.|The guild librarian acknowledges your presence with a grunt\.|The librarian stops sorting inventory and floats down to help you\.|An intellectual assassin is here organising the guilds treasures\.|The librarian looks up from his book to help you find what you want\.|The guild librarian tries to go unnoticed\.|A templar librarian is here, waiting to help you\.|An old lady warlock drops a stack of papers to run over and help you\.|The guild librarian is here)(, fighting [^\.!]+.|)" tfMobsubstKarandrasLibrarian = \
    /if (mobsubs) \
      /if ({P1} =~ 'The guild librarian is here, cleaning the bookshelves.') \
        /substitute -p %{PL}@{nCyellow}The guild librarian (An) @{Cgreen}(N, 100, shopkeeper)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'The guild librarian acknowledges your presence with a grunt.') \
        /substitute -p %{PL}@{nCyellow}The guild librarian (Fi) @{Cgreen}(N, 100, shopkeeper)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'The librarian stops sorting inventory and floats down to help you.') \
        /substitute -p %{PL}@{nCyellow}The guild librarian (Ma) @{Cgreen}(N, 100, shopkeeper)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'An intellectual assassin is here organising the guilds treasures.') \
        /substitute -p %{PL}@{nCyellow}The guild librarian (Nb) @{Cgreen}(N, 100, shopkeeper)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'The librarian looks up from his book to help you find what you want.') \
        /substitute -p %{PL}@{nCyellow}The guild librarian (Pr) @{Cgreen}(N, 100, shopkeeper)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'The guild librarian tries to go unnoticed.') \
        /substitute -p %{PL}@{nCyellow}The guild librarian (Ro) @{Cgreen}(N, 100, shopkeeper)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'A templar librarian is here, waiting to help you.') \
        /substitute -p %{PL}@{nCyellow}The guild librarian (Te) @{Cgreen}(N, 100, shopkeeper)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'An old lady warlock drops a stack of papers to run over and help you.') \
        /substitute -p %{PL}@{nCyellow}The guild librarian (Wl) @{Cgreen}(N, 100, shopkeeper)@{n}%{P2}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}The guild librarian @{Cgreen}(N, 100, shopkeeper)@{n}%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p98 -F -mregexp -t"(The herbalist lights some incense then turns to help you choose\.|The herbalist is here)(, fighting [^\.!]+.|)" tfMobsubstKarandrasHerbalist = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The herbalist @{Cgreen}(N, 100, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The innkeeper stands behind the bar, waiting for your order\.|The innkeeper is here)(, fighting [^\.!]+.|)" tfMobsubstKarandrasInnkeeper = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The innkeeper @{Cgreen}(N, 100, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The iron worker looks up from his work to help you make your purchase\.|The iron worker is here)(, fighting [^\.!]+.|)" tfMobsubstKarandrasIronWorker = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The iron worker @{Cgreen}(N, 100, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The clerk stands behind the counter, waiting to help you\.|The item store clerk is here)(, fighting [^\.!]+.|)" tfMobsubstKarandrasClerk = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The item store clerk @{Cgreen}(N, 100, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Mercenary Shopkeeper relaxes here, behind his counter\.|The Mercenary Shopkeeper is here)(, fighting [^\.!]+.|)" tfMobsubstKarandrasMercShopkeeper = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Mercenary Shopkeeper @{Cgreen}(N, 100, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The smartly dressed jeweller of Karandras awaits wealthy customers here\.|The Jeweller of Karandras is here)(, fighting [^\.!]+.|)" tfMobsubstKarandrasJeweller = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Jeweller of Karandras @{Cgreen}(N, 100, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A proud looking lieutenant of the guard stands here in a shiny armor\.|The Lieutenant of the Karandras cityguard is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKarandrasLieutenant = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Lieutenant of the Karandras cityguard @{Cgreen}(@{hCwhite}G@{nCgreen}, 100, QM)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Overseer is here, helping distribute the spoils of battle|The Overseer is here)(, fighting [^\.!]+.|)" tfMobsubstKarandrasOverseer = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Overseer @{Cgreen}(N, 100, no-attack)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The postmaster sits here, waiting to help you with your mail\.|The postmaster is here)(, fighting [^\.!]+.|)" tfMobsubstKarandrasPostmaster = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The postmaster @{Cgreen}(N, 100, nofight-room)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The receptionist sits here, ready to help you check into a room\.|The receptionist is here)(, fighting [^\.!]+.|)" tfMobsubstKarandrasReceptionist = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The receptionist @{Cgreen}(N, 100, nofight-room)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The wizard's assistant watches you enter and immediately offers his help\.|The wizard's assistant is here)(, fighting [^\.!]+.|)" tfMobsubstKarandrasWizAssistant = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The wizard's assistant @{Cgreen}(N, 100, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Karandras - Merchant's Tower  -----------------------
/def -p99 -F -mregexp -t"Gimli the retired hero is standing here\." tfMobsubstKarandrasTower2n = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Gimli @{Cgreen}(N, 1, shopkeeper)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"Torgny, the man under the table welcomes you\." tfMobsubstKarandrasTower2e = \
    /if (mobsubs) \
      /substitute%; \
      /def -p99 -F -n1 -mregexp -t"\\.\\.\\.surrounded by a stench of diesel!" tfMobsubstSpecial = \
        /substitute -p %{PL}@{nCyellow}Torgny @{Cgreen}(N, 1, shopkeeper)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"Stilgar is here eyeing you suspiciously\." tfMobsubstKarandrasTower2s = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Stilgar @{Cgreen}(N, 100, shopkeeper)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"Inquisitor Simon is here praying at the altar\." tfMobsubstKarandrasTower2w = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Inquisitor Simon @{Cgreen}(N, 100, shopkeeper)@{n}%{PR}%; \
    /endif

/def -p99 -F -mregexp -t"'El Pollo' is here, waiting for you\." tfMobsubstKarandrasTower3n = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}El Pollo @{Cgreen}(N, 100, shopkeeper)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"Before you stands a giraffe ready to sell you something\." tfMobsubstKarandrasTower3e = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A giraffe @{Cgreen}(N, 100, shopkeeper)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"Steve is resting here, waiting to barter" tfMobsubstKarandrasTower3s = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Steve @{Cgreen}(N, 100, shopkeeper)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"A massive dragon is sitting here, counting it's treasures\." tfMobsubstKarandrasTower3w = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A massive dragon @{Cgreen}(N, 100, shopkeeper)@{n}%{PR}%; \
    /endif

/def -p99 -F -mregexp -t"Sandor, the K'ta'viiri Lord tolerates your presence\." tfMobsubstKarandrasTower4n = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Sandor the K'ta'viiri Lord @{Cgreen}(N, 100, shopkeeper)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"Zodoth, the greedy shopkeeper stands here\." tfMobsubstKarandrasTower4e = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Zodoth the greedy shopkeeper @{Cgreen}(N, 100, shopkeeper)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"An obsolete T-800 Model 101, precursor of the Gorogminator, guards the area\.( \(Red Aura\)|)" tfMobsubstKarandrasTower4s = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Terminator @{Cgreen}(@{nCred}E@{nCgreen}, 100, shopkeeper)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"Waukeen the Merchant's friend is standing here ready to help you with goods\." tfMobsubstKarandrasTower4w = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Waukeen @{Cgreen}(N, 100, shopkeeper)@{n}%{PR}%; \
    /endif

/def -p99 -F -mregexp -t"A grizzled old shopkeeper stands here, waiting to take your money\." tfMobsubstKarandrasTower5n = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Old One Eye @{Cgreen}(N, 100, shopkeeper)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"Cindy's assistant is standing here, reading his notes\." tfMobsubstKarandrasTower5e = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Cindy's Assistant @{Cgreen}(N, 100, shopkeeper)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"A strong-looking, scarred man is sitting lazily next to the entrance, whistling his favourite battle hymn" tfMobsubstKarandrasTower5s = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A scarred man @{Cgreen}(N, 100, shopkeeper)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"Ashard is here, waiting patiently for you to finish your buisness\." tfMobsubstKarandrasTower5w = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Ashard @{Cgreen}(N, 100, shopkeeper)@{n}%{PR}%; \
    /endif

/def -p99 -F -mregexp -t"Ender Sai the Shadowhand brigand is standing here, looking at you\.( \(Red Aura\)|)" tfMobsubstKarandrasTower6n = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Ender Sai @{Cgreen}(@{nCred}E@{nCgreen}, 100, shopkeeper)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"The Archbishop Lazarus stands here, glaring at you viciously\.( \(Red Aura\)|)" tfMobsubstKarandrasTower6e = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Archbishop Lazarus @{Cgreen}(@{nCred}E@{nCgreen}, 100, shopkeeper)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"Dayakus, the holy holder of the beer stands tall and proud\." tfMobsubstKarandrasTower6s = \
    /if (mobsubs) \
      /substitute%; \
      /def -p99 -F -n1 -mregexp -t"\\.\\.\\.surrounded by a stench of beer!( \\(Red Aura\\)|)" tfMobsubstSpecial = \
        /substitute -p %{PL}@{nCyellow}Dayakus @{Cgreen}(@{nCred}E@{nCgreen}, 100, shopkeeper)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"The Disgruntled Government employee seems frustrated at your interruption\." tfMobsubstKarandrasTower6w = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Disgruntled Government Employee @{Cgreen}(N, 1, shopkeeper)@{n}%{PR}%; \
    /endif

/def -p99 -F -mregexp -t"A short ugly humanoid dressed in black is standing here\." tfMobsubstKarandrasTower7n = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Antola the shopkeeper @{Cgreen}(N, 100, shopkeeper)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"An associate in a crimson red vest is standing here ready to be of service\." tfMobsubstKarandrasTower7e = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Associate @{Cgreen}(N, 90, shopkeeper)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"Catherine, one of the oldest and most pure mages, sits here awaiting your purchase\." tfMobsubstKarandrasTower7s = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Catherine @{Cgreen}(N, 1, shopkeeper)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"A huge ugly man-fish named Siken is swiming here\." tfMobsubstKarandrasTower7w = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Siken @{Cgreen}(N, 90, shopkeeper)@{n}%{PR}%; \
    /endif

/def -p99 -F -mregexp -t"A large man stands here feeding his pets\." tfMobsubstKarandrasTower8n = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A large man @{Cgreen}(N, 1, shopkeeper)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"Rorimak the retired old hobbit adventurer is standing here just in front of you\." tfMobsubstKarandrasTower8e = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Rorimak the retired hobbit adventurer @{Cgreen}(N, 100, shopkeeper)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"Lion the Shopkeeper stands ready to take your order\." tfMobsubstKarandrasTower8s = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Lion the Shopkeeper @{Cgreen}(N, 1, shopkeeper)@{n}%{PR}%; \
    /endif

/def -p99 -F -mregexp -t"The Reaper is standing here, leaning against his scythe\." tfMobsubstKarandrasTower9n = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Reaper @{Cgreen}(N, 100, shopkeeper)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"A shopkeeper is here wearily watching you, making sure you do not touch anything to preserve his precious collection of dust\." tfMobsubstKarandrasTower9e = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Schelp @{Cgreen}(N, 100, shopkeeper)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"Ronja is here counting her gold coins and waiting for someone\." tfMobsubstKarandrasTower9s = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Ronja @{Cgreen}(N, 100, shopkeeper)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"Nancy the shop attendant is here assisting all customers\." tfMobsubstKarandrasTower9w = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Nancy @{Cgreen}(N, 100, shopkeeper)@{n}%{PR}%; \
    /endif

/def -p99 -F -mregexp -t"A fat guard is here, leaning on the counter\." tfMobsubstKarandrasTower10n = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A fat guard @{Cgreen}(N, 100, shopkeeper)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"Silke, the widely known salesman is standing in front of you, grinning wildly\." tfMobsubstKarandrasTower10e = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Silke the salesman @{Cgreen}(N, 100, shopkeeper)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"A small elven man eyes you strangely as you enter his house\." tfMobsubstKarandrasTower10s = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Keeper of the Wares @{Cgreen}(N, 100, shopkeeper)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"Galad, Gawyn's half-brother is standing here\." tfMobsubstKarandrasTower10w = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Galad @{Cgreen}(N, 100, shopkeeper)@{n}%{PR}%; \
    /endif

/def -p99 -F -mregexp -t"Bathilda Bagshot is here, growling as you enter\." tfMobsubstKarandrasTower11n = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Bathilda Bagshot @{Cgreen}(N, 100, shopkeeper)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"A tiny little devil is flying around searching through some piles\." tfMobsubstKarandrasTower11e = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The tiny red devil called Xnlzsakxz @{Cgreen}(N, 100, shopkeeper)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"Si Gimuk appears out of nowhere and says 'Wee! I found a berry! Squeek! Oops! What can I do for you\?'" tfMobsubstKarandrasTower11s = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Si gimuk @{Cgreen}(N, 100, shopkeeper)@{n}%{PR}%; \
    /endif

/def -p99 -F -mregexp -t"Coolie is standing here with a sly grin on his face\." tfMobsubstKarandrasTower11w = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Coolie @{Cgreen}(N, 100, shopkeeper)@{n}%{PR}%; \
    /endif

/def -p99 -F -mregexp -t"Aindafai al'Raieem the merchant is standing here\." tfMobsubstKarandrasTower12n = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Aindafai al'Raieem the merchant @{Cgreen}(N, 1, shopkeeper)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"A big hideous Troll, named Geten, stands here\." tfMobsubstKarandrasTower12e = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Geten @{Cgreen}(N, 100, shopkeeper)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"Brunoga, the old caveman, patiently waits for you behind the fire\." tfMobsubstKarandrasTower12s = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Brunoga, the old caveman @{Cgreen}(N, 1, shopkeeper)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"Pagar the Elder Orc is here tending to his merchandise\." tfMobsubstKarandrasTower12w = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Pagar the Elder Orc @{Cgreen}(N, 1, shopkeeper)@{n}%{PR}%; \
    /endif

/def -p99 -F -mregexp -t"A large white wolf is sitting here, watching your every movement\.( \(Red Aura\)|)" tfMobsubstKarandrasTower13n = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The White Wolf @{Cgreen}(@{nCred}E@{nCgreen}, 100, shopkeeper)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"Dingus the dwarf, with a waist like the equator, stands here greeting your moneypurse\.\.\." tfMobsubstKarandrasTower13e = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Dingus the dwarf @{Cgreen}(N, 90, shopkeeper)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"Comic Book Guy stands here, eyeing your suspicious behavior\." tfMobsubstKarandrasTower13s = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Comic Book Guy @{Cgreen}(N, 100, shopkeeper)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"Rigg the Flex is standing here\." tfMobsubstKarandrasTower13w = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Rigg the Flex @{Cgreen}(N, 100, shopkeeper)@{n}%{PR}%; \
    /endif

; -----------------------  Kender Village  -----------------------
/def -p99 -F -mregexp -t"(A small receptionist stands here, assigning tasks to small kenders\.|A receptionist is here)(, fighting [^\.!]+.|)" tfMobsubstKenderReceptionist = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A receptionist @{Cgreen}(N, 2, hobbit)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A kender child sits on the ground here playing with some toys\.|A kender child is here)(, fighting [^\.!]+.|)" tfMobsubstKenderChild = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A kender child @{Cgreen}(N, 15, hobbit)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A teenage kender leans against one of the walls here, eyeing you suspiciously|A teenage kender is here)(, fighting [^\.!]+.|)" tfMobsubstKenderTeenage = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A teenage kender @{Cgreen}(N, 25, hobbit)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A weary traveller rest his elbows on a table here|A sleeping traveller snores peacefully here\.|A traveller is here)(, fighting [^\.!]+.|)" tfMobsubstKenderTraveller = \
    /if (mobsubs) \
      /if ({P1} =~ 'A weary traveller rest his elbows on a table here') \
        /substitute -p %{PL}@{nCyellow}A traveller (weary) @{Cgreen}(N, 25, human)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'A sleeping traveller snores peacefully here.') \
        /substitute -p %{PL}@{nCyellow}A traveller (sleeping) @{Cgreen}(N, 27, human)@{n}%{P2}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}A traveller (weary/sleeping) @{Cgreen}(N, 25/27, human)@{n}%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(An adult kender stands here, smiling welcomingly at you\.|An adult kender is here)(, fighting [^\.!]+.|)" tfMobsubstKenderAdult = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An adult kender @{Cgreen}(N, 33, hobbit)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A dashing young gambler tries his luck at the games here\.|A gambler is here)(, fighting [^\.!]+.|)" tfMobsubstKenderGambler = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A gambler @{Cgreen}(N, 38, hobbit)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A trusty bodyguard stands here protecting the princess\.|A bodyguard is here)(, fighting [^\.!]+.|)" tfMobsubstKenderBodyguard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A bodyguard @{Cgreen}(N, 40, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A rat scurries about on the floor here\.|A rat is here)(, fighting [^\.!]+.|)" tfMobsubstKenderRat = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A rat @{Cgreen}(N, 40, rodent)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Tasslehof the kender is here, looking very sleepy\.|Tasslehof is here)(, fighting [^\.!]+.|)" tfMobsubstKenderTasslehof = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Tasslehof @{Cgreen}(N, 45, hobbit)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Bosk the slave driver whips young kenders all over the place here\.|Bosk is here)(, fighting [^\.!]+.|)" tfMobsubstKenderBosk = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Bosk @{Cgreen}(N, 50, hobbit)@{n}%{P2}%{PR}%; \
    /endif
/set tfMobsubstKenderVillageLikaelFound 0
/def -p99 -F -mregexp -t"(A thief rests in the shadows\.|Byron the Thief is here|Likael the Thief is here|Notur the Thief is here)(, fighting [^\.!]+.|)" tfMobsubstKenderThief = \
    /if (mobsubs) \
      /if ({P1} =~ 'Byron the Thief is here') \
        /substitute -p %{PL}@{nCyellow}Byron the Thief @{Cgreen}(N, 50, human)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'Likael the Thief is here') \
        /substitute -p %{PL}@{nCyellow}Likael the Thief @{Cgreen}(N, 50, human)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'Notur the Thief is here') \
        /substitute -p %{PL}@{nCyellow}Notur the Thief @{Cgreen}(N, 50, human)@{n}%{P2}%{PR}%; \
      /elseif (exits == 1) \
        /substitute -p %{PL}@{nCyellow}Notur the Thief @{Cgreen}(N, 50, human)@{n}%{P2}%{PR}%; \
      /elseif (!tfMobsubstKenderVillageLikaelFound) \
        /substitute -p %{PL}@{nCyellow}Likael the Thief @{Cgreen}(N, 50, human)@{n}%{P2}%{PR}%; \
        /set tfMobsubstKenderVillageLikaelFound 1%; \
        /repeat -1 1 /set tfMobsubstKenderVillageLikaelFound 0%; \
      /else \
        /substitute -p %{PL}@{nCyellow}Byron the Thief @{Cgreen}(N, 50, human)@{n}%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(Kazaar the Kender Armourer sits here polishing some chain mail|Kazaar is here)(, fighting [^\.!]+.|)" tfMobsubstKenderKazaar = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Kazaar @{Cgreen}(N, 50, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Kint the master baker stands here, awaiting your order\.|Kint is here)(, fighting [^\.!]+.|)" tfMobsubstKenderKint = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Kint @{Cgreen}(N, 50, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Musin stands here, showing off his magical wares to customers\. \(invisible\)|Musin \(invisible\) is here)(, fighting [^\.!]+.|)" tfMobsubstKenderMusin = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Musin @{Cgreen}(N, 50, shopkeeper)@{n} (imp)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Poe the Kender Weaponsmaster watches you evilly from behind a counter\.|Poe is here)(, fighting [^\.!]+.|)" tfMobsubstKenderPoe = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Poe @{Cgreen}(N, 50, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Sadi the Kender watershop owner is weeping here\.|Sadi is here)(, fighting [^\.!]+.|)" tfMobsubstKenderSadi = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Sadi @{Cgreen}(N, 50, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Judge is here, smiling peacefully\.|The Judge is here)(, fighting [^\.!]+.|)" tfMobsubstKenderJudge = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Judge @{Cgreen}(N, 50, hobbit)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Tika the bartender is here serving out drinks to her customers\.|Tika is here)(, fighting [^\.!]+.|)" tfMobsubstKenderTika = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Tika @{Cgreen}(N, 50, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Tanis the master archer sits here, refining new arrows|Tanis is here)(, fighting [^\.!]+.|)" tfMobsubstKenderTanis = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Tanis @{Cgreen}(N, 60, half-elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A powerful looking thief rests in the shadows\.|Brontar the Thief Master is here)(, fighting [^\.!]+.|)" tfMobsubstKenderBrontar = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Brontar the Thief Master @{Cgreen}(N, 65, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Goldmoon the barbarian princess stands regally here\.|Goldmoon is here)(, fighting [^\.!]+.|)" tfMobsubstKenderGoldmoon = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Goldmoon @{Cgreen}(N, 65, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Caramon the giant stands here, listening to Raistlins' ramblings\.( \(invisible\)|)|Caramon( \(invisible\)|) is here)(, fighting [^\.!]+.|)" tfMobsubstKenderCaramon = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}Caramon @{Cgreen}(N, 70, human)@{n}%{invisTxt}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Flint Fireforge the Dwarf is awaiting a meal\.( \(invisible\)|)|Flint Fireforge( \(invisible\)|) is here)(, fighting [^\.!]+.|)" tfMobsubstKenderFlint = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}Flint Fireforge @{Cgreen}(N, dwarf, hobbit)@{n}%{invisTxt}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Sturm the Great Knight stands proudly here\.|Sturm is here)(, fighting [^\.!]+.|)" tfMobsubstKenderSturm = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Sturm @{Cgreen}(N, 70, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Raistlin the powerful mage is here practicing his magic\.( \(invisible\)|)|Raistlin( \(invisible\)|) is here)(, fighting [^\.!]+.|)" tfMobsubstKenderRaistlin = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}Raistlin @{Cgreen}(N, 75, human)@{n}%{invisTxt}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Zara the charitable kender sits at a desk here, counting her money\.( \(invisible\)|)|Zara( \(invisible\)|) is here)(, fighting [^\.!]+.|)" tfMobsubstKenderZara = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}Zara @{Cgreen}(N, 80, hobbit)@{n}%{invisTxt}%{P4}%{PR}%; \
    /endif
; ------------
/def -p99 -F -mregexp -t"(The Ein Snower awaits his next meal, which looks like you\.|The Ein Snower is here)(, fighting [^\.!]+.|)" tfMobsubstKenderSnowballEinSnower = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Ein Snower @{Cgreen}(N, 38-40, entity)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Kapak Snowconian is here\.|The Kapak Snowconain is here)(, fighting [^\.!]+.|)" tfMobsubstKenderSnowballSnowconain = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Kapak Snowconain @{Cgreen}(N, 40, lizardman)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(V'snowy Vair awaits your arrival with a manical gleam in her eyes\.|V'snowy Vair is here)(, fighting [^\.!]+.|)" tfMobsubstKenderSnowballVair = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}V'snowy Vair @{Cgreen}(N, 40, human)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Kerjim  -----------------------
/def -p99 -F -mregexp -t"(A human slave is chained to the wall here\.|A human slave is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKerjimSlave = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A human slave @{Cgreen}(@{nCwhite}G@{nCgreen}, 20, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A small winged balrog is here gazing at you with demonic red eyes\.|A small balrog is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstKerjimSmallBalrog = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A small balrog @{Cgreen}(@{nCred}E@{nCgreen}, 45, devil)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An undead corpse is here, attempting to persuade you to join the living dead\.|The corpse is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstKerjimCorpse = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The corpse @{Cgreen}(@{nCred}E@{nCgreen}, 50, undead)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Elder Balrog reaches menacingly towards you\.|The Elder Balrog is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstKerjimElderBalrog = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Elder Balrog @{Cgreen}(@{nCred}E@{nCgreen}, 50, devil)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Bergron the Balrog Torturer grins wickedly\.|Bergron is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstKerjimBergron = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Bergron @{Cgreen}(@{nCred}E@{nCgreen}, 60, devil, SUMMONER)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Ralich, protector of Kerjim, blocks the portal to his masters abode\.|Ralich is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstKerjimRalich = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Ralich @{Cgreen}(@{nCred}E@{nCgreen}, 60, devil, SUMMONER)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Zedan, protector of Kerjim, blocks the portal to his masters abode\.|Zedan is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstKerjimZedan = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Zedan @{Cgreen}(@{nCred}E@{nCgreen}, 60, devil, SUMMONER)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Grand High Balrog tears his claws deep into your flesh\.|The Grand Balrog is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstKerjimGrandBalrog = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Grand Balrog @{Cgreen}(@{nCred}E@{nCgreen}, 60, devil, SUMMONER)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A balrog shaman invokes the power of his gods\.|A balrog shaman is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstKerjimShaman = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A balrog shaman @{Cgreen}(@{nCred}E@{nCgreen}, 65, devil, SUMMONER)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Lilith stands here in all her magnificence\.|Lilith is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKerjimLilith = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Lilith @{Cgreen}(@{nCwhite}G@{nCgreen}, 75, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Kerjim, Lord of the Balrogs sits here on his throne\.|Kerjim is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstKerjimKerjim = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Kerjim @{Cgreen}(@{nCred}E@{nCgreen}, 75, devil, summoner, SUMMONER)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A large, grey haired man stands defiantly here\.|Gabriel Dreyid is here)(, fighting [^\.!]+.|)" tfMobsubstKerjimGabriel = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Gabriel Dreyid @{Cgreen}(N, 100, human)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Kerofk  -----------------------
/def -p99 -F -mregexp -t"(Mayor Kell greets you into his office with a welcoming hand\.|Kell is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKerofkKell = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Kell @{Cgreen}(@{nCwhite}G@{nCgreen}, 1, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The receptionist smiles and offers you a room\.|The Receptionist is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKerofkReceptionist = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Receptionist @{Cgreen}(@{nCwhite}G@{nCgreen}, 1, nofight-room)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A prisoner here has given up all hopes of escape\.|The Prisoner is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstKerofkPrisoner = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Prisoner @{Cgreen}(@{nCred}E@{nCgreen}, 2, human)@{n}%{P2}%{PR}%; \
    /endif
/set tfMobsubstKerofkGaultorFound 0
/def -p99 -F -mregexp -t"(A drunk person is here, babbling about something incessantly\.|The Drunk is here|Gaultor the Thief is here)(, fighting [^\.!]+.|)" tfMobsubstKerofkDrunk = \
    /if (mobsubs) \
      /if ({P1} =~ 'Gaultor the Thief is here') \
        /substitute -p %{PL}@{nCyellow}Gaultor the Thief @{Cgreen}(N, 50, human)@{n}%{P2}%{PR}%; \
        /set tfMobsubstKerofkGaultorFound 1%; \
        /repeat -1 1 /set tfMobsubstKerofkGaultorFound 0%; \
      /elseif ({P1} =~ 'A drunk person is here, babbling about something incessantly.' & currentroom='The CliffHanger' & !tfMobsubstKerofkGaultorFound) \
        /substitute -p %{PL}@{nCyellow}Gaultor the Thief / The Drunk @{Cgreen}(N, 50/4, human)@{n}%{P2}%{PR}%; \
        /set tfMobsubstKerofkGaultorFound 1%; \
        /repeat -1 1 /set tfMobsubstKerofkGaultorFound 0%; \
      /else \
        /substitute -p %{PL}@{nCyellow}The Drunk @{Cgreen}(N, 4, human)@{n}%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(The barmaids rush about delivering drinks and taking orders\.|The barmaid rushes about delivering drinks and taking orders\.|The Barmaid is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKerofkBarmaid = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Barmaid @{Cgreen}(@{nCwhite}G@{nCgreen}, 5, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Guide of the Kerofk Guiding Alliance is waiting to help you\.|The Guide is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKerofkGuide = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Guide (Kerofk) @{Cgreen}(@{nCwhite}G@{nCgreen}, 5, guide)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A priest is here, performing his absolutions\.|The Priest is here)(, fighting [^\.!]+.|)" tfMobsubstKerofkPriest = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Priest @{Cgreen}(N, 7, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A citizen is here, debating politics with anyone who will listen\.|A citizen of Kerofk is here, going about her business\.|A citizen of Kerofk is here, going about his business\.|A citizen is here, waiting in line\.|The Citizen is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKerofkCitizen = \
    /if (mobsubs) \
      /if ({P1} =~ 'A citizen is here, debating politics with anyone who will listen.') \
        /substitute -p %{PL}@{nCyellow}The Citizen (debating) @{Cgreen}(@{nCwhite}G@{nCgreen}, 9, human)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'A citizen of Kerofk is here, going about his business.') \
        /substitute -p %{PL}@{nCyellow}The Citizen (Kerofk male) @{Cgreen}(@{nCwhite}G@{nCgreen}, 9, human)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'A citizen of Kerofk is here, going about her business.') \
        /substitute -p %{PL}@{nCyellow}The Citizen (Kerofk female) @{Cgreen}(@{nCwhite}G@{nCgreen}, 9, human)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'A citizen is here, waiting in line.') \
        /substitute -p %{PL}@{nCyellow}The Citizen (waiting) @{Cgreen}(@{nCwhite}G@{nCgreen}, 9, human)@{n}%{P2}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}The Citizen (debating/Kerofk/waiting) @{Cgreen}(@{nCwhite}G@{nCgreen}, 9, human)@{n}%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(A gravedigger works away the nightshift here\.|The gravedigger is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKerofkGravedigger = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The gravedigger @{Cgreen}(@{nCwhite}G@{nCgreen}, 9, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A goblin launches into a frenzied attack!|A goblin is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstKerofkGoblin = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A goblin @{Cgreen}(@{nCred}E@{nCgreen}, 10, ---)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The jailer reads his newspaper while sitting in his chair\.|The Jailer is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKerofkJailer = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Jailer @{Cgreen}(@{nCwhite}G@{nCgreen}, 10, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The storm demons attack on the Liche's order!|The Storm Demon is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstKerofkStormDemon = \
    /if (mobsubs & ({P1} =~ "The storm demons attack on the Liche's order!" | area =~ 'Kerofk')) \
      /substitute -p %{PL}@{nCyellow}The Storm Demon @{Cgreen}(@{nCred}E@{nCgreen}, 10, demon)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Sosivia stands here, lost in daydreams\.|Sosivia is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKerofkSosivia = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Sosivia @{Cgreen}(@{nCwhite}G@{nCgreen}, 12, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An unlucky gambler struggles to hold back tears as his money disappears\.|A lucky gambler is here, striking it rich!|The Gambler is here)(, fighting [^\.!]+.|)" tfMobsubstKerofkGambler = \
    /if (mobsubs) \
      /if ({P1} =~ 'An unlucky gambler struggles to hold back tears as his money disappears.') \
        /substitute -p %{PL}@{nCyellow}The Gambler (unlucky) @{Cgreen}(N, 12, human)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'A lucky gambler is here, striking it rich!') \
        /substitute -p %{PL}@{nCyellow}The Gambler (lucky) @{Cgreen}(N, 12, human)@{n}%{P2}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}The Gambler (lucky/unlucky) @{Cgreen}(N, 12, human)@{n}%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p98 -F -mregexp -t"(A militia guard is here keeping the peace\.|The Militia Man is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKerofkMilitiaMan = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Militia Man @{Cgreen}(@{nCwhite}G@{nCgreen}, 13, human, protector)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Bartender pours drinks several at a time to keep up with the rush\.|The Bartender is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKerofkBartender = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Bartender @{Cgreen}(@{nCwhite}G@{nCgreen}, 14, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Bungle Fleecem, esquire, looks at you expectantly\.|Bungle Fleecem is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstKerofkBungleFleecem = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Bungle Fleecem @{Cgreen}(@{nCred}E@{nCgreen}, 14, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The lawyer is here, ready to lie his tongue out\.|The Lawyer is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstKerofkLawyer = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Lawyer @{Cgreen}(@{nCred}E@{nCgreen}, 14, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Korino spars with his brother Talbot here\.|Korino is here)(, fighting [^\.!]+.|)" tfMobsubstKerofkKorino = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Korino @{Cgreen}(N, 15, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Talbot spars with his brother Korino here\.|Talbot is here)(, fighting [^\.!]+.|)" tfMobsubstKerofkTalbot = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Talbot @{Cgreen}(N, 15, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The council member looks quite upset as you interrupt them!|The Council Member is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKerofkCouncilMember = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Council Member @{Cgreen}(@{nCwhite}G@{nCgreen}, 15, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The gateguard is here, guarding the gate\.|The Gateguard is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKerofkGateguard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Gateguard @{Cgreen}(@{nCwhite}G@{nCgreen}, 15, human, protector)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Celia sneers at you\.\.\.Sneer!  Sneer!|Celia is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstKerofkCelia = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Celia @{Cgreen}(@{nCred}E@{nCgreen}, 16, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A receptionist stands in front of you, waiting to help you\.|The Receptionist is here)(, fighting [^\.!]+.|)" tfMobsubstKerofkReceptionist2 = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Receptionist @{Cgreen}(N, 17-18, nofight-room)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A hellhound looks at you with hunger\.|A hellhound is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstKerofkHellhound = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A hellhound @{Cgreen}(@{nCred}E@{nCgreen}, 18, magical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A bright shining light here nearly blinds you!|The Bright Light is here)(, fighting [^\.!]+.|)" tfMobsubstKerofkBrightLight = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Bright Light @{Cgreen}(N, 18, insubstantial)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The farmer sells her lackluster with all the excitement it warrants\.|The Farmer is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKerofkFarmer = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Farmer @{Cgreen}(@{nCwhite}G@{nCgreen}, 18, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Some guardian wisps here attack!|The Guardian Wisp is here)(, fighting [^\.!]+.|)" tfMobsubstKerofkGuardianWisp = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Guardian Wisp @{Cgreen}(N, 18, insubstantial)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(MouseRider sits on his throne here, his head in his hands\.|MouseRider is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKerofkMouseRider = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}MouseRider @{Cgreen}(@{nCwhite}G@{nCgreen}, 20, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A mist-like being stabs at you with a tendril!( \(invisible\)|) \(hidden\)|The Edimmu( \(invisible\)|) \(hidden\) is here)(, fighting [^\.!]+.|)" tfMobsubstKerofkEdimmu = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}The Edimmu @{Cgreen}(N, 20, insubstantial, summoner)@{n}%{invisTxt} (hide)%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Sentinel Beast's eyes glow chaotically as it attacks!|The Sentinel Beast is here)(, fighting [^\.!]+.|)" tfMobsubstKerofkSentinelBeast = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Sentinel Beast @{Cgreen}(N, 20, magical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Council Guards look ready to rip you apart if you disturb the meeting\.|The Council Guard is here)(, fighting [^\.!]+.|)" tfMobsubstKerofkCouncilGuard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Council Guard @{Cgreen}(N, 23, human, protector)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Bookstore Owner looks up from a paperback as you come in\.|The Bookstore Owner is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstKerofkBookstoreOwner = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Bookstore Owner @{Cgreen}(@{nCred}E@{nCgreen}, 23, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The dealer sets out a new hand for all to play\.|The Dealer is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKerofkDealer = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Dealer @{Cgreen}(@{nCwhite}G@{nCgreen}, 23, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The herbalist is here, reading to her plants\.|The Herbalist is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKerofkHerbalist = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Herbalist @{Cgreen}(@{nCwhite}G@{nCgreen}, 23, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The recruiting sergeant tries to make you sign his forms\.|The Sergeant is here)(, fighting [^\.!]+.|)" tfMobsubstKerofkSergeant = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Sergeant @{Cgreen}(N, 23, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The shopkeeper smiles at you as you enter her store\.|The Shopkeeper is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKerofkShopkeeper = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Shopkeeper @{Cgreen}(@{nCwhite}G@{nCgreen}, 23, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Ben counts his money, ignoring you completely\.|Ben is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstKerofkBen = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Ben @{Cgreen}(@{nCred}E@{nCgreen}, 24, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Leonna, guildmaster of the Mages' Guild of Kerofk, greets you\.|Leonna is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKerofkLeonna = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Leonna @{Cgreen}(@{nCred}E@{nCgreen}, 24, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Thieves' Guildmaster, Seobagn, watches you with narrowed eyes\.|Seobagn is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstKerofkSeobagn = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Seobagn @{Cgreen}(@{nCred}E@{nCgreen}, 24, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The High Priest is here, glowing with the benevolence of AO\.|The High Priest is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKerofkHighPriest = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The High Priest @{Cgreen}(@{nCwhite}G@{nCgreen}, 24, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The secretary pops his gum and asks you what you want\.|The Secretary is here)(, fighting [^\.!]+.|)" tfMobsubstKerofkSecretary = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Secretary @{Cgreen}(N, 24, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Jenk is here, ready to sell you anything!|Jenk is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstKerofkJenk = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Jenk @{Cgreen}(@{nCred}E@{nCgreen}, 25, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Kervin the wandering mage is well, \.\.\.wandering here\.|Kervin is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKerofkKervin = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Kervin @{Cgreen}(@{nCwhite}G@{nCgreen}, 25, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The black marketeer is here ready to sell you anything you want\.|The Black Marketeer is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstKerofkBlackMarketeer = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Black Marketeer @{Cgreen}(@{nCred}E@{nCgreen}, 25, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Captain of the Guard salutes you with his epee\.|The Captain is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKerofkCaptain = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Captain @{Cgreen}(@{nCwhite}G@{nCgreen}, 25, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A innguard is here, ready to fight off some marauding hordes\.|The Innguard is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKerofkInnguard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Innguard @{Cgreen}(@{nCwhite}G@{nCgreen}, 25, human, protector)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Tiersten looks at you with angry eyes and bared fangs!|Tiersten is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstKerofkTiersten = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Tiersten @{Cgreen}(@{nCred}E@{nCgreen}, 26, vampire)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The orb glows with a pure white light\.|The Orb is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKerofkTheOrb = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Orb @{Cgreen}(@{nCwhite}G@{nCgreen}, 28, entity)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The liche that was MouseRider curses you horribly!|The Liche is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstKerofkLiche = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Liche @{Cgreen}(@{nCred}E@{nCgreen}, 30, undead)@{n}%{P2}%{PR}%; \
    /endif
/def -p100 -F -mregexp -t"(The cartographer is here, busily copying new maps\.|The Cartographer is here)(, fighting [^\.!]+.|)" tfMobsubstKerofkCartographer = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Cartographer @{Cgreen}(N, 99, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The item clerk looks up as you enter and asks how he can help you\.|The Item Clerk is here)(, fighting [^\.!]+.|)" tfMobsubstKerofkItemClerk = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Item Clerk @{Cgreen}(N, 99, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Beau the Dealer smiles swarthily at all who enter\.|Beau the Dealer is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstKerofkBeau = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Beau the Dealer @{Cgreen}(@{nCred}E@{nCgreen}, 100, special-gamble)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(This well known blacksmith needs a ghost hunter\.|Iglaus Mefren the reknowned blacksmith is here)(, fighting [^\.!]+.|)" tfMobsubstKerofkIglaus = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Iglaus Mefren the reknowned blacksmith @{Cgreen}(N, 100, QM)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A thin man in a red cloak beckons to you\.|Thanalos Stormfeld is here)(, fighting [^\.!]+.|)" tfMobsubstKerofkThanalos = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Thanalos Stormfeld @{Cgreen}(N, 100, QM)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The barker leans against the doorframe, barking out orders to all who enter\.|The Barker is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstKerofkBarker = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Barker @{Cgreen}(@{nCred}E@{nCgreen}, 100, special-gamble)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(One of the local town guards stands here, watching you warily\.|Viagra the Town Guard is here)(, fighting [^\.!]+.|)" tfMobsubstKerofkViagra = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Viagra the Town Guard @{Cgreen}(N, 100, human)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Khronatio  -----------------------
/def -p99 -F -mregexp -t"(You see the ghost of a long dead woman floating here\.|A ghost of a decapitated woman is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstKhronatioDecap = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A ghost of a decapitated woman @{Cgreen}(@{nCred}E@{nCgreen}, 84, water, murder)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Khronatian Gatehouse Guard is here, floating in the air\.|Khronatian Gatehouse Guard is here)(, fighting [^\.!]+.|)" tfMobsubstKhronatioGatehouseGuard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Khronatian Gatehouse Guard @{Cgreen}(N, 85, human/water, SUMMONER)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A large Kronatio cityguard is standing here\.|A Guard of Khron is here)(, fighting [^\.!]+.|)" tfMobsubstKhronatioGuard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Guard of Khron @{Cgreen}(N, 92, human/water)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A bloodthirsty soldier of Khron is here, floating in the air\.|Soldier of Khron is here)(, fighting [^\.!]+.|)" tfMobsubstKhronatioSoldier = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Soldier of Khron @{Cgreen}(N, 94, human/water, murder)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A proud captain of the guard is here, floating in the air\.|The late Captain of Khron is here)(, fighting [^\.!]+.|)" tfMobsubstKhronatioCaptain = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The late Captain of Khron @{Cgreen}(N, 95, human/water, murder)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(a Ghostly Shopkeeper is here, floating in the air\.|Ghostly shopkeeper is here)(, fighting [^\.!]+.|)" tfMobsubstKhronatioShopkeeper = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Ghostly shopkeeper @{Cgreen}(N, 99, nofight-room)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  King's Castle  -----------------------
/def -p99 -F -mregexp -t"(There is a Cleaning Woman here, trying not be noticed\.|The cleaning woman is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKingsCastleCleaningWoman = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The cleaning woman @{Cgreen}(@{nCwhite}G@{nCgreen}, 1, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(James the Butler is standing here, looking pompous\.|James the butler is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKingsCastleJames = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}James the butler  @{Cgreen}(@{nCwhite}G@{nCgreen}, 20, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(There is a Cook here, making himself busy with a pot\.|The cook is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKingsCastleCook = \
    /if (mobsubs & ({P1} != 'The cook is here' | area =~ 'KingsCastle')) \
      /substitute -p %{PL}@{nCyellow}The cook @{Cgreen}(@{nCwhite}G@{nCgreen}, 24, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Brian the Royal guard is here, training with the Master\.|Brian is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKingsCastleBrian = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Brian @{Cgreen}(@{nCwhite}G@{nCgreen}, 30, human, protector)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Jerry the Royal guard is here off duty, playing dice\.|Jerry the royal guard is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKingsCastleJerry = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Jerry the royal guard @{Cgreen}(@{nCwhite}G@{nCgreen}, 30, human, protector)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Jim the Royal guard is here on duty\.|Jim the royal guard is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKingsCastleJim = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Jim the royal guard @{Cgreen}(@{nCwhite}G@{nCgreen}, 30, human, protector)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Jochem the Royal guard sits here, off duty\.|Jochem the royal guard is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKingsCastleJochem = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Jochem the royal guard @{Cgreen}(@{nCwhite}G@{nCgreen}, 30, human, protector)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Matt the Royal guard is here on duty\.|Matt the royal guard is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKingsCastleMatt = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Matt the royal guard @{Cgreen}(@{nCwhite}G@{nCgreen}, 30, human, protector)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Michael the Royal guard is here off duty, playing dice\.|Michael the royal guard is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKingsCastleMichael = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Michael the royal guard @{Cgreen}(@{nCwhite}G@{nCgreen}, 30, human, protector)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Mick the Royal guard is here, training with the Master\.|Mick is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKingsCastleMick = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Mick @{Cgreen}(@{nCwhite}G@{nCgreen}, 30, human, protector)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Royal Herald is standing here\.|The royal herald is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKingsCastleHerald = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The royal herald @{Cgreen}(@{nCwhite}G@{nCgreen}, 33, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Andrew the Royal guard is here on duty\.|Andrew the royal guard is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKingsCastleAndrew = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Andrew the royal guard @{Cgreen}(@{nCwhite}G@{nCgreen}, 35, human, protector)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Anne the Royal guard is here on duty\.|Anne the royal guard is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKingsCastleAnne = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Anne the royal guard @{Cgreen}(@{nCwhite}G@{nCgreen}, 35, human, protector)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Hans the Royal guard is here on duty\.|Hans the royal guard is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKingsCastleHans = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Hans the royal guard @{Cgreen}(@{nCwhite}G@{nCgreen}, 35, human, protector)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Chef is here, shouting orders to the other cooks\.|The chef is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKingsCastleChef = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The chef @{Cgreen}(@{nCwhite}G@{nCgreen}, 39, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Bertram the Royal guard is here on duty\.|Bertram the royal guard is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKingsCastleBertram = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Bertram the royal guard @{Cgreen}(@{nCwhite}G@{nCgreen}, 40, human, protector)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Boris the Royal guard is here on duty\.|Boris the royal guard is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKingsCastleBoris = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Boris the royal guard @{Cgreen}(@{nCwhite}G@{nCgreen}, 40, human, protector)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Jeanette the Royal guard is here on duty\.|Jeanette the royal guard is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKingsCastleJeanette = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Jeanette the royal guard @{Cgreen}(@{nCwhite}G@{nCgreen}, 40, human, protector)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Tim, the King's Lifeguard, is standing here\.|Tim, the king's lifeguard is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKingsCastleTim = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Tim, the king's lifeguard @{Cgreen}(@{nCwhite}G@{nCgreen}, 40, human, protector)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Tom, the King's Lifeguard, is standing here\.|Tom, the king's lifeguard is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKingsCastleTom = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Tom, the king's lifeguard @{Cgreen}(@{nCwhite}G@{nCgreen}, 40, human, protector)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Training Master is here, supervising\.|The training master is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKingsCastleTrainingMaster = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The training master @{Cgreen}(@{nCwhite}G@{nCgreen}, 42, human, protector)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Peter, the Captain of the Royal guard, walks around inspecting\.|Peter, the captain of the royal guard is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKingsCastlePeter = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Peter, the captain of the royal guard @{Cgreen}(@{nCwhite}G@{nCgreen}, 45, nofight-room)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(David, a big, mean-looking man, stands here, guarding the door\.|David is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKingsCastleDavid = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}David @{Cgreen}(@{nCwhite}G@{nCgreen}, 50, human, protector)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Dick, a big, mean-looking man, stands here, guarding the door\.|Dick is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKingsCastleDick = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Dick @{Cgreen}(@{nCwhite}G@{nCgreen}, 50, human, protector)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Astrologer is sitting here, studying a book\.|The astrologer is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKingsCastleAstrologer = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The astrologer @{Cgreen}(@{nCwhite}G@{nCgreen}, 70, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The wise King Welmar sits here in his throne\.|King Welmar is( sitting| sleeping|) here)(\.|)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKingsCastleWelmar = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}King Welmar @{Cgreen}(@{nCwhite}G@{nCgreen}, 80, human, protector)@{n}%{P2}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Haldur son of Haldir is resting here\.|Haldur son of Haldir is here)(, fighting [^\.!]+.|)" tfMobsubstKingsCastleHaldur = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Haldur son of Haldir @{Cgreen}(N, 100, QM)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Isengrim, the King's personal Counselor, is standing here looking sad\.|Isengrim is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstKingsCastleIsengrim = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Isengrim @{Cgreen}(@{nCwhite}G@{nCgreen}, 100, nofight-room)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Nerwren, the King's Questmaster, eyes you intently\.|Nerwren is here)(, fighting [^\.!]+.|)" tfMobsubstKingsCastleNerwren = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Nerwren @{Cgreen}(N, 100, QM)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An old wizard in a long red cloak sits here, lost deep in thought\. \(invisible\)|Rasmuss the Court Mage \(invisible\) is resting here\.|Rasmuss the Court Mage \(invisible\) is here)(, fighting [^\.!]+.|)" tfMobsubstKingsCastleRasmuss = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Rasmuss the Court Mage @{Cgreen}(N, 100, QM)@{n} (imp)%{P2}%{PR}%; \
    /endif

; -----------------------  Krashkarand  -----------------------
/def -p99 -F -mregexp -t"(A marsh viper is here!!|A marsh viper is here)(, fighting [^\.!]+.|)" tfMobsubstKrashkarandViper = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A marsh viper @{Cgreen}(N, 25, snake)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A small child is chasing a frog\.|A small child is here)(, fighting [^\.!]+.|)" tfMobsubstKrashkarandChild = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A small child @{Cgreen}(N, 25, human, thief)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A venom wurm is here!|A venom wurm is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstKrashkarandWurm = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A venom wurm @{Cgreen}(@{nCred}E@{nCgreen}, 25, dragon)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A villager is standing here\.|A villager is here)(, fighting [^\.!]+.|)" tfMobsubstKrashkarandVillager = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A villager @{Cgreen}(N, 25, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A deadly insect is here looking for food\.|A deadly insect is here)(, fighting [^\.!]+.|)" tfMobsubstKrashkarandInsect = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A deadly insect @{Cgreen}(N, 30, insect)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A jungle goblin is standing here\.|A jungle goblin is here)(, fighting [^\.!]+.|)" tfMobsubstKrashkarandGoblin = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A jungle goblin @{Cgreen}(N, 30, ---)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A village guardian stands here\. \(invisible\) \(hidden\)|A village guardian \(invisible\) \(hidden\) is here)(, fighting [^\.!]+.|)" tfMobsubstKrashkarandGuardian = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A village guardian @{Cgreen}(N, 30, human)@{n} (imp) (hide)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A village shaman stands here mixing some herbs\. \(invisible\) \(hidden\)|A village shaman \(invisible\) \(hidden\) is here)(, fighting [^\.!]+.|)" tfMobsubstKrashkarandShaman = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A village shaman @{Cgreen}(N, 30, human)@{n} (imp) (hide)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Ghazga the holy guardian is standing here!|Ghazga the holy guardian is here)(, fighting [^\.!]+.|)" tfMobsubstKrashkarandGhazga = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Ghazga the holy guardian @{Cgreen}(N, 45, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Nebuchadnezzar the Village Chief is standing here watching you carefully\.|Nebuchadnezzar the Village Chief is here)(, fighting [^\.!]+.|)" tfMobsubstKrashkarandNebuchadnezzar = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Nebuchadnezzar the Village Chief @{Cgreen}(N, 65, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Garatza the evil Serpent god is floating here ready to kill you!|Garatza the evil Serpent god is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstKrashkarandGaratza = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Garatza the evil Serpent god @{Cgreen}(@{nCred}E@{nCgreen}, 75, mythical)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Laboratory  -----------------------
/def -p99 -F -mregexp -t"(A pair of glowing red eyes stare at you\.|The soulcrusher stands here\.|A blurred figure stands here\.|The soulcrusher glances at you with fear\.|An angry looking soulcrusher is standing here\.|The soulcrusher is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstLaboratorySoulcrusher = \
    /if (mobsubs) \
      /if ({P1} =~ 'A pair of glowing red eyes stare at you.') \
        /substitute -p %{PL}@{nCyellow}The soulcrusher (eyes) @{Cgreen}(@{nCred}E@{nCgreen}, 68, demon, assist-equals)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'The soulcrusher stands here.') \
        /substitute -p %{PL}@{nCyellow}The soulcrusher @{Cgreen}(@{nCred}E@{nCgreen}, 68, demon, assist-equals)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'A blurred figure stands here.') \
        /substitute -p %{PL}@{nCyellow}The soulcrusher (blurred) @{Cgreen}(@{nCred}E@{nCgreen}, 80, demon, assist-equals)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'The soulcrusher glances at you with fear.') \
        /substitute -p %{PL}@{nCyellow}The soulcrusher (fear) @{Cgreen}(@{nCred}E@{nCgreen}, 80, demon, assist-equals)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'An angry looking soulcrusher is standing here.') \
        /substitute -p %{PL}@{nCyellow}The soulcrusher (angry) @{Cgreen}(@{nCred}E@{nCgreen}, 90, demon)@{n}%{P2}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}The soulcrusher (angry?) @{Cgreen}(@{nCred}E@{nCgreen}, 90, demon)@{n}%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(A great soulcrusher stands here\.|The Great Soulcrusher is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstLaboratoryGreatSoulcrusher = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Great Soulcrusher @{Cgreen}(@{nCred}E@{nCgreen}, 85, demon)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A mystical soulcrusher( \(invisible\)|)|The mystical soulcrusher( \(invisible\)|) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstLaboratoryMysticalSoulcrusher = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}The mystical soulcrusher @{Cgreen}(@{nCred}E@{nCgreen}, 95, demon)@{n}%{invisTxt}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The SoulStealer sits here with great content about himself\.|The SoulStealer is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstLaboratorySoulStealer = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The SoulStealer @{Cgreen}(@{nCred}E@{nCgreen}, 100, demon, deathspell)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Lagamore  -----------------------
/def -p99 -F -mregexp -t"(A duck is here, quacking happily\.|The Duck is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstLagamoreDuck = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Duck @{Cgreen}(@{nCwhite}G@{nCgreen}, 1, bird)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A pelican is swimming around in a shallow pool here\.|The pelican is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstLagamorePelican = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The pelican @{Cgreen}(@{nCwhite}E@{nCgreen}, 1, bird)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A sparrow is flapping around on the ground\.|The Sparrow is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstLagamoreSparrow = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Sparrow @{Cgreen}(@{nCwhite}G@{nCgreen}, 1, bird)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A swan is swimming around in the pond\.|The Swan is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstLagamoreSwan = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Swan @{Cgreen}(@{nCwhite}G@{nCgreen}, 1, bird)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A beaver ignores you and continues munching away at a tree-trunk\.|The beaver is here)(, fighting [^\.!]+.|)" tfMobsubstLagamoreBeaver = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The beaver @{Cgreen}(N, 2, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A chipmunk tries to hide from you|The chipmunk is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstLagamoreChipmunk = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The chipmunk @{Cgreen}(@{nCwhite}G@{nCgreen}, 2, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A sheep says \"Baaaaa\" at you\.|The Ewe is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstLagamoreEwe = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Ewe @{Cgreen}(@{nCwhite}G@{nCgreen}, 2, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Timmy the Carthorse rolls his eyes and nickers\.|Timmy the Carthorse is here)(, fighting [^\.!]+.|)" tfMobsubstLagamoreTimmy = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Timmy the Carthorse @{Cgreen}(N, 2, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A sheep says \"Baaa Baaaa\" at you\.|The Ram is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstLagamoreRam = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Ram @{Cgreen}(@{nCwhite}G@{nCgreen}, 4, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A tiny pony munches hay here\.|Tiny is here)(, fighting [^\.!]+.|)" tfMobsubstLagamoreTiny = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Tiny @{Cgreen}(N, 4, ---)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Burr stamps his foot impatiently|Burr is here)(, fighting [^\.!]+.|)" tfMobsubstLagamoreBurr = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Burr @{Cgreen}(N, 5, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Bessy neighs to you\.|Bessy is here)(, fighting [^\.!]+.|)" tfMobsubstLagamoreBessy = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Bessy @{Cgreen}(N, 6, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A foxhound drools on your boots\.|A foxhound is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstLagamoreFoxhound = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A foxhound @{Cgreen}(@{nCwhite}G@{nCgreen}, 10, canine)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Clyde the groom is here, cleaning saddles\.|The groom is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstLagamoreGroom = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The groom @{Cgreen}(@{nCwhite}G@{nCgreen}, 10, human, mana shielded)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Flash the Magnificent rears up and thrashes the air with his hooves!|Flash the Magnificent is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstLagamoreFlash = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Flash the Magnificent @{Cgreen}(@{nCwhite}G@{nCgreen}, 15, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Jeeves, the butler, awaits your request\.( \(invisible\)|)|Jeeves, the butler( \(invisible\)|) is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstLagamoreJeeves = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}Jeeves, the butler @{Cgreen}(@{nCwhite}G@{nCgreen}, 24, human)@{n}%{invisTxt}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A maid screams 'Get out of my room you pervert!!'|The Maid is here)(, fighting [^\.!]+.|)" tfMobsubstLagamoreMaid = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Maid @{Cgreen}(N, 26, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A lackey pesters you for attention\.|The lackey is here)(, fighting [^\.!]+.|)" tfMobsubstLagamoreLackey = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The lackey @{Cgreen}(N, 27, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A sweaty cook sits here, smoking a cigarette\.|The cook is here)(, fighting [^\.!]+.|)" tfMobsubstLagamoreCook = \
    /if (mobsubs & ({P1} != 'The cook is here' | area =~ 'Lagamore')) \
      /substitute -p %{PL}@{nCyellow}The cook @{Cgreen}(N, 32, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Bela is here, ready to accuse you of misbehaving!|Bela the Governess is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstLagamoreBela = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Bela the Governess @{Cgreen}(@{nCred}E@{nCgreen}, 33, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A student is practising here, he wears a yellow belt\.|A student is practising here, she wears a blue belt\.|A student is practising here, he wears a brown belt\.|The Student is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstLagamoreStudent = \
    /if (mobsubs) \
      /if ({P1} =~ 'A student is practising here, he wears a yellow belt.') \
        /substitute -p %{PL}@{nCyellow}The Student (yellow belt) @{Cgreen}(@{nCred}E@{nCgreen}, 35, human)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'A student is practising here, she wears a blue belt.') \
        /substitute -p %{PL}@{nCyellow}The Student (blue belt) @{Cgreen}(@{nCred}E@{nCgreen}, 38, human)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ 'A student is practising here, he wears a brown belt.') \
        /substitute -p %{PL}@{nCyellow}The Student (brown belt) @{Cgreen}(@{nCred}E@{nCgreen}, 42, human)@{n}%{P2}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}The Student (yellow/blue/brown belt) @{Cgreen}(@{nCred}E@{nCgreen}, 35/38/42, human)@{n}%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(A librarian scowls at you and says 'Shhhhhhhh!!!!'|The librarian is here)(, fighting [^\.!]+.|)" tfMobsubstLagamoreLibrarian = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The librarian @{Cgreen}(N, 42, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A doberman snarls and lunges at you!|The doberman is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstLagamoreDoberman = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The doberman @{Cgreen}(@{nCred}E@{nCgreen}, 47, canine)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A sensei watches his students with pride\. He is wearing a black belt\.|The Sensei is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstLagamoreSensei = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Sensei @{Cgreen}(@{nCwhite}G@{nCgreen}, 55, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Master is meditating here\.  His belt has faded to grey from practice\.|The Master is standing here\.|The Master is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstLagamoreMaster = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Master @{Cgreen}(@{nCwhite}G@{nCgreen}, 85, human)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Lahresin  -----------------------
/def -p100 -F -mregexp -t"(A small rabbit is here, looking innocent\.|A rabbit is here)(, fighting [^\.!]+.|)" tfMobsubstLahresinRabbit = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A rabbit @{Cgreen}(N, 1, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A small sparrow is here, pecking on the ground\.|A sparrow is here)(, fighting [^\.!]+.|)" tfMobsubstLahresinSparrow = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A sparrow @{Cgreen}(N, 1, ---)@{n}%{P2}%{PR}%; \
    /endif
/def -p100 -F -mregexp -t"(An orc child is here, playing around\.|An orc child is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstLahresinChild = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An orc child @{Cgreen}(@{nCred}E@{nCgreen}, 30, orc)@{n}%{P2}%{PR}%; \
    /endif
/def -p100 -F -mregexp -t"(An orc woman is here, doing her daily duties\.|An orc woman is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstLahresinWoman = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An orc woman @{Cgreen}(@{nCred}E@{nCgreen}, 40, orc)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An orc man stands here, looking busy\.|An orc man is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstLahresinMan = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An orc man @{Cgreen}(@{nCred}E@{nCgreen}, 45, orc)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An orc commander stands here\.|An orc commander is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstLahresinCommander = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An orc commander @{Cgreen}(@{nCred}E@{nCgreen}, 50, orc)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An orc guard stands here, glaring at you\.|An orc guard is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstLahresinGuard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An orc guard @{Cgreen}(@{nCred}E@{nCgreen}, 53, orc)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The orc guardian stands here\.|The orc guardian is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstLahresinGuardian = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The orc guardian @{Cgreen}(@{nCred}E@{nCgreen}, 65, orc)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A suffering creature is standing here\.|A suffering ghoul is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstLahresinGhoul = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A suffering ghoul @{Cgreen}(@{nCred}E@{nCgreen}, 65, undead)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A tortured soul is standing here\.|A tortured soul is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstLahresinTorturedSoul = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A tortured soul @{Cgreen}(@{nCred}E@{nCgreen}, 67, entity)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A evil lifestream floats in the air here\.|A lost soul is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstLahresinLostSoul = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A lost soul @{Cgreen}(@{nCred}E@{nCgreen}, 75, undead)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Corpse of Loreshi, the elf-king is lying here\.|Loreshi, the undead elf-king is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstLahresinLoreshi = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Loreshi, the undead elf-king @{Cgreen}(@{nCred}E@{nCgreen}, 90, undead, resist WEAPON/pure/light/silver, summoner)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Lethriel's Crypt  -----------------------
/def -p99 -F -mregexp -t"(a small guardian of the unholy is standing here\.( \(invisible\)|)|A small Guardian of The Unholy( \(invisible\)|) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstLethrielGuardian = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}A small Guardian of The Unholy @{Cgreen}(@{nCred}E@{nCgreen}, 50, undead)@{n}%{invisTxt}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(a Watchman of the Dark is standing here\.( \(invisible\)|)|A Watchman of the Dark( \(invisible\)|) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstLethrielWatchman = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}A Watchman of the Dark @{Cgreen}(@{nCred}E@{nCgreen}, 55, skeleton/crush/pure/light/silver, murder)@{n}%{invisTxt}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The ancient spirit of a long lost Ptrekkian King is standing here\.|The Spirit of a forgotten Ptrekkian King is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstLethrielSpirit = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Spirit of a forgotten Ptrekkian King @{Cgreen}(@{nCred}E@{nCgreen}, 60, entity/light)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(You sense a hidden life form in the room\.|A demon of old is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstLethrielDemonOfOld = \
    /if (mobsubs & race =~ 'Ktv' & area =~ 'LethrielsCrypt') \
      /substitute -p %{PL}@{nCyellow}A demon of old @{Cgreen}(@{nCred}E@{nCgreen}, 75, demon, ULTRA-hide)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Ice Demon is standing here\.|The Ice-Demon is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstLethrielIceDemon = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Ice-Demon @{Cgreen}(@{nCred}E@{nCgreen}, 75, fire)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(the Ptrekkian priest of Ptrok is walking around\.|The Ptrekkian priest of Ptrok is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstLethrielPriest = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Ptrekkian priest of Ptrok @{Cgreen}(@{nCred}E@{nCgreen}, 75, no-attack)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Red Lava Demon is standing here\.|The Red Lava-Demon is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstLethrielLavaDemon = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Red Lava-Demon @{Cgreen}(@{nCred}E@{nCgreen}, 75, ice)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Solid Earth Demon is standing here\.|The Solid Earth-Demon is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstLethrielEarthDemon = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Solid Earth-Demon @{Cgreen}(@{nCred}E@{nCgreen}, 75, air)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Translucent Air Demon is standing here\.|The Translucent Air-Demon is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstLethrielAirDemon = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Translucent Air-Demon @{Cgreen}(@{nCred}E@{nCgreen}, 75, earth)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(the Chaotic Demon-Lord is standing here\.|The Chaotic Demon-Lord is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstLethrielLord = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Chaotic Demon-Lord @{Cgreen}(@{nCred}E@{nCgreen}, 100, ---, murder)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Little Haven  -----------------------
/def -p99 -F -mregexp -t"(A thief is here, sneaking between the shadows\.|The thief is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstLittleHavenThief = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The thief @{Cgreen}(@{nCred}E@{nCgreen}, 15, large/superlarge)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The busy gnome shuffles past you\.|The busy gnome is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstLittleHavenBusyGnome = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The busy gnome @{Cgreen}(@{nCwhite}G@{nCgreen}, 16, large/superlarge)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The gnome guard stands at attention\.|The gnome guard is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstLittleHavenGnomeGuard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The gnome guard @{Cgreen}(@{nCwhite}G@{nCgreen}, 20, large/superlarge)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The frost giant guard is ready for intruders\.|The cold frost giant is here)(, fighting [^\.!]+.|)" tfMobsubstLittleHavenFrostGiant = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The cold frost giant @{Cgreen}(N, 20, giant)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The master herbal is playing with her mints\.|The master herbal is here)(, fighting [^\.!]+.|)" tfMobsubstLittleHavenHerbal = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The master herbal @{Cgreen}(N, 20, elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -msimple -t"directions, making you completely dizzy! There is a big plaque on the wall." tfMobsubstLittleHavenWhiteMistressDescFix = \
    /def -p100 -n1 -msimple -t"The white mistress leaps and shouts \"Intruder!\"" tfMobsubstLittleHavenWhiteMistressDescFix2 = \
      donothing
/def -p99 -F -mregexp -t"(The white mistress leaps and shouts \"Intruder!\"|The white mistress is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstLittleHavenWhiteMistress = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The white mistress @{Cgreen}(@{nCred}E@{nCgreen}, 20, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The giant polar bear doesn't like you disturbing her sleep\.|The giant polar bear is here)(, fighting [^\.!]+.|)" tfMobsubstLittleHavenBear = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The giant polar bear @{Cgreen}(N, 24, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The white dragon glares at you\.|The white dragon is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstLittleHavenWhiteDragon = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The white dragon @{Cgreen}(@{nCred}E@{nCgreen}, 25, dragon)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The blue dragon dislikes being here\.|The blue dragon is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstLittleHavenBlueDragon = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The blue dragon @{Cgreen}(@{nCred}E@{nCgreen}, 26, dragon)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Queen of Snows did not invite you to be here\.|The Snow Queen is here)(, fighting [^\.!]+.|)" tfMobsubstLittleHavenSnowQueen = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Snow Queen @{Cgreen}(N, 55, human)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Lorca  -----------------------
/def -p99 -F -mregexp -t"(A Gangly-Armed Sloth swings from branch to branch|A sloth is here)(, fighting [^\.!]+.|)" tfMobsubstLorcaSloth = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A sloth @{Cgreen}(N, 20, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A falcon is soaring high above the ground|A falcon is here)(, fighting [^\.!]+.|)" tfMobsubstLorcaFalcon = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A falcon @{Cgreen}(N, 25, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A man-eating plant snaps its jaws hungrily around|A man-eating plant is here)(, fighting [^\.!]+.|)" tfMobsubstLorcaPlant = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A man-eating plant @{Cgreen}(N, 30, botanic)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A traveller wheels his wares towards the city\.|A traveller is here)(, fighting [^\.!]+.|)" tfMobsubstLorcaTraveller = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A traveller @{Cgreen}(N, 30, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A watersnake twists and turns in the mud\.|A watersnake is here)(, fighting [^\.!]+.|)" tfMobsubstLorcaSnake = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A watersnake @{Cgreen}(N, 33, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A wild lion roars towards the sky|A lion is here)(, fighting [^\.!]+.|)" tfMobsubstLorcaLion = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A lion @{Cgreen}(N, 34, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A python rears its head up and hisses evilly|A python is here)(, fighting [^\.!]+.|)" tfMobsubstLorcaPython = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A python @{Cgreen}(N, 35, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Firebeast burns away happily\.|A Firebeast is here)(, fighting [^\.!]+.|)" tfMobsubstLorcaFirebeast = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Firebeast @{Cgreen}(N, 45, elemental)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A pile of ashes lie on the ground here\.|A pile of ashes is here)(, fighting [^\.!]+.|)" tfMobsubstLorcaAshes = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A pile of ashes @{Cgreen}(N, 50, entity)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A savage raider snarls menacingly and begins slashing at a Lorcan\.|A Raider is here)(, fighting [^\.!]+.|)" tfMobsubstLorcaRaider = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Raider @{Cgreen}(N, 55, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A lava demon hurls magma around\.|A lava demon is here)(, fighting [^\.!]+.|)" tfMobsubstLorcaDemon = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A lava demon @{Cgreen}(N, 56, demon)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A shopkeeper is here, wailing over his loss|A shopkeeper is here)(, fighting [^\.!]+.|)" tfMobsubstLorcaShopkeeper = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A shopkeeper @{Cgreen}(N, 60, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Raider leader stands here, grinning evilly\.|The Raider leader is here)(, fighting [^\.!]+.|)" tfMobsubstLorcaLeader = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Raider leader @{Cgreen}(N, 60, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(King Rhalarji the Ruler of Lorca stands regally here\.|King Rhalarji is here)(, fighting [^\.!]+.|)" tfMobsubstLorcaKing = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}King Rhalarji @{Cgreen}(N, 80, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Bustibieren the Dark Mage commands all energy to cause havoc\.|Bustibieren is here)(, fighting [^\.!]+.|)" tfMobsubstLorcaBustibieren = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Bustibieren @{Cgreen}(N, 85, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Fayador the Destiny Weaver whirls a blade around\.|Fayador is here)(, fighting [^\.!]+.|)" tfMobsubstLorcaFayador = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Fayador @{Cgreen}(N, 95, human)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Lorchid  -----------------------
/def -p99 -F -mregexp -t"(A female Troin is standing here\.( \(invisible\)|)|A female Troin( \(invisible\)|) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstLorchidFTroin = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}A female Troin @{Cgreen}(@{nCred}E@{nCgreen}, 55, troll)@{n}%{invisTxt}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A large green shimmering Troin is flying around here\.( \(invisible\)|)|A ghostly Troin( \(invisible\)|) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstLorchidGTroin = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}A ghostly Troin @{Cgreen}(@{nCred}E@{nCgreen}, 55, insubstantial)@{n}%{invisTxt}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A male Troin is standing here\.( \(invisible\)|)|Troin male( \(invisible\)|) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstLorchidMTroin = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}Troin male @{Cgreen}(@{nCred}E@{nCgreen}, 60, troll)@{n}%{invisTxt}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The troin guard is lying here asleep\.( \(invisible\)|)|The Troin guard( \(invisible\)|) is sleeping here\.|The Troin guard( \(invisible\)|) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstLorchidGuard = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)" | {P4} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}The Troin guard @{Cgreen}(@{nCred}E@{nCgreen}, 65, troll)@{n}%{invisTxt}%{P5}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A huge shimmering dog lies here, asleep\.|A lazy guard dog spirit is( sleeping|) here)(\.|)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstLorchidDog = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A lazy guard dog spirit @{Cgreen}(@{nCred}E@{nCgreen}, 75, entity)@{n}%{P2}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A large Troin with nice yellow clothes stands here ready to drink some blood from a graal\.|A Lorchid high priest is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstLorchidPriest = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Lorchid high priest @{Cgreen}(@{nCred}E@{nCgreen}, 75, troll)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Worchdo, the Lord of Lorchid, is standing here.|Worchdo, Lord of Lorchid is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstLorchidLord = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Worchdo, Lord of Lorchid @{Cgreen}(@{nCred}E@{nCgreen}, 85, resist WEAPON/fire/energy/...)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Master of the ROOTS is sitting here talking to the roots of the ancient tree\. \(invisible\)|The Master of the ROOTS \(invisible\) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstLorchidRoots = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Master of the ROOTS @{Cgreen}(@{nCred}E@{nCgreen}, 95, botanic?)@{n} (imp)%{P2}%{PR}%; \
    /endif

; -----------------------  Lost Souls  -----------------------
/def -p99 -F -mregexp -t"(A maggot is here, eating away at some bonemarrow\.|A maggot is here)(, fighting [^\.!]+.|)" tfMobsubstLostSoulsCatacombsMaggot = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A maggot @{Cgreen}(N, 17, insect)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An embalmed carcass rests nearby|The carcass is here)(, fighting [^\.!]+.|)" tfMobsubstLostSoulsCatacombsCarcass = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The carcass @{Cgreen}(N, 18, undead)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A skeleton without arms is standing here\.|A skeleton is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstLostSoulsCatacombsSkeleton = \
    /if (mobsubs & area =~ 'LostSoulsCatacombs') \
      /substitute -p %{PL}@{nCyellow}A skeleton @{Cgreen}(@{nCred}E@{nCgreen}, 23, undead)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A half-decayed cadaver is lying on the ground, trying to move|The cadaver is here)(, fighting [^\.!]+.|)" tfMobsubstLostSoulsCatacombsCadaver = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The cadaver @{Cgreen}(N, 27, undead)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A decrepit zombie is leaning against the wall|A decrepit zombie is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstLostSoulsCatacombsZombie = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A decrepit zombie @{Cgreen}(@{nCred}E@{nCgreen}, 28, undead)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An entity is floating in mid-air before you|An entity is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstLostSoulsCatacombsEntity = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An entity @{Cgreen}(N, 30, entity)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The zombie master is standing here, invoking the dead\.|The zombie master is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstLostSoulsCatacombsMaster = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The zombie master @{Cgreen}(@{nCred}E@{nCgreen}, 35, undead)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Lost Temple  -----------------------
/def -p99 -F -mregexp -t"(A skeleton is here covered in dust\.|A skeleton is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstLostTempleSkeleton = \
    /if (mobsubs & ({P1} != 'A skeleton is here' | area =~ 'LostTemple')) \
      /substitute -p %{PL}@{nCyellow}A skeleton @{Cgreen}(@{nCred}E@{nCgreen}, 53, skeleton, resist WEAPON)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A skeletal warrior dressed in armor is here\.|A Skeletal Warrior is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstLostTempleWarrior = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Skeletal Warrior @{Cgreen}(@{nCred}E@{nCgreen}, 55, skeleton)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A vine lies here\.|Vine creeper is here)(, fighting [^\.!]+.|)" tfMobsubstLostTempleVine = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Vine creeper @{Cgreen}(@{nCred}E@{nCgreen}, 55, botanic)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A suit of armor stands at attention|A Doom Guard is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstLostTempleDoomGuard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Doom Guard @{Cgreen}(@{nCred}E@{nCgreen}, 61, insubstantial)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A statue stands here bereft of dust\.|The Statue is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstLostTempleStatue = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Statue @{Cgreen}(N, 80, mythical)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Lumberjack  -----------------------
/def -p99 -F -mregexp -t"(A cute rabbit is here\.|The cute rabbit is here)(, fighting [^\.!]+.|)" tfMobsubstLumberjackRabbit = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The cute rabbit @{Cgreen}(N, 1, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A brown fox is here, looking for some rabbits to chew up\.|The brown fox is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstLumberjackFox = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The brown fox @{Cgreen}(@{nCred}E@{nCgreen}, 2, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A fallow deer is grazing peacefully here\.|The fallow deer is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstLumberjackDeer = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The fallow deer @{Cgreen}(@{nCwhite}G@{nCgreen}, 2, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(John the Lumberjack is here, looking for some trees to chop down\.|John the Lumberjack is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstLumberjackJohn = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}John the Lumberjack @{Cgreen}(@{nCwhite}G@{nCgreen}, 5, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A big, brown, angry-looking bear is here\.|The brown bear is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstLumberjackBear = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The brown bear @{Cgreen}(@{nCred}E@{nCgreen}, 8, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A gnome with a tortured mind wanders aimlessly here\.|Phorius Gobee is here)(, fighting [^\.!]+.|)" tfMobsubstLumberjackPhorius = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Phorius Gobee @{Cgreen}(N, 100, QM)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Billy, the son of a local lumberjack, is here selling things\.|Billy, the lumberjack's son is here)(, fighting [^\.!]+.|)" tfMobsubstLumberjackBilly = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Billy, the lumberjack's son @{Cgreen}(N, 100, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Mahn Tor  -----------------------
/def -p99 -F -mregexp -t"(A harem girl cowers here in fear\.|The Harem Girl is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMahnTorHaremGirl = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Harem Girl @{Cgreen}(@{nCwhite}G@{nCgreen}, 2, ???)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The ogre villager is here, going about its chores\.|The Ogre Villager is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMahnTorOgreVillager = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Ogre Villager @{Cgreen}(@{nCred}E@{nCgreen}, 10, lugroki)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A rather large rock toad sits here, croaking loudly\.|The Rock Toad is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMahnTorToad = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Rock Toad @{Cgreen}(@{nCred}E@{nCgreen}, 14, amphibian)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A slimy, gross creature is here munching on a corpse\.|The Cave Dweller is here)(, fighting [^\.!]+.|)" tfMobsubstMahnTorDweller = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Cave Dweller @{Cgreen}(N, 15, magical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A mistling emerges from the mist surrounding you\.|The Mistling is here)(, fighting [^\.!]+.|)" tfMobsubstMahnTorMistling = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Mistling @{Cgreen}(N, 15, insubstantial)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The ogre warrior stands here, growling fiercely\.|The Ogre Warrior is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMahnTorOgreWarrior = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Ogre Warrior @{Cgreen}(@{nCred}E@{nCgreen}, 15, lugroki)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The white yeti crouches here snarling\.|The White Yeti is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMahnTorYeti = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The White Yeti @{Cgreen}(@{nCred}E@{nCgreen}, 16, ---)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The ogre guard is here manning his post faithfully\.|The Ogre Guard is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMahnTorOgreGuard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Ogre Guard @{Cgreen}(@{nCred}E@{nCgreen}, 19, lugroki)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A minotaur butler stands here rigidly, awaiting orders\.|The Minotaur Butler is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMahnTorButler = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Minotaur Butler @{Cgreen}(@{nCwhite}G@{nCgreen}, 20, ---)@{n}%{P2}%{PR}%; \
    /endif
/def -p100 -F -mregexp -t"(The ogre shaman is here chanting arcane words and waving his arms\.|The Ogre Shaman is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMahnTorShaman = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Ogre Shaman @{Cgreen}(@{nCred}E@{nCgreen}, 20, lugroki)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A huge, gnarled tree stands here, battered by age and nature\.|The Old Treant is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMahnTorTree = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Old Treant @{Cgreen}(@{nCwhite}G@{nCgreen}, 20, botanic)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A plains barbarian is here, clad in heavy furs\.|The Plains Barbarian is here)(, fighting [^\.!]+.|)" tfMobsubstMahnTorBarbarian = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Plains Barbarian @{Cgreen}(N, 20, ---)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A swamp wraith emerges from the mist here\.|The Swamp Wraith is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMahnTorWraith = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Swamp Wraith @{Cgreen}(@{nCred}E@{nCgreen}, 20, insubstantial)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A minotaur citizen is here, hurrying through the icy streets\.|The Minotaur Citizen is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMahnTorCitizen = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Minotaur Citizen @{Cgreen}(@{nCwhite}G@{nCgreen}, 25, ---)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A large willow tree stands here, weeping\.|The Weeping Willow is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMahnTorWillow = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Weeping Willow @{Cgreen}(@{nCwhite}G@{nCgreen}, 25, botanic)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A huge ice worm burrows through the ice and snow here\. It rears up and|The Ice Worm is here)(, fighting [^\.!]+.|)" tfMobsubstMahnTorIceWorm = \
    /let mobName=@{nCyellow}The Ice Worm @{Cgreen}(N, 30, snake)@{n}%; \
    /if (mobsubs & {P1} =~ 'The Ice Worm is here') \
      /substitute -p %{PL}%{mobName}%{P2}%{PR}%; \
    /elseif (mobsubs) \
      /substitute%; \
      /def -p99 -F -n1 -mregexp -t"^attacks!" tfMobsubstSpecial = \
        /substitute -p %%{PL}%{mobName}%%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A minotaur guard catches you trespassing and attacks!|The Minotaur Guard is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMahnTorGuard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Minotaur Guard @{Cgreen}(@{nCred}E@{nCgreen}, 32, ---)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A minotaur warrior is here looking for intruders\.|The Minotaur Warrior is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMahnTorWarrior = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Minotaur Warrior @{Cgreen}(@{nCred}E@{nCgreen}, 36, ---)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A minotaur is here guarding the Keep of Mahn-Tor\.|The Minotaur Gatekeeper is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMahnTorGatekeeper = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Minotaur Gatekeeper @{Cgreen}(@{nCred}E@{nCgreen}, 38, ---)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A dark ethereal knight hovers over the bloody clearing\.|The Dark Ethereal Knight is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMahnTorKnight = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Dark Ethereal Knight @{Cgreen}(@{nCred}E@{nCgreen}, 40, astral)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The minotaur high guard is here guarding the Keep\.|The High Minotaur Guard is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMahnTorHighGuard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The High Minotaur Guard @{Cgreen}(@{nCred}E@{nCgreen}, 40, ---)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The royal minotaur guard considers you an intruder and attacks!|The Royal Minotaur Guard is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMahnTorRoyalGuard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Royal Minotaur Guard @{Cgreen}(@{nCred}E@{nCgreen}, 42, ---)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The elite minotaur guard sees you and attacks!|The Elite Minotaur Guard is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMahnTorEliteGuard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Elite Minotaur Guard @{Cgreen}(@{nCred}E@{nCgreen}, 45, ---)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The minotaur ring-keeper stands guarding his post\.|The Minotaur Ring-Keeper is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMahnTorRingKeeper = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Minotaur Ring-Keeper @{Cgreen}(@{nCred}E@{nCgreen}, 47, ---)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Sumaron, master cleric of Mahn-Tor, is here looking holy\.|Sumaron is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMahnTorSumaron = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Sumaron @{Cgreen}(@{nCwhite}G@{nCgreen}, 50, ---)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The ogre chieftain is here, observing his subjects\.|The Ogre Chieftain is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMahnTorChieftain = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Ogre Chieftain @{Cgreen}(@{nCred}E@{nCgreen}, 50, lugroki)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Belrak, the minotaur ranger, looks unhappy about having visitors\.|Belrak is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMahnTorBelrak = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Belrak @{Cgreen}(@{nCwhite}G@{nCgreen}, 55, ---)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Dorgar, the minotaur thief, is here hiding in the shadows\.|Dorgar is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMahnTorDorgar = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Dorgar @{Cgreen}(@{nCred}E@{nCgreen}, 55, ---)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Gorak, the Minotaur Master Warrior, is here practicing his skills\.|Gorak is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMahnTorGorak = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Gorak @{Cgreen}(@{nCred}E@{nCgreen}, 55, ---)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Nasturn, the minotaur druid, is here studying the arts of nature\.|Nasturn is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMahnTorNasturn = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Nasturn @{Cgreen}(@{nCwhite}G@{nCgreen}, 55, ---)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Amyrok, the minotaur archmage, is here chanting arcane spells\.|Amyrok is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMahnTorAmyrok = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Amyrok @{Cgreen}(@{nCwhite}G@{nCgreen}, 60, ---)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Darkoth, the minotaur anti-paladin, stands here grinning wickedly\.|Darkoth is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMahnTorDarkoth = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Darkoth @{Cgreen}(@{nCred}E@{nCgreen}, 60, ---)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Tyrgoth, the minotaur paladin, is here worshipping silently\.|Tyrgoth is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMahnTorTyrgoth = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Tyrgoth @{Cgreen}(@{nCwhite}G@{nCgreen}, 60, ---)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Mahn-Tor, the minotaur grand master, is here looking down at you\.|Mahn-Tor is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMahnTorMahnTor = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Mahn-Tor @{Cgreen}(@{nCred}E@{nCgreen}, 80, mythical, resist WEAPON)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Marsh  -----------------------
/def -p99 -F -mregexp -t"(A rather small beast cringes in terror as it notices you\.|A rather small beast is here)(, fighting [^\.!]+.|)" tfMobsubstMarshSmallBeast = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A rather small beast @{Cgreen}(N, 15, ---)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Marsh Hag is here\.|The Marsh Hag is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMarshHag = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Marsh Hag @{Cgreen}(@{nCred}E@{nCgreen}, 26, ---)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A large gargoyle lands next to you, baring his fangs at you\.|A gargoyle is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMarshGargoyle = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A gargoyle @{Cgreen}(@{nCred}E@{nCgreen}, 28, magical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A marsh wolf has followed your scent.|A marsh wolf is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMarshWolf = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A marsh wolf @{Cgreen}(@{nCred}E@{nCgreen}, 28, canine)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A heap of garbage shambles towards you\.|A shambling mound is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMarshMound = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A shambling mound @{Cgreen}(@{nCred}E@{nCgreen}, 33, jelly)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A green troll attempts to get a hold on you\.|A green troll is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMarshGreenTroll = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A green troll @{Cgreen}(@{nCred}E@{nCgreen}, 34, troll)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A rather large python rests in a coil here\.|A large snake is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMarshLargeSnake = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A large snake @{Cgreen}(@{nCred}E@{nCgreen}, 35, snake)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A huge hairy beast shambles towards you with death in his eyes\.|A huge hairy beast is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMarshHugeBeast = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A huge hairy beast @{Cgreen}(@{nCred}E@{nCgreen}, 36, ---)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A swamp troll charges towards you\.|A swamp troll is standing here\.|A swamp troll is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMarshSwampTroll = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A swamp troll @{Cgreen}(@{nCred}E@{nCgreen}, 36, troll)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A monstrous snake slithers towards you, thinking 'breakfast'\. \(hidden\)|The monstrous snake \(hidden\) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMarshMonstrousSnake = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The monstrous snake @{Cgreen}(@{nCred}E@{nCgreen}, 36, snake)@{n} (hide)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(There is a mean looking gnoll here\.|A gnoll is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMarshGnoll = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A gnoll @{Cgreen}(@{nCred}E@{nCgreen}, 40, ---)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An ogre stands here getting ready to beat in your face\.|An ogre is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMarshOgre = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An ogre @{Cgreen}(@{nCred}E@{nCgreen}, 40, lugroki)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Will-O-Wisp darts here and there, making fun of you\.|The Will-O-Wisp is here)(, fighting [^\.!]+.|)" tfMobsubstMarshWisp = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Will-O-Wisp @{Cgreen}(N, 40, insubstantial)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Swamp Thing is standing here\.|The Swamp Thing is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMarshThing = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Swamp Thing @{Cgreen}(@{nCred}E@{nCgreen}, 44, magical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A marsh giant stomps towards you\.|A marsh giant is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMarshGiant = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A marsh giant @{Cgreen}(@{nCred}E@{nCgreen}, 45, giant)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Death Slaad is standing here distraught\.  He seems lost\.|A Death Slaad is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMarshSlaad = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Death Slaad @{Cgreen}(@{nCred}E@{nCgreen}, 75, demon)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Matrix  -----------------------
/def -p99 -F -mregexp -t"(A bug scuttles towards you, running in small circles around your|The bug is here)(, fighting [^\.!]+.|)" tfMobsubstMatrixBug = \
    /let mobName=@{nCyellow}The bug @{Cgreen}(N, 1, insect)@{n}%; \
    /if (mobsubs & {P1} =~ 'The bug is here') \
      /substitute -p %{PL}%{mobName}%{P2}%{PR}%; \
    /elseif (mobsubs) \
      /substitute%; \
      /def -p99 -F -n1 -mregexp -t"^feet\." tfMobsubstSpecial = \
        /substitute -p %%{PL}%{mobName}%%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A beautiful, butterfly-like thing is fluttering around here\.|The butterfly is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMatrixButterfly = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The butterfly @{Cgreen}(@{nCwhite}G@{nCgreen}, 1, insect)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Cursor is here, tracing incomprehensible patterns in the air\.|The cursor is here)(, fighting [^\.!]+.|)" tfMobsubstMatrixCursor = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The cursor @{Cgreen}(N, 3, insubstantial)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A hard-eyed cowboy is here, going about his business\.|The cowboy is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMatrixCowboy = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The cowboy @{Cgreen}(@{nCwhite}G@{nCgreen}, 5, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Juggernaut is working its way methodically through this area\.|The Juggernaut is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMatrixJuggernaut = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Juggernaut @{Cgreen}(@{nCwhite}G@{nCgreen}, 8, magical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Shredder advances towards you, claws clicking menacingly\.|The Shredder is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMatrixShredder = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Shredder @{Cgreen}(@{nCred}E@{nCgreen}, 9, magical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Daemon looks at you expressionlessly, from the comfort of its|The Daemon is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMatrixDaemon = \
    /let mobName=@{nCyellow}The Daemon @{Cgreen}(@{nCwhite}G@{nCgreen}, 10, demon)@{n}%; \
    /if (mobsubs & {P1} =~ 'The Daemon is here') \
      /substitute -p %{PL}%{mobName}%{P2}%{PR}%; \
    /elseif (mobsubs) \
      /substitute%; \
      /def -F -n1 -msimple -ag -t"chair (it feels that way, anyway... You can't see its eyes). Then its"%; \
      /def -p99 -F -n1 -mregexp -t"^attention returns to the screens\.( \\(White Aura\\)|)" tfMobsubstSpecial = \
        /substitute -p %%{PL}%{mobName}%%{PR}%; \
    /endif

; -----------------------  Merc  -----------------------
/def -p99 -F -mregexp -t"(A huge tamed shadow dragon stands here guarding the gates of Hope\.|A tamed great shadow dragon is here)(, fighting [^\.!]+.|)" tfMobsubstMercKodDragon = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A tamed great shadow dragon @{Cgreen}(N, 100, no-attack)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A guardian stands here, prepared to push back those who are not members\.|The Suicide Squad Guardian is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMercSsGuardian = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Suicide Squad Guardian @{Cgreen}(@{nCred}E@{nCgreen}, 1, no-attack)@{n}%{P2}%{PR}%; \
    /endif
/def -p100 -F -mregexp -t"(A maid is here rigorously scrubbing the floor\.|A maid is here)(, fighting [^\.!]+.|)" tfMobsubstMercSinMaid = \
    /if (mobsubs & ({P1} != 'A maid is here' | area =~ 'Desert')) \
      /substitute -p %{PL}@{nCyellow}A maid @{Cgreen}(N, 1, ???)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A black robed monk wearing a black silk hood walks around the room, chanting|A black robed monk is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMercCosMonk = \
    /let mobName=@{nCyellow}A black robed monk @{Cgreen}(@{nCred}E@{nCgreen}, 100, ???)@{n}%; \
    /if (mobsubs & {P1} =~ 'A black robed monk is here') \
      /substitute -p %{PL}%{mobName}%{P2}%{PR}%; \
    /elseif (mobsubs) \
      /substitute%; \
      /def -p99 -F -n1 -mregexp -t"^evil prayers to his ancient Lord - Baal Zebub\\.( \\(Red Aura\\)|)" tfMobsubstSpecial = \
        /substitute -p %%{PL}%{mobName}%%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Unholy Guardian of Sin towers in front a huge, black gate\.|The Unholy Guardian of Sin is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMercSinGuardian = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Unholy Guardian of Sin @{Cgreen}(@{nCred}E@{nCgreen}, 100, nofight-room)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Alshir the guardian is standing here, ready to take arms againt the enemies of Generation Zero\.|Alshir is here)(, fighting [^\.!]+.|)" tfMobsubstMercGzAlshir = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Alshir @{Cgreen}(N, 99, no-attack)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A man sits behind a counter here, organizing the treasures in the vault\.|Teshinar, the Keeper is here)(, fighting [^\.!]+.|)" tfMobsubstMercPovTeshinar = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Teshinar, the Keeper @{Cgreen}(N, 1, no-attack)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The matron of the sleeping quarters sits behind a desk, ready to help you to your room\.|Tirana, Matron of Paragons of Valour is here)(, fighting [^\.!]+.|)" tfMobsubstMercPovTirana = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Tirana, Matron of Paragons of Valour @{Cgreen}(N, 1, no-attack)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Knight stands guard here over the gates of Castle Valour\.|Yukor, the Sentinel of the Gates is here)(, fighting [^\.!]+.|)" tfMobsubstMercPovYukor = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Yukor, the Sentinel of the Gates @{Cgreen}(N, 90, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A handsome, long haired lady stands here smiling happily\.|Lilith, the shadowblade is here)(, fighting [^\.!]+.|)" tfMobsubstMercFsLilith = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Lilith, the shadowblade @{Cgreen}(N, 74-75, nofight-room)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A blademaster is here, protecting the treasure vault\.|Alain, the blademaster is here)(, fighting [^\.!]+.|)" tfMobsubstMercFsAlain = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Alain, the blademaster @{Cgreen}(N, 80, nofight-room)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An armored guardian stands his ground here\.|Devrel, the guardian is here)(, fighting [^\.!]+.|)" tfMobsubstMercFsDevrel = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Devrel, the guardian @{Cgreen}(N, 94-95, human, special-instakill)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The inky shadows seem to coalesce and block your way forward\.|The gathered shadows is here)(, fighting [^\.!]+.|)" tfMobsubstMercScShadows = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The gathered shadows @{Cgreen}(N, 70, nofight-room)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A dark hooded thief hides silently in the shadows\.|A hooded thief is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMercTroThief = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A hooded thief @{Cgreen}(@{nCred}E@{nCgreen}, 1, nofight-room)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A large, brown rat scurries in the corner\.|A large rat is here)(, fighting [^\.!]+.|)" tfMobsubstMercTroRat = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A large rat @{Cgreen}(@{nCred}E@{nCgreen}, 4, nofight-room)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A servant is standing here, awaiting your commands\.|A female servant is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMercTroServant = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A female servant @{Cgreen}(@{nCred}E@{nCgreen}, 70, nofight-room)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A black hooded clerk hides in the shadows behind the counter\.|A black hooded clerk is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMercTroClerk = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A black hooded clerk @{Cgreen}(@{nCred}E@{nCgreen}, 100, nofight-room)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A dark hooded humanoid is lurking in the shadows\.|A hooded humanoid is here)(, fighting [^\.!]+.|)" tfMobsubstMercTroHooded = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A hooded humanoid @{Cgreen}(N, 100, nofight-room)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A black hooded receptionist is standing behind the wooden counter\.|The receptionist is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMercTroReceptionist = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The receptionist @{Cgreen}(@{nCred}E@{nCgreen}, 100, nofight-room)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Miden'Nir  -----------------------
/def -p99 -F -mregexp -t"(A mountain goblin is wandering around mumbling to himself\.\.\.|The goblin is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMidenNirGoblin = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The goblin @{Cgreen}(@{nCred}E@{nCgreen}, 4, lugroki)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A monsterous wyvern slowly circles just above your heads\.\.\.|The wyvern is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMidenNirWyvern = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The wyvern @{Cgreen}(@{nCred}E@{nCgreen}, 30, dragon)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Milorai  -----------------------
/def -p99 -F -mregexp -t"(A beautiful K'ta'viiri lady is forced to cover her face from the wind|A Milo'raian lady is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMiloraiLady = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Milo'raian lady @{Cgreen}(@{nCwhite}G@{nCgreen}, 100, no-attack)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An eminent K'ta'viiri admires the wonders of Milo'rai|A Milo'raian lord is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMiloraiLord = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Milo'raian lord @{Cgreen}(@{nCwhite}G@{nCgreen}, 100, no-attack)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A bard hailing from the surrounding desert is telling stories here|A nomad of the desert patiently waits for an opportunity to speak|A desert Rawun is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMiloraiRawun = \
    /if (mobsubs) \
      /if ({P1} =~ "A bard hailing from the surrounding desert is telling stories here") \
        /substitute -p %{PL}@{nCyellow}A desert Rawun (telling) @{Cgreen}(@{nCwhite}G@{nCgreen}, 100, no-attack)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ "A nomad of the desert patiently waits for an opportunity to speak") \
        /substitute -p %{PL}@{nCyellow}A desert Rawun (waits) @{Cgreen}(@{nCwhite}G@{nCgreen}, 100, no-attack)@{n}%{P2}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}A desert Rawun (telling/waits) @{Cgreen}(@{nCwhite}G@{nCgreen}, 100, no-attack)@{n}%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(A hooded figure of the desert cant tear himself away from here|A hooded figure of the desert moves quietly through the back alleys|A desert dweller is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMiloraiDweller = \
    /if (mobsubs) \
      /if ({P1} =~ "A hooded figure of the desert cant tear himself away from here") \
        /substitute -p %{PL}@{nCyellow}A desert dweller (cant tear) @{Cgreen}(@{nCwhite}G@{nCgreen}, 100, no-attack)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ "A hooded figure of the desert moves quietly through the back alleys") \
        /substitute -p %{PL}@{nCyellow}A desert dweller (moves) @{Cgreen}(@{nCwhite}G@{nCgreen}, 100, no-attack)@{n}%{P2}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}A desert dweller (cant tear/moves) @{Cgreen}(@{nCwhite}G@{nCgreen}, 100, no-attack)@{n}%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(A dirty leather-clad merchant has stopped trading to hear some legends|A dirty leather-clad merchant peers about for his next gullible victim|A desert merchant is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMiloraiMerchant = \
    /if (mobsubs) \
      /if ({P1} =~ "A dirty leather-clad merchant has stopped trading to hear some legends") \
        /substitute -p %{PL}@{nCyellow}A desert merchant (hear) @{Cgreen}(@{nCwhite}G@{nCgreen}, 100, no-attack)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ "A dirty leather-clad merchant peers about for his next gullible victim") \
        /substitute -p %{PL}@{nCyellow}A desert merchant (peer) @{Cgreen}(@{nCwhite}G@{nCgreen}, 100, no-attack)@{n}%{P2}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}A desert merchant (hear/peer) @{Cgreen}(@{nCwhite}G@{nCgreen}, 100, no-attack)@{n}%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(A traveller holding a compass studies the horizon|A desert navigator is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMiloraiNavigator = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A desert navigator @{Cgreen}(@{nCwhite}G@{nCgreen}, 100, nofight-room)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A hooded figure softly chants some ancient verse as he walks|An intellectual pays homage to his vision of the original K'ta'viir|A duskwalker disciple is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMiloraiDisciple = \
    /if (mobsubs) \
      /if ({P1} =~ "A hooded figure softly chants some ancient verse as he walks") \
        /substitute -p %{PL}@{nCyellow}A duskwalker disciple (chants) @{Cgreen}(@{nCwhite}G@{nCgreen}, 100, no-attack)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ "An intellectual pays homage to his vision of the original K'ta'viir") \
        /substitute -p %{PL}@{nCyellow}A duskwalker disciple (homage) @{Cgreen}(@{nCwhite}G@{nCgreen}, 100, nofight-room)@{n}%{P2}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}A duskwalker disciple (chants/homage) @{Cgreen}(@{nCwhite}G@{nCgreen}, 100, no-attack)@{n}%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(An elderly K'ta'viir touches a stone to embrace it's power|A duskwalker mystic is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMiloraiMystic = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A duskwalker mystic @{Cgreen}(@{nCwhite}G@{nCgreen}, 100, nofight-room)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A fat sweaty hobbit sits here cooking joints of meat|A portly hobbit chef is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMiloraiChef = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A portly hobbit chef @{Cgreen}(@{nCwhite}G@{nCgreen}, 100, no-attack)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A lady of adventure seeks refuge from the inhospitable desert|A voyager of the wilderness is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMiloraiVoyager = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A voyager of the wilderness @{Cgreen}(@{nCwhite}G@{nCgreen}, 100, no-attack)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(This powerful K'ta'viiri defender oversees activity in the city|A heavily armed K'ta'viir has been ordered to guard this area of the city|A warden of Milo'rai is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMiloraiWarden = \
    /if (mobsubs) \
      /if ({P1} =~ "This powerful K'ta'viiri defender oversees activity in the city") \
        /substitute -p %{PL}@{nCyellow}A warden of Milo'rai (defender) @{Cgreen}(@{nCwhite}G@{nCgreen}, 100, no-attack)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ "A heavily armed K'ta'viir has been ordered to guard this area of the city") \
        /substitute -p %{PL}@{nCyellow}A warden of Milo'rai (guard) @{Cgreen}(@{nCwhite}G@{nCgreen}, 100, nofight-room)@{n}%{P2}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}A warden of Milo'rai (defender/guard) @{Cgreen}(@{nCwhite}G@{nCgreen}, 100, no-attack)@{n}%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(An innocent K'ta'viiri girl is amazed at the stories she is hearing|A man of the desert listens attentively to the storyteller's|A young K'ta'viiri male sits here engrossed in the tales|An eager listener is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMiloraiListener = \
    /if (mobsubs) \
      /if ({P1} =~ "An innocent K'ta'viiri girl is amazed at the stories she is hearing") \
        /substitute -p %{PL}@{nCyellow}An eager listener (girl) @{Cgreen}(@{nCwhite}G@{nCgreen}, 100, no-attack)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ "A man of the desert listens attentively to the storyteller's") \
        /substitute -p %{PL}@{nCyellow}An eager listener (man) @{Cgreen}(@{nCwhite}G@{nCgreen}, 100, no-attack)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ "A young K'ta'viiri male sits here engrossed in the tales") \
        /substitute -p %{PL}@{nCyellow}An eager listener (young male) @{Cgreen}(@{nCwhite}G@{nCgreen}, 100, no-attack)@{n}%{P2}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}An eager listener (girl/man/young male) @{Cgreen}(@{nCwhite}G@{nCgreen}, 100, no-attack)@{n}%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(An elf with an eye for business dwells amongst the shadows \(invisible\) \(hidden\)|An elven pioneer \(invisible\) \(hidden\) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMiloraiPioneer = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An elven pioneer @{Cgreen}(@{nCred}E@{nCgreen}, 100, nofight-room)@{n} (imp) (hide)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An Astrogater of Essence with his compass, is standing here\.|An Essence Astrogater is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMiloraiAstrogater = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An Essence Astrogater @{Cgreen}(@{nCwhite}G@{nCgreen}, 100, navigator)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(There is a plume of marijuana smoke surrounding a man here|Gorshwen the hermit is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMiloraiGorshwen = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Gorshwen the hermit @{Cgreen}(@{nCwhite}G@{nCgreen}, 100, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A merchant dressed in expensive clothing greets your arrival|Lariq Houper'ak is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMiloraiLariq = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Lariq Houper'ak @{Cgreen}(@{nCwhite}G@{nCgreen}, 100, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A revered knight of Thalos has been entrusted with this appointment|Palinor of Thalos is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMiloraiPalinor = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Palinor of Thalos @{Cgreen}(@{nCwhite}G@{nCgreen}, 100, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The shop assistant is here rummaging around in some crates\.|Sanq'il Calik is here)(, fighting [^\.!]+.|)" tfMobsubstMiloraiSanqil = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Sanq'il Calik @{Cgreen}(N, 100, no-attack)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(This K'ta'viiri entrepreneur offers to store your belongings for a fee|The clerk of the store is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMiloraiClerk = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The clerk of the store @{Cgreen}(@{nCwhite}G@{nCgreen}, 100, nofight-room)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(This K'ta'viiri elder acts as curator to the mausoleum and its occupants|The curator of the mausoleum is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMiloraiCurator = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The curator of the mausoleum @{Cgreen}(@{nCwhite}G@{nCgreen}, 100, no-attack)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(a roamer of the kingdom invites you to purchase some of his goods|The roamer is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMiloraiRoamer = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The roamer @{Cgreen}(@{nCwhite}G@{nCgreen}, 100, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A mysterious blue haze drifts through the shrine|The spirit form is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMiloraiSpirit = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The spirit form @{Cgreen}(@{nCwhite}G@{nCgreen}, 100, no-attack, ask spirit bless)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Mirror Beyond  -----------------------
/def -p99 -F -mregexp -t"(The corpse of Detrom is lying here\.|Detrom is here)(, fighting [^\.!]+.|)" tfMobsubstMirrorBeyondDetrom = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Detrom @{Cgreen}(N, 97, human, specials)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Mirror Realm  -----------------------
/def -p99 -F -mregexp -t"(The watchman stands here, enforcing the law of the realm\.|The watchman stands here, eyeing you carefully\.|A watchman is here)(, fighting [^\.!]+.|)" tfMobsubstMirrorRealmWatchman = \
    /if (mobsubs) \
      /if ({P1} =~ "The watchman stands here, enforcing the law of the realm.") \
        /substitute -p %{PL}@{nCyellow}A watchman (enforcing) @{Cgreen}(N, 19, human)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ "The watchman stands here, eyeing you carefully.") \
        /substitute -p %{PL}@{nCyellow}A watchman (eyeing) @{Cgreen}(N, 19, human)@{n}%{P2}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}A watchman (enforcing/eyeing) @{Cgreen}(N, 19, human)@{n}%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(A citizen of the Mirror Realm strolls by you\.|A middle-aged woman shuffles past you, pulling her shawl tight around her head\.|The woman is here)(, fighting [^\.!]+.|)( \(Red Aura\)| \(White Aura\)|)" tfMobsubstMirrorRealmWoman = \
    /if (mobsubs) \
      /if ({P1} =~ "A citizen of the Mirror Realm strolls by you." | {P3} =~ " (White Aura)") \
        /substitute -p %{PL}@{nCyellow}The woman (good) @{Cgreen}(@{nCwhite}G@{nCgreen}, 19, human)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ "A middle-aged woman shuffles past you, pulling her shawl tight around her head." | {P3} =~ " (Red Aura)") \
        /substitute -p %{PL}@{nCyellow}The woman (evil) @{Cgreen}(@{nCred}E@{nCgreen}, 20, human)@{n}%{P2}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}The woman (good/evil) @{Cgreen}(@{nCwhite}G@{nCgreen}/@{nCred}E@{nCgreen}, 19/20, human)@{n}%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(A good citizen of the Mirror Realm strolls by you\.|A citizen of the Mirror Realm shuffles along the dark road\.|The young man is here)(, fighting [^\.!]+.|)( \(Red Aura\)| \(White Aura\)|)" tfMobsubstMirrorRealmYoungMan = \
    /if (mobsubs) \
      /if ({P1} =~ "A good citizen of the Mirror Realm strolls by you." | {P3} =~ " (White Aura)") \
        /substitute -p %{PL}@{nCyellow}The young man (good) @{Cgreen}(@{nCwhite}G@{nCgreen}, 19, human)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ "A citizen of the Mirror Realm shuffles along the dark road." | {P3} =~ " (Red Aura)") \
        /substitute -p %{PL}@{nCyellow}The young man (evil) @{Cgreen}(@{nCred}E@{nCgreen}, 20, human)@{n}%{P2}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}The young man (good/evil) @{Cgreen}(@{nCwhite}G@{nCgreen}/@{nCred}E@{nCgreen}, 19/20, human)@{n}%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(A young boy tries to climb the tree; he struggles and grabs at the high, thick branches\.|The young boy is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMirrorRealmYoungBoy = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The young boy @{Cgreen}(@{nCwhite}G@{nCgreen}, 20, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A young urchin shuffles around the trees, ignoring the fruit that hangs from their branches\.|The young urchin is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMirrorRealmUrchin = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The young urchin @{Cgreen}(@{nCred}E@{nCgreen}, 20, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A mirror guardian stands here\.|The mirror guardian is here)(, fighting [^\.!]+.|)" tfMobsubstMirrorRealmMGuardian = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The mirror guardian @{Cgreen}(N, 23, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A young woman stands here, taking her vows of marriage\.|The bride is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMirrorRealmBride = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The bride @{Cgreen}(@{nCwhite}G@{nCgreen}, 25, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The card shark stands here, waiting for a sucker\.|The card shark is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMirrorRealmShark = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The card shark @{Cgreen}(@{nCred}E@{nCgreen}, 25, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A fisherman floats here in his dinghy, trying to add to his catch\.|The fisherman is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMirrorRealmFisherman = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The fisherman @{Cgreen}(@{nCwhite}G@{nCgreen}, 25, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The gardener stands here, hacking away at the tangles of vines\.|A gardener stands here, tending to the plants\.|The gardener is here)(, fighting [^\.!]+.|)( \(Red Aura\)| \(White Aura\)|)" tfMobsubstMirrorRealmGardener = \
    /if (mobsubs) \
      /if ({P1} =~ "The gardener stands here, hacking away at the tangles of vines." | {P3} =~ " (Red Aura)") \
        /substitute -p %{PL}@{nCyellow}The gardener (evil) @{Cgreen}(@{nCred}E@{nCgreen}, 25, human)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ "A gardener stands here, tending to the plants." | {P3} =~ " (White Aura)") \
        /substitute -p %{PL}@{nCyellow}The gardener (good) @{Cgreen}(@{nCwhite}G@{nCgreen}, 25, human)@{n}%{P2}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}The gardener (evil/good) @{Cgreen}(@{nCred}E@{nCgreen}/@{nCwhite}G@{nCgreen}, 25, human)@{n}%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(A young man stands here, taking his vows of marriage\.|The groom is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMirrorRealmGroom = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The groom @{Cgreen}(@{nCwhite}G@{nCgreen}, 25, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A lady of ill repute lounges against a pole, eyeing you coyly\.|The lady of ill repute is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMirrorRealmLady = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The lady of ill repute @{Cgreen}(@{nCred}E@{nCgreen}, 25, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A pool player stands here practicing his game\.|The pool player is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMirrorRealmPoolPl = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The pool player @{Cgreen}(@{nCwhite}G@{nCgreen}, 25, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A bear stands here\.  You have disturbed him\.|The bear is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMirrorRealmBear = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The bear @{Cgreen}(@{nCred}E@{nCgreen}, 30, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A deer stands here rubbing his antlers against a tree\.|The buck is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMirrorRealmBuck = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The buck @{Cgreen}(@{nCwhite}G@{nCgreen}, 30, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A moose stands here, nibbling at the tree branches\.|The moose is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMirrorRealmMoose = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The moose @{Cgreen}(@{nCwhite}G@{nCgreen}, 30, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Carvallo stands here, operating his \"disposal\" business\.|Carvallo is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMirrorRealmCarvallo = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Carvallo @{Cgreen}(@{nCred}E@{nCgreen}, 35, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Caerlin the Bard stands here, strumming on his harp and asking for small donations\.|Caerlin is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMirrorRealmCaerlin = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Caerlin @{Cgreen}(@{nCwhite}G@{nCgreen}, 35, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Lord of the Dark stands here, clothed in jet-black robes\.|The Black Lord is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMirrorRealmBlackLord = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Black Lord @{Cgreen}(@{nCred}E@{nCgreen}, 35, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Lord of the Light stands here, clothed in light blue robes\.|The Blue Lord is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMirrorRealmBlueLord = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Blue Lord @{Cgreen}(@{nCwhite}G@{nCgreen}, 35, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Lord of the Light stands here, clothed in dark green robes\.|The Green Lord is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMirrorRealmGreenLord = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Green Lord @{Cgreen}(@{nCwhite}G@{nCgreen}, 35, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A grey fox emerges from the brush, growling angrily at you\.|The grey fox is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMirrorRealmFox = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The grey fox @{Cgreen}(@{nCred}E@{nCgreen}, 35, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A huge mass of red ants mills frantically around the tree trunk\.|The mass of red ants is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMirrorRealmAnts = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The mass of red ants @{Cgreen}(@{nCred}E@{nCgreen}, 35, insect)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A greasy-looking man stands here, keeping watch over the lady of ill repute\.|The master is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMirrorRealmMaster = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The master @{Cgreen}(@{nCred}E@{nCgreen}, 35, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Lord of the Light stands here, clothed in deep orange robes\.|The Orange Lord is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMirrorRealmOrangeLord = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Orange Lord @{Cgreen}(@{nCwhite}G@{nCgreen}, 35, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(One of the six Lords of the Light stands here, clothed in bright red robes\.|The Red Lord is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMirrorRealmRedLord = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Red Lord @{Cgreen}(@{nCwhite}G@{nCgreen}, 35, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Lord of the Light stands here, clothed in dark violet robes\.|The Violet Lord is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMirrorRealmVioletLord = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Violet Lord @{Cgreen}(@{nCwhite}G@{nCgreen}, 35, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Lord of the Dark stands here, clothed in an icy white robe\.|The White Lord is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMirrorRealmWhiteLord = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The White Lord @{Cgreen}(@{nCred}E@{nCgreen}, 35, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The shadows shift faintly\.( \(invisible\)|)|The wily little thief \(hidden somewherehere amongst the shadows\)( \(invisible\)|) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMirrorRealmThief = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}The wily little thief (...) @{Cgreen}(@{nCred}E@{nCgreen}, 35, human)@{n}%{invisTxt}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Lord of the Light stands here, clothed in bright yellow robes\.|The Yellow Lord is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMirrorRealmYellowLord = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Yellow Lord @{Cgreen}(@{nCwhite}G@{nCgreen}, 35, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A standard issue wizard putters about his shop, mixing potions and enchanting staffs\.|A standard issue wizard is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMirrorRealmSIWizard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A standard issue wizard @{Cgreen}(@{nCwhite}G@{nCgreen}, 39, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Brother Thomas stands here giving his blessings\.|Brother Thomas is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMirrorRealmThomas = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Brother Thomas @{Cgreen}(@{nCwhite}G@{nCgreen}, 39, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Father Franklin stands here, smiling gently at you\.|Father Franklin is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMirrorRealmFranklin = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Father Franklin @{Cgreen}(@{nCwhite}G@{nCgreen}, 39, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Lauraine paces behind the bar, waiting for your order\.|Lauraine the barkeep is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMirrorRealmLauraine = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Lauraine the barkeep @{Cgreen}(@{nCwhite}G@{nCgreen}, 39, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A silver unicorne wanders around the pathway quietly grazing on grass\.|The unicorne is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMirrorRealmUnicorne = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The unicorne @{Cgreen}(@{nCwhite}G@{nCgreen}, 39, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A waiter hustles about the room taking orders and delivering food\.|A waiter slouches against the wall waiting to serve you stew\.|The waiter is here)(, fighting [^\.!]+.|)( \(White Aura\)| \(Red Aura\)|)" tfMobsubstMirrorRealmWaiter = \
    /if (mobsubs) \
      /if ({P1} =~ "A waiter hustles about the room taking orders and delivering food." | {P3} =~ " (White Aura)") \
        /substitute -p %{PL}@{nCyellow}The waiter (good) @{Cgreen}(@{nCwhite}G@{nCgreen}, 39, shopkeeper)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ "A waiter slouches against the wall waiting to serve you stew." | {P3} =~ " (Red Aura)") \
        /substitute -p %{PL}@{nCyellow}The waiter (evil) @{Cgreen}(@{nCred}E@{nCgreen}, 40, shopkeeper)@{n}%{P2}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}The waiter (good/evil) @{Cgreen}(@{nCwhite}G@{nCgreen}/@{nCred}E@{nCgreen}, 39/40, shopkeeper)@{n}%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(A haggard, toothless woman stands here tending the bar\.|Hepzibah the Barkeep is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMirrorRealmHepzibah = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Hepzibah the Barkeep @{Cgreen}(@{nCred}E@{nCgreen}, 40, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Mandeep the Beekeeper strolls about his house, puffing smoke at his bees\.|Mandeep the Beekeeper is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMirrorRealmMandeep = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Mandeep the Beekeeper @{Cgreen}(@{nCwhite}G@{nCgreen}, 40, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Mr\. Teece sits here playing on his banjo\.|Mr\. Teece is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMirrorRealmTeece = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Mr. Teece @{Cgreen}(@{nCwhite}G@{nCgreen}, 40, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Mrs\. Truxton is here, checking overdue notices\.|Mrs\. Truxton the Librarian is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMirrorRealmTruxton = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Mrs. Truxton the Librarian @{Cgreen}(@{nCwhite}G@{nCgreen}, 45, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The bleached, gray skeleton of a horse laughs soundlessly as it trots by\.|The Grey Mare is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMirrorRealmMare = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Grey Mare @{Cgreen}(@{nCred}E@{nCgreen}, 45, undead)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The proprietor of the Travellers' Shop stands here, dusting off his stock\.|The proprietor is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMirrorRealmProprietor = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The proprietor @{Cgreen}(@{nCwhite}G@{nCgreen}, 45, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The wizard behind the counter snickers softly at you\.|The wizard is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMirrorRealmTheWizard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The wizard @{Cgreen}(@{nCred}E@{nCgreen}, 45, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A pale, withered knight looks up in surprise as you enter\.|A withered knight is here)(, fighting [^\.!]+.|)" tfMobsubstMirrorRealmKnight = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A withered knight @{Cgreen}(N, 45, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Master Dunn is here, quietly reviewing his katas\.|Master Dunn is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMirrorRealmDunn = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Master Dunn @{Cgreen}(@{nCwhite}G@{nCgreen}, 45, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Storn the Assassin is here, practicing his backstab\.|Storn the assassin is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMirrorRealmStorn = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Storn the assassin @{Cgreen}(@{nCred}E@{nCgreen}, 45, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(King Loranhir is sitting motionless on his throne, staring into emptiness\.|King Loranhir is here)(, fighting [^\.!]+.|)" tfMobsubstMirrorRealmKing = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}King Loranhir @{Cgreen}(N, 49, human, special-give)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Something swirls about the mists\.( \(invisible\)|)|Something( \(invisible\)|) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMirrorRealmSomething = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}Something @{Cgreen}(@{nCred}E@{nCgreen}, 50, insubstantial)@{n}%{invisTxt}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Jerry Garcia hovers in the center of this room\.|Jerry Garcia is here)(, fighting [^\.!]+.|)" tfMobsubstMirrorRealmJerry = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Jerry Garcia @{Cgreen}(N, 50, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Amber Master rises from his throne as you appear in the room\.|The Amber Master is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMirrorRealmAmberMaster = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Amber Master @{Cgreen}(@{nCwhite}G@{nCgreen}, 50, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Blue Master rises from his throne as you appear in the room\.|The Blue Master is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMirrorRealmBlueMaster = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Blue Master @{Cgreen}(@{nCwhite}G@{nCgreen}, 50, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Green Master rises from his throne as you appear in the room\.|The Green Master is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMirrorRealmGreenMaster = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Green Master @{Cgreen}(@{nCwhite}G@{nCgreen}, 50, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(\(Golden Aura\) A figure of pure rainbow light rises from a sparkling throne\.|The Master of Light is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMirrorRealmMasterOfLight = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Master of Light @{Cgreen}(@{nCwhite}G@{nCgreen}, 50, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An incredible bird sits in its nest, flapping its enormous wings\.|The Phoenix is here)(, fighting [^\.!]+.|)" tfMobsubstMirrorRealmPhoenix = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Phoenix @{Cgreen}(N, 50, magical, special-clone-at-death)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Red Master rises from his throne as you enter\.|The Red Master is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMirrorRealmRedMaster = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Red Master @{Cgreen}(@{nCwhite}G@{nCgreen}, 50, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Violet Master rises from his throne as you appear in the room\.|The Violet Master is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMirrorRealmVioletMaster = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Violet Master @{Cgreen}(@{nCwhite}G@{nCgreen}, 50, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Black Master stands quietly at the northern end of the room\.|The Black Master is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMirrorRealmBlackMaster = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Black Master @{Cgreen}(@{nCred}E@{nCgreen}, 50, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The White Master stands quietly at the northern end of the room\.|The White Master is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMirrorRealmWhiteMaster = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The White Master @{Cgreen}(@{nCred}E@{nCgreen}, 50, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Yellow Master rises from his throne as you enter\.|The Yellow Master is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMirrorRealmYellowMaster = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Yellow Master @{Cgreen}(@{nCwhite}G@{nCgreen}, 50, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(\(Cuteness\) Dee big byoo bear hulks and yerks in the corner, wrinkling and folding at ebry motion\.( \(invisible\)|)|Bear-de-bear( \(invisible\)|) is here)(, fighting [^\.!]+.|)" tfMobsubstMirrorRealmBearDeBear = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}Bear-de-bear @{Cgreen}(N, 60, ???)@{n}%{invisTxt}%{P4}%{PR}%; \
    /endif

; -----------------------  Mob Factory  -----------------------
/def -p99 -F -mregexp -t"(Mutated butterfly wings are here, flapping on the floor\.|Butterfly wings is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstmobFactoryWings = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Butterfly wings @{Cgreen}(@{nCwhite}G@{nCgreen}, 1, magical?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Mob Factory worker is here, asleep in a chair\.|The factory worker is standing here\.|A Mob Factory worker is standing here, looking bored\.|The factory worker is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstmobFactoryWorker = \
    /if (mobsubs) \
      /if ({P1} =~ "A Mob Factory worker is here, asleep in a chair.") \
        /substitute -p %{PL}@{nCyellow}The factory worker (asleep) @{Cgreen}(@{nCwhite}G@{nCgreen}, 4, human)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ "The factory worker is standing here.") \
        /substitute -p %{PL}@{nCyellow}The factory worker (asleep) @{Cgreen}(@{nCwhite}G@{nCgreen}, 4, human)@{n}%{P2} standing%{PR}%; \
      /elseif ({P1} =~ "A Mob Factory worker is standing here, looking bored.") \
        /substitute -p %{PL}@{nCyellow}The factory worker (bored) @{Cgreen}(@{nCwhite}G@{nCgreen}, 5, human)@{n}%{P2}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}The factory worker (asleep/bored) @{Cgreen}(@{nCwhite}G@{nCgreen}, 4/5, human)@{n}%{P2}%{PR}%; \
      /endif%; \
   /endif
/def -p99 -F -mregexp -t"(A huge pool of toxic slime lies on the floor\.|The toxic slime is( standing|) here)(\.|)(, fighting [^\.!]+.|)" tfMobsubstmobFactorySlime = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The toxic slime @{Cgreen}(N, 8, jelly)@{n}%{P2}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Cityguard head floats around aimlessly\. \(hidden\)|The Cityguard head \(hidden\) is here)(, fighting [^\.!]+.|)" tfMobsubstmobFactoryHead = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Cityguard head @{Cgreen}(N, 10, magical)@{n} (hide)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The mutant beastly fido is here, his eyes glowing green!|The mutant beastly fido is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstmobFactoryFido = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The mutant beastly fido @{Cgreen}(@{nCred}E@{nCgreen}, 10, canine, agg-sleeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Revolving drunk is here, spinning in place\.|The revolving drunk is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstmobFactoryDrunk = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The revolving drunk @{Cgreen}(@{nCwhite}G@{nCgreen}, 10, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Foreman Floyd is here, making plans for the factory's future\.|Foreman Floyd is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstmobFactoryFloyd = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Foreman Floyd @{Cgreen}(@{nCwhite}G@{nCgreen}, 39, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Gribbons is standing here, sweating while working on the|Gribbons is here)(, fighting [^\.!]+.|)" tfMobsubstmobFactoryGribbons = \
    /let mobName=@{nCyellow}Gribbons @{Cgreen}(N, 100, QM)@{n}%; \
    /if (mobsubs & {P1} =~ 'Gribbons is here') \
      /substitute -p %{PL}%{mobName}%{P2}%{PR}%; \
    /elseif (mobsubs) \
      /substitute%; \
      /def -p99 -F -n1 -mregexp -t"^assembly line\\." tfMobsubstSpecial = \
        /substitute -p %%{PL}%{mobName}%%{PR}%; \
    /endif

; -----------------------  Moria  -----------------------
/def -p99 -F -mregexp -t"(A small centipede\.|A white centipede is here\.|The centipede is here)(, fighting [^\.!]+.|)( \(White Aura\)| \(Red Aura\)|)" tfMobsubstMoriaTheCentipede = \
    /if (mobsubs) \
      /if ({P1} =~ "A small centipede." | {P3} =~ " (White Aura)") \
        /substitute -p %{PL}@{nCyellow}The centipede (small) @{Cgreen}(@{nCwhite}G@{nCgreen}, 3, insect)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ "A white centipede is here." | {P3} =~ " (Red Aura)") \
        /substitute -p %{PL}@{nCyellow}The centipede (white) @{Cgreen}(@{nCred}E@{nCgreen}, 5, insect)@{n}%{P2}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}The centipede (small/white) @{Cgreen}(@{nCwhite}G@{nCgreen}/@{nCred}E@{nCgreen}, 3/5, insect)@{n}%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(A bird flutters about you, chirping softly a sweet hymn\.|A happy little bird is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMoriaBird = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A happy little bird @{Cgreen}(@{nCwhite}G@{nCgreen}, 3, bird)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An ugly kobold is standing here\.|A green kobold is here\.|The kobold is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMoriaKobold = \
    /if (mobsubs) \
      /if ({P1} =~ "An ugly kobold is standing here.") \
        /substitute -p %{PL}@{nCyellow}The kobold (ugly) @{Cgreen}(@{nCred}E@{nCgreen}, 4, ---)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ "A green kobold is here.") \
        /substitute -p %{PL}@{nCyellow}The kobold (green) @{Cgreen}(@{nCred}E@{nCgreen}, 7, ---)@{n}%{P2}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}The kobold (ugly/green) @{Cgreen}(@{nCred}E@{nCgreen}, 4/7, ---)@{n}%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(A rabbit hops around here\.|The rabbit is here)(, fighting [^\.!]+.|)" tfMobsubstMoriaRabbit = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The rabbit @{Cgreen}(N, 4, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A fox is eyeing you up and down here\.|The fox is here)(, fighting [^\.!]+.|)" tfMobsubstMoriaFox = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The fox @{Cgreen}(N, 5, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A mountain lion is here growling at you\.|The mountain lion is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMoriaLion = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The mountain lion @{Cgreen}(@{nCred}E@{nCgreen}, 5, feline)@{n}%{P2}%{PR}%; \
    /endif
/def -p100 -F -mregexp -t"(The orc walks around, looking for someone to kill\.|A large orc, looking really mean, is standing here\.|An orc is here, looking for something \(or perhaps someone \? \) to eat\.|The orc is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMoria<NAME = \
    /if (mobsubs & ({P1} != 'The orc is here' | area =~ 'Moria')) \
      /if ({P1} =~ "The orc walks around, looking for someone to kill.") \
        /substitute -p %{PL}@{nCyellow}The orc (kill) @{Cgreen}(@{nCred}E@{nCgreen}, 5, lugroki)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ "A large orc, looking really mean, is standing here.") \
        /substitute -p %{PL}@{nCyellow}The orc (mean) @{Cgreen}(@{nCred}E@{nCgreen}, 7, lugroki)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ "An orc is here, looking for something (or perhaps someone ? ) to eat.") \
        /substitute -p %{PL}@{nCyellow}The orc (eat) @{Cgreen}(@{nCred}E@{nCgreen}, 8, lugroki)@{n}%{P2}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}The orc (kill/mean/eat) @{Cgreen}(@{nCred}E@{nCgreen}, 5/7/8, lugroki)@{n}%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(A small harmless centipede is here\.|A centipede is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMoriaACentipede = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A centipede @{Cgreen}(@{nCwhite}G@{nCgreen}, 6, insect)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A small hobgoblin stands here\.|A large hobgoblin is here\.|The hobgoblin is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMoriaHobgoblin = \
    /if (mobsubs) \
      /if ({P1} =~ "A small hobgoblin stands here.") \
        /substitute -p %{PL}@{nCyellow}The hobgoblin (small) @{Cgreen}(@{nCred}E@{nCgreen}, 6, lugroki)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ "A large hobgoblin is here.") \
        /substitute -p %{PL}@{nCyellow}The hobgoblin (large) @{Cgreen}(@{nCred}E@{nCgreen}, 10, lugroki)@{n}%{P2}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}The hobgoblin (small/large) @{Cgreen}(@{nCred}E@{nCgreen}, 6/10, lugroki)@{n}%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(A small green snake\.|The green snake is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMoriaGreenSnake = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The green snake @{Cgreen}(@{nCred}E@{nCgreen}, 7, snake)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A tall warrior is standing here\.|A human warrior is here\. He has a evil grin in his face\.|A tall dangerous warrior is preparing for battle\.|The warrior is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMoriaWarrior = \
    /if (mobsubs) \
      /if ({P1} =~ "A tall warrior is standing here.") \
        /substitute -p %{PL}@{nCyellow}The warrior (standing) @{Cgreen}(@{nCred}E@{nCgreen}, 7, human)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ "A human warrior is here. He has a evil grin in his face.") \
        /substitute -p %{PL}@{nCyellow}The warrior (grin) @{Cgreen}(@{nCred}E@{nCgreen}, 9, human)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ "A tall dangerous warrior is preparing for battle.") \
        /substitute -p %{PL}@{nCyellow}The warrior (preparing) @{Cgreen}(@{nCred}E@{nCgreen}, 12, human)@{n}%{P2}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}The warrior (standing/grin/preparing) @{Cgreen}(@{nCred}E@{nCgreen}, 7/9/12, human)@{n}%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(A thief, all dressed in black\.|The Thief is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMoriaThief = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Thief @{Cgreen}(@{nCwhite}G@{nCgreen}, 8, human, thief)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A brown snake watches you\.|A large green snake, looks like a guardian for an evil force\.|A large dreadful snake\.|The snake is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMoriaTheSnake = \
    /if (mobsubs) \
      /if ({P1} =~ "A brown snake watches you.") \
        /substitute -p %{PL}@{nCyellow}The snake (brown) @{Cgreen}(@{nCred}E@{nCgreen}, 10, snake)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ "A large green snake, looks like a guardian for an evil force.") \
        /substitute -p %{PL}@{nCyellow}The snake (guardian) @{Cgreen}(@{nCred}E@{nCgreen}, 10, snake)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ "A large dreadful snake.") \
        /substitute -p %{PL}@{nCyellow}The snake (dreadful) @{Cgreen}(@{nCred}E@{nCgreen}, 11, snake)@{n}%{P2}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}The snake (brown/guardian/dreadful) @{Cgreen}(@{nCred}E@{nCgreen}, 10/10/11, snake)@{n}%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(A large mean-looking troll is here\.|The troll is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMoriaTroll = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The troll @{Cgreen}(@{nCred}E@{nCgreen}, 12, troll)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A small intelligent looking mage is standing here. It looks like he|The Mage is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMoriaMage = \
    /let mobName=@{nCyellow}The Mage @{Cgreen}(@{nCred}E@{nCgreen}, 13, human)@{n}%; \
    /if (mobsubs & {P1} =~ 'The Mage is here') \
      /substitute -p %{PL}%{mobName}%{P2}%{PR}%; \
    /elseif (mobsubs) \
      /substitute%; \
      /def -p99 -F -n1 -mregexp -t"^knows his way with the magic\\. ( \\(Red Aura\\)|)" tfMobsubstSpecial = \
        /substitute -p %%{PL}%{mobName}%%{PR}%; \
    /endif
/def -p100 -F -mregexp -t"(A hill giant is here tossing some rocks around\.|The hill giant is here)(, fighting [^\.!]+.|)" tfMobsubstMoriaGiant = \
    /if (mobsubs & ({P1} != 'The hill giant is here' | area =~ 'Moria')) \
      /substitute -p %{PL}@{nCyellow}The hill giant @{Cgreen}(N, 23, giant)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Muldorbrooke  -----------------------
/def -p99 -F -mregexp -t"(a gnome child is playing with a stick|The child is here)(, fighting [^\.!]+.|)" tfMobsubstMuldorbrookeChild = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The child @{Cgreen}(N, 16, large/superlarge)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(the gnome citizen scampers about the village shopping|The citizen is here)(, fighting [^\.!]+.|)" tfMobsubstMuldorbrookeCitizen = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The citizen @{Cgreen}(N, 20, large/superlarge)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A gnome mother is searching for her children\.|The mother is here)(, fighting [^\.!]+.|)" tfMobsubstMuldorbrookeMother = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The mother @{Cgreen}(N, 20, large/superlarge)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(a gnome peasant is looking for food|The peasant is here)(, fighting [^\.!]+.|)" tfMobsubstMuldorbrookePeasant = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The peasant @{Cgreen}(N, 20, large/superlarge)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(the beggar asks you for a coin or two|The beggar is here)(, fighting [^\.!]+.|)" tfMobsubstMuldorbrookeBeggar = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The beggar @{Cgreen}(N, 23, large/superlarge)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(the gnome father is going to work|The father is here)(, fighting [^\.!]+.|)" tfMobsubstMuldorbrookeFather = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The father @{Cgreen}(N, 23, large/superlarge)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(a gnome guard stands at attention|The guard is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMuldorbrookeGuard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The guard @{Cgreen}(@{nCwhite}G@{nCgreen}, 24, large/superlarge)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(a hobgoblin soldier readies to attack|The hobgoblin soldier is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMuldorbrookeHobSoldier = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The hobgoblin soldier @{Cgreen}(@{nCred}E@{nCgreen}, 24, lugroki)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(the soldier prepares for battle|The soldier is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMuldorbrookeSoldier = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The soldier @{Cgreen}(@{nCwhite}G@{nCgreen}, 24, large/superlarge)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(a hobgoblin spy is sneaking around|The spy is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMuldorbrookeSpy = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The spy @{Cgreen}(@{nCred}E@{nCgreen}, 24, lugroki)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(the captain surveys the situation|The captain is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMuldorbrookeCaptain = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The captain @{Cgreen}(@{nCwhite}G@{nCgreen}, 26, large/superlarge)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(an undead zombie springs from the grave|The gnome zombie is here)(, fighting [^\.!]+.|)" tfMobsubstMuldorbrookeZombie = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The gnome zombie @{Cgreen}(N, 30, undead)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(an imperial guard is here watching over the chief|The imperial guard is here)(, fighting [^\.!]+.|)" tfMobsubstMuldorbrookeImpGuard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The imperial guard @{Cgreen}(N, 30, large/superlarge)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(the necromancer is bringing corpses to life|The necromancer is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMuldorbrookeNecromancer = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The necromancer @{Cgreen}(@{nCred}E@{nCgreen}, 33, large/superlarge)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Kirisat, the gnome chief paces around|Kirisat is here)(, fighting [^\.!]+.|)" tfMobsubstMuldorbrookeKirisat = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Kirisat @{Cgreen}(N, 50, large/superlarge)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Museum  -----------------------
/def -p99 -F -mregexp -t"(An art critic is here examining the murals\.|The critic is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMuseumCritic = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The critic @{Cgreen}(@{nCred}G@{nCgreen}, 20, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An aspiring cleric is practicing his armor spell\.|The cleric is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMuseumCleric = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The cleric @{Cgreen}(@{nCwhite}G@{nCgreen}, 33, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An aspiring mage wanders about looking for secrets\.|The mage is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMuseumMage = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The mage @{Cgreen}(@{nCwhite}G@{nCgreen}, 33, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A thief is wondering how much the busts are worth\.|The thief is here)(, fighting [^\.!]+.|)" tfMobsubstMuseumThief = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The thief @{Cgreen}(N, 33, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A green security guard is protecting the displays\.|The guard is( standing|) here)(\.|)(, fighting [^\.!]+.|)" tfMobsubstMuseumGuard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The guard @{Cgreen}(N, 35, human)@{n}%{P2}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A warrior has been practicing techniques from the paintings\.|The warrior is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMuseumWarrior = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The warrior @{Cgreen}(@{nCwhite}G@{nCgreen}, 36, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p100 -F -mregexp -t"(A patron is here admiring the exhibits\.|A patron is here)(, fighting [^\.!]+.|)" tfMobsubstMuseumPatron = \
    /if (mobsubs & ({P1} != 'A patron is here' | area =~ 'Museum')) \
      /substitute -p %{PL}@{nCyellow}A patron @{Cgreen}(N, 40, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A vicious guard dog is here looking for intruders\.( \(invisible\)|)|The guard dog( \(invisible\)|) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMuseumDog = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}The guard dog @{Cgreen}(@{nCred}E@{nCgreen}, 40, canine)@{n}%{invisTxt}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A philosophy teacher is pondering the hero's motives\.|A history teacher is writing on his tablet\.|An alchemy teacher dreams of transmutation\.|The teacher is here)(, fighting [^\.!]+.|)" tfMobsubstMuseumTeacher = \
    /if (mobsubs) \
      /if ({P1} =~ "A philosophy teacher is pondering the hero's motives.") \
        /substitute -p %{PL}@{nCyellow}The teacher (philosopy) @{Cgreen}(N, 40, human)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ "A history teacher is writing on his tablet.") \
        /substitute -p %{PL}@{nCyellow}The teacher (history) @{Cgreen}(N, 41, human)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ "An alchemy teacher dreams of transmutation.") \
        /substitute -p %{PL}@{nCyellow}The teacher (alchemy) @{Cgreen}(N, 43, human)@{n}%{P2}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}The teacher (philosopy/history/alchemy) @{Cgreen}(N, 40/41/43, human)@{n}%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(A monstrously giant rat is here digging through the rubble\.|The giant rat is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMuseumRat = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The giant rat @{Cgreen}(@{nCred}E@{nCgreen}, 42, rodent)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An artist is here touching up a defiled mural\.|The artist is( standing|) here)(\.|)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMuseumArtist = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The artist @{Cgreen}(@{nCwhite}G@{nCgreen}, 45, human)@{n}%{P2}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The cleaner is getting stoned off cleaning agents\.|The cleaner is( standing|) here)(\.|)(, fighting [^\.!]+.|)" tfMobsubstMuseumCleaner = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The cleaner @{Cgreen}(N, 45, human)@{n}%{P2}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The carpenter is sawing away at a piece of lumber\.|The carpenter is here)(, fighting [^\.!]+.|)" tfMobsubstMuseumCarpenter = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The carpenter @{Cgreen}(N, 50, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The tunnel digger is picking away at the wall\.|The tunnel digger is here)(, fighting [^\.!]+.|)" tfMobsubstMuseumDigger = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The tunnel digger @{Cgreen}(N, 50, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A lowlife vandal peers around as she defiles a statue\.|The vandal is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMuseumVandal = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The vandal @{Cgreen}(@{nCred}E@{nCgreen}, 50, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(You think you see a large rat\.|The displacer rat is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMuseumDispRat = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The displacer rat @{Cgreen}(@{nCred}E@{nCgreen}, 58, rodent)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An elite security guard is here keeping the rookies on their toes\. \(hidden\)|The elite guard \(hidden\) is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMuseumEliteGuard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The elite guard @{Cgreen}(@{nCwhite}G@{nCgreen}, 61, human)@{n} (hide)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A statue of Tomarin, the Icon of Mages is here on display|Tomarin is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMuseumTomarin = \
    /if (mobsubs) \
      /if ({P1} =~ "Tomarin is here" | {P3} =~ " (White Aura)") \
        /substitute -p %{PL}@{nCyellow}Tomarin @{Cgreen}(@{nCwhite}G@{nCgreen}, 88, human, mana shielded)@{nCwhite} Alive!@{n}%{P2}%{PR}%; \
      /elseif (iHaveDetectAlign & {P3} =~ "") \
        /substitute -p %{PL}@{nCyellow}Tomarin @{Cgreen}(@{nCwhite}G@{nCgreen}, 88, human, mana shielded)@{nCwhite} Statue!@{n}%{P2}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}Tomarin @{Cgreen}(@{nCwhite}G@{nCgreen}, 88, human, mana shielded)@{n}%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(A statue of Zelboth, the Icon of Clerics is here on display|Zelboth is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMuseumZelboth = \
    /if (mobsubs) \
      /if ({P1} =~ "Zelboth is here" | {P3} =~ " (White Aura)") \
        /substitute -p %{PL}@{nCyellow}Zelboth @{Cgreen}(@{nCwhite}G@{nCgreen}, 90, human, mana shielded)@{nCwhite} Alive!@{n}%{P2}%{PR}%; \
      /elseif (iHaveDetectAlign & {P3} =~ "") \
        /substitute -p %{PL}@{nCyellow}Zelboth @{Cgreen}(@{nCwhite}G@{nCgreen}, 90, human, mana shielded)@{nCwhite} Statue!@{n}%{P2}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}Zelboth @{Cgreen}(@{nCwhite}G@{nCgreen}, 90, human, mana shielded)@{n}%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(A statue of Jogath, the Icon of Warriors is here on display|Jogath is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMuseumJogath = \
    /if (mobsubs) \
      /if ({P1} =~ "Jogath is here" | {P3} =~ " (White Aura)") \
        /substitute -p %{PL}@{nCyellow}Jogath @{Cgreen}(@{nCwhite}G@{nCgreen}, 93, human)@{nCwhite} Alive!@{n}%{P2}%{PR}%; \
      /elseif (iHaveDetectAlign & {P3} =~ "") \
        /substitute -p %{PL}@{nCyellow}Jogath @{Cgreen}(@{nCwhite}G@{nCgreen}, 93, human)@{nCwhite} Statue!@{n}%{P2}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}Jogath @{Cgreen}(@{nCwhite}G@{nCgreen}, 93, human)@{n}%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(a frail old man stands here, leaning over a staff|Eindenlal is here)(, fighting [^\.!]+.|)" tfMobsubstMuseumEindenlal = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Eindenlal @{Cgreen}(N, 99, QM)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Mushroom Forest  -----------------------
/def -p100 -F -mregexp -t"(A rabbit is here, nibbling on wild grasses and clover\.|A rabbit is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMushroomforestRabbitNibbling = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A rabbit (nibbling) @{Cgreen}(@{nCwhite}G@{nCgreen}, 1, animal?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A small rabbit hops around about happily\.|A rabbit is here)(, fighting [^\.!]+.|)"  tfMobsubstMushroomforestRabbitHops = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A rabbit (hops) @{Cgreen}(N, 1, animal?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A little forest mouse scampers around in the vegetation\.|The mouse is here)(, fighting [^\.!]+.|)"  tfMobsubstMushroomforestMouse = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The mouse @{Cgreen}(N, 1, animal?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A small sparrow perched on the branch of a nearby tree whistles joyfully\.|The sparrow is here)(, fighting [^\.!]+.|)"  tfMobsubstMushroomforestSparrow = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The sparrow @{Cgreen}(N, 1, bird)@{n}%{P2}%{PR}%; \
    /endif
/def -p100 -F -mregexp -t"(A brown bear is here rummaging through the undergrowth\.|The brown bear is here)(, fighting [^\.!]+.|)"  tfMobsubstMushroomforestBrownBear = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The brown bear @{Cgreen}(N, 8, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An ugly forest ogre lumbers around looking for toadstools\.|A forest ogre is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)"  tfMobsubstMushroomforestForestOgre = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A forest ogre @{Cgreen}(@{nCred}E@{nCgreen}, 50, lugroki)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Mustaine  -----------------------
/def -p99 -F -mregexp -t"(A servant stands here\.|The servant is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMustaineServant = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The servant @{Cgreen}(@{nCwhite}G@{nCgreen}, 5, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An Apprentice Blacksmith stands here\. |The Apprentice Blacksmith is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMustaineAppBlacksmith = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Apprentice Blacksmith @{Cgreen}(@{nCwhite}G@{nCgreen}, 35, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Castle Guard stands here\.|The Castle Guard is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMustaineDastleGuard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Castle Guard @{Cgreen}(@{nCwhite}G@{nCgreen}, 35, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Blacksmith stands here\.|The Blacksmith is here)(, fighting [^\.!]+.|)" tfMobsubstMustaineBlacksmith = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Blacksmith @{Cgreen}(N, 40, no-attack)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Captain of the Guard stands here\.|The Captain of the Guard is here)(, fighting [^\.!]+.|)" tfMobsubstMustaineCaptain = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Captain of the Guard @{Cgreen}(N, 40, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Stablemaster stands here\.|The Stablemaster is here)(, fighting [^\.!]+.|)" tfMobsubstMustaineStablemaster = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Stablemaster @{Cgreen}(N, 40, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Warhorse bares its teeth at you\. |The Warhorse is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMustaineWarhorse = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Warhorse @{Cgreen}(@{nCred}E@{nCgreen}, 40, ---)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Keep Guard is patrolling this area\.|The Keep Guard is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMustaineKeepGuard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Keep Guard @{Cgreen}(@{nCwhite}G@{nCgreen}, 47, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p100 -F -mregexp -t"(The Chef stands here, dishing out soup from a cauldron\.|The Chef is here)(, fighting [^\.!]+.|)" tfMobsubstMustaineChef = \
    /if (mobsubs & ({P1} != 'The Chef is here' | area =~ 'Mustaine')) \
      /substitute -p %{PL}@{nCyellow}The Chef @{Cgreen}(N, 50, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Jail Keeper stands here\.|The Jail keeper is here)(, fighting [^\.!]+.|)" tfMobsubstMustaineJailKeeper = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Jail keeper @{Cgreen}(N, 50, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Kings Guard stands here\.|The Kings Guard is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMustaineKingsGuard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Kings Guard @{Cgreen}(@{nCwhite}G@{nCgreen}, 50, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Kings Warhorse rears at your presence\. |The Kings Warhorse is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMustaineKingsWarhorse = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Kings Warhorse @{Cgreen}(@{nCred}E@{nCgreen}, 50, ---)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Noble stands here\.|The Visiting Noble is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMustaineNoble = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Visiting Noble @{Cgreen}(@{nCwhite}G@{nCgreen}, 50, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A General stands here barking orders\.|The General is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMustaineGeneral = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The General @{Cgreen}(@{nCwhite}G@{nCgreen}, 55, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Prisoner is here chained to the wall\.|The Prisoner is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMustainePrisoner = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Prisoner @{Cgreen}(@{nCwhite}G@{nCgreen}, 55, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Kings Chancellor stands here\.|The Kings Chancellor is here)(, fighting [^\.!]+.|)" tfMobsubstMustaineChancellor = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Kings Chancellor @{Cgreen}(N, 60, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Steel Golem stands here\.|The Steel Golem is here)(, fighting [^\.!]+.|)" tfMobsubstMustaineGolem = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Steel Golem @{Cgreen}(N, 60, entity)@{n}%{P2}%{PR}%; \
    /endif
/def -p100 -F -mregexp -t"(The Torturer stands here smattered with blood\.|The Torturer is here)(, fighting [^\.!]+.|)" tfMobsubstMustaineTorturer = \
    /if (mobsubs & ({P1} != 'The Torturer is here' | area =~ 'Mustaine')) \
      /substitute -p %{PL}@{nCyellow}The Torturer @{Cgreen}(N, 65, ---)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(King Mustaine stands here\.|King Mustaine is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMustaineKing = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}King Mustaine @{Cgreen}(@{nCwhite}G@{nCgreen}, 94, human, blocker/norecall)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Wraith peers at you with glowing red eyes\.|The Wraith is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMustaineWraith = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Wraith @{Cgreen}(@{nCred}E@{nCgreen}, 100, insubstantial, immune WEAPON)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Myrridon  -----------------------
/def -p99 -F -mregexp -t"(An frail old woman is lying in her bed\.|Haebeth is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMyrridonHaebeth = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Haebeth @{Cgreen}(@{nCwhite}G@{nCgreen}, 1, QM)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(You see a small child playing here\.|A child of Myrridon is here)(, fighting [^\.!]+.|)" tfMobsubstMyrridonChild = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A child of Myrridon @{Cgreen}(N, 15, human, thief)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(You see a man here, obviously drunk, swearing that he is your friend\.|The happy drunk is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMyrridonHappyDrunk = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The happy drunk @{Cgreen}(@{nCwhite}G@{nCgreen}, 15, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(You see a tame horse eating grain here\.|A horse is here)(, fighting [^\.!]+.|)" tfMobsubstMyrridonHorse = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A horse @{Cgreen}(N, 20, ---)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(You see a drunk here finding it hard to keep his feet\.|A tipsy drunk is here)(, fighting [^\.!]+.|)" tfMobsubstMyrridonTipsyDrunk = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A tipsy drunk @{Cgreen}(N, 20, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(You see an angry drunk here cursing loudly\.|An angry drunk is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMyrridonAngryDrunk = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An angry drunk @{Cgreen}(@{nCred}E@{nCgreen}, 25, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(You see a pisshead downing some slabs here\.|The Pisshead is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMyrridonPisshead = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Pisshead @{Cgreen}(@{nCwhite}G@{nCgreen}, 30, nofight-room)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Shambling mound shambles about here\.|A Shambling Mound is here)(, fighting [^\.!]+.|)" tfMobsubstMyrridonMound = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Shambling Mound @{Cgreen}(N, 40, botanic)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(You see a merchant standing here\.|The Merchant is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMyrridonMerchant = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Merchant @{Cgreen}(@{nCwhite}G@{nCgreen}, 40, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A City guard of Myrridon patrols here\.|A City Guard of Myrridon is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMyrridonCityGuard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A City Guard of Myrridon @{Cgreen}(@{nCwhite}G@{nCgreen}, 45, human, protector)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A wealthy merchant proudly struts about here\.|A wealthy merchant is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMyrridonWealthyMerchant = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A wealthy merchant @{Cgreen}(@{nCwhite}G@{nCgreen}, 45, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(You see a burly thug standing here\.|The Thug is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMyrridonThug = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Thug @{Cgreen}(@{nCred}E@{nCgreen}, 45, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(You see a wild unbroken horse in it's stall here\.|The unbroken horse is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMyrridonUnbrokenHorse = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The unbroken horse @{Cgreen}(@{nCred}E@{nCgreen}, 45, ---)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Citizen of Myrridon stands here\.|A Citizen of Myrridon is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMyrridonCitizen = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Citizen of Myrridon @{Cgreen}(@{nCwhite}G@{nCgreen}, 50, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Merchant Guard stands protectively here\.|A merchant guard is here)(, fighting [^\.!]+.|)" tfMobsubstMyrridonMerchantGuard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A merchant guard @{Cgreen}(N, 50, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Metaphysician is here, mumbling to himself\.|The Metaphysician is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMyrridonMetaphysician = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Metaphysician @{Cgreen}(@{nCwhite}G@{nCgreen}, 50, nofight-room)@{n}%{P2}%{PR}%; \
    /endif
/set tumblewcons 0
/def -p99 -F -mregexp -t"(A huge tumbleweed rolls about here\.|A huge tumbleweed is here)(, fighting [^\.!]+.|)" tfMobsubstMyrridonTumbleweed = \
    /if (owner =~ 'Cindy' & mylevel < 65 & !tumblewcons) \
      /tfshow CONSIDER tumbleweed!!!%; \
      co tumbleweed%; \
      /set tumblewcons 1%; \
    /endif%; \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A huge tumbleweed @{Cgreen}(N, 53-55, ???, can split)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(You see the proud Elite guard standing here\.|An Elite guard is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMyrridonEliteGuard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An Elite guard @{Cgreen}(@{nCwhite}G@{nCgreen}, 55, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A sea troll stands hunched over here\.|The sea troll is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMyrridonSeaTroll = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The sea troll @{Cgreen}(@{nCred}E@{nCgreen}, 65, troll)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A retired soldier is sitting here in his cosy house\.|The retired sergeant is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMyrridonSergeant = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The retired sergeant @{Cgreen}(@{nCwhite}G@{nCgreen}, 65, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(You see a larger then normal thug standing here\.|The Thug King is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMyrridonThugKing = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Thug King @{Cgreen}(@{nCred}E@{nCgreen}, 65, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A lesser shard stands motionless here\.|The lesser shard is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMyrridonLesserShard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The lesser shard @{Cgreen}(@{nCred}E@{nCgreen}, 65, magical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A dwarf ent is guarding the entrance\.|The Dwarf Ent is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMyrridonDwarfEnt = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Dwarf Ent @{Cgreen}(@{nCwhite}G@{nCgreen}, 70, nofight-room)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A knight is guarding the entrance\.|You see a Knight wandering about here\.|The Knight is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMyrridonTheKnight = \
    /if (mobsubs) \
      /if ({P1} =~ "A knight is guarding the entrance." | {P3} =~ " (White Aura)") \
        /substitute -p %{PL}@{nCyellow}The Knight @{Cgreen}(@{nCwhite}G@{nCgreen}, 70, nofight-room)@{n}%{P2}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}The Knight @{Cgreen}(N, 85, mythical, specials)@{n}%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(A knight templar is guarding the entrance\.|The Knight Templar is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMyrridonKnightTemplar = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Knight Templar @{Cgreen}(@{nCwhite}G@{nCgreen}, 70, nofight-room)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A large sea troll stands hunched over here\.|The Large Sea Troll is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMyrridonLargeSeaTroll = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Large Sea Troll @{Cgreen}(@{nCred}E@{nCgreen}, 70, troll)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A paladin is guarding the entrance\.|The Paladin is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMyrridonPaladin = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Paladin @{Cgreen}(@{nCwhite}G@{nCgreen}, 70, nofight-room)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A sorcerer is guarding the entrance\.|The Sorcerer is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMyrridonSorcerer = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Sorcerer @{Cgreen}(@{nCwhite}G@{nCgreen}, 70, nofight-room)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A warlock is guarding the entrance\.|The Warlock is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMyrridonWarlock = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Warlock @{Cgreen}(@{nCwhite}G@{nCgreen}, 70, nofight-room)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Captain of the Guard stands here in his finery\.|The Captain of the Guard is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMyrridonCaptain = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Captain of the Guard @{Cgreen}(@{nCwhite}G@{nCgreen}, 75, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(You see a large sea troll standing here, with a thin band of gold on its head\.|The Shaman Troll King is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMyrridonShaman = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Shaman Troll King @{Cgreen}(@{nCred}E@{nCgreen}, 80, troll, mana shielded)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(You see a Catoblepas grazing here\.|The Catoblepas is here)(, fighting [^\.!]+.|)" tfMobsubstMyrridonCatoblepas = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Catoblepas @{Cgreen}(N, 85, resist fire, special-instakill)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(You see a greater shard standing motionless here\.|The greater shard is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMyrridonGreaterShard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The greater shard @{Cgreen}(@{nCred}E@{nCgreen}, 85, magical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An assassin is guarding the entrance\.|The Assassin is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMyrridonTheAssassin = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Assassin @{Cgreen}(@{nCwhite}G@{nCgreen}, 90, nofight-room)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Gatekeepers assistant stands here observing all visitors to Myrridon|The Gatekeepers assistant is here)(, fighting [^\.!]+.|)" tfMobsubstMyrridonGAssistant = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Gatekeepers assistant @{Cgreen}(N, 90, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Lionheart the Coward is here, undertaking his business\.|Lionheart the Coward is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMyrridonLionheart = \
    /if (owner =~ 'Cindy' & mylevel > 90 & !tumblewcons) \
      /tfshow CONSIDER lionheart!!!%; \
      co lionheart%; \
    /endif%; \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Lionheart the Coward @{Cgreen}(@{nCwhite}G@{nCgreen}, 99?, no-attack?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Lionheart the Coward flies in|An astral vortex opens, and Lionheart the Coward emerges)" tfMobsubstMyrridonLionhearChecklevel = \
    /if (owner =~ 'Cindy' & mylevel > 90 & !tumblewcons) \
      /tfshow CONSIDER lionheart!!!%; \
      co lionheart%; \
    /endif
/def -p99 -F -mregexp -t"(Smallheart the Wuss is here, doing a roaring trade\.|Smallheart the Wuss is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMyrridonSmallheart = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Smallheart the Wuss @{Cgreen}(@{nCwhite}G@{nCgreen}, 99, no-attack?)@{n}%{P2}%{PR}%; \
    /endif
/def -p98 -F -mregexp -t"(The secretary is sitting here at her desk, filing her nails\.|The secretary is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMyrridonSecretary = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The secretary @{Cgreen}(@{nCwhite}G@{nCgreen}, 99, nofight-room)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(You see one of the Brothers Bob tending his shop here\.|A Brother Bob is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMyrridonBob = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Brother Bob @{Cgreen}(@{nCwhite}G@{nCgreen}, 100, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(You see Alfred the Baker here\.|Alfred the Baker is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMyrridonAlfred = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Alfred the Baker @{Cgreen}(@{nCwhite}G@{nCgreen}, 100, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Diamond Astrogater with his compass, is standing here\.|An Diamond Astrogater is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMyrridonAstrogaterD = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An Diamond Astrogater @{Cgreen}(@{nCwhite}G@{nCgreen}, 100, nofight-room)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An Emerald Astrogater with his compass, is standing here\.|An Emerald Astrogater is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMyrridonAstrogaterE = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An Emerald Astrogater @{Cgreen}(@{nCwhite}G@{nCgreen}, 100, nofight-room)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Sapphire Astrogater with his compass, is standing here\.|An Sapphire Astrogater is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMyrridonAstrogaterS = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An Sapphire Astrogater @{Cgreen}(@{nCwhite}G@{nCgreen}, 100, nofight-room)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(You see Bill the shipwright working here\.|Bill the Shipwright is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMyrridonBill = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Bill the Shipwright @{Cgreen}(@{nCwhite}G@{nCgreen}, 100, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Gressford the Priest stands here\.|Gressford the Priest is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMyrridonGressford = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Gressford the Priest @{Cgreen}(@{nCwhite}G@{nCgreen}, 100, nofight-room)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An Ancient Wizard studies here\.|The Ancient Wizard is here)(, fighting [^\.!]+.|)" tfMobsubstMyrridonWizard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Ancient Wizard @{Cgreen}(N, 100, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(You see the Auctioneer screaming his head off here\.|The Auctioneer is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMyrridonAuctioneer = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Auctioneer @{Cgreen}(@{nCwhite}G@{nCgreen}, 100, nofight-room)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(You see a large behemoth standing here\.|The Behemoth is here)(, fighting [^\.!]+.|)" tfMobsubstMyrridonBehemoth = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Behemoth @{Cgreen}(N, 100, fire)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Gatekeeper of Myrridon stands here observing you with a dispassionate eye\.|The Gatekeeper of Myrridon is here)(, fighting [^\.!]+.|)" tfMobsubstMyrridonGatekeeper = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Gatekeeper of Myrridon @{Cgreen}(N, 100, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Guildmaster stands here\.|The Guild Master is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMyrridonGuildmaster = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Guild Master @{Cgreen}(@{nCwhite}G@{nCgreen}, 100, nofight-room)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Postmaster stands here\.|The Postmaster is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMyrridonPostmaster = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Postmaster @{Cgreen}(@{nCwhite}G@{nCgreen}, 100, no-attack)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(You see the Publican here tending his legendary bar\.|The Publican is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMyrridonPublican = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Publican @{Cgreen}(@{nCwhite}G@{nCgreen}, 100, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The receptionist presides here\.|The receptionist is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMyrridonReceptionist = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The receptionist @{Cgreen}(@{nCwhite}G@{nCgreen}, 100, nofight-room)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The general store shopkeeper stands here\.|The shopkeeper is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMyrridonShopkeeper = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The shopkeeper @{Cgreen}(@{nCwhite}G@{nCgreen}, 100, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(You see the Storekeeper standing here\.|The Storekeeper is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstMyrridonStorekeeper = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Storekeeper @{Cgreen}(@{nCwhite}G@{nCgreen}, 100, nofight-room)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(You see a Demon of Thorns looking for souls to devour\.|The Thorn Demon is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMyrridonThornDemon = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Thorn Demon @{Cgreen}(@{nCred}E@{nCgreen}, 100, demon)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Myrridonmines  -----------------------
/def -p99 -F -mregexp -t"(You see a small brain on legs here\.|A Ustilagor is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMyrridonMinesUstilagor = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Ustilagor @{Cgreen}(@{nCred}E@{nCgreen}, 30, ---)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Mole emerges from beneath your feet here\.|A Mole is here)(, fighting [^\.!]+.|)" tfMobsubstMyrridonMinesMole = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Mole @{Cgreen}(N, 25, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An Umber Hulk stands here waiting for it's prey\. \(hidden\)|An Umber Hulk \(hidden\) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMyrridonMinesHulk = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An Umber Hulk @{Cgreen}(@{nCred}E@{nCgreen}, 40, ---)@{n} (hide)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A small dog-like brain stands guard here\.|An Intellect Devourer is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMyrridonMinesDevourer = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An Intellect Devourer @{Cgreen}(@{nCred}E@{nCgreen}, 45, magical, mana shielded)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Mind Flayer patrols around here\.|A Mind Flayer is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMyrridonMinesMindFlayer = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Mind Flayer @{Cgreen}(@{nCred}E@{nCgreen}, 50, ---)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(You see a captured Dwarven Champion chained here\.|A Captured Dwarven Champion is here)(, fighting [^\.!]+.|)" tfMobsubstMyrridonMinesChamp = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Captured Dwarven Champion @{Cgreen}(N, 75, dwarf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Tub of briny fluid sits here\.|The Tub of briny fluid is here)(, fighting [^\.!]+.|)" tfMobsubstMyrridonMinesTub = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Tub of briny fluid @{Cgreen}(N, 100, entity/crush, specials)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Elder Brain sits in it's large tub here\.|The Elder-Brain is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstMyrridonMinesEBrain = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Elder-Brain @{Cgreen}(@{nCred}E@{nCgreen}, 100, ???)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An immense psionic worm with a tentacled maw slithers here\.|The Psionic Worm is here)(, fighting [^\.!]+.|)" tfMobsubstMyrridonMinesPsiWorm = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Psionic Worm @{Cgreen}(N, 150, ---)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Narnia  -----------------------
/def -p99 -F -mregexp -t"(A servant is standing here\.|A servant is here)(, fighting [^\.!]+.|)" tfMobsubstNarniaServant = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A servant @{Cgreen}(N, 3, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An old lady is standing here mumbling about something she wants to change\.|The old lady is here)(, fighting [^\.!]+.|)" tfMobsubstNarniaLady = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The old lady @{Cgreen}(N, 3, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A faun is standing here\.|Mr\. Tumnuz - The Faun is here)(, fighting [^\.!]+.|)" tfMobsubstNarniaTumnuz = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Mr. Tumnuz - The Faun @{Cgreen}(N, 10, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A female beaver is here, standing at here sewing machine\.|Mrs\. Beaver is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstNarniaMrsBeaver = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Mrs. Beaver @{Cgreen}(@{nCwhite}G@{nCgreen}, 16, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A fat and funny male beaver stands here\.|Mr\. Beaver is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstNarniaMrBeaver = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Mr. Beaver @{Cgreen}(@{nCwhite}G@{nCgreen}, 24, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A dryad is here, running around you whining!|A Dryad is here)(, fighting [^\.!]+.|)" tfMobsubstNarniaDryad = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Dryad @{Cgreen}(N, 30, elemental)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An old grey-haired man is standing here\.|The old professor is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstNarniaProfessor = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The old professor @{Cgreen}(@{nCwhite}G@{nCgreen}, 30, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A small mist is floating in the air|A small-sized demon is( standing|) here)(\.|)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstNarniaSmallDemon = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A small-sized demon @{Cgreen}(@{nCred}E@{nCgreen}, 55, demon)@{n}%{P2}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A little man with a funny red hat is standing here\.|A little man with a red hat is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstNarniaManWithHat = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A little man with a red hat @{Cgreen}(@{nCred}E@{nCgreen}, 55, dwarf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A medium mist is floating in the air|A medium-sized demon is( standing|) here)(\.|)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstNarniaMediumDemon = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A medium-sized demon @{Cgreen}(@{nCred}E@{nCgreen}, 60, demon)@{n}%{P2}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A huge tree stands here\.( \(invisible\)|)|A spytree( \(invisible\)|) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstNarniaSpytree = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}A spytree @{Cgreen}(@{nCred}E@{nCgreen}, 60, animal)@{n}%{invisTxt}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A young blond girl is standing here\.|Queen Susan is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstNarniaSusan = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Queen Susan @{Cgreen}(@{nCwhite}G@{nCgreen}, 60, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A young brown-haired girl is standing here\.|Queen Lucy is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstNarniaLucy = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Queen Lucy @{Cgreen}(@{nCwhite}G@{nCgreen}, 63, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A large mist is floating in the air|A large-sized demon is( standing|) here)(\.|)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstNarniaLargeDemon = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A large-sized demon @{Cgreen}(@{nCred}E@{nCgreen}, 65, demon)@{n}%{P2}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A young brown-haired boy stands here, dressed as a king\.|King Peter is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstNarniaPeter = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}King Peter @{Cgreen}(@{nCwhite}G@{nCgreen}, 65, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A white winged horse is circling around in the air\.|The Pegasus is here)( circling around in the air\.|, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstNarniaPegasus = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Pegasus @{Cgreen}(@{nCwhite}G@{nCgreen}, 66, mythical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A giant mist is floating in the air|A giant-sized demon is( standing|) here(\.|))(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstNarniaGiantDemon = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A giant-sized demon @{Cgreen}(@{nCred}E@{nCgreen}, 70, demon)@{n}%{P2}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A young prince is here, travelling across his father's property\.|Prince Caspian is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstNarniaCaspien = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Prince Caspian @{Cgreen}(@{nCwhite}G@{nCgreen}, 70, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A huge fearsome wolf is standing here\.|Maugrim - Chief of the Secret Police is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstNarniaMaugrim = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Maugrim - Chief of the Secret Police @{Cgreen}(@{nCred}E@{nCgreen}, 80, canine/fire)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A young red-haired boy is standing here\.|King Edmund is here)(, fighting [^\.!]+.|)" tfMobsubstNarniaEdmund = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}King Edmund @{Cgreen}(N, 90, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An old king of Narnia is standing here\.( \(invisible\)|)|An old king of Narnia( \(invisible\)|) is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstNarniaOldKing = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}An old king of Narnia @{Cgreen}(@{nCwhite}G@{nCgreen}, 100, human)@{n}%{invisTxt}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A dark mist is floating in air\.|The Demon Queen is( standing|) here)(\.|)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstNarniaDemonQueen = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Demon Queen @{Cgreen}(@{nCred}E@{nCgreen}, 100, demon)@{n}%{P2}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An old white-skinned lady stands here\.|The white Witch is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstNarniaWitch = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The white Witch @{Cgreen}(@{nCred}E@{nCgreen}, 100, human/light)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A giant dark mist is floating in the air\.|The great Demon King is( standing|) here)(\.|)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstNarniaDemonKing = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The great Demon King @{Cgreen}(@{nCred}E@{nCgreen}, 100, demon)@{n}%{P2}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A huge fearsome lion is standing here\.|Aslan - The great Lion is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstNarniaAslan = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Aslan - The great Lion @{Cgreen}(@{nCwhite}G@{nCgreen}, 100, mythical)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  NC  -----------------------
/def -p99 -F -mregexp -t"(A boatseller stands on the banks of the Laen river awaiting business\.|The Boatseller is here)(, fighting [^\.!]+.|)" tfMobsubstNCBoatseller = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Boatseller @{Cgreen}(N, 99, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A salmon leaps out of the water infront of you\.|A salmon is here)(, fighting [^\.!]+.|)" tfMobsubstNCSalmon = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A salmon @{Cgreen}(N, 4, fish)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A fisherman smiles at you before casting off\.|A fisherman is here)(, fighting [^\.!]+.|)" tfMobsubstNCFisherman = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A fisherman @{Cgreen}(N, 35, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A kingfisher is perched in some nearby reeds\.|A kingfisher is here)(, fighting [^\.!]+.|)" tfMobsubstNCKingfisher = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A kingfisher @{Cgreen}(N, 8, bird)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A swan gracefully drifts past you\.|A swan is here)(, fighting [^\.!]+.|)" tfMobsubstNCSwan = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A swan @{Cgreen}(N, 14-17, bird)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A cute little duck slowly paddles along here\.|A duck is here)(, fighting [^\.!]+.|)" tfMobsubstNCDuck = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A duck @{Cgreen}(N, 11, bird)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A beautiful pink butterfly aimlessly flys around\.|A butterfly is here)(, fighting [^\.!]+.|)" tfMobsubstNCButterfly = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A butterfly @{Cgreen}(N, 4, insect)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A brightly coloured dragonfly flits about here\.|A dragonfly is here)(, fighting [^\.!]+.|)" tfMobsubstNCDragonfly = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A dragonfly @{Cgreen}(N, 3, insect)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A beaver is here gnawing on a piece of driftwood\.|A beaver is here)(, fighting [^\.!]+.|)" tfMobsubstNCBeaver = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A beaver @{Cgreen}(N, 14-17, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A mayflie hovers in the air above the surface of the water\.|A mayflie is here)(, fighting [^\.!]+.|)" tfMobsubstNCMayflie = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A mayflie @{Cgreen}(N, 2, insect)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A pondskater skits off the surface of the water\.|A pondskater is here)(, fighting [^\.!]+.|)" tfMobsubstNCPondskater = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A pondskater @{Cgreen}(N, 2, insect)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A damselfly frantically buzzes its wings as it passes\.|A damselfly is here)(, fighting [^\.!]+.|)" tfMobsubstNCDamselfly = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A damselfly @{Cgreen}(N, 2, insect)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(You spot a grasshopper bouncing around amidst the reeds\.|A grasshopper is here)(, fighting [^\.!]+.|)" tfMobsubstNCGrasshopper = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A grasshopper @{Cgreen}(N, 4, insect)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An otter is swimming around looking for a meal\.|An otter is here)(, fighting [^\.!]+.|)" tfMobsubstNCOtter = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An otter @{Cgreen}(N, 8?, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A river rat swims through the water\.|A river rat is here)(, fighting [^\.!]+.|)" tfMobsubstNCRiverrat = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A river rat @{Cgreen}(N, 6, rodent)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Keeper of the lighthouse stands here, smoking a pipe\.|The Wolf Rock Lighthouse Keeper is here)(, fighting [^\.!]+.|)" tfMobsubstNCWolfrocklighthousekeepert = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Wolf Rock Lighthouse Keeper @{Cgreen}(N, 99, no-attack)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A retired ship's captain bumbles around trying to keep the lighthouse working\.|Mad Jack Silver is here)(, fighting [^\.!]+.|)" tfMobsubstNCMadjacksilver = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Mad Jack Silver @{Cgreen}(N, 99, no-attack)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An old gnarly sea-dog is here tending to the lighthouse\.|Portland Bill is here)(, fighting [^\.!]+.|)" tfMobsubstNCPortlandbill = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Portland Bill @{Cgreen}(N, 99, no-attack)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The ghost of a lighthouse keeper haunts this place\.|The Ghost of the Last Keeper is here)(, fighting [^\.!]+.|)" tfMobsubstNCGhostofthelastkeeper = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Ghost of the Last Keeper @{Cgreen}(N, 99, no-attack)@{n}%{P2}%{PR}%; \
    /endif
/def -p115 -F -mregexp -t"(A horse is here, trotting slowly along\.|A horse is here)(, fighting [^\.!]+.|)" tfMobsubstNCHorse = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A horse @{Cgreen}(N, 1-10?, ???)@{n}%{P2}%{PR}%; \
    /endif




; -----------------------  New Thalos  -----------------------
/def -p99 -F -mregexp -t"(A beautiful woman is here offering you a massage\.|A beautiful masseuse is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstNewThalosMasseuse = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A beautiful masseuse @{Cgreen}(@{nCwhite}G@{nCgreen}, 4, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A pet lamia stands here waiting for her next command\.|The pet lamia is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstNewThalosLamia = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The pet lamia @{Cgreen}(@{nCwhite}G@{nCgreen}, 4, magical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A citizen of Thalos is here, conversing with everyone\.|A citizen of Thalos is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstNewThalosCitizen = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A citizen of Thalos @{Cgreen}(@{nCwhite}G@{nCgreen}, 5, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A female citizen of Thalos is here, showing off her new dress\.|A female citizen of Thalos is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstNewThalosFemaleCitizen = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A female citizen of Thalos @{Cgreen}(@{nCwhite}G@{nCgreen}, 5, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A man is here bathing\.|A man is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstNewThalosMan = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A man @{Cgreen}(@{nCwhite}G@{nCgreen}, 5, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(You meet a baby beholder's cute gaze!|The baby beholder is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstNewThalosBeholder = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The baby beholder @{Cgreen}(@{nCwhite}G@{nCgreen}, 5, magical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Guide from the Eternal Order of Navigators is waiting to help you\.|The Guide is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstNewThalosGuide = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Guide (EOoN) @{Cgreen}(@{nCwhite}G@{nCgreen}, 5, guide)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A young scholar studies quietly in the corner\.|A young scholar is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstNewThalosScholar = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A young scholar @{Cgreen}(@{nCwhite}G@{nCgreen}, 6, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A bard sings of the glory of Thalos\.|This bard merrily skips along singing of the glory of Thalos\.|Bard of Thalos is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstNewThalosBard = \
    /if (mobsubs) \
      /if ({P1} =~ "A bard sings of the glory of Thalos.") \
        /substitute -p %{PL}@{nCyellow}Bard of Thalos (in tavern) @{Cgreen}(@{nCwhite}G@{nCgreen}, 6, human)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ "This bard merrily skips along singing of the glory of Thalos.") \
        /substitute -p %{PL}@{nCyellow}Bard of Thalos (merry) @{Cgreen}(@{nCwhite}G@{nCgreen}, 7, human)@{n}%{P2}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}Bard of Thalos (in tavern/merry) @{Cgreen}(@{nCwhite}G@{nCgreen}, 6/7, human)@{n}%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(The librarian is here shelving books away neatly\.|The librarian is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstNewThalosLibrarian = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The librarian @{Cgreen}(@{nCwhite}G@{nCgreen}, 8, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A fanatic priest is here, foretelling the destruction of Thalos\.|The fanatic priest is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstNewThalosFanatic = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The fanatic priest @{Cgreen}(@{nCred}E@{nCgreen}, 10, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An imperial cityguard guards the Grand Gate\.|An imperial cityguard is here, keeping the peace of Thalos\.|An imperial cityguard overseeing patrols in the city\.|An imperial cityguard is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstNewThalosCityguard = \
    /if (mobsubs) \
      /if ({P1} =~ "An imperial cityguard guards the Grand Gate.") \
        /substitute -p %{PL}@{nCyellow}An imperial cityguard (guarding gate) @{Cgreen}(@{nCwhite}G@{nCgreen}, 17, human)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ "An imperial cityguard is here, keeping the peace of Thalos.") \
        /substitute -p %{PL}@{nCyellow}An imperial cityguard (keeping peace) @{Cgreen}(@{nCwhite}G@{nCgreen}, 17, human)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ "An imperial cityguard overseeing patrols in the city.") \
        /substitute -p %{PL}@{nCyellow}An imperial cityguard (overseeing) @{Cgreen}(@{nCwhite}G@{nCgreen}, 17, human)@{n}%{P2}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}An imperial cityguard (guarding gate/keeping peace/overseeing) @{Cgreen}(@{nCwhite}G@{nCgreen}, 17, human)@{n}%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(The mayor of Thalos is sitting here, doing her paperwork\.|The mayor of Thalos is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstNewThalosMayor = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The mayor of Thalos @{Cgreen}(@{nCwhite}G@{nCgreen}, 20, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The priest of Thalos tells you of the glories of this city\.|The priest of Thalos is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstNewThalosPriest = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The priest of Thalos @{Cgreen}(@{nCwhite}G@{nCgreen}, 20, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An old wizard sits quietly at the counter waiting for a sale\.|An old wizard is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstNewThalosOldWizard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An old wizard @{Cgreen}(@{nCwhite}G@{nCgreen}, 30, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Ben the Smith sells metal odds and ends to anyone interested\.|Ben the Smith is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstNewThalosBen = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Ben the Smith @{Cgreen}(@{nCwhite}G@{nCgreen}, 30, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Dan the Barkeep stands by the counter wiping a glass\.|Dan the Barkeep is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstNewThalosDan = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Dan the Barkeep @{Cgreen}(@{nCwhite}G@{nCgreen}, 30, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Farmer Betty looks at you sweetly offering you some apples\.|Farmer Betty is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstNewThalosBetty = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Farmer Betty @{Cgreen}(@{nCwhite}G@{nCgreen}, 30, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(George the Butcher is here whacking away at a side of beef\.|George the Butcher is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstNewThalosGeorge = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}George the Butcher @{Cgreen}(@{nCwhite}G@{nCgreen}, 30, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Thaellor is here selling his metal wares\.|Thaellor the dwarf is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstNewThalosThaellor = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Thaellor the dwarf @{Cgreen}(@{nCwhite}G@{nCgreen}, 30, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(In the corner you see a large, stone golem faithfully standing watch\.|The stone golem is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstNewThalosGolem = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The stone golem @{Cgreen}(@{nCwhite}G@{nCgreen}, 30, entity)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Gordon the Brave, the Defender of Thalos, is here, looking at no|Gordon the Brave is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstNewThalosGordon = \
    /let mobName=@{nCyellow}Gordon the Brave @{Cgreen}(@{nCwhite}G@{nCgreen}, 35, human)@{n}%; \
    /if (mobsubs & {P1} =~ 'Gordon the Brave is here') \
      /substitute -p %{PL}%{mobName}%{P2}%{PR}%; \
    /elseif (mobsubs) \
      /substitute%; \
      /def -p99 -F -n1 -mregexp -t"^one but you, the only stranger in town\\.( \\(White Aura\\)|)" tfMobsubstSpecial = \
        /substitute -p %%{PL}%{mobName}%%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An old half-elf hunter is sitting here with his beer\.|Relyar Aspenwind, the half-elf ranger is here)(, fighting [^\.!]+.|)" tfMobsubstNewThalosRelyar = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Relyar Aspenwind, the half-elf ranger @{Cgreen}(N, 84, QM)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The auctioneer is standing here screaming bids loudly\.|The auctioneer is here)(, fighting [^\.!]+.|)" tfMobsubstNewThalosAuctioneer = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The auctioneer @{Cgreen}(N, 99, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A priest stands here, looking worried about your spiritual condition\.|Ourip, Priest of the Righteous Order is here)(, fighting [^\.!]+.|)" tfMobsubstNewThalosOurip = \
    /if (mobsubs) \
      /substitute -p %{PL}@{hCyellow}Ourip, Priest of the Righteous Order @{nCgreen}(N, 100, QM)@{n}%{P2}%{PR}%; \
    /endif
/def -p100 -F -mregexp -t"(The Cartographer is here, busily copying more maps to sell\.|The Cartographer is here)(, fighting [^\.!]+.|)" tfMobsubstNewThalosCartographer = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Cartographer @{Cgreen}(N, 100, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The cryogenicist is here, smiling at you\.|The Cryogenicist is here)(, fighting [^\.!]+.|)" tfMobsubstNewThalosCryogenicist = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Cryogenicist @{Cgreen}(N, 100, nofight-room)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Master of this Guild House is here, ready to train you\.|The Guildmaster is here)(, fighting [^\.!]+.|)" tfMobsubstNewThalosGuildmaster = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Guildmaster @{Cgreen}(N, 100, nofight-room)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Clerk is here, watching you to make sure you touch nothing\.|The Item Store Clerk is here)(, fighting [^\.!]+.|)" tfMobsubstNewThalosClerk = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Item Store Clerk @{Cgreen}(N, 100, nofight-room)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The New Thalos Postmaster is here, sorting through today's mail\.|The Postmaster is here)(, fighting [^\.!]+.|)" tfMobsubstNewThalosPostmaster = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Postmaster @{Cgreen}(N, 100, nofight-room)@{n}%{P2}%{PR}%; \
    /endif
/def -p100 -F -mregexp -t"(The Receptionist is here, smiling at you gently\.|The Receptionist is here)(, fighting [^\.!]+.|)" tfMobsubstNewThalosReceptionist = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Receptionist @{Cgreen}(N, 100, nofight-room)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Nirvana  -----------------------
/def -p99 -F -mregexp -t"(A tridrone is here, doing a menial task\.|A tridrone is here)(, fighting [^\.!]+.|)" tfMobsubstNirvanaTridrone = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A tridrone @{Cgreen}(N, 18, magical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A quadrone is here, watching for trespassers\.|A quadrone is here)(, fighting [^\.!]+.|)" tfMobsubstNirvanaQuadrone = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A quadrone @{Cgreen}(N, 21, magical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A pentadrone is here, policing the area\.|A pentadrone is here)(, fighting [^\.!]+.|)" tfMobsubstNirvanaPentadrone = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A pentadrone @{Cgreen}(N, 23, magical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A decaton is here, overseeing the other modrons\.|A decaton is here)(, fighting [^\.!]+.|)" tfMobsubstNirvanaDecaton = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A decaton @{Cgreen}(N, 25, magical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A nonaton is here, preserving law and order\.|A nonaton is here)(, fighting [^\.!]+.|)" tfMobsubstNirvanaNonaton = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A nonaton @{Cgreen}(N, 27, magical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An octon is here, governing his ward of responsilbility\.|An octon is here)(, fighting [^\.!]+.|)" tfMobsubstNirvanaOcton = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An octon @{Cgreen}(N, 29, magical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A septon is here, preserving order\.|A septon is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstNirvanaSepton = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A septon @{Cgreen}(@{nCwhite}G@{nCgreen}, 31, magical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A hexton is here, watching over his armies\.|A hexton is here)(, fighting [^\.!]+.|)" tfMobsubstNirvanaHexton = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A hexton @{Cgreen}(N, 33, magical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A quinton is here keeping records\.|A quinton is here)(, fighting [^\.!]+.|)" tfMobsubstNirvanaQuinton = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A quinton @{Cgreen}(N, 35, magical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A tertian is here administering the law\.|A tertian is here)(, fighting [^\.!]+.|)" tfMobsubstNirvanaTertian = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A tertian @{Cgreen}(N, 40, magical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Secundus, Viceroy of the quarter, is here\.|Secundus is here)(, fighting [^\.!]+.|)" tfMobsubstNirvanaSecundus = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Secundus @{Cgreen}(N, 45, magical)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Primus, ruler of all the planes of Nirvana, forms out of an energy pool\.|Primus is here)(, fighting [^\.!]+.|)" tfMobsubstNirvanaPrimus = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Primus @{Cgreen}(N, 70, mythical)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Northern Plains  -----------------------
/def -p99 -F -mregexp -t"(Sorbus the Hermit is sitting here, roasting a rabbit\.|Sorbus the Hermit is here)(, fighting [^\.!]+.|)" tfMobsubstNorthernPlainsSorbus = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Sorbus the Hermit @{Cgreen}(N, 5, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Aruncus the Druid is walking around here, searching for herbs\.|Aruncus the Druid is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstNorthernPlainsAruncus = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Aruncus the Druid @{Cgreen}(@{nCred}E@{nCgreen}, 15, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Shudde-M'ell the Giant worm of G'harne is guarding his treasure\.|Shudde-M'ell is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstNorthernPlainsShuddeMell = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Shudde-M'ell @{Cgreen}(@{nCred}E@{nCgreen}, 25, dragon)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Sir Kayodin is here, watching you from the shadows\. \(invisible\)|Sir Kayodin \(invisible\) is here)(, fighting [^\.!]+.|)" tfMobsubstNorthernPlainsSirKayodin = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Sir Kayodin @{Cgreen}(N, 60, QM)@{n} (imp)%{P2}%{PR}%; \
    /endif

; -----------------------  Oblivion  -----------------------
/def -p99 -F -mregexp -t"(u_n_k_n_o_w_n|A small shadow daedra is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstOblivionSmShDaedra = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A small shadow daedra @{Cgreen}(@{nCred}E@{nCgreen}, 1-61, elemental?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A small annoying daedra is here, teasing you carelessly\.|A scamp is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstOblivionScamp = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A scamp @{Cgreen}(@{nCred}E@{nCgreen}, 75, demon?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A huge daedra is here, clad in dark robes\.( \(invisible\)|)|The Tower Guardian( \(invisible\)|) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstOblivionTowerGuardian = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (imp/invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}The Tower Guardian @{Cgreen}(@{nCred}E@{nCgreen}, 74-75, ???)@{n}%{invisTxt}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A huge daedra is here, torturing the lesser evils of Oblivion|The Torturer is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstOblivionTorturer = \
    /let mobName=@{nCyellow}The Torturer @{Cgreen}(@{nCred}E@{nCgreen}, 75, demon?, special-portal)@{n}%; \
    /if (mobsubs & {P1} =~ 'The Torturer is here') \
      /substitute -p %{PL}%{mobName}%{P2}%{PR}%; \
    /elseif (mobsubs) \
      /substitute%; \
      /def -p99 -F -n1 -mregexp -t"^\\.\\.\\.surrounded by an aura of ultimate evil\\.( \\(Red Aura\\)|)" tfMobsubstSpecial = \
        /substitute -p %%{PL}%{mobName}%%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A tall vegetable-like daedra is here, talking to everyone and everything\.|A vermai is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstOblivionVermai = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A vermai @{Cgreen}(@{nCred}E@{nCgreen}, 80, demon?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A tall skeletal creature is here, with a tiny figure trapped in its rib cage\.|The devourer is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstOblivionDevourer = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The devourer @{Cgreen}(@{nCred}E@{nCgreen}, 80, undead?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A snakelike creature with three heads and nine arms is floating here\.|A Sharn is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstOblivionSharn = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Sharn @{Cgreen}(@{nCred}E@{nCgreen}, 80, magical?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A daedra with a fish-like head and lobster claws is here\.|A clannfear is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstOblivionClannfear = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A clannfear @{Cgreen}(@{nCred}E@{nCgreen}, 80, demon?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Dragon Daedra's faintly visible, almost transparent head is here\.|Azimers transparent head of Air is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstOblivionAzimerHeadAir = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Azimers transparent head of Air @{Cgreen}(@{nCred}E@{nCgreen}, 80, ???)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Dragon Daedra's red head is burning with an intense heat\.|Azimers red head of Fire is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstOblivionAzimerHeadFire = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Azimers red head of Fire @{Cgreen}(@{nCred}E@{nCgreen}, 80, ???)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Dragon Daedra's blue head has icicles hanging from it\.|Azimers blue head of Ice is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstOblivionAzimerHeadIce = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Azimers blue head of Ice @{Cgreen}(@{nCred}E@{nCgreen}, 80, ???)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Dragon Daedra's white head has bolts of lightning dancing all over it|Azimers white head of Electricity is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstOblivionAzimerHeadElec = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Azimers white head of Electricity @{Cgreen}(@{nCred}E@{nCgreen}, 80, ???)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A long snake-like creature with a tentacled head is prowling here\. \(hidden\)|The grick \(hidden\) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstOblivionGrick = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The grick @{Cgreen}(@{nCred}E@{nCgreen}, 80, ???/fire/ice/light)@{n} (hide)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A frost daedra is here, chilling you to the bone with its cold aura\. \(invisible\)|A frost daedra \(invisible\) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstOblivionFrostDaedra = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A frost daedra @{Cgreen}(@{nCred}E@{nCgreen}, 83, elemental?/fire)@{n} (imp)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A fire daedra is here, burning you with its flaming body\. \(invisible\)|A fire daedra \(invisible\) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstOblivionFireDaedra = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A fire daedra @{Cgreen}(@{nCred}E@{nCgreen}, 83, elemental?/ice)@{n} (imp)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A beautiful voluptuous woman is here, winking at you\. \(invisible\) \(hidden\)|The doppelganger \(invisible\) \(hidden\) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstOblivionDoppelganger = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The doppelganger @{Cgreen}(@{nCred}E@{nCgreen}, 85, ???)@{n} (imp) (hide)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(a red-skinned daedra is here, clad in a white chefs uniform\.|The Chef is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstOblivionChef = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Chef @{Cgreen}(@{nCred}E@{nCgreen}, 85, human/pure/light/iron/silver/electricity)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A large green daedra in heavy crimson armor is patrolling here\.|An Elite Daedroth Guard is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstOblivionEliteGuard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An Elite Daedroth Guard (small/big) @{Cgreen}(@{nCred}E@{nCgreen}, 90/94, demon?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A huge fire daedra is here, jumping between the flames \(invisible\)|A greater fire daedra \(invisible\) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstOblivionGreaterFireDaedra = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A greater fire daedra @{Cgreen}(@{nCred}E@{nCgreen}, 90, elemental?/ice)@{n} (imp)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A small green daedra wearing a crimson armor is standing here\.|A small green daedra is sitting here, having dinner\.|A Daedroth is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstOblivionDaedroth = \
    /if (mobsubs) \
      /if ({P1} =~ "A small green daedra wearing a crimson armor is standing here.") \
        /substitute -p %{PL}@{nCyellow}A Daedroth (standing) @{Cgreen}(@{nCred}E@{nCgreen}, 90, demon?)@{n}%{P2}%{PR}%; \
      /elseif ({P1} =~ "A small green daedra is sitting here, having dinner.") \
        /substitute -p %{PL}@{nCyellow}A Daedroth (dinner) @{Cgreen}(@{nCred}E@{nCgreen}, 90, demon?)@{n}%{P2}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}A Daedroth (standing/dinner) @{Cgreen}(@{nCred}E@{nCgreen}, 90, demon?)@{n}%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(A huge frost daedra emerges from the cold wasteland \(invisible\)|A greater frost daedra \(invisible\) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstOblivionGreaterFrostDaedra = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A greater frost daedra @{Cgreen}(@{nCred}E@{nCgreen}, 90, elemental?/fire)@{n} (imp)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(u_n_k_n_o_w_n( \(invisible\)|)|A nalfeshnee( \(invisible\)|) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstOblivionNalfeshnee = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (imp/invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}A nalfeshnee @{Cgreen}(@{nCred}E@{nCgreen}, 90, demon?)@{n}%{invisTxt}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A solid shadow strides towards you\.( \(invisible\)|) \(hidden\)|The nightwalker( \(invisible\)|) \(hidden\) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstOblivionNightwalker = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (imp/invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}The nightwalker @{Cgreen}(@{nCred}E@{nCgreen}, 94, ???/crush?)@{n}%{invisTxt} (hide)%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A beautiful female daedra is here, her wings folded on her back\.( \(invisible\)|)|The Daedra Seducer( \(invisible\)|) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstOblivionSeducer = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (imp/invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}The Daedra Seducer @{Cgreen}(@{nCred}E@{nCgreen}, 95, demon?)@{n}%{invisTxt}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A man-like daedra clad in a full platemail looks angrily at you as you enter\.( \(invisible\)|)|The Dremora( \(invisible\)|) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstOblivionDremora = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (imp/invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}The Dremora @{Cgreen}(@{nCred}E@{nCgreen}, 95, demon?)@{n}%{invisTxt}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A half frost, half fire Daedra Lord is here on his throne\. \(invisible\)|Freiza \(invisible\) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstOblivionFreiza = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (imp/invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}Freiza @{Cgreen}(@{nCred}E@{nCgreen}, 95, ?/dark)@{n} (imp)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A daedra with a humanoid torso and a spider body is here, weaving its web\.( \(invisible\)|)|The Spider Daedra( \(invisible\)|) is here)(, fighting [^\.!]+.|)" tfMobsubstOblivionSpiderDaedra = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (imp/invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}The Spider Daedra @{Cgreen}(N, 95, demon?)@{n}%{invisTxt}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A huge, four headed Dragon Daedra is here, looking displeased as you enter\.|The Daedra Lord Azimer is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstOblivionAzimer = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Daedra Lord Azimer @{Cgreen}(@{nCred}E@{nCgreen}, 100, dragon/light)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A tall Divine warrior is here, guarding the Gates of Oblivion|The Guardian of Oblivion is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstOblivionGuardianOfOblivion = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Guardian of Oblivion @{Cgreen}(@{nCwhite}G@{nCgreen}, 100, WEAPON/dark/mental)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A beautiful winged creature is here, chained to the wall\.|The imprisoned Deva is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstOblivionimprisonedDeva = \
    /let mobName=@{nCyellow}The imprisoned Deva @{Cgreen}(@{nCwhite}G@{nCgreen}, 100, ???, special-give)@{n}%; \
    /if (mobsubs & {P1} =~ 'The imprisoned Deva is here') \
      /substitute -p %{PL}%{mobName}%{P2}%{PR}%; \
    /elseif (mobsubs) \
      /substitute%; \
      /def -p99 -F -n1 -mregexp -t"^\\.\\.\\.radiating goodness like none you have ever felt\\.( \\(White Aura\\)|)" tfMobsubstSpecial = \
        /substitute -p %%{PL}%{mobName}%%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A beautiful woman is here, watching the stars and taking some notes\.|Meridia is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstOblivionMeridia = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Meridia @{Cgreen}(@{nCred}E@{nCgreen}, 100, demon?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A tall, fair skinned humanoid-looking creature is sitting behind his desk\.|Nocturnal is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstOblivionNocturnal = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Nocturnal @{Cgreen}(@{nCred}E@{nCgreen}, 100, demon?, summoner)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Ocean Floor  -----------------------
/def -p99 -F -mregexp -t"A cannibal is standing here grinning at you... That is a very large knife..." tfMobsubstOceanfloorCannibal = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A cannibal @{Cgreen}(lvl 1, ???)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"A tiny ebony man is here, holding a very large knife." tfMobsubstOceanfloorTribeChief = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The cannibal tribe chief @{Cgreen}(lvl 70, human)@{n}%{PR}%; \
    /endif

; -----------------------  Palanthas  -----------------------

;Dalamar is here, fighting Zoebri. (Red Aura)
;Raistlin Majere is here, fighting Zoebri. (Red Aura)

;Lord Amothus is sleeping here. (White Aura)
;Before you stands Lord Amothus, the supreme ruler of Palanthas. (White Aura)


; -----------------------  Pathweaver 4  -----------------------

;A castle guard stands rigidly in place. (invisible)

; -----------------------  Ragnarok  -----------------------
/def -p99 -F -mregexp -t"A large warrior is here, muscles bulging as he moves." tfMobsubstRagnarokThor = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Thor @{Cgreen}(lvl 100, slay human?)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"A norse warrior-maiden is here, ready for battle." tfMobsubstRagnarokValkyrie = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Valkyrie @{Cgreen}(lvl 94, normal?)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"A Fire Giant is burning the fields with his aura of heat" tfMobsubstRagnarokFireGiant = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Fire Giant @{Cgreen}(lvl 94, PULSE-DAM, slay giant?)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"A Frost Giant is freezing the air with his aura of cold." tfMobsubstRagnarokFrostGiant = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Frost Giant @{Cgreen}(lvl 94, PULSE-DAM, slay giant?)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"A crazed berserking viking is here, madness shining in his eyes." tfMobsubstRagnarokBerserker = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Berserker @{Cgreen}(lvl 94, AGG, slay human?)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"A large viking strides across the plains." tfMobsubstRagnarokViking = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Viking @{Cgreen}(lvl 90, slay human?)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"A large norse warrior is prepared for battle." tfMobsubstRagnarokVikingSummoned = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Viking @{Cgreen}(lvl 75, AGG, summoned, dark/bleed)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"A tall man is standing here, whistling merrily." tfMobsubstRagnarokHeimdal = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Heimdal, the Guardian of Bifrost @{Cgreen}(lvl 99, slay mythical?)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"A Giant glares around him, holding his club high." tfMobsubstRagnarokGiantWarrior = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Giant Warrior @{Cgreen}(lvl 90, AGG, slay giant?)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"A black warg glances at you, apparently too tired to attempt to eat you." tfMobsubstRagnarokSleepyWarg = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A sleepy warg @{Cgreen}(lvl 75, mental)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"A hungry warg glares at you and licks its fangs." tfMobsubstRagnarokHungryWarg = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A hungry warg @{Cgreen}(lvl 80, mental)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"A huge warg stands before you, saliva dripping from its huge fangs." tfMobsubstRagnarokBloodthirstyWarg = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A bloodthirsty Warg @{Cgreen}(lvl 80, mental)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"Angerboda, Lokis giant wife is sitting here amongst her children." tfMobsubstRagnarokAngerboda = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Angerboda @{Cgreen}(lvl 95, magic)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"A small wolf is here, looking confused." tfMobsubstRagnarokSmallWolf = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A small grey/red/white wolf @{Cgreen}(lvl 40, mental)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"A one-eyed god is walking steadily across the lands, two ravens by his side." tfMobsubstRagnarokOdin = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Odin @{Cgreen}(lvl 100, mythical?)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"An eight-legged warhorse stands here royally." tfMobsubstRagnarokSleipner = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Sleipner @{Cgreen}(N, 95, ???)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"A very large wolf stands here, glowling at you." tfMobsubstRagnarokFenril = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Fenril Wolf @{Cgreen}(@{nCred}E@{nCgreen}, 90, canine?)@{n}%{PR}%; \
    /endif

; -----------------------  Shadowdwell  -----------------------

/def -p99 -F -mregexp -t"(A drow scout stalks here, patrolling the outskirts\.( \(invisible\)|) \(hidden\)|A drow scout( \(invisible\)|) \(hidden\) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellDrowscout = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (imp/invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}A drow scout @{Cgreen}(@{nCred}E@{nCgreen}, 60, drow-elf)@{n}%{invisTxt} (hide)%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A drow guard patrols here, seemingly uninterested\.|A drow patrol is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellDrowpatrol = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A drow patrol @{Cgreen}(@{nCred}E@{nCgreen}, 55, drow-elf, assist-all)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A drow guard stands here, leaning on his spear\.|A drow guard is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellDrowguard = \
    /if (mobsubs & area !~ 'Guallidurth') \
      /if (currentroom =~ 'A Topaz-lit Entrance Hall') \
        /substitute -p %{PL}@{nCyellow}A drow guard @{Cgreen}(@{nCred}E@{nCgreen}, 55, drow-elf, assist-all)@{n}%{P2}%{PR}%; \
      /else \
        /substitute -p %{PL}@{nCyellow}A drow guard @{Cgreen}(@{nCred}E@{nCgreen}, 55, drow-elf)@{n}%{P2}%{PR}%; \
      /endif%; \
    /endif
/def -p99 -F -mregexp -t"(A male drow citizen is here, observing the activities\.|A male drow citizen is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellMaledrowcitizen = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A male drow citizen @{Cgreen}(@{nCred}E@{nCgreen}, 35, drow-elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A drow mercenary walks by\.|A drow mercenary is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellDrowmercenary = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A drow mercenary @{Cgreen}(@{nCred}E@{nCgreen}, 45, drow-elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A hooded outlaw is here, looking for a place to stay\.|A drow outlaw is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellDrowoutlaw = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A drow outlaw @{Cgreen}(@{nCred}E@{nCgreen}, 42, drow-elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A drow urchin loiters in a dark alley\.|A drow urchin is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellDrowurchin = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A drow urchin @{Cgreen}(@{nCred}E@{nCgreen}, 22, drow-elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A shadowy spider about the size of your foot, scuttles about\.|A small wraith spider is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellWraithspider = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A small wraith spider @{Cgreen}(@{nCred}E@{nCgreen}, 1-57, spider)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A deep rothe stumbles around here\.|A deep rothe is here)(, fighting [^\.!]+.|)" tfMobsubstShadowdwellRothe = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A deep rothe @{Cgreen}(N, 40, animal)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A female drow commoner walks by\.|A female drow commoner is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellFemaledrowcommoner = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A female drow commoner @{Cgreen}(@{nCred}E@{nCgreen}, 35, drow-elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A svirfneblin slave is here, hauling equipment around\.|A svirfneblin slave is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstShadowdwellSvirfneblinslave = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A svirfneblin slave @{Cgreen}(@{nCwhite}G@{nCgreen}, 25, large/slarge)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A smelly footpad tries to determine the value of your gear\.|A drow footpad is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellDrowFootpad = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A drow footpad @{Cgreen}(@{nCred}E@{nCgreen}, 40, drow-elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A goblin slave pole-rafts about, looking for fish\.|A fisher goblin slave is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellFishergoblinslave = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A fisher goblin slave @{Cgreen}(@{nCred}E@{nCgreen}, 20, goblin)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A creeping blanket of moss lies here\.|The memory moss is here)(, fighting [^\.!]+.|)" tfMobsubstShadowdwellMemorymoss = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The memory moss @{Cgreen}(N, 58-62, acid/mental, resist WEAPON)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A drow marauder flits from shadow to shadow\.( \(invisible\)|) \(hidden\)|A drow marauder( \(invisible\)|) \(hidden\) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellDrowmarauder = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (imp/invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}A drow marauder @{Cgreen}(@{nCred}E@{nCgreen}, 43, drow-elf)@{n}%{invisTxt} (hide)%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A heavily armored duergar stands here, alert\.|A duergar warrior is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellDuergarwarrior = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A duergar warrior @{Cgreen}(@{nCred}E@{nCgreen}, 65, dwarf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A chained reptilian humanoid trudges along\.|A troglodyte is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellTroglodyte = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A troglodyte @{Cgreen}(@{nCred}E@{nCgreen}, 27, ---)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A drow slaver stands here, holding a whip and chain\.|A drow slaver is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellDrowslaver = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A drow slaver @{Cgreen}(@{nCred}E@{nCgreen}, 60, drow-elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A charismatic drow artisan performs here\.|A drow artisan is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellDrowartisan = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A drow artisan @{Cgreen}(@{nCred}E@{nCgreen}, 36, drow-elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A svirfneblin gambler sits here, looking rather pale\.|A svirfneblin gambler is standing here\.|A svirfneblin gambler is here)(, fighting [^\.!]+.|)" tfMobsubstShadowdwellSvirfneblingambler = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A svirfneblin gambler @{Cgreen}(N, 30, large/slarge)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A drunk half-orc stands here, looking for a fight\.|A half-orc drunkard is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellHalforcdrunkard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A half-orc drunkard @{Cgreen}(@{nCred}E@{nCgreen}, 47, half-orc)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An elderly human woman sits here, listening to stories\.|Shimryl is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstShadowdwellShimryl = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Shimryl @{Cgreen}(@{nCwhite}G@{nCgreen}, 100, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A patron sits here, chatting with the customers\.|A drow patron is standing here\.|A drow patron is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellDrowpatron = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A drow patron @{Cgreen}(@{nCred}E@{nCgreen}, 35, drow-elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A drow sharper sits here, dealing cards\.|A drow sharper is standing here\.|A drow sharper is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellDrowsharper = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A drow sharper @{Cgreen}(@{nCred}E@{nCgreen}, 45, drow-elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A bitter old drow sits here, begging\.|A drow beggar is standing here\.|A drow beggar is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellDrowbeggar = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A drow beggar @{Cgreen}(@{nCred}E@{nCgreen}, 20, drow-elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A blackleg sits here, preparing for another round of poker\.|A human fence is standing here\.|A human fence is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellHumanfence = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A human fence @{Cgreen}(@{nCred}E@{nCgreen}, 60, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A bugbear shaman sleeps here, snorting and grunting\.|A bugbear shaman is standing here\.|A bugbear shaman is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellBugbearshaman = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A bugbear shaman @{Cgreen}(@{nCred}E@{nCgreen}, 57, resist poison/dark/gas)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A drow scout sits here, cursing his luck\.\.|Valas Hune is standing here\.|Valas Hune is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellValashune = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Valas Hune @{Cgreen}(@{nCred}E@{nCgreen}, 80, drow-elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A bugbear grunt snarls at you\.|A bugbear grunt is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellBugbeargrunt = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A bugbear grunt @{Cgreen}(@{nCred}E@{nCgreen}, 55, resist poison/dark/gas)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A young drow stumbles around, obviously intoxicated\.|A raving drunk is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellRavingdrunk = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A raving drunk @{Cgreen}(@{nCred}E@{nCgreen}, 20, drow-elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An attractive dark skinned female catches your attention\.|A drow temptress is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellDrowtemptress = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A drow temptress @{Cgreen}(@{nCred}E@{nCgreen}, 20, drow-elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The bartender greets you with a lopsided grin\.|Vhurn the Bartender is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellVhurn = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Vhurn the Bartender @{Cgreen}(@{nCred}E@{nCgreen}, 100, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A waitress walks around, carrying a few tankards of a local brew\.|A female drow waitress is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellFemaledrowwaitress = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A female drow waitress @{Cgreen}(@{nCred}E@{nCgreen}, 25, drow-elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A sly looking drow sits here, chatting with the sharpers\.|A thimble rigger is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellThimblerigger = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A thimble rigger @{Cgreen}(@{nCred}E@{nCgreen}, 50, drow-elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A tipsy old warrior sits here, telling stories\.|A drunk old veteran is standing here\.|A drunk old veteran is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellDrunkoldveteran = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A drunk old veteran @{Cgreen}(@{nCred}E@{nCgreen}, 65, drow-elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A leather clad half-orc sits here, armwrestling lesser humanoids\.|A half-orc brawler is standing here\.|A half-orc brawler is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellHalforcbrawler = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A half-orc brawler @{Cgreen}(@{nCred}E@{nCgreen}, 70, half-orc)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A hooded drow bard sits here, crooning quietly\.|A drow deep singer is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellDrowdeepsinger = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A drow deep singer @{Cgreen}(@{nCred}E@{nCgreen}, 1-57, no-attack)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An old dirge singer sits here, playing his velnarin\.|Telanis the Dirge Singer is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellTelanis = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Telanis the Dirge Singer @{Cgreen}(@{nCred}E@{nCgreen}, 100, QM)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A placid pack-lizard shuffles around here\.|A subterranean pack-lizard is here)(, fighting [^\.!]+.|)" tfMobsubstShadowdwellSuptpacklizard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A subterranean pack-lizard @{Cgreen}(N, 65, fire/ice/mental)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A hooded humanoid stands here, conferring with his companions\.|A tiefling rogue is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellTieflingrogue = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A tiefling rogue @{Cgreen}(@{nCred}E@{nCgreen}, 55, pure)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A young human priestess sits here, reading a tome\.|Orianne Tougas is standing here\.|Orianne Tougas is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstShadowdwellOriannetougas = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Orianne Tougas @{Cgreen}(@{nCwhite}G@{nCgreen}, 65, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A swaggering swashbuckler stands here, grinning\.( \(invisible\)|) \(hidden\)|Vincent Darkedge( \(invisible\)|) \(hidden\) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellVincentdarkedge = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (imp/invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}Vincent Darkedge @{Cgreen}(@{nCred}E@{nCgreen}, 96-98, drow-elf)@{n}%{invisTxt} (hide)%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A mercenary stands here, conversing with his leader\.( \(invisible\)|) \(hidden\)|Vargel( \(invisible\)|) \(hidden\) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellVargel = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (imp/invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}Vargel @{Cgreen}(@{nCred}E@{nCgreen}, 1-90, drow-elf)@{n}%{invisTxt} (hide)%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A proud paladin stands by the bar, looking imposing in his fieldplate\.|Tavos Evenstar is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstShadowdwellTavosevenstar = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Tavos Evenstar @{Cgreen}(@{nCwhite}G@{nCgreen}, 83, human, resist pierce)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The innkeeper welcomes you to the establishment\.|Symeera is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstShadowdwellSymeera = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Symeera @{Cgreen}(@{nCwhite}G@{nCgreen}, 58-62, no-attack)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A street vendor stands here, selling meat from his stall\.|A street vendor is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellStreetvendor = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A street vendor @{Cgreen}(@{nCred}E@{nCgreen}, 30, drow-elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A drow merchant walks here, peddling his wares\.|A drow merchant is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellDrowmerchant = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A drow merchant @{Cgreen}(@{nCred}E@{nCgreen}, 37, drow-elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An arrogant noblewoman walks here, commanding spiders\.|A noble drow priestess is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellNobledrowpriestess = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A noble drow priestess @{Cgreen}(@{nCred}E@{nCgreen}, 60, drow-elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A drow noble is here, browsing the merchant's wares\.|A drow noble is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellDrownoble = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A drow noble @{Cgreen}(@{nCred}E@{nCgreen}, 40, drow-elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A drow youngster is here, applauding the street performers\.|A drow youngster is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellDrowyoungster = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A drow youngster @{Cgreen}(@{nCred}E@{nCgreen}, 20, drow-elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p98 -F -mregexp -t"(A snobbish youngster is here, applauding the street performers\.|A drow youngster is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellDrowyoungstersnob = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A drow youngster (snob) @{Cgreen}(@{nCred}E@{nCgreen}, 20, drow-elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A large eye watches all your moves\.|The city enforcer eye is standing here\.|The city enforcer eye is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellEnforcereye = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The city enforcer eye @{Cgreen}(@{nCred}E@{nCgreen}, 35, magical)@{n}%{P2}%{PR}%; \
    /endif
/def -p98 -F -mregexp -t"(A drow militia veteran stands here, sharpening his scimitar\.|A drow militia veteran is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellDrowmilitiaveteran = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A drow militia veteran @{Cgreen}(@{nCred}E@{nCgreen}, 80, drow-elf, assist-all)@{n}%{P2}%{PR}%; \
    /endif
/def -p98 -F -mregexp -t"(A fiery high priestess stands here, readying her whip for you\!|A noble high priestess is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellNoblehighpriestess = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A noble high priestess @{Cgreen}(@{nCred}E@{nCgreen}, 1-90, drow-elf?)@{n}%{P2}%{PR}%; \
    /endif
/def -p98 -F -mregexp -t"(A slender drow masseuse is here, taking care of customers\.|A drow masseuse is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellDrowmasseuse = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A drow masseuse @{Cgreen}(@{nCred}E@{nCgreen}, 25, drow-elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p98 -F -mregexp -t"(A beautiful artisan sleeps here, dressed in a small loincloth\.|Jabbress Jhulaye is standing here\.|Jabbress Jhulaye is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellJabbressjhulaye = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Jabbress Jhulaye @{Cgreen}(@{nCred}E@{nCgreen}, 38, drow-elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p98 -F -mregexp -t"(A muscular drow noble rests here, with his favourite masseuse\.|Welverin is standing here\.|Welverin is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellWelverin = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Welverin @{Cgreen}(@{nCred}E@{nCgreen}, 65, drow-elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p98 -F -mregexp -t"(A drow warlock walks here, surrounded by a darkspiral aura\.|A dark pact warlock is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellDarkpactwarlock = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A dark pact warlock @{Cgreen}(@{nCred}E@{nCgreen}, 75, drow-elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p98 -F -mregexp -t"(A drow hunter stands here, preparing for a skirmish\.|A drow phindar hunter is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellDrowphindarhunter = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A drow phindar hunter @{Cgreen}(@{nCred}E@{nCgreen}, 70, drow-elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p98 -F -mregexp -t"(A caravan swordhand stands here, guarding his employer's wares\.|A caravan swordhand is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellCaravanswordhand = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A caravan swordhand @{Cgreen}(@{nCred}E@{nCgreen}, 45, drow-elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A sleezy drow peddler looks for customers\.( \(invisible\)|) \(hidden\)|A drow peddler( \(invisible\)|) \(hidden\) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellDrowpeddler = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (imp/invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}A drow peddler @{Cgreen}(@{nCred}E@{nCgreen}, 40, drow-elf)@{n}%{invisTxt} (hide)%{P4}%{PR}%; \
    /endif
/def -p98 -F -mregexp -t"(A silk merchant from the surface stands here, looking for exotic fabrics\.|A silk trader is here)(, fighting [^\.!]+.|)" tfMobsubstShadowdwellSilktrader = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A silk trader @{Cgreen}(N, 50, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p98 -F -mregexp -t"(Tuabbar the shopkeeper nods at you, as you enter\.|Uluruela Drael Tuabbar is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellTuabbar = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Uluruela Drael Tuabbar @{Cgreen}(@{nCred}E@{nCgreen}, 100, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p98 -F -mregexp -t"(A metalworker in a black chain apron stands here, over a huge anvil\.|Tlar is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellTlar = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Tlar @{Cgreen}(@{nCred}E@{nCgreen}, 100, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p98 -F -mregexp -t"(A watchful imaskari stands here, observing you quietly\.|A deep imaskari is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellDeepimaskari = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A deep imaskari @{Cgreen}(N, 52, ---)@{n}%{P2}%{PR}%; \
    /endif
/def -p98 -F -mregexp -t"(A House agent is here, searching for someone\.( \(invisible\)|)|An agent of House Shobalar( \(invisible\)|) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellAgentofhousesholabar = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (imp/invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}An agent of House Shobalar @{Cgreen}(@{nCred}E@{nCgreen}, 45, drow-elf)@{n}%{invisTxt}%{P4}%{PR}%; \
    /endif
/def -p98 -F -mregexp -t"(A tall female drow trader stands here, speaking with a soft voice\.|Rhauvais del'Ygana is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellRhauvais = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Rhauvais del'Ygana @{Cgreen}(@{nCred}E@{nCgreen}, 100, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p98 -F -mregexp -t"(A darkmoon mercenary sits here\.|A darkmoon rogue is standing here\.|A darkmoon rogue is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellDarkmoonrogue = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A darkmoon rogue 1 @{Cgreen}(@{nCred}E@{nCgreen}, 65, drow-elf, assist-all)@{n}%{P2}%{PR}%; \
    /endif
/def -p98 -F -mregexp -t"(A darkmoon mercenary stands here, conversing with the proprietor\.|A darkmoon rogue is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellDarkmoonrogue2 = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A darkmoon rogue 2 @{Cgreen}(@{nCred}E@{nCgreen}, 65, drow-elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p98 -F -mregexp -t"(A darkmoon mercenary guards the premises\.|A darkmoon rogue is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellDarkmoonrogue3 = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A darkmoon rogue 3 @{Cgreen}(@{nCred}E@{nCgreen}, 1-90, drow-elf?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A darkmoon rogue is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellDarkmoonroguefighting = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A darkmoon rogue @{Cgreen}(@{nCred}E@{nCgreen}, 65?/65?/1-90, drow-elf?)@{n}%{P2}%{PR}%; \
    /endif
/def -p98 -F -mregexp -t"(A drow male stands here, wearing a bloody butcher's apron\.|Herok the Butcher is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellHerok = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Herok the Butcher @{Cgreen}(@{nCred}E@{nCgreen}, 100, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p98 -F -mregexp -t"(A tobacco trader from Myrridon is here, looking for bargains\.|A Myrridon tobacco trader is here)(, fighting [^\.!]+.|)" tfMobsubstShadowdwellMyrridontobaccotrader = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Myrridon tobacco trader @{Cgreen}(N, 50, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An old human adventurer with a weather-beaten face sits here\.|Farren Dashrag is standing here\.|Farren Dashrag is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstShadowdwellFarrendashrag = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Farren Dashrag @{Cgreen}(@{nCwhite}G@{nCgreen}, 78, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p98 -F -mregexp -t"(A calm drow lady stands here, welcoming old and new customers\.|Xalyth is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellXalyth = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Xalyth @{Cgreen}(@{nCred}E@{nCgreen}, 100, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p98 -F -mregexp -t"(A hooded mindflayer stands here, reading the minds of passers-by\.)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellMindflayer = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A mindflayer @{Cgreen}(@{nCred}E@{nCgreen}, 70, magical, resist WEAPON)@{n}%{P2}%{PR}%; \
    /endif
/def -p98 -F -mregexp -t"(A hooded mindflayer communicates telepathically with the mercenaries\.)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellMindflayerhooded = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A mindflayer (hooded) @{Cgreen}(@{nCred}E@{nCgreen}, 54-90, magical, resist WEAPON)@{n}%{P2}%{PR}%; \
    /endif
/def -p98 -F -mregexp -t"(A mindflayer is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellMindflayerfighting = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A mindflayer (hooded) @{Cgreen}(@{nCred}E@{nCgreen}, 54-90, magical, resist WEAPON)@{n}%{P2}%{PR}%; \
    /endif
/def -p98 -F -mregexp -t"(A handsome young darkelf stands here, sorting his wares\.|Daelin Shimmerdark is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellDaelinshimmerdark = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Daelin Shimmerdark @{Cgreen}(@{nCred}E@{nCgreen}, 100, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p98 -F -mregexp -t"(An intoxicated duergar stands here, bantering with the proprietor\.|Fror is here)(, fighting [^\.!]+.|)" tfMobsubstShadowdwellFror = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Fror @{Cgreen}(N, 1-57, dwarf)@{n}%{P2}%{PR}%; \
    /endif
/def -p98 -F -mregexp -t"(A planar walker stands here, ready to astral-jaunt at a moment's notice\.|A human planar walker is here)(, fighting [^\.!]+.|)" tfMobsubstShadowdwellHumanplanarwalker = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A human planar walker @{Cgreen}(N, 60, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p98 -F -mregexp -t"(A cowled magician stands here, centered in mindful awareness\.( \(invisible\)|)|A drow magician( \(invisible\)|) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellDrowmagician = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (imp/invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}A drow magician @{Cgreen}(@{nCred}E@{nCgreen}, 70, drow-elf, assist-all)@{n}%{invisTxt}%{P4}%{PR}%; \
    /endif
/def -p98 -F -mregexp -t"(A wizard adept stands here, overseeing the activities\.( \(invisible\)|)|A wizard adept( \(invisible\)|) is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellWizardadept = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (imp/invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}A wizard adept @{Cgreen}(@{nCred}E@{nCgreen}, 80, drow-elf, assist-all)@{n}%{invisTxt}%{P4}%{PR}%; \
    /endif
/def -p98 -F -mregexp -t"(A cowled drow magician walks here, spellbinding demons\.|A devil tamer is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellDeviltamer = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A devil tamer @{Cgreen}(@{nCred}E@{nCgreen}, 80, drow-elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p98 -F -mregexp -t"(A mounted lizard-rider guardian towers before you\.|A mounted lizard-rider guardian is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellMountedlizardriderguardian = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A mounted lizard-rider guardian @{Cgreen}(@{nCred}E@{nCgreen}, 84, ice)@{n}%{P2}%{PR}%; \
    /endif
/def -p98 -F -mregexp -t"(A drow lizard rider stands here, armed with a spear\.|A drow lizard rider is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellDrowlizardrider = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A drow lizard rider @{Cgreen}(@{nCred}E@{nCgreen}, 60, drow-elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p98 -F -mregexp -t"(A lizard predator darts around, waiting for its master\.|A riding lizard is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellRidinglizard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A riding lizard @{Cgreen}(@{nCred}E@{nCgreen}, 70, ice/mental)@{n}%{P2}%{PR}%; \
    /endif
/def -p98 -F -mregexp -t"(A chained wyvern rests on the triumphal arch before the academy\.|A chained wyvern is standing here\.|A chained wyvern is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellChainedwyvern = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A chained wyvern @{Cgreen}(@{nCred}E@{nCgreen}, 85, dragon)@{n}%{P2}%{PR}%; \
    /endif
/def -p98 -F -mregexp -t"(A defender priestess of the temple stands guard here\.|A talon of the dark mother is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellTalonofthedarkmother = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A talon of the dark mother @{Cgreen}(@{nCred}E@{nCgreen}, 83, drow-elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p98 -F -mregexp -t"(A gigantic spider statue stands here, immovable\.|A huge jade spider is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellHugejadespider = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A huge jade spider @{Cgreen}(@{nCred}E@{nCgreen}, 85, vuln unlife, resist WEAPON/slash/crush/normal)@{n}%{P2}%{PR}%; \
    /endif
/def -p98 -F -mregexp -t"(A mounted lizard-rider guardian patrols here\.|A mounted lizard-rider patrol is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellMountedlizardriderpatrol = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A mounted lizard-rider patrol @{Cgreen}(@{nCred}E@{nCgreen}, 1-90, ???)@{n}%{P2}%{PR}%; \
    /endif
/def -p98 -F -mregexp -t"(A winged hulking fiend stomps around here\.|A malebranche is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellMalebranche = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A malebranche @{Cgreen}(@{nCred}E@{nCgreen}, 85, pure/light/iron)@{n}%{P2}%{PR}%; \
    /endif
/def -p98 -F -mregexp -t"(A winged hulking fiend stomps towards you\.|A malebranche is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellMalebranche2 = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A malebranche 2 @{Cgreen}(@{nCred}E@{nCgreen}, 85, pure/light/iron)@{n}%{P2}%{PR}%; \
    /endif
/def -p98 -F -mregexp -t"(A winged sinewy demon glides over the rooftops\.|A greater nabassu is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellGreaternabassu = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A greater nabassu @{Cgreen}(@{nCred}E@{nCgreen}, 80, demon)@{n}%{P2}%{PR}%; \
    /endif
/def -p98 -F -mregexp -t"(A winged sinewy demon descends to attack\!|A greater nabassu is standing here\.|A greater nabassu is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellGreaternabassu2 = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A greater nabassu 2 @{Cgreen}(@{nCred}E@{nCgreen}, 80, demon)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A shadowy spectral figure stands quietly in the corner\.( \(invisible\)|) \(hidden\)|An invisible stalker( \(invisible\)|) \(hidden\) is here)(, fighting [^\.!]+.|)" tfMobsubstShadowdwellInvisiblestalker = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (imp/invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}An invisible stalker @{Cgreen}(N, 77, energy, resist WEAPON)@{n}%{invisTxt} (hide)%{P4}%{PR}%; \
    /endif
/def -p98 -F -mregexp -t"(A colossal figure with a bison's head stands here, confused\.|A Colossal Goristro is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellColossalgoristro = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Colossal Goristro @{Cgreen}(@{nCred}E@{nCgreen}, 90, demon)@{n}%{P2}%{PR}%; \
    /endif
/def -p98 -F -mregexp -t"(An academy fighter rests here\.|A drow academy swordsman is standing here\.|A drow academy swordsman is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellDrowacademyswordsmanrests = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A drow academy swordsman (rests) @{Cgreen}(@{nCred}E@{nCgreen}, 70, drow-elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p98 -F -mregexp -t"(An academy swordsman stands here, working on his technique\.|A drow academy swordsman is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellDrowacademyswordsman = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A drow academy swordsman @{Cgreen}(@{nCred}E@{nCgreen}, 70, drow-elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p98 -F -mregexp -t"(An academy apprentice passes by, on his way to practice\.|A drow academy apprentice is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellDrowacademyapprentice = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A drow academy apprentice @{Cgreen}(@{nCred}E@{nCgreen}, 68, drow-elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p98 -F -mregexp -t"(An academy officer stands here\.|A drow academy officer is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellDrowacademyofficer = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A drow academy officer @{Cgreen}(@{nCred}E@{nCgreen}, 83, drow-elf, assist-all)@{n}%{P2}%{PR}%; \
    /endif
/def -p98 -F -mregexp -t"(The academy weaponsmaster stands here, conferring with the advisors\.|Gilzent Vanlier is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellGilzentvanlier = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Gilzent Vanlier @{Cgreen}(@{nCred}E@{nCgreen}, 87, drow-elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p98 -F -mregexp -t"(A composed drow captain stands here, administrating\.|Gilzent Vanlier is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellCommanderildan = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Commander Ildan @{Cgreen}(@{nCred}E@{nCgreen}, 87, drow-elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p98 -F -mregexp -t"(A drow abjurer hovers here, surrounded by defensive energies\.|The dweomer defender is standing here\.|The dweomer defender is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellDweomerdefender = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The dweomer defender @{Cgreen}(@{nCred}E@{nCgreen}, 72, drow-elf, resist WEAPON, mana shielded?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A cowled humanoid stands here, clutching a black longbow\.( \(invisible\)|) \(hidden\)|The arcane archer( \(invisible\)|) \(hidden\) is here)(, fighting [^\.!]+.|)" tfMobsubstShadowdwellArcanearcher = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (imp/invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}The arcane archer @{Cgreen}(N, 76, ???)@{n}%{invisTxt} (hide)%{P4}%{PR}%; \
    /endif
/def -p98 -F -mregexp -t"(The warlord of Shadowdwell sits here, brooding over politics and betrayal\.|Reylen Dar is standing here\.|Reylen Dar is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellReylendar = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Reylen Dar @{Cgreen}(@{nCred}E@{nCgreen}, 99, drow-elf?)@{n}%{P2}%{PR}%; \
    /endif
/def -p98 -F -mregexp -t"(A malicious looking drow stands here, holding a fanged whip\.|Kaar Bloodlash the torturer is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstShadowdwellKaarbloodlash = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Kaar Bloodlash the torturer @{Cgreen}(@{nCred}E@{nCgreen}, 82, drow-elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A sickly elf lady hugs the iron bars, praying to her gods\.|A sickly elf lady is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstShadowdwellSicklyelflady = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A sickly elf lady @{Cgreen}(@{nCwhite}G@{nCgreen}, 20, elf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A skinny human prisoner sits against the wall\.|A captured surface traveller is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstShadowdwellCapturedsurfacetraveller = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A captured surface traveller @{Cgreen}(@{nCwhite}G@{nCgreen}, 20, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A frail and beaten man sits here, half conscious\.|A myrridon captive is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstShadowdwellMyrridoncaptive = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A myrridon captive @{Cgreen}(@{nCwhite}G@{nCgreen}, 20, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A planetouched creature walks here, hooded and cloaked\.( \(invisible\)|) \(hidden\)|A cloaked gloaming( \(invisible\)|) \(hidden\) is here)(, fighting [^\.!]+.|)" tfMobsubstShadowdwellCLoakedGloaming = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (imp/invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}A cloaked gloaming @{Cgreen}(, 73-77, ???)@{n}%{invisTxt} (hide)%{P4}%{PR}%; \
    /endif

; -----------------------  Snake Lair  -----------------------
/def -p99 -F -mregexp -t"A huge constrictor is eyeing you lazily." tfMobsubstSnakelairBoa = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Venerable Boa Constrictor @{Cgreen}(lvl 90, snake, peaceful)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"A huge constrictor slithers away from you." tfMobsubstSnakelairPython = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Venerable Python @{Cgreen}(lvl 90, snake, peaceful)@{n}%{PR}%; \
    /endif

; -----------------------  Stonewell  -----------------------
/def -p99 -F -mregexp -t"(A beggar is here with outstretched palms\.|A beggar is here)(, fighting [^\.!]+.|)" tfMobsubstStonewellBeggar = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A beggar @{Cgreen}(N, 4, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A kid frolics around here\.|A kid is here)(, fighting [^\.!]+.|)" tfMobsubstStonewellKid = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A kid @{Cgreen}(N, 5, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An alleycat rummages through some trash here\.|An alleycat is here)(, fighting [^\.!]+.|)" tfMobsubstStonewellAlleycat = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An alleycat @{Cgreen}(N, 5, feline, agg-sleeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A barking dog loiters around here\.|A stray dog is here)(, fighting [^\.!]+.|)" tfMobsubstStonewellStrayDog = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A stray dog @{Cgreen}(N, 7, canine)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A pet creature has escaped and is running amok here\.|A pet creature is here)(, fighting [^\.!]+.|)" tfMobsubstStonewellPetCreature = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A pet creature @{Cgreen}(N, 8, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p100 -F -mregexp -t"(A janitor is walking around, cleaning up\.|The Janitor is here)(, fighting [^\.!]+.|)" tfMobsubstStonewellTheJanitor = \
    /if (mobsubs & area !~ 'Karandras') \
      /substitute -p %{PL}@{nCyellow}The Janitor @{Cgreen}(N, 8, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A young girl runs around with a net trying to catch butterflies|A butterfly collecter is here)(, fighting [^\.!]+.|)" tfMobsubstStonewellButterflyCollector = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A butterfly collecter @{Cgreen}(N, 9, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A female citizen of Stonewell passes by you\.|A citizen of Stonewell is here)(, fighting [^\.!]+.|)" tfMobsubstStonewellCitizenOfStonewellFemale = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A citizen of Stonewell (female) @{Cgreen}(N, 9, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A citizen of Stonewell passes by you\.|A citizen of Stonewell is here)(, fighting [^\.!]+.|)" tfMobsubstStonewellCitizenOfStonewellMale = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A citizen of Stonewell (male) @{Cgreen}(N, 11, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A footpad stalks the city streets looking for an easy victim\.|The footpad is here)(, fighting [^\.!]+.|)" tfMobsubstStonewellFootpad = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The footpad @{Cgreen}(N, 12, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A huge sewer rat has emerged from the drains and scurries around here\.|A HUGE sewer rat is here)(, fighting [^\.!]+.|)" tfMobsubstStonewellHugeSewerRat = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A HUGE sewer rat @{Cgreen}(N, 12, rodent)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A visitor to Stonewell is here exploring the city\.|A visitor to Stonewell is here)(, fighting [^\.!]+.|)" tfMobsubstStonewellVisitorToStonewell = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A visitor to Stonewell @{Cgreen}(N, 15, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A singing, happy drunk staggers about\.|The happy drunk is here)(, fighting [^\.!]+.|)" tfMobsubstStonewellHappyDrunk = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The happy drunk @{Cgreen}(N, 16, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A smoking man is here enjoying his pipe\.|A smoking man is here)(, fighting [^\.!]+.|)" tfMobsubstStonewellSmokingMan = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A smoking man @{Cgreen}(N, 17, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A citizen of the western shores of the continent stands here\.|A westerner is here)(, fighting [^\.!]+.|)" tfMobsubstStonewellWesterner = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A westerner @{Cgreen}(N, 19, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A thief hides in the shadows searching for another unwitting victim\. \(hidden\)|A casual thief \(hidden\) is here)(, fighting [^\.!]+.|)" tfMobsubstStonewellCasualThief = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A casual thief @{Cgreen}(N, 20, human, thief)@{n} (hide)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A shoe shiner is here looking for business\.|A shoe shiner is here)(, fighting [^\.!]+.|)" tfMobsubstStonewellShoeShiner = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A shoe shiner @{Cgreen}(N, 22, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A street entertainer is here performing one of her acts|A street entertainer is here)(, fighting [^\.!]+.|)" tfMobsubstStonewellStreetEntertainer = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A street entertainer @{Cgreen}(N, 24, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A hooded magician quietly moves past you\.|A hooded magician is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstStonewellHoodedMagician = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A hooded magician @{Cgreen}(@{nCred}E@{nCgreen}, 26, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An elderly citizen shuffles around here\.|An elderly citizen is here)(, fighting [^\.!]+.|)" tfMobsubstStonewellElderlyCitizen = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An elderly citizen @{Cgreen}(N, 28, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A buxom beauty is here serving drinks\.|The pub wench is here)(, fighting [^\.!]+.|)" tfMobsubstStonewellPubWench = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The pub wench @{Cgreen}(N, 30, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An off-duty cityguard stumbles around after a heavy drinking session\.|A drunken cityguard is here)(, fighting [^\.!]+.|)" tfMobsubstStonewellDrunkenCityguard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A drunken cityguard @{Cgreen}(N, 38, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A patron of this establishment takes a swig of his drink\.|A drinker is here)(, fighting [^\.!]+.|)" tfMobsubstStonewellDrinker = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A drinker @{Cgreen}(N, 40, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A sailor on shore leave in Stonewell is stood here\.|A sailor on shore leave is here)(, fighting [^\.!]+.|)" tfMobsubstStonewellSailorOnShoreLeave = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A sailor on shore leave @{Cgreen}(N, 41, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A jolly drunken sailor is rolling around on the floor here\.|A drunken sailor is here)(, fighting [^\.!]+.|)" tfMobsubstStonewellDrunkenSailor = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A drunken sailor @{Cgreen}(N, 45, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Member of the City Guard stands rigidly at attention here\.|A city sentry is here)(, fighting [^\.!]+.|)" tfMobsubstStonewellCityCentry = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A city sentry @{Cgreen}(N, 48, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A female City Guard patrols the area\.|A city guard is here)(, fighting [^\.!]+.|)" tfMobsubstStonewellCityGuardFemale = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A city guard (female) @{Cgreen}(N, 51, human, protector)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Member of the City Guard warns you to stay out of trouble\.|A city guard is here)(, fighting [^\.!]+.|)" tfMobsubstStonewellCityGuardWarns = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A city guard (warns) @{Cgreen}(N, 53, human, protector)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A retired pirate hops around here on his peg-leg\.|A retired pirate is here)(, fighting [^\.!]+.|)" tfMobsubstStonewellRetiredPirate = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A retired pirate @{Cgreen}(N, 55, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Hill Giant has wandered down from the Celestial Peaks\.|A hill giant is here)(, fighting [^\.!]+.|)" tfMobsubstStonewellHillGiant = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A hill giant @{Cgreen}(N, 62, giant)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A stoic defender of the city is here\.|A Stonewell defender is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstStonewellStonewellDefender = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Stonewell defender @{Cgreen}(@{nCwhite}G@{nCgreen}, 70, human, assist-all)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Commander of the Stonewell Fortress watches observes proceedings\.|The Fortress Commander is here)(, fighting [^\.!]+.|)" tfMobsubstStonewellFortressCommander = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Fortress Commander @{Cgreen}(N, 72, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Heavy robes drape from the body of a spire sage\.|A spire sage is here)(, fighting [^\.!]+.|)" tfMobsubstStonewellSpireSage = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A spire sage @{Cgreen}(N, 80, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Argal the Headsman stands here eyeing you cautiously\.|Argal the Headsman is here)(, fighting [^\.!]+.|)" tfMobsubstStonewellArgalTheHeadsman = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Argal the Headsman @{Cgreen}(N, 81, human, murder)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A religious fanatic is here trying to channel the word of his deity\.|A religious fanatic is here)(, fighting [^\.!]+.|)" tfMobsubstStonewellReligiousFanatic = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A religious fanatic @{Cgreen}(N, 81, goblin, mana-shielded)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A devout worshiper solemnly prays here\.|A devout worshiper is here)(, fighting [^\.!]+.|)" tfMobsubstStonewellDevoutWorshiper = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A devout worshiper @{Cgreen}(N, 82, fairie)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A mean-looking orc wanders the city looking for a job\.|An orc mercenary is here)(, fighting [^\.!]+.|)" tfMobsubstStonewellOrcMercenary = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An orc mercenary @{Cgreen}(N, 82, orc)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A human mercenary is here looking for business\. \(hidden\)|A human mercenary \(hidden\) is here)(, fighting [^\.!]+.|)" tfMobsubstStonewellHumanMercenary = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A human mercenary @{Cgreen}(N, 83, human)@{n} (hide)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A druid has travelled from afar to be here\.|A humble druid is here)(, fighting [^\.!]+.|)" tfMobsubstStonewellHumbleDruid = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A humble druid @{Cgreen}(N, 83, lizardman)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An ogrish man dressed in leather wearing a belt of keys stands here\.|The Stonewell Jailor is here)(, fighting [^\.!]+.|)" tfMobsubstStonewellJailor = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Stonewell Jailor @{Cgreen}(N, 83, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Dwarven Mercenary scowls menacingly at you\.|A dwarven mercenary is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstStonewellDwarvenMercenary = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A dwarven mercenary @{Cgreen}(@{nCred}E@{nCgreen}, 84, dwarf)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A rabid monk accosts you as you arrive\.|A rabid monk is here)(, fighting [^\.!]+.|)" tfMobsubstStonewellRabidMonk = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A rabid monk @{Cgreen}(N, 84, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Castellan of Stonewell politely welcomes you to the city\.|The Castellan of Stonewell is here)(, fighting [^\.!]+.|)" tfMobsubstStonewellCastellan = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Castellan of Stonewell @{Cgreen}(N, 83, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A powerful magician stands here channeling his power through the spire\. \(invisible\)|A Castellan magus \(invisible\) is here)(, fighting [^\.!]+.|)" tfMobsubstStonewellCastellanMagus = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Castellan magus @{Cgreen}(N, 90, magical)@{n} (imp)%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Betty the baker stands here selling her freshly-baked goods\.|Betty the Baker is here)(, fighting [^\.!]+.|)" tfMobsubstStonewellBettyBaker = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Betty the Baker @{Cgreen}(N, 99, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The landlord is here serving drinks\.|The landlord is here)(, fighting [^\.!]+.|)" tfMobsubstStonewellLandlord = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The landlord @{Cgreen}(N, 99, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Swordsmith of Stonewell stands here selling his wares\.|The Swordsmith is here)(, fighting [^\.!]+.|)" tfMobsubstStonewellTheSwordsmith = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Swordsmith @{Cgreen}(N, 99, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An odd man is here doing odd things!|An odd man is here)(, fighting [^\.!]+.|)" tfMobsubstStonewellOddMan = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An odd man @{Cgreen}(N, 50, human)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The city jester stands here with a puzzled expression, he needs help\.|Johan the jester is here)(, fighting [^\.!]+.|)" tfMobsubstStonewellJohanTheJester = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Johan the jester @{Cgreen}(N, 99, QM)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An elderly lady welcomes you to the general store of Stonewell\.|The shop assistant is here)(, fighting [^\.!]+.|)" tfMobsubstStonewellTheShopAssistant = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The shop assistant @{Cgreen}(N, 99, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The postmaster of Stonewell is here sorting through the mail\.|The Postmaster General is here)(, fighting [^\.!]+.|)" tfMobsubstStonewellThePostmasterGeneral = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Postmaster General @{Cgreen}(N, 100, nofight-room)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The auctioneer stands behind a dais calling out bids\.|The Auction Clerk is here)(, fighting [^\.!]+.|)" tfMobsubstStonewellTheAuctionClerk = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Auction Clerk @{Cgreen}(N, 100, nofight-room)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Items Registrar of the Rising Sun Inn stands here at the counter\.|The Items Registrar is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstStonewellTheItemsRegistrar = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Items Registrar @{Cgreen}(@{nCwhite}G@{nCgreen}, 100, nofight-room)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The receptionist stands behind the counter, waiting to check in new guests\.|The Receptionist is here)(, fighting [^\.!]+.|)" tfMobsubstStonewellTheReceptionist = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Receptionist @{Cgreen}(N, 100, nofight-room)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Spellbinder stands behind the counter concocting potions\.|The Spellbinder is here)(, fighting [^\.!]+.|)" tfMobsubstStonewellTheSpellbinder = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Spellbinder @{Cgreen}(N, 99, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A man appears from behind the counter to help you pick your armour\.|The Armourer is here)(, fighting [^\.!]+.|)" tfMobsubstStonewellTheArmourer = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Armourer @{Cgreen}(N, 99, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A fat greasy man stands here shovelling chips into a fryer\.|Greasy Bob is here)(, fighting [^\.!]+.|)" tfMobsubstStonewellGreasyBob = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Greasy Bob @{Cgreen}(N, 99, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The cartographer of the city sits here drawing a map\.|The cartographer of Stonewell is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstStonewellCartographerOfStonewell = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The cartographer of Stonewell @{Cgreen}(@{nCwhite}G@{nCgreen}, 99, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The local guildmaster stands here training adventurers\.|The Guildmaster is here)(, fighting [^\.!]+.|)" tfMobsubstStonewellTheGuildmaster = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Guildmaster @{Cgreen}(N, 99, no-attack)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The scarred boss of Mercenaries Unlimited stands here\. \(hidden\)|Mob Boss \(hidden\) is here)(, fighting [^\.!]+.|)" tfMobsubstStonewellMobBoss = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Mob Boss @{Cgreen}(N, 120, human, murder)@{n} (hide)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A wise man with long grey hair welcomes you to his residence\.|Mitzak the Sage is here)(, fighting [^\.!]+.|)" tfMobsubstStonewellMitzakTheSage = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Mitzak the Sage @{Cgreen}(N, 100, nofight-room)@{n}%{P2}%{PR}%; \
    /endif

; -----------------------  Underworld  -----------------------
/def -p99 -F -mregexp -t"(A brave soldier stands here having been rewarded by the gods\.|A brave soldier is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstUnderworldBraveSoldier = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A brave soldier @{Cgreen}(@{hCwhite}G@{nCgreen}, 80, dark/pure)@{n}%{P2}%{PR}%; \
    /endif%; \
    attackIfLeaderEtc soldier none
/def -p99 -F -mregexp -t"(A famed and glorious soldier stands here\.)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstUnderworldSoldierValiantHeroic = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A heroic/valiant soldier @{Cgreen}(@{hCwhite}G@{nCgreen}, 80/90, dark/pure)@{n}%{P2}%{PR}%; \
    /endif%; \
    attackIfLeaderEtc soldier none
/def -p99 -F -mregexp -t"(A valiant soldier is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstUnderworldSoldierValiant = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A valiant soldier @{Cgreen}(@{hCwhite}G@{nCgreen}, 90, dark/pure)@{n}%{P2}%{PR}%; \
    /endif%; \
    attackIfLeaderEtc soldier none
/def -p99 -F -mregexp -t"(A heroic soldier is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstUnderworldSoldierHeroic = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A heroic soldier @{Cgreen}(@{hCwhite}G@{nCgreen}, 80, dark/pure)@{n}%{P2}%{PR}%; \
    /endif%; \
    attackIfLeaderEtc soldier none
/def -p99 -F -mregexp -t"(A member of the Trojan Royal House stands here\.|A member of the Trojan Royal House is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstUnderworldMember = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A member of the Trojan Royal House @{Cgreen}(@{hCwhite}G@{nCgreen}, 80, dark/unlife)@{n}%{P2}%{PR}%; \
    /endif%; \
    attackIfLeaderEtc member none
/def -p99 -F -mregexp -t"The musical son of Orpheus stands here." tfMobsubstUnderworldMusaeus = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Musaeus of Athens @{Cgreen}(lvl 85, dark/unlife)@{n}%{PR}%; \
    /endif%; \
    attackIfLeaderEtc musaeus none
/def -p99 -F -mregexp -t"(The bulwark of the Achaeans towers over you\.|Ajax the Greater is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstUnderworldAjax = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Ajax the Greater @{Cgreen}(@{hCwhite}G@{nCgreen}, 85, dark/unlife)@{n}%{P2}%{PR}%; \
    /endif%; \
    attackIfLeaderEtc ajax none
/def -p99 -F -mregexp -t"(The captain of the Argos stands here\.|Jason the Argonaut is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstUnderworldJason = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Jason the Argonaut @{Cgreen}(@{hCwhite}G@{nCgreen}, 85, dark/pure)@{n}%{P2}%{PR}%; \
    /endif%; \
    attackIfLeaderEtc mythical none
/def -p99 -F -mregexp -t"(A great hero and nearly invicible warrior looms here\.|Achilles the Swift Footed is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstUnderworldAchilles = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Achilles the Swift Footed @{Cgreen}(@{hCwhite}G@{nCgreen}, 85, dark/pure)@{n}%{P2}%{PR}%; \
    /endif%; \
    attackIfLeaderEtc mythical none
/def -p99 -F -mregexp -t"(A legendary slayer of monsters glories here\.|Perseus the Legendary is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstUnderworldPerseus = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Perseus the Legendary @{Cgreen}(@{hCwhite}G@{nCgreen}, 85, dark/pure)@{n}%{P2}%{PR}%; \
    /endif%; \
    attackIfLeaderEtc mythical none
/def -p99 -F -mregexp -t"(A mythical man of ancient Greece stands here\.)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstUnderworldTheseusAgamemnon = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Theseus/Agamemnon @{Cgreen}(@{hCwhite}G@{nCgreen}, 85, dark/pure)@{n}%{P2}%{PR}%; \
    /endif%; \
    attackIfLeaderEtc mythical none
/def -p99 -F -mregexp -t"(Theseus the Founder is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstUnderworldTheseus = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Theseus the Founder @{Cgreen}(@{hCwhite}G@{nCgreen}, 85, dark/pure)@{n}%{P2}%{PR}%; \
    /endif%; \
    attackIfLeaderEtc mythical none
/def -p99 -F -mregexp -t"(Agamemnon the Steadfast is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstUnderworldAgamemnon = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Agamemnon the Steadfast @{Cgreen}(@{hCwhite}G@{nCgreen}, 85, dark/pure)@{n}%{P2}%{PR}%; \
    /endif%; \
    attackIfLeaderEtc mythical none
/def -p99 -F -mregexp -t"(A minstrel of the argonauts stands here\.|Orpheus the Charmer is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstUnderworldOrpheus = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Orpheus the Charmer @{Cgreen}(@{hCwhite}G@{nCgreen}, 85, dark/pure)@{n}%{P2}%{PR}%; \
    /endif%; \
    attackIfLeaderEtc orpheus none
/def -p99 -F -mregexp -t"Charon is standing here, ready to usher you into the next world." tfMobsubstUnderworldCharon = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Charon @{Cgreen}(lvl 1, no-attack)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"A lost soul of a poor child wanders around." tfMobsubstUnderworldSoulOfChild = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A soul of a young boy/girl @{Cgreen}(lvl 20, human)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"A lost soul of a poor woman wanders around." tfMobsubstUnderworldSoulOfWoman = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A soul of a woman @{Cgreen}(lvl 25, human)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"A lost soul of a poor man wanders around." tfMobsubstUnderworldSoulOfMan = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A soul of a man @{Cgreen}(lvl 27, human)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Man of Final Judgement stands here\.|King Minos is standing here\.|King Minos is here)(, fighting [^\.!]+.|)" tfMobsubstUnderworldKingMinos = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}King Minos @{Cgreen}(N, 90, ktv)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"The Judge of Europeans stand here." tfMobsubstUnderworldKingAeacus = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}King Aeacus @{Cgreen}(N, 60, ktv)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"The Judge of Asians stands here." tfMobsubstUnderworldRhadamanthys = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Rhadamanthys @{Cgreen}(N, 60, ktv)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A god that has left this realm in the eyes of retirement stands here\.|Arcane the defiler is here)(, fighting [^\.!]+.|)" tfMobsubstUnderworldArcane = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Arcane the defiler @{Cgreen}(N, 100, no-attack)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An ingenious tactician schemes here\.|Odysseus the Cunning is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstUnderworldOdysseus = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Odysseus the Cunning @{Cgreen}(@{hCwhite}G@{nCgreen}, 100, mythical/dark)@{n}%{P2}%{PR}%; \
    /endif
/set robeChecked 0
/def -p99 -F -mregexp -t"(A demon guards the lands carefully\.|Tisiphone is here)" tfMobsubstUnderworldTisiphone = \
    /if (!robeChecked) \
      exa tisiphone%; \
      /set robeChecked 1%; \
    /endif%; \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Tisiphone @{Cgreen}(lvl 90, demon, unlife)@{n}%{PR}%; \
    /endif

/def -p99 -F -msimple -t"A soldier is dead! R.I.P." tfMobsubstUnderworldRIPSoldier = \
    /if (groupleader =~ name & initiator =~ 'none' & autoattack) \
      k soldier%; \
      k member%; \
    /endif
/def -p99 -F -msimple -t"A member of the Trojan Royal House is dead! R.I.P." tfMobsubstUnderworldRIPMember = \
    /if (groupleader =~ name & initiator =~ 'none' & autoattack) \
      k soldier%; \
      k member%; \
    /endif


;Mulciber                   1       N--                                    nofight-room
;The Left Hades            50             2   GNE                          vuln fire, immune ice/blindness(dark?), invis, triad of fire, 2-2 spells, shrugger
;The Right Hades           50             2   GNE                          vuln ice, immune fire/blindness(dark?), invis, triad of fire, 2-2 spells, shrugger
;A soul                    60  150M N-xxx-    -   6099-6174       1-1      vuln light, ignore-cop
;Sysiphous                 60   63M N--xx-    --- 4554-4561     101-101    [human], flees
;Campe                  62-65   98M Nx-x -    --E 6877-6970   50048-50079  vuln light, resist fire/ice/unlife/earth/air
;A Demonic Guard of Evil   75  394M E--x      G  15290-15398      1-1      vuln silver/stun, immune pure/light/iron/fire, resist unlife/dark/poison, bash, kick, headbang, berserk, hide, flying before being in battle - standing after
;The Angelic Guard of Hades (female)
;                          75  394M Gx-x      G  15216-15374      1-1      vuln unlife, resist magic/energy, flying before being in battle - standing after, bash, kick, headbang, berserk
;The Angelic Guard of Hades (male)
;                          75  394M Gx-x      G  15188-15338      1-1      vuln unlife, resist magic/energy, flying before being in battle - standing after, bash, kick, headbang, berserk
;Briareus                  80  560M N--x -    -  17273-17501  52855-53270  vuln pure/light/iron, immune fire, resist dark/unlife/poison
;Cottus                    80  560M N--x -    -  17277-17351  53011-53117  vuln pure/light/iron, immune fire, resist dark/unlife/poison
;Cronos                    80  704M N-xxx-    -  18158-18270 120185-120435 [human], bash, kick, headbang, berserk, ignore-cop
;Cyclopse                  80  560M N--x -    -  22862-22952  51221-51307  vuln unlife/energy/iron/ice
;Ephialtes                 80  608M E-xxx-    -  16284-16452      1-1      [human], bash, kick, headbang, berserk, ignore-cop
;Eurynomus                 80       E--x      GNE                 1        vuln pure/light/iron, immune fire, resist dark/unlife?/poison?, divides into entity of life + void of death when killed. They, in turn, divide into 2 shatters each when killed. When first shatter dies, Eurynomus returns
;Eurynomus (returning)    85+                                              immune fire, 10-10 attacks (pulverize), corpseless
;A light entity of life    80                                              summoned, sun arrow, 0-1 spells, divides into shatter of life + shatter of light when killed.
;A dark void of death      80                                              summoned, area vampiric mist, 1-5 spells, 8-9 attacks (vaporize) divides into shatter of darkness + shatter of death when killed.
;A shatter of life         80                                              summoned, burst of life, 7-7 attacks (anni/vapo)
;A shatter of light        80                                              summoned, sun arrow, 7-7 attacks (anni/vapo)
;A shatter of darkness     80                                              summoned, blindness
;A shatter of death        80                                              summoned, soulsteal
;Gyes                      80  560M N--x -    -  17273-17274  53022-53447  vuln pure/light/iron, immune fire, resist dark/unlife/poison
;Ixion                     80  608M E-xxx-    -  16268-16288      1-1      [human], backstab, ignore-cop, takes 7.5-second rests every 10-60 second
;Mnemosyne                 80  608M N-xxx-    -  17355-17383  40056-40057  [human], resist pure, sitting, powerword pain, meteor blast, mass pain
;Oceanus                   80  608M N-xxx-    ---16137-16302  60197-60355  [human], bash, kick, headbang, berserk, ignore-cop
;Otus                      80  608M E-xxx-    -  16293-16321      1-1      [human], bash, kick, headbang, berserk, ignore-cop
;Rhea                      80  608M N-xxx-    -  16292-16303 600234-600352 [human], bash, kick, headbang, ignore-cop
;Salmoneus                 80  608M E-xxx-    -  16209-16429      1-1      [human], backstab, ignore-cop, takes 7.5-second rests every 10-60 second
;Tantalus                  80  608M N--xx-    ---16272-16285    101-101    [human], walk-path (4s6w6n6e3s, every 75-150s)
;The Statue of Odysseus    80  583M Nx-x x    -  19392-19426      1-1      vuln dark/unlife, resist mental, bash, kick, headbang, berserk
;Themis                    80       N-xxx-    -                            [human], resist pure, sitting, powerheal, powerword pain, mass pain, wither, meteor blast, harm, confusion, blindness, ignore-cop
;Tityus                    80  608M E-xxx-    -  16305-16399      1-1      [human], backstab (400), ignore-cop, takes 7.5-second rests every 10-60 second
;Alecto                    85       G-xxx-    -                            [human], immune fire, resist dark/unlife, berserk
;Megaera                   85       G-xxx-    -               60224        INFO, vuln pure/light/iron, immune fire, resist dark/unlife/poison, bash, kick, berserk
;A blessed guard           90       Gx-xxx    -                            [human], vuln dark, resist light, kick, revenger
;A soldier (famed, 2)      90       G--x -    ---                          vuln dark/pure?, headbang, bash
;Cerberus               93-95       E--x  2   GNE                 1-1      INFO, vuln mental, resist dark, headrip(?)-special, noflee-room
;Erebus                   41+        x-   3   ---            225988-230074 INFO, unlife or dark damage, ultra-hide, noflee-room, area blindness, harm, wither, powerheal, he is not evil
;Hades                    98+        [mythical?]
;Nyx                      100       [mythical]

; -----------------------  Underdark  -----------------------


; -----------------------  Well  -----------------------
/def -p99 -F -mregexp -t"A faintly visible, almost transparent mist floats through the air." tfMobsubstWellEssaenceMyst = \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite} 1 --- @{nCyellow}Myst @{Cwhite}(NO MAGIC)@{n}%{PR}%; \
    /else \
      tfnextlineshow 1 The Essaence Myst (1+): No-agg, NO MAGIC%; \
    /endif%; \
    /if ({PL} =~ "") \
      /if (area !~ "Well") \
        2 drop setareaWell%; \
      /endif%; \
      setarea Well The Well%; \
      /set nomagic 1%; \
    /endif

/def -p99 -F -mregexp -t"(A large, red toad covered in purple warts leaps at you!|The fire toad is here)" tfMobsubstWellFireToad = \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}50 @{Cred}AGG @{nCyellow}Fire toad @{Cwhite}(ice)@{n}%{PR}%; \
    /else \
      tfnextlineshow 50 Fire toad (5-9): Agg, d-i, Vuln ice, aware%; \
    /endif

/def -p99 -F -mregexp -t"(A large toad with grayish skin mottled with blue sits here|The ice toad is here)" tfMobsubstWellIceToad = \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}55 @{Cred}AGG @{nCyellow}Ice toad @{Cwhite}(fire)@{n}%{PR}%; \
    /else \
      tfnextlineshow 55 Ice toad (6-10): Agg, d-i, Vuln fire%; \
    /endif

/def -p99 -F -mregexp -t"(A serpent rises out of the water, grasping at you!|The water weird is here)" tfMobsubstWellWaterWeird = \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}55 @{Cred}AGG @{nCyellow}Water Weird @{Cwhite}(remove poison)@{n}%{PR}%; \
    /else \
      tfnextlineshow 55 Water Weird (9-17): Agg, d-i, cast rp to kill.%; \
    /endif%; \
    /if (!pg) \
      tfnextlineshow Trying rp-scroll!%;recite canduswazz weird%; \
    /elseif (classPr | classNb | classTe | classAn) \
      /tfshow Trying rp!%;retreat%;rp weird%; \
    /endif

/def -p99 -F -mregexp -t"You sense a hidden life form in the room." tfMobsubstWellSlitheringTracker = \
    /if (area =~ "Well") \
      /if (mobsubs) \
        /substitute -p %{PL}@{Cwhite}56 --- @{nCyellow}Slithering Tracker @{Cwhite}(UltraHidden, Resist WEAPON)@{n}%{PR}%; \
      /else \
        tfnextlineshow 56 Slithering Tracker (4-10): UltraHidden, Resist WEAPON%; \
      /endif%; \
    /endif

/def -p99 -F -mregexp -t"(Something floats in the water here\. \(invisible\) \(hidden\)|The crystal ooze \(invisible\) \(hidden\) is here)(, fighting [^\.!]+.|)" tfMobsubstWellCrystalOoze = \
    /if (pg & groupleader !~ name & autoassist & !fighting) \
      assist%; \
    /endif%; \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}40 @{Cred}AGG @{nCyellow}Crystal Ooze @{Cwhite}(resist WEAPON/crush)@{n} (invisible) (hide)%{P2}%{PR}%; \
    /else \
      tfnextlineshow 40 Crystal Ooze (1-6): Agg, d-i, resist WEAPON/crush, aware%; \
    /endif

/def -p99 -F -mregexp -t"(A large, round creature with thin stalks protruding from its body|The gas spore is here)" tfMobsubstWellGasSpore = \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}40 @{Cred}agg @{nCyellow}Gas Spore @{Cwhite}(acid, belch-spores:true)@{n}%{PR}%; \
    /else \
      tfnextlineshow 40 Gas Spore (1-5): Agg, no d-i, Vuln acid, aware, belch-spores (true)%; \
    /endif

/def -p99 -F -mregexp -t"(The sand here shifts slightly\. \(invisible\) \(hidden\)|The sandling \(invisible\) \(hidden\) is here)" tfMobsubstWellSandling = \
    /if (pg & groupleader !~ name & autoassist & !fighting) \
      assist%; \
    /endif%; \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}40 @{Cred}AGG @{nCyellow}Sandling @{Cwhite}(unlife)@{n} (invisible) (hide)%{PR}%; \
    /else \
      tfnextlineshow 40 Sandling (1-19): Agg, d-i, Vuln unlife, aware%; \
    /endif

/def -p99 -F -mregexp -t"(A small, reptile-like bird is here gawking at you|The strider is here)" tfMobsubstWellStrider = \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}40 @{Cred}AGG @{nCyellow}Strider @{Cwhite}(air)@{n}%{PR}%; \
    /else \
      tfnextlineshow 40 Strider (1-4): Agg, d-i, Vuln air, aware%; \
    /endif

/def -p99 -F -mregexp -t"(A shaggy ape-like humanoid is resting here|The taer is here)" tfMobsubstWellTaer = \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}40 @{Cred}agg @{nCyellow}Taer @{Cwhite}(---)@{n}%{PR}%; \
    /else \
      tfnextlineshow 40 Taer (1-3): Agg, no d-i, no known vulns, aware%; \
    /endif

/def -p99 -F -mregexp -t"(A large, round ball of fungus rolls around here|The ascomoid is here)" tfMobsubstWellAscomoid = \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}41 @{Cred}agg @{nCyellow}Ascomoid @{Cwhite}(pierce/acid, immune crush)@{n}%{PR}%; \
    /else \
      tfnextlineshow 41 Ascomoid (1-5): Agg, no d-i, Vuln pierce/acid, Immune crush, aware%; \
    /endif

/def -p99 -F -mregexp -t"(A large violet-streaked mushroom grows here|The violet fungus is here)" tfMobsubstWellVioletFungus = \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}42 @{Cred}agg @{nCyellow}Violet Fungus @{Cwhite}(acid, fungal disease:true)@{n}%{PR}%; \
    /else \
      tfnextlineshow 42 Violet Fungus (1-5): Agg, no d-i, Vuln acid, aware, Fungal Disease (true)%; \
    /endif

/def -p99 -F -mregexp -t"(A flat, wet stone lies across the middle of the cavern\. \(hidden\)|The grey ooze \(hidden\) is here)" tfMobsubstWellGreyOoze = \
    /if (pg & groupleader !~ name & autoassist & !fighting) \
      assist%; \
    /endif%; \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}43 @{Cred}agg @{nCyellow}Grey Ooze @{Cwhite}(resist WEAPON, VAPE boots!)@{n} (hide)%{PR}%; \
    /else \
      tfnextlineshow 43 Grey Ooze (1-5): Agg, no d-i, resist WEAPON, VAPE boots!%; \
    /endif

/def -p99 -F -mregexp -t"(What looks like a boulder is stomping around here|A boulder is here)" tfMobsubstWellBoulder = \
    /if (owner =~ 'Cindy' & mylevel < 56) \
      /tfshow CONSIDER BOULDER!!!%; \
      co boulder%; \
    /endif%; \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}44-46 @{Cred}AGG @{nCyellow}Boulder @{Cwhite}(fire)@{n}%{PR}%; \
    /else \
      tfnextlineshow 44-46 Boulder (6-13): Agg, d-i, Vuln fire, aware%; \
    /endif

/def -p99 -F -mregexp -t"(A large snail, with sharp-spiked protrusions from its head slithers around|The flail snail is here)" tfMobsubstWellFlailSnail = \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}44 @{Cred}agg @{nCyellow}Flail Snail @{Cwhite}(mental/gas)@{n}%{PR}%; \
    /else \
      tfnextlineshow 44 Flail Snail (1-5): Agg, no d-i, Vuln mental/gas, reflect spells, aware%; \
    /endif

/def -p99 -F -mregexp -t"(A huge dragon breathes fire at you as you arrive|The doppleganger is here)" tfMobsubstWellDoppleganger = \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}45 --- @{nCyellow}Doppleganger @{Cwhite}(unlife)@{n}%{PR}%; \
    /else \
      tfnextlineshow 45 Doppleganger (1-5): No-agg, Vuln unlife, aware%; \
    /endif

/def -p99 -F -mregexp -t"(A large weasel-like creature is here, preparing to attack\. \(hidden\)|The giant wolverine \(hidden\) is here)" tfMobsubstWellGWolverine = \
    /if (pg & groupleader !~ name & autoassist & !fighting) \
      assist%; \
    /endif%; \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}45 @{Cred}agg @{nCyellow}Giant Wolverine @{Cwhite}(mental/gas)@{n} (hide)%{PR}%; \
    /else \
      tfnextlineshow 45 Giant Wolverine (2-5): Agg, no d-i, Vuln mental/gas, aware%; \
    /endif

/def -p99 -F -mregexp -t"(A strange milky-white algae grows on the surface of the water|The phycomid is here)" tfMobsubstWellPhycomid = \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}45 @{Cred}agg @{nCyellow}Phycomid @{Cwhite}(acid, inject)@{n}%{PR}%; \
    /else \
      tfnextlineshow 45 Phycomid (5-12): Agg, no d-i, Vuln acid, inject phycomid-alien, aware%; \
    /endif

/def -p99 -F -mregexp -t"(A patch of brown fungus grows in the cavern here|The brown mold is here)" tfMobsubstWellBrownMold = \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}46 @{Cred}AGG @{nCyellow}Brown Mold @{Cwhite}(acid)@{n}%{PR}%; \
    /else \
      tfnextlineshow 46 Brown Mold (1-5): Agg, d-i, Vuln acid, Immune most spells (not ice), aware%; \
    /endif

/def -p99 -F -mregexp -t"(A tall humanoid with a tentacled mouth looks at you and charges|The mind flayer is here)" tfMobsubstWellMindFlayer = \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}47 @{Cred}AGG @{nCyellow}Mind Flayer @{Cwhite}(---)@{n}%{PR}%; \
    /else \
      tfnextlineshow 47 Mind Flayer (1-5): Agg, d-i, no known vulns%; \
    /endif

/def -p99 -F -mregexp -t"(A large, gray wolf sits here, watching you carefully|The Mist Wolf is here)" tfMobsubstWellMistWolf = \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}50 @{Cred}agg @{nCyellow}Mist Wolf @{Cwhite}(mental)@{n}%{PR}%; \
    /else \
      tfnextlineshow 50 Mist Wolf (4-7): Agg, no d-i, Vuln mental, aware%; \
    /endif

/def -p99 -F -mregexp -t"(A crimson mist floats through the caverns,|The vampiric mist is here)" tfMobsubstWellVampiricMist = \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}48 @{Cred}AGG @{nCyellow}Vampiric mist @{Cwhite}(energy, Resist WEAPON)@{n}%{PR}%; \
    /else \
      tfnextlineshow 48 Vampiric mist (1-8): Agg, d-i, Vuln energy, Resist WEAPON, Immune lots!, aware%; \
    /endif

/def -p99 -F -mregexp -t"(A large web is spread out across the cavern here, quivering slightly|The living web is here)" tfMobsubstWellLivingWeb = \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}48 --- @{nCyellow}Living web @{Cwhite}(no-attack)@{n}%{PR}%; \
    /else \
      tfnextlineshow 49 Living web (1-5): no-attack%; \
    /endif

/def -p99 -F -mregexp -t"(A hideous beast with long tentacles slithers around here, looking for food|The roper is here)" tfMobsubstWellRoper = \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}50 @{Cred}agg @{nCyellow}Roper @{Cwhite}(unlife)@{n}%{PR}%; \
    /else \
      tfnextlineshow 50 Roper (1-8): Agg, no d-i, Vuln unlife%; \
    /endif

/def -p99 -F -mregexp -t"(A tall humanoid with purplish skin and a tentacled mouth stands|The elder mind flayer is here)" tfMobsubstWellElderMindFlayer = \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}52 @{Cred}AGG @{nCyellow}Elder Mind Flayer @{Cwhite}(---)@{n}%{PR}%; \
    /else \
      tfnextlineshow 52 Elder Mind Flayer (1-8): Agg, d-i, no known vulns%; \
    /endif

/def -p99 -F -mregexp -t"(A dark black cloak lies here, neatly folded|The cloaker is here)" tfMobsubstWellCloaker = \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}53 @{Cred}AGG @{nCyellow}Cloaker @{Cwhite}(unlife, grab-as-shield)@{n}%{PR}%; \
    /else \
      tfnextlineshow 53 Cloaker (1-8): Agg, d-i, Vuln unlife, grab-as-shield, aware%; \
    /endif

/def -p99 -F -mregexp -t"(A medium-sized gargoyle-like creature stands here, grinning at you\. \(hidden\)|The berbalang \(hidden\) is here)" tfMobsubstWellBerbalang = \
    /if (pg & groupleader !~ name & autoassist & !fighting) \
      assist%; \
    /endif%; \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}55 @{Cred}AGG @{nCyellow}Berbalang @{Cwhite}(unlife)@{n} (hide)%{PR}%; \
    /else \
      tfnextlineshow 55 Berbalang (1-9): Agg, d-i, vuln unlife%; \
    /endif

/def -p99 -F -mregexp -t"(A large reptilian bird flies at you!|The darkenbeast is here)" tfMobsubstWellDarkenbeast = \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}57 @{Cred}AGG @{nCyellow}Darkenbeast @{Cwhite}(unlife)@{n}%{PR}%; \
    /else \
      tfnextlineshow 57 Darkenbeast (4-10): Agg, d-i, Vuln unlife, aware%; \
    /endif

/def -p99 -F -mregexp -t"(An ugly snake with a human head slithers around here, hissing at you|The spirit naga is here)" tfMobsubstWellSpiritNaga = \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}58 @{Cred}AGG @{nCyellow}Spirit Naga @{Cwhite}(---)@{n}%{PR}%; \
    /else \
      tfnextlineshow 58 Spirit Naga (4-10): Agg, d-i, no known vulns, aware%; \
    /endif

/def -p99 -F -mregexp -t"(A large fleshy web is stretched out across the cavern here\. \(invisible\) \(hidden\)|The memory web \(invisible\) \(hidden\) is here)" tfMobsubstWellMemoryWeb = \
    /if (pg & groupleader !~ name & autoassist & !fighting) \
      assist%; \
    /endif%; \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}59 @{Cred}AGG @{nCyellow}Memory Web @{Cwhite}(---)@{n} (invisible) (hide)%{PR}%; \
    /else \
      tfnextlineshow 59 Memory Web (4-10): Agg, d-i, no known vulns, aware%; \
    /endif

/def -p99 -F -mregexp -t"(A skeletal dog stands here, breathing fire|The hell hound is here)" tfMobsubstWellHellHound = \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}60 @{Cred}AGG @{nCyellow}Hell Hound @{Cwhite}(unlife)@{n}%{PR}%; \
    /else \
      tfnextlineshow 60 Hell Hound (8-12): Agg, d-i, Vuln unlife, aware%; \
    /endif

/def -p99 -F -mregexp -t"(You sense something nearby\. \(hidden\)|The tentamort \(hidden\) is here)" tfMobsubstWellTentamort = \
    /if (pg & groupleader !~ name & autoassist & !fighting) \
      assist%; \
    /endif%; \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}60 @{Cred}AGG @{nCyellow}Tentamort @{Cwhite}(unlife, INJECT!!!)@{n} (hide)%{PR}%; \
    /else \
      tfnextlineshow 60 Tentamort (4-10): S?, Agg, d-i, Vuln unlife, INJECT!!!, aware%; \
    /endif

/def -p99 -F -mregexp -t"(A very large white wolf stands here, growling at you\. \(hidden\)|The winter wolf \(hidden\) is here)" tfMobsubstWellWinterWolf = \
    /if (pg & groupleader !~ name & autoassist & !fighting) \
      assist%; \
    /endif%; \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}60 @{Cred}AGG @{nCyellow}Winter Wolf @{Cwhite}(fire/mental)@{n} (hide)%{PR}%; \
    /else \
      tfnextlineshow 60 Winter Wolf (8-15): Agg, d-i, Vuln fire/mental, aware%; \
    /endif

/def -p99 -F -mregexp -t"(A large reptilian creature shuffles around here|The basilisk is here)" tfMobsubstWellBasilisk = \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}62 @{Cred}AGG @{nCyellow}Basilisk @{Cwhite}(fire, petrify)@{n}%{PR}%; \
    /else \
      tfnextlineshow 62 Basilisk (6-13): Agg, d-i, Vuln fire, petrify%; \
    /endif

/def -p99 -F -mregexp -t"(A bull-like creature with thick metal scales stands here|The gorgon is here)" tfMobsubstWellGorgon = \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}61 @{Cred}AGG @{nCyellow}Gorgon @{Cwhite}(unlife, timed paralyzis)@{n}%{PR}%; \
    /else \
      tfnextlineshow 61 Gorgon (6-13): Agg, d-i, Vuln unlife, timed paralyzis%; \
    /endif

/def -p99 -F -mregexp -t"(A strangely-deformed dragon-like reptile is prowling here|The dracolisk is here)" tfMobsubstWellDracolisk = \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}63 @{Cred}AGG @{nCyellow}Dracolisk @{Cwhite}(fire/ice, petrify)@{n}%{PR}%; \
    /else \
      tfnextlineshow 63 Dracolisk (6-10): Agg, d-i, Vuln fire/ice, petrify, aware%; \
    /endif

/def -p99 -F -mregexp -t"An immense boulder is here" tfMobsubstWellImmenseBoulder = \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}63-65 --- @{nCyellow}Immense Boulder @{Cwhite}(---, HUNTER)@{n}%{PR}%; \
    /else \
      tfnextlineshow 63-65 Immense Boulder (6-13): no-agg, d-i, HUNTER%; \
    /endif

/def -p99 -F -mregexp -t"A skeletal bat of immense size swoops down at you!" tfMobsubstWellVarrangoinEasy = \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}64 @{Cred}AGG @{nCyellow}Varrangoin (easy) @{Cwhite}(pure/light/iron)@{n}%{PR}%; \
    /else \
      tfnextlineshow 64 (easy) Varrangoin (6-13): Agg, d-i, Vuln pure/light/iron%; \
    /endif
/def -p99 -F -mregexp -t"A huge skeletal bat is prowling here" tfMobsubstWellVarrangoinHard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}69 @{Cred}AGG @{nCyellow}Varrangoin (hard) @{Cwhite}(pure/light/iron)@{n}%{PR}%; \
    /else \
      tfnextlineshow 69 (hard) Varrangoin (6-13): Agg, d-i, Vuln pure/light/iron%; \
    /endif
/def -p99 -F -mregexp -t"The varrangoin \(hidden\) is here" tfMobsubstWellVarrangoinFighting = \
    /if (pg & groupleader !~ name & autoassist & !fighting) \
      assist%; \
    /endif%; \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}64/69 @{Cred}AGG @{nCyellow}Varrangoin @{Cwhite}(pure/light/iron)@{n} (hide)%{PR}%; \
    /else \
      tfnextlineshow 64/69 Varrangoin (6-13): Agg, d-i, Vuln pure/light/iron%; \
    /endif

/def -p99 -F -mregexp -t"(You see a beautiful feminine body in the shadows|The medusa is here)" tfMobsubstWellMedusa = \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}65 @{Cred}AGG @{nCyellow}Medusa @{Cwhite}(unlife, timed petrify)@{n}%{PR}%; \
    /else \
      tfnextlineshow 65 Medusa (6-10): Agg, d-i, Vuln unlife, timed petrify%; \
    /endif

/def -p99 -F -mregexp -t"(A thin layer of snow covers the ground here|The white pudding (\(invisible\) |)\(hidden\) is here)" tfMobsubstWellWhitePudding = \
    /if (pg & groupleader !~ name & autoassist & !fighting) \
      assist%; \
    /endif%; \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}65 @{Cred}AGG @{nCyellow}White pudding @{Cwhite}(---, VAPE shield!)@{n}%{PR}%; \
    /else \
      tfnextlineshow 65 White pudding (10-13): Agg, d-i, VAPE shield!%; \
    /endif

/def -p99 -F -mregexp -t"(A huge floating brain with a beak and tentacles floats towards you|The grell \(hidden\) is here)" tfMobsubstWellGrell = \
    /if (pg & groupleader !~ name & autoassist & !fighting) \
      assist%; \
    /endif%; \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}66 @{Cred}AGG @{nCyellow}Grell @{Cwhite}(unlife, No-BM)@{n}%{PR}%; \
    /else \
      tfnextlineshow 66 Grell (6-13): Agg, d-i, Vuln unlife, No-BM%; \
    /endif

/def -p99 -F -mregexp -t"(A strange creature with three legs and three arms waddles towards you|The xorn \(hidden\) is here)" tfMobsubstWellXorn = \
    /if (pg & groupleader !~ name & autoassist & !fighting) \
      assist%; \
    /endif%; \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}67 @{Cred}AGG @{nCyellow}Xorn @{Cwhite}(slay elemental, eats money)@{n}%{PR}%; \
    /else \
      tfnextlineshow 67 Xorn (6-13): Agg, d-i, vuln slay elemental, eats money%; \
    /endif

/def -p99 -F -mregexp -t"(A large boulder sits here conspicuously|The galeb duhr \(hidden\) is here)" tfMobsubstWellGalebDuhr = \
    /if (pg & groupleader !~ name & autoassist & !fighting) \
      assist%; \
    /endif%; \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}68 @{Cred}AGG @{nCyellow}Galeb Duhr @{Cwhite}(ice, immune electricity)@{n}%{PR}%; \
    /else \
      tfnextlineshow 68 Galeb Duhr (6-13): Agg, d-i, Vuln ice, Immune electricity, spawn boulders%; \
    /endif

/def -p99 -F -mregexp -t"A huge boulder rests on the ground here" tfMobsubstWellGalebDuhrRock = \
    /if (pg & groupleader !~ name & autoassist & !fighting) \
      assist%; \
    /endif%; \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}68 @{Cred}agg @{nCyellow}Galeb Duhr - Rock! @{Cwhite}(ice, immune electricity)@{n}%{PR}%; \
    /else \
      tfnextlineshow 68 Galeb Duhr (6-13): Agg, d-i, Vuln ice, Immune electricity, spawn boulders%; \
    /endif

/def -p99 -F -mregexp -t"(A vaguely humanoid shape formed from fire stands here|The fire elemental \(hidden\) is here)" tfMobsubstWellFireElemental = \
    /if (pg & groupleader !~ name & autoassist & !fighting) \
      assist%; \
    /endif%; \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}70 @{Cred}AGG @{nCyellow}Fire Elemental @{Cwhite}(ice)@{n}%{PR}%; \
    /else \
      tfnextlineshow 70 Fire Elemental (11-17): Agg, d-i, Vuln ice%; \
    /endif

/def -p99 -F -mregexp -t"(A snake with a human head slithers around here, looking for a meal|The greater medusa is here)" tfMobsubstWellGreaterMedusa = \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}70 @{Cred}AGG @{nCyellow}Greater Medusa @{Cwhite}(unlife, timed petrify)@{n}%{PR}%; \
    /else \
      tfnextlineshow 70 Greater Medusa (6-11): Agg, d-i, Vuln unlife, timed petrify%; \
    /endif

/def -p99 -F -mregexp -t"(A vaguely humanoid form made of ice rushes to attack you!|The ice elemental is here)" tfMobsubstWellIceElemental = \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}70 @{Cred}AGG @{nCyellow}Ice Elemental @{Cwhite}(fire)@{n}%{PR}%; \
    /else \
      tfnextlineshow 70 Ice Elemental (8-15): Agg, d-i, Vuln fire%; \
    /endif

/def -p99 -F -mregexp -t"The water elemental \(invisible\) is here" tfMobsubstWellWaterElemental2 = \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}70 @{Cred}AGG @{nCyellow}Water elemental @{Cwhite}(fire)@{n}%{PR}%; \
    /else \
      tfnextlineshow 70 Water elemental (14-18): Agg, d-i, Vuln fire, Resist crush?%; \
    /endif
/def -p99 -F -mregexp -t"(A strange presence pervades the water here\.|The water elemental is here)" tfMobsubstWellWaterElemental = \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}70/80 @{Cred}AGG @{nCyellow}Water elemental @{Cwhite}(fire)@{n}%{PR}%; \
    /else \
      tfnextlineshow 70/80 Water elemental (14-18/16+): Agg, d-i, Vuln fire, Resist crush?%; \
    /endif

/def -p99 -F -mregexp -t"(A strange creature is wandering the caverns here\.|The thessaltrice is here)" tfMobsubstWellThessaltrice = \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}71 @{Cred}AGG @{nCyellow}Thessaltrice @{Cwhite}(unlife, petrify)@{n}%{PR}%; \
    /else \
      tfnextlineshow 71 Thessaltrice (9-15): Agg, d-i, Vuln: unlife, petrify%; \
    /endif

/def -p99 -F -mregexp -t"(A large humanoid creature made of rock stands here\.|The earth elemental is here)" tfMobsubstWellEarthElemental = \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}72 @{Cred}AGG @{nCyellow}Earth elemental @{Cwhite}(air)@{n}%{PR}%; \
    /else \
      tfnextlineshow 72 Earth elemental (9-15): Agg, d-i, Vuln air%; \
    /endif

/def -p99 -F -mregexp -t"(A large tornado swirls here, threatening to carry you away\.|The air elemental is here)" tfMobsubstWellAirElemental = \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}73 @{Cred}AGG @{nCyellow}Air elemental @{Cwhite}(earth)%{PR}%; \
    /else \
      tfnextlineshow 73 Air elemental (9-15): Agg, d-i, Vuln earth%; \
    /endif

/def -p99 -F -mregexp -t"(A hideous creature stands here, looking intently at you\.|The otyugh is here)" tfMobsubstWellOtyugh = \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}74 @{Cred}AGG @{nCyellow}Otyugh @{Cwhite}(unlife)%{PR}%; \
    /else \
      tfnextlineshow 74 Otyugh (9-15): Agg, d-i, Vuln unlife%; \
    /endif

/def -p99 -F -mregexp -t"(A huge, ugly creature stands before you, grunting\.|The thessalgorgon is here)" tfMobsubstWellThessalgorgon = \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}75 @{Cred}AGG @{nCyellow}Thessalgorgon @{Cwhite}(unlife, petrify)%{PR}%; \
    /else \
      tfnextlineshow 75 Thessalgorgon (11-15): Agg, d-i, Vuln unlife, petrify%; \
    /endif

/def -p99 -F -mregexp -t"(A hideous creature spots you and rushes to attack!|The thessalmera is here)" tfMobsubstWellThessalmera = \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}76 @{Cred}AGG @{nCyellow}Thessalmera @{Cwhite}(unlife)%{PR}%; \
    /else \
      tfnextlineshow 76 Thessalmera (11-15): Agg, d-i, Vuln unlife%; \
    /endif

/def -p99 -F -mregexp -t"(A shadowy form drifts around here\.|The soul beckoner (\(invisible\) |)\(hidden\) is here)" tfMobsubstWellSoulBeckoner = \
    /if (pg & groupleader !~ name & autoassist & !fighting) \
      assist%; \
    /endif%; \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}77 @{Cred}AGG @{nCyellow}Soul Beckoner @{Cwhite}(pure?/light/energy, Resist WEAPON)%{PR}%; \
    /else \
      tfnextlineshow 77 Soul Beckoner (11-15): Agg, d-i, Vuln pure?/light/energy, Resist WEAPON%; \
    /endif

/def -p99 -F -mregexp -t"(An immense purple worm bursts from the floor as you approach!|The purple worm is here)" tfMobsubstWellPurpleWorm = \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}78 @{Cred}AGG @{nCyellow}Purple worm @{Cwhite}(unlife)%{PR}%; \
    /else \
      tfnextlineshow 78 Purple worm (11-15): Agg, d-i, Vuln unlife%; \
    /endif

/def -p99 -F -mregexp -t"(A large round eye creature floats here\.|The beholder is here)" tfMobsubstWellBeholder = \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}79 @{Cred}AGG @{nCyellow}Beholder @{Cwhite}(pure/light/iron?)%{PR}%; \
    /else \
      tfnextlineshow 79 Beholder (11-17): Agg, d-i, Vuln pure/light/iron?%; \
    /endif

/def -p99 -F -mregexp -t"(A huge beast with 8 heads stands here, breathing fire\.|The pyrohydra is here)" tfMobsubstWellPyrohydra = \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}80 @{Cred}AGG @{nCyellow}Pyrohydra @{Cwhite}(ice)%{PR}%; \
    /else \
      tfnextlineshow 80 Pyrohydra (14-18): Agg, d-i, Vuln ice%; \
    /endif

/def -p99 -F -mregexp -t"(A huge bluish worm-like creature rears up to attack!|The remorhaz is here)" tfMobsubstWellRemorhaz = \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}80 @{Cred}AGG @{nCyellow}Remorhaz @{Cwhite}(slay dragon)%{PR}%; \
    /else \
      tfnextlineshow 80 Remorhaz (14-17): Agg, Vuln slay dragon%; \
    /endif

/def -p99 -F -mregexp -t"(A strange warped creature with eight snake heads stands here|The thessalhydra is here)" tfMobsubstWellThessalhydra = \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}80 @{Cred}AGG @{nCyellow}Thessalhydra @{Cwhite}(unlife)%{PR}%; \
    /else \
      tfnextlineshow 80 Thessalhydra (11-15): Agg, Vuln unlife%; \
    /endif

/def -p99 -F -mregexp -t"(A hideous, shambling creature sees you and rushes to attack!|The neo-otyugh \(hidden\) is here)" tfMobsubstWellNeoOtyugh = \
    /if (pg & groupleader !~ name & autoassist & !fighting) \
      assist%; \
    /endif%; \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}81 @{Cred}AGG @{nCyellow}Neo-otyugh @{Cwhite}(unlife)%{PR}%; \
    /else \
      tfnextlineshow 81 Neo-otyugh (11-18): Agg, Vuln unlife%; \
    /endif

/def -p99 -F -mregexp -t"(A large, imposing creature with a spiked tail is here\.|The manticore is here)" tfMobsubstWellManticore = \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}82 @{Cred}AGG @{nCyellow}Manticore @{Cwhite}(unlife)%{PR}%; \
    /else \
      tfnextlineshow 82 Manticore (11-18): Agg, Vuln unlife%; \
    /endif

/def -p99 -F -mregexp -t"(A repulsive sphere-shaped eye floats here\.|The gauth is here)" tfMobsubstWellGauth = \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}83 @{Cred}AGG @{nCyellow}Gauth @{Cwhite}(light, forceflee N-E-S-W)%{PR}%; \
    /else \
      tfnextlineshow 83 Gauth (11-18): Agg, Vuln light, forceflee N-E-S-W%; \
    /endif

/def -p99 -F -mregexp -t"(A large, hulking creature sees you and charges!|The umber hulk is here)" tfMobsubstWellUmberHulk = \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}84 @{Cred}AGG @{nCyellow}Umber hulk @{Cwhite}(pure/light/fire)%{PR}%; \
    /else \
      tfnextlineshow 84 Umber hulk (11-18): Agg, Vuln pure/light/fire%; \
    /endif

/def -p99 -F -mregexp -t"(A large, old white dragon scowls at you as you enter, then attacks!|The ancient white dragon is here)" tfMobsubstWellAWDragon = \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}85 @{Cred}AGG @{nCyellow}Ancient White Dragon @{Cwhite}(fire)%{PR}%; \
    /else \
      tfnextlineshow 85 Ancient White Dragon (16+): Agg, Vuln fire%; \
    /endif

/def -p99 -F -mregexp -t"(A two-headed lesser eraditor stands here displaying an evil grin\.|The Lesser Eraditor is here)" tfMobsubstWellLesserEraditor = \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}85 --- @{nCyellow}Lesser Eraditor @{Cwhite}(pure/light/iron)%{PR}%; \
    /else \
      tfnextlineshow 85 Lesser Eraditor (14+): No-agg, Vuln pure/light/iron%; \
    /endif

/def -p99 -F -mregexp -t"(A three headed eraditor stands here getting ready for battle\.|The Eraditor is here)" tfMobsubstWellEraditor = \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}86 @{Cred}AGG @{nCyellow}Eraditor @{Cwhite}(pure/light/iron)%{PR}%; \
    /else \
      tfnextlineshow 86 Eraditor (14+): Agg, Vuln pure/light/iron%; \
    /endif

/def -p99 -F -mregexp -t"(A Lord Eraditor charges towards you with an evil laugh|The Lord Eraditor is here)" tfMobsubstWellLordEraditor = \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}88 @{Cred}AGG @{nCyellow}Lord Eraditor @{Cwhite}(pure/light/iron)%{PR}%; \
    /else \
      tfnextlineshow 88 Lord Eraditor (18): Agg, Vuln pure/light/iron%; \
    /endif

/def -p99 -F -mregexp -t"(A Major Eraditor displays a vicious grin as it goes to attack\.|The Major Eraditor is here)" tfMobsubstWellMajorEraditor = \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}87 @{Cred}AGG @{nCyellow}Major Eraditor @{Cwhite}(pure/light/iron)%{PR}%; \
    /else \
      tfnextlineshow 87 Major Eraditor (14+): Agg, Vuln pure/light/iron%; \
    /endif

/def -p99 -F -mregexp -t"(A tall, skeletal creature looks at you with glowing red eyes\.|The thassaloss is here)" tfMobsubstWellThassaloss = \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}89 --- @{nCyellow}Thassaloss @{Cwhite}(slay mythical?)%{PR}%; \
    /else \
      tfnextlineshow 89 Thassaloss (14+): No-agg, mythical?%; \
    /endif

/def -p99 -F -mregexp -t"(A light-blue colored dragon of immense size rests here, waiting for a meal\.|The frost dragon is here)" tfMobsubstWellFrostDragon = \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}90 @{Cred}AGG @{nCyellow}Frost Dragon @{Cwhite}(fire)%{PR}%; \
    /else \
      tfnextlineshow 90 Frost Dragon (16+): Agg, Vuln fire%; \
    /endif

/def -p99 -F -mregexp -t"(A hideous wormlike creature is crawling here\.|The horgar is here)" tfMobsubstWellHorgar = \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}90 --- @{nCyellow}Horgar @{Cwhite}(fire, VAPE weapon!)%{PR}%; \
    /else \
      tfnextlineshow 90 Horgar (14+): no-agg, Vuln fire, VAPE weapon!%; \
    /endif

/def -p99 -F -mregexp -t"(A large, flaming humanoid stands here, grinning widely as he notices you\.|The Efreeti Emir is here)" tfMobsubstWellEfreetiEmir = \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}91 --- @{nCyellow}Efreeti Emir @{Cwhite}(ice)%{PR}%; \
    /else \
      tfnextlineshow 91 Efreeti Emir (17+): No-agg, Vuln ice%; \
    /endif

/def -p99 -F -mregexp -t"(A muscular humanoid shadow glides towards you\.|The Shadow Demon is here)" tfMobsubstWellShadowDemon = \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}91 --- @{nCyellow}Shadow Demon @{Cwhite}(pure/light/iron/fire/electricity)%{PR}%; \
    /else \
      tfnextlineshow 91 Shadow Demon (16+): No-agg, Vuln pure/light/iron/fire/electricity%; \
    /endif

/def -p99 -F -mregexp -t"(A winged hairless sword demon glares at you\.|The Sword Demon is here)" tfMobsubstWellSwordDemon = \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}91 @{Cred}AGG @{nCyellow}Sword Demon @{Cwhite}(pure/light/iron)%{PR}%; \
    /else \
      tfnextlineshow 91 Sword Demon (16+): Agg, d-i, Vuln pure/light/iron%; \
    /endif

/def -p99 -F -mregexp -t"(A large, flaming humanoid is standing here\.|The Efreeti Bey is here)" tfMobsubstWellEfreetiBey = \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}93 --- @{nCyellow}Efreeti Bey @{Cwhite}(ice)%{PR}%; \
    /else \
      tfnextlineshow 93 Efreeti Bey (18+): No-agg, Vuln ice%; \
    /endif

/def -p99 -F -mregexp -t"(A tall, light-blue skinned humanoid hovers in the water here\.|The Marid Beglerbeg is here)" tfMobsubstWellMaridBeglerbeg = \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}93 --- @{nCyellow}Marid Beglerbeg @{Cwhite}(fire)%{PR}%; \
    /else \
      tfnextlineshow 93 Marid Beglerbeg (18+): No-agg, Vuln fire%; \
    /endif

/def -p99 -F -mregexp -t"(A large, blue-skinned humanoid hovers in the water here\.|The Marid Mufti is here)" tfMobsubstWellMaridMufti = \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}93 @{Cred}AGG @{nCyellow}Marid Mufti @{Cwhite}(fire)%{PR}%; \
    /else \
      tfnextlineshow 93 Marid Mufti (18+): Agg, Vuln fire%; \
    /endif

/def -p99 -F -mregexp -t"(A human with jet-black skin stands here\.|The Storm Demon is here)" tfMobsubstWellStormDemon = \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}93 --- @{nCyellow}Storm Demon @{Cwhite}(pure/light/iron)%{PR}%; \
    /else \
      tfnextlineshow 93 Storm Demon (16+): No-agg. Vuln pure/light/iron%; \
    /endif

/def -p99 -F -mregexp -t"(A terrorite demon looks down at you with an amused smile\.|The Terrorite Demon is here)" tfMobsubstWellTerroriteDemon = \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}93 @{Cred}AGG @{nCyellow}Terrorite Demon @{Cwhite}(pure/light/iron)%{PR}%; \
    /else \
      tfnextlineshow 93 Terrorite Demon (16+): Agg, Vuln pure/light/iron%; \
    /endif

/def -p99 -F -mregexp -t"(There is a shadow of a dragon on the wall\.|The shadow dragon is here)" tfMobsubstWellShadowDragon = \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}94 --- @{nCyellow}Shadow Dragon @{Cwhite}(slay dragon)%{PR}%; \
    /else \
      tfnextlineshow 94 Shadow Dragon (16+): No-agg, Vuln slay dragon%; \
    /endif

/def -p99 -F -mregexp -t"(A tall, imposing humanoid stands here, with hate in its eyes|The Dao Khan is here)" tfMobsubstWellDaoKhan = \
    /if (owner =~ 'Cindy' & mylevel >= 73) \
      /tfshow CONSIDER DAO!!!%; \
      co dao%; \
    /endif%; \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}L98-99 @{Cred}AGG @{nCyellow}Dao Khan @{Cwhite}(fire/air)%{PR}%; \
    /else \
      tfnextlineshow 98-99 Dao Khan (20): Agg, Vuln fire/air%; \
    /endif

/def -p99 -F -mregexp -t"(A large humanoid surrounded by wisps of ether stands here boldly\.|The Djinni Malik is here)" tfMobsubstWellDjinniMalik = \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}95 @{Cred}AGG @{nCyellow}Djinni Malik @{Cwhite}(earth)%{PR}%; \
    /else \
      tfnextlineshow 95 Djinni Malik (17+): Agg, Vuln earth%; \
    /endif

/def -p99 -F -mregexp -t"(A large, imposing humanoid stands here, surrounded by flames\.|The Efreeti Malik is here)" tfMobsubstWellEfreetiMalik = \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}95 --- @{nCyellow}Efreeti Malik @{Cwhite}(ice)%{PR}%; \
    /else \
      tfnextlineshow 95 Efreeti Malik (18+): No-agg, Vuln ice%; \
    /endif

/def -p99 -F -mregexp -t"(A tall, regal humanoid with deep blue skin hovers in the water here\.|The Marid Atabeg is here)" tfMobsubstWellMaridAtabeg = \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}95 --- @{nCyellow}Marid Atabeg @{Cwhite}(fire)%{PR}%; \
    /else \
      tfnextlineshow 95 Marid Atabeg (19+): No-agg, Vuln fire%; \
    /endif

/def -p99 -F -mregexp -t"(A great Thonis demon is standing here contemplating your fate\.|The Thonis is here)" tfMobsubstWellThonis = \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}95 --- @{nCyellow}Thonis @{Cwhite}(pure/light/iron)%{PR}%; \
    /else \
      tfnextlineshow 95 Thonis (17+): No-agg, Vuln pure/light/iron%; \
    /endif

/def -p99 -F -mregexp -t"(A regal humanoid formed from solid rock eyes you contemptuously\.|The Dao Hetman is here)" tfMobsubstWellDaoHetman = \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}97 @{Cred}AGG @{nCyellow}Dao Hetman @{Cwhite}(air)%{PR}%; \
    /else \
      tfnextlineshow 97 Dao Hetman (18+): Agg, Vuln air%; \
    /endif

/def -p99 -F -mregexp -t"(A Djinni Vizier is here to end your sad life\.|The Djinni Vizier is here)" tfMobsubstWellDjinniVizier = \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}97 @{Cred}AGG @{nCyellow}Djinni Vizier @{Cwhite}(earth)%{PR}%; \
    /else \
      tfnextlineshow 97 Djinni Vizier (18+): Agg, Vuln earth%; \
    /endif

/def -p99 -F -mregexp -t"(A regal-looking humanoid dressed in the robes of a prince stands here\.|The Efreeti Pasha is here)" tfMobsubstWellEfreetiPasha = \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}97 @{Cred}AGG @{nCyellow}Efreeti Pasha @{Cwhite}(ice)%{PR}%; \
    /else \
      tfnextlineshow 97 Efreeti Pasha (20): Agg, Vuln ice%; \
    /endif

/def -p99 -F -mregexp -t"(A tall, imposing humanoid hovers in the water here, scowling at you|The Marid Padishah is here)" tfMobsubstWellMaridPadishah = \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}99 @{Cred}AGG @{nCyellow}Marid Padishah @{Cwhite}(fire)%{PR}%; \
    /else \
      tfnextlineshow 99 Marid Padishah (20): Agg, Vuln fire%; \
    /endif

/def -p99 -F -mregexp -t"(An imposing humanoid with turquoise skin hovers in the water here\.|The Marid Shah is here)" tfMobsubstWellMaridShah = \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}97 @{Cred}AGG @{nCyellow}Marid Shah @{Cwhite}(fire)%{PR}%; \
    /else \
      tfnextlineshow 97 Marid Shah (19+): Agg, Vuln fire%; \
    /endif

/def -p99 -F -mregexp -t"(A fearsome Balrog is here\.|The Balrog is here)" tfMobsubstWellBalrog = \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}98 @{Cred}AGG @{nCyellow}Balrog @{Cwhite}(earth?/slay mythical, forceflee)%{PR}%; \
    /else \
      tfnextlineshow 98 Balrog (18+): Agg, d-i, Vuln earth?/slay mythical%; \
    /endif

/def -p99 -F -mregexp -t"(A tall, imposing humanoid within a storm, looks down on you with disdain\.|The Djinni Caliph is here)" tfMobsubstWellDjinniCaliph = \
    /if (owner =~ 'Cindy' & mylevel >= 74) \
      /tfshow CONSIDER CALIPH!!!%; \
      co caliph%; \
    /endif%; \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}99+--- @{nCyellow}Djinni Caliph @{Cwhite}(earth)%{PR}%; \
    /else \
      tfnextlineshow 99+ Djinni Caliph (20): No-agg, Vuln earth%; \
    /endif

/def -p99 -F -mregexp -t"(A tall, imposing humanoid stands here, looking down upon you with scorn\.|The Efreeti Sultan is here)" tfMobsubstWellEfreetiSultan = \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}99 @{Cred}AGG @{nCyellow}Efreeti Sultan @{Cwhite}(ice)%{PR}%; \
    /else \
      tfnextlineshow 99 Efreeti Sultan (20): Agg, Vuln ice%; \
    /endif

/def -p99 -F -mregexp -t"(Morgoth the Valar God is standing in front of, yes - YOU!|Morgoth the Valar God is here)" tfMobsubstWellMorgoth = \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}100 @{Cred}AGG @{nCyellow}Morgoth @{Cwhite}(mythical?/earth, forceflee)%{PR}%; \
    /else \
      tfnextlineshow 100 Morgoth (20): Agg, Vuln earth%; \
    /endif

/def -p99 -F -mregexp -t"(Gond the Wonderbringer is here, examining a small gem through an eyepiece|Gond is here)" tfMobsubstWellGond = \
    /if (mobsubs) \
      /substitute -p %{PL}@{Cwhite}Lvl100 --- @{nCyellow}Gond @{Cwhite}(give crystal/transform to ktv/buy <stat>)%{PR}%; \
    /else \
      tfnextlineshow 100 Gond (6+): No-agg, give crystal/transform to ktv/buy <stat>%; \
    /endif

; -----------------------  Whitebridge  -----------------------
/def -p99 -F -mregexp -t"(A successful trader is here taking a stroll around the city\.|A Wealthy Trader is here)(, fighting [^\.!]+.|)" tfMobsubstWhitebridgeWealthyTrader = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Wealthy Trader @{Cgreen}(N, 1-90, human?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A brown and white dog stands here wagging its tail\.|A Slumdog is here)(, fighting [^\.!]+.|)" tfMobsubstWhitebridgeSlumdog = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Slumdog @{Cgreen}(N, 1-90, canine?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A posh little poodle is yapping away here\.|A pampered poodle is here)(, fighting [^\.!]+.|)" tfMobsubstWhitebridgePamperedPoodle = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A pampered poodle @{Cgreen}(N, 1-90, canine?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A man from the slums is standing around here\.|A Man from the Slums is here)(, fighting [^\.!]+.|)" tfMobsubstWhitebridgeManFromTheSlums = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Man from the Slums @{Cgreen}(N, 1-90, human?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A citadel sentry stands here solemnly\.|A Citadel Sentry is here)(, fighting [^\.!]+.|)" tfMobsubstWhitebridgeCitadelSentry = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Citadel Sentry @{Cgreen}(N, 1-90, human?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A well to-do lady of Whitebridge walks here\.|A Whitebridge Lady is here)(, fighting [^\.!]+.|)" tfMobsubstWhitebridgeLady = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Whitebridge Lady @{Cgreen}(N, 1-90, human?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A deck swab has been allowed some time off his ship\.|A Deck Swab is here)(, fighting [^\.!]+.|)" tfMobsubstWhitebridgeDeckSwab = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Deck Swab @{Cgreen}(N, 1-90, human?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A district guard stands here on the lookout for thieves\.|A District Guard is here)(, fighting [^\.!]+.|)" tfMobsubstWhitebridgeDistrictGuard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A District Guard @{Cgreen}(N, 1-90, human?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A sailor is here taking some well earnt shore leave\.|A Sailor is here)(, fighting [^\.!]+.|)" tfMobsubstWhitebridgeSailor = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Sailor @{Cgreen}(N, 1-90, human?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A female lady of the city wanders around here\.|A Woman from the Slums is here)(, fighting [^\.!]+.|)" tfMobsubstWhitebridgeWomanfromtheSlums = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Woman from the Slums @{Cgreen}(N, 1-90, human?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A cityguard is here looking for criminal activity\.|A Whitebridge Cityguard is here)(, fighting [^\.!]+.|)" tfMobsubstWhitebridgeWhitebridgeCityguard = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Whitebridge Cityguard @{Cgreen}(N, 1-90, human?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A well-travelled merchant is in the city on business\.|A Successful Merchant is here)(, fighting [^\.!]+.|)" tfMobsubstWhitebridgeSuccessfulMerchant = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Successful Merchant @{Cgreen}(N, 1-90, human?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A wealthy citizen rushes past you\.|A Wealthy Citizen is here)(, fighting [^\.!]+.|)" tfMobsubstWhitebridgeWealthyCitizen = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Wealthy Citizen @{Cgreen}(N, 1-90, human?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An executive officier of the city authority is busy working here\.|An Executive Officer is here)(, fighting [^\.!]+.|)" tfMobsubstWhitebridgeExecutiveOfficer = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An Executive Officer @{Cgreen}(N, 1-90, human?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An administrative assistant is here on a task\.|An Administrative Assistant is here)(, fighting [^\.!]+.|)" tfMobsubstWhitebridgeAdministrativeAssistant = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An Administrative Assistant @{Cgreen}(N, 1-90, human?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A treasury official walks around here\.|A treasury official is here)(, fighting [^\.!]+.|)" tfMobsubstWhitebridgeTreasuryOfficial = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A treasury official @{Cgreen}(N, 1-90, human?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A heavily-armored guard is here defending the citadel\.|A Citadel Defender is here)(, fighting [^\.!]+.|)" tfMobsubstWhitebridgeCitadelDefender = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Citadel Defender @{Cgreen}(N, 1-90, human?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A towering sentinel clad in white-gold armor guards the city here\.|A Whitebridge Sentinel is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstWhitebridgeWhitebridgeSentinel = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Whitebridge Sentinel 1 @{Cgreen}(@{nCwhite}G@{nCgreen}, 1-90, human?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A towering sentinel clad in white-gold armor stands here impassively\.|A Whitebridge Sentinel is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstWhitebridgeSentinel2 = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Whitebridge Sentinel 2 @{Cgreen}(@{nCwhite}G@{nCgreen}, 1-90, human?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A bounty hunter is following up on witness reports of troll sightings outside the city\.|A Bounty Hunter is here)(, fighting [^\.!]+.|)" tfMobsubstWhitebridgeBountyHunter = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Bounty Hunter @{Cgreen}(N, 1-90, human?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A citizen of this fine city strolls around here\.|A citizen of Whitebridge is here)(, fighting [^\.!]+.|)" tfMobsubstWhitebridgeCitizenOfWhitebridge = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A citizen of Whitebridge @{Cgreen}(N, 1-90, human?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A concerned citizen is in discussion here with a councillor\.|A Concerned Citizen is here)(, fighting [^\.!]+.|)" tfMobsubstWhitebridgeConcernedCitizen = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Concerned Citizen @{Cgreen}(N, 1-90, human?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A councillor of the city is here engaging in debate with a citizen\.|An Interested Councillor is here)(, fighting [^\.!]+.|)" tfMobsubstWhitebridgeInterestedCouncillor = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An Interested Councillor @{Cgreen}(N, 1-90, human?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A Whitebridge Councillor is here in discussion\.|A Whitebridge Councillor is here)(, fighting [^\.!]+.|)" tfMobsubstWhitebridgeWhitebridgeCouncillor = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Whitebridge Councillor @{Cgreen}(N, 1-90, human?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Clerk of the Court is here recording the trial\.|The Clerk Court is here)(, fighting [^\.!]+.|)" tfMobsubstWhitebridgeClerkCourt = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Clerk Court @{Cgreen}(N, 1-90, human?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A small well-dressed kid is playing around here\.|A Slum kid is here)(, fighting [^\.!]+.|)" tfMobsubstWhitebridgeSlumKid = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Slum kid @{Cgreen}(N, 1-90, human?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A defence lawyer is here making notes\.|The Defence Lawyer is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstWhitebridgeDefenceLawyer = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Defence Lawyer @{Cgreen}(@{nCred}E@{nCgreen}, 1-90, human?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The lawyer for the prosecution states the case\.|The Prosecution Lawyer is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstWhitebridgeProsecutionLawyer = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Prosecution Lawyer @{Cgreen}(@{nCwhite}G@{nCgreen}, 1-90, human?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The accused stands trial here\.|The Defendant is here)(, fighting [^\.!]+.|)" tfMobsubstWhitebridgeDefendant = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Defendant @{Cgreen}(N, 1-90, human?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A jury member is sat here following proceedings\.|A Juror is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstWhitebridgeJuror = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Juror @{Cgreen}(@{nCwhite}G@{nCgreen}, 1-90, human?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A cabinet member is here debating important issues\.|A Cabinet Member is here)(, fighting [^\.!]+.|)" tfMobsubstWhitebridgeCabinetMember = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Cabinet Member @{Cgreen}(N, 1-90, human?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A cabinet secretary is drafting a letter here\.|Secretary to the Cabinet is here)(, fighting [^\.!]+.|)" tfMobsubstWhitebridgeSecretaryToTheCabinet = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Secretary to the Cabinet @{Cgreen}(N, 1-90, human?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A secretary to the treasury is here composing an official document\.|A Secretary to the Treasury is here)(, fighting [^\.!]+.|)" tfMobsubstWhitebridgeSecretaryToTheTreasury = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Secretary to the Treasury @{Cgreen}(N, 1-90, human?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Crime Commissioner mulls over sentencing guidelines for criminals\.|The Crime Commissioner is here)(, fighting [^\.!]+.|)" tfMobsubstWhitebridgeCrimeCommissioner = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Crime Commissioner @{Cgreen}(N, 1-90, human?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Lord Mayor stands here considering his next civic speech\.|The Lord Mayor of Whitebridge is here)(, fighting [^\.!]+.|)" tfMobsubstWhitebridgeLordMayorOfWhitebridge = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Lord Mayor of Whitebridge @{Cgreen}(N, 91-95, human?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Chancellor of Whitebridge is here signing papers at his desk\.|Holbrand Redwater, the Ninth Whitebridge Chancellor is here)(, fighting [^\.!]+.|)" tfMobsubstWhitebridgeHolbrandRedwater = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Holbrand Redwater @{Cgreen}(N, 91-95, human?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Magistrate of Whitebridge sits behind a raised bench here\.|The City Magistrate is here)(, fighting [^\.!]+.|)" tfMobsubstWhitebridgeCityMagistrate = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The City Magistrate @{Cgreen}(N, 1-90, human?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A trustee of the Grand Union is listening to the latest proposals\.|A Grand Union Trustee is here)(, fighting [^\.!]+.|)" tfMobsubstWhitebridgeGrandUnionTrustee = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Grand Union Trustee @{Cgreen}(N, 1-90, human?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The chairman of the Grand Union is heading a meeting here\.|The Chairman of the Grand Union is here)(, fighting [^\.!]+.|)" tfMobsubstWhitebridgeGrandUnionChairman = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Chairman of the Grand Union @{Cgreen}(N, 91-95, QM, no-attack)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A cat with an expensive jewelled necklace bounces around\.|An aristo cat is here)(, fighting [^\.!]+.|)" tfMobsubstWhitebridgeAristoCat = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An aristo cat @{Cgreen}(N, 1-90, feline?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A commander of the district guard walks around observing here\.|A District Guard Commander is here)(, fighting [^\.!]+.|)" tfMobsubstWhitebridgeDistrictGuardCommander = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A District Guard Commander @{Cgreen}(N, 1-90, human?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Guard Station Chief sits behind a large oak desk puffing a cigar\.|The Guard Station Chief is here)(, fighting [^\.!]+.|)" tfMobsubstWhitebridgeGuardStationChief = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Guard Station Chief @{Cgreen}(N, 1-90, human?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A cartographer is here scribing a new map to sell\.|The Whitebridge Cartographer is here)(, fighting [^\.!]+.|)" tfMobsubstWhitebridgeCartographer = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Whitebridge Cartographer @{Cgreen}(N, 100, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A magician's apprentice is here helping out in the shop\.|The magician's apprentice is here)(, fighting [^\.!]+.|)" tfMobsubstWhitebridgeMagiciansApprentice = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The magician's apprentice @{Cgreen}(N, 100, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A well-dressed man is acting suspiciously here\. \(hidden\)|A Disguised Thief \(hidden\) is here)(, fighting [^\.!]+.|)" tfMobsubstWhitebridgeDisguisedThief = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Disguised Thief @{Cgreen}(N, 42, human?, thief)@{n} (hide)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A dubious character is watching your actions here\. \(hidden\)|A Dubious Character \(hidden\) is here)(, fighting [^\.!]+.|)" tfMobsubstWhitebridgeDubiousCharacter = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Dubious Character @{Cgreen}(N, 39, human?)@{n} (hide)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The guildmaster of the city welcomes you to the guild\.|The Guildmaster of Whitebridge is here)(, fighting [^\.!]+.|)" tfMobsubstWhitebridgeGuildmaster = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Guildmaster of Whitebridge @{Cgreen}(N, 100, no-attack)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A former gladiator with an eye for weaponry greets you as you enter his shop\.|Thyann is here)(, fighting [^\.!]+.|)" tfMobsubstWhitebridgeThyann = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Thyann @{Cgreen}(N, 100, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Justice of the Peace walks around ensuring order is being kept\.|The Justice of the Peace is here)(, fighting [^\.!]+.|)" tfMobsubstWhitebridgeJusticeOfThePeace = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Justice of the Peace @{Cgreen}(N, 91-95, human?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An owner of residential property in the city stands before you\.|A Slum Lord is here)(, fighting [^\.!]+.|)" tfMobsubstWhitebridgeSlumLord = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Slum Lord @{Cgreen}(N, 1-90, human?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A second-rate con is serving his time here\.|A Seized Con-Artist is here)(, fighting [^\.!]+.|)" tfMobsubstWhitebridgeSeizedConArtist = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Seized Con-Artist @{Cgreen}(N, 1-90, human?, thief)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A swindler is here leaning against a support pillar\.|A Captive Swindler is here)(, fighting [^\.!]+.|)" tfMobsubstWhitebridgeCaptiveSwindler = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Captive Swindler @{Cgreen}(N, 91-95, human?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An inept crook is imprisoned in the vaults\.|An Incarcerated Crook is here)(, fighting [^\.!]+.|)( \(Red Aura\)|)" tfMobsubstWhitebridgeIncarceratedCrook = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An Incarcerated Crook @{Cgreen}(@{nCred}E@{nCgreen}, 91-95, human?, thief)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A dirty rotten scoundrel is lurking around waiting to be freed\.|A Reformed Scoundrel is here)(, fighting [^\.!]+.|)( \(White Aura\)|)" tfMobsubstWhitebridgeReformedScoundrel = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Reformed Scoundrel @{Cgreen}(@{nCwhite}G@{nCgreen}, 1-90, human?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A scallywag has been jailed in the vaults for his crimes\. \(hidden\)|A Caged Scally \(hidden\) is here)(, fighting [^\.!]+.|)" tfMobsubstWhitebridgeCagedScally = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Caged Scally @{Cgreen}(N, 1-90, human?)@{n} (hide)%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A thief caught stealing has been imprisoned in this grim place\. \(hidden\)|A Jailed Thief \(hidden\) is here)(, fighting [^\.!]+.|)" tfMobsubstWhitebridgeJailedThief = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Jailed Thief @{Cgreen}(N, 91-95, human?, not thief)@{n} (hide)%{P2}%{PR}%; \
    /endif
/def -p98 -F -mregexp -t"(A scruffy little rascal is cursing his luck here\.( \(invisible\)|)|A Caught Rascal( \(invisible\)|) is here)(, fighting [^\.!]+.|)" tfMobsubstWhitebridgeCaughtRascal = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (imp/invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}A Caught Rascal @{Cgreen}(N, 1-90, human?)@{n}%{invisTxt}%{P4}%{PR}%; \
    /endif
/def -p98 -F -mregexp -t"(A bandit slinks around in the shadows\.( \(invisible\)|)|An Imprisoned Bandit( \(invisible\)|) is here)(, fighting [^\.!]+.|)" tfMobsubstWhitebridgeImprisonedBandit = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (imp/invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}An Imprisoned Bandit @{Cgreen}(N, 91-95, human?, assist-all)@{n}%{invisTxt}%{P4}%{PR}%; \
    /endif
/def -p98 -F -mregexp -t"(A pickpocket caught by the authorities has been caged here\.( \(invisible\)|)|A Captured Pickpocket( \(invisible\)|) is here)(, fighting [^\.!]+.|)" tfMobsubstWhitebridgeCapturedPickpocket = \
    /if (mobsubs) \
      /if ({P2} =~ " (invisible)" | {P3} =~ " (invisible)") \
        /let invisTxt= (imp/invis)%; \
      /else \
        /let invisTxt=%; \
      /endif%; \
      /substitute -p %{PL}@{nCyellow}A Captured Pickpocket @{Cgreen}(N, 1-90, human?, thief)@{n}%{invisTxt}%{P4}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Whitebridge Baker welcomes you to his shop\.|The Whitebridge Baker is here)(, fighting [^\.!]+.|)" tfMobsubstWhitebridgeBaker = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Whitebridge Baker @{Cgreen}(N, 100, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A barrel-chested barman is here serving drinks\.|A portly innkeeper is here)(, fighting [^\.!]+.|)" tfMobsubstWhitebridgePortlyInnkeeper = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A portly innkeeper @{Cgreen}(N, 100, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Jebbe, the owner of the general store walks over to assist you\.|Jebbe the shopkeeper is here)(, fighting [^\.!]+.|)" tfMobsubstWhitebridgeJebbeTheShopkeeper = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Jebbe the shopkeeper @{Cgreen}(N, 100, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The Whitebridge postmaster stands here sorting mail\.|The postmaster is here)(, fighting [^\.!]+.|)" tfMobsubstWhitebridgePostmaster = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The postmaster @{Cgreen}(N, 100, human?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A smartly-dressed gentleman is here conducting the auction\.|The auctioneer is here)(, fighting [^\.!]+.|)" tfMobsubstWhitebridgeAuctioneer = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The auctioneer @{Cgreen}(N, 100, human?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The clerk of this establishment stands behind the counter, waiting to help\.|The item store clerk is here)(, fighting [^\.!]+.|)" tfMobsubstWhitebridgeItemStoreClerk = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The item store clerk @{Cgreen}(N, 100, human?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The receptionist offers you a room for the duration of your stay in the city\.|The receptionist is here)(, fighting [^\.!]+.|)" tfMobsubstWhitebridgeReceptionist = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The receptionist @{Cgreen}(N, 100, human?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Dargen Golch stands before you writing trollkilling contracts\.|Dargen Golch is here)(, fighting [^\.!]+.|)" tfMobsubstWhitebridgeDargenGolch = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Dargen Golch @{Cgreen}(N, 99, QM, human?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A mean man with an array of weaponry designed to kill trolls stands here\.|A Trollkiller is here)(, fighting [^\.!]+.|)" tfMobsubstWhitebridgeTrollkiller = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Trollkiller @{Cgreen}(N, 1-90, human?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A dock hand is here working\.|A Dock Hand is here)(, fighting [^\.!]+.|)" tfMobsubstWhitebridgeDockHand = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A Dock Hand @{Cgreen}(N, 1-90, human?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(Baxter, a purveyor of fine armors, is busy replenishing stock in the shop\.|Baxter is here)(, fighting [^\.!]+.|)" tfMobsubstWhitebridgeBaxter = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Baxter @{Cgreen}(N, 100, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A suspicious sailor is hanging around here\.|An Incognito Pirate is here)(, fighting [^\.!]+.|)" tfMobsubstWhitebridgeIncognitoPirate = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An Incognito Pirate @{Cgreen}(N, 1-90, human?)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An experienced boatswain is here selling dinghys to the public\.|Yveyo the boatswain is here)(, fighting [^\.!]+.|)" tfMobsubstWhitebridgeYveyoTheBoatswain = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Yveyo the boatswain @{Cgreen}(N, 100, shopkeeper)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A golden statue of the First Chancellor of Whitebridge has been installed here\.|The Golem of Keleof Dragonmoon, the First Chancellor is here)(, fighting [^\.!]+.|)" tfMobsubstWhitebridgeKeleofDragonmoon = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Golem of Keleof Dragonmoon... @{Cgreen}(N, 1-90, ???)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A golden statue of the Second Chancellor of Whitebridge has been installed here\.|The Golem of Isen Shadowlock, the Second Chancellor is here)(, fighting [^\.!]+.|)" tfMobsubstWhitebridgeIsenShadowlock = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Golem of Isen Shadowlock... @{Cgreen}(N, 1-90, ???)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A golden statue of the Third Chancellor of Whitebridge has been installed here\.|The Golem of Leying Greendawn, the Third Chancellor is here)(, fighting [^\.!]+.|)" tfMobsubstWhitebridgeLeyingGreendawn = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Golem of Leying Greendawn... @{Cgreen}(N, 1-90, ???)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A golden statue of the Fourth Chancellor of Whitebridge has been installed here\.|The Golem of Redmark Fallrage, the Fourth Chancellor is here)(, fighting [^\.!]+.|)" tfMobsubstWhitebridgeRedmarkFallrage = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Golem of Redmark Fallrage... @{Cgreen}(N, 1-90, ???)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A golden statue of the Fifth Chancellor of Whitebridge has been installed here\.|The Golem of Masdeb Helmbreak, the Fifth Chancellor is here)(, fighting [^\.!]+.|)" tfMobsubstWhitebridgeMasdebHelmbreak = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Golem of Masdeb Helmbreak... @{Cgreen}(N, 1-90, ???)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A golden statue of the Sixth Chancellor of Whitebridge has been installed here\.|The Golem of Debthas Hawktree, the Sixth Chancellor is here)(, fighting [^\.!]+.|)" tfMobsubstWhitebridgeDebthasHawktree = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Golem of Debthas Hawktree... @{Cgreen}(N, 1-90, ???)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A golden statue of the Seventh Chancellor of Whitebridge has been installed here\.|The Golem of Armuel Blackspear, the Seventh Chancellor is here)(, fighting [^\.!]+.|)" tfMobsubstWhitebridgeArmuelBlackspear = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Golem of Armuel Blackspear... @{Cgreen}(N, 1-90, ???)@{n}%{P2}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A golden statue of the Eighth Chancellor of Whitebridge has been installed here\.|The Golem of Dasean Nightbreaker, the Eighth Chancellor is here)(, fighting [^\.!]+.|)" tfMobsubstWhitebridgeDaseanNightbreaker = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Golem of Dasean Nightbreaker... @{Cgreen}(N, 1-90, ???)@{n}%{P2}%{PR}%; \
    /endif




; -----------------------  Woods of Whispers  -----------------------
/def -p99 -F -mregexp -t"A giant black beetle runs past your feet in its search for food." tfMobsubstWoodsOfWhispersBeetle = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A black beetle @{Cgreen}(lvl 15, ???)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"A gigantic mosquito is buzzing around among the trees." tfMobsubstWoodsOfWhispersMosquito = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A gigantic culicidae-mosquito @{Cgreen}(lvl 10, ???)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"A small red and white fox is prowling between the trees." tfMobsubstWoodsOfWhispersFox = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A fox @{Cgreen}(lvl 28, ???)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"A tiny roe deer seems to be separated from its mother." tfMobsubstWoodsOfWhispersDeerTiny = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A tiny roe deer @{Cgreen}(lvl 32, ???)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"A large black ant with huge tusks is patrolling the area." tfMobsubstWoodsOfWhispersAnt = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A giant warrior ant @{Cgreen}(lvl 22, ???)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"A huge lynx is prowling the woods of whispers, searching for prey." tfMobsubstWoodsOfWhispersLynx = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A prowling lynx @{Cgreen}(lvl 36, ???)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"A healthy adult deer is eating some grass beside an old spruce." tfMobsubstWoodsOfWhispersDeerAdult = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An adult deer @{Cgreen}(lvl 39, ???)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"The moose is furiously stamping in the ground as he is about to charge!" tfMobsubstWoodsOfWhispersMoose = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An aggressive moose @{Cgreen}(lvl 52-54, mental/gas)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"An oak, probably several centuries old, is proudly walking with giant steps." tfMobsubstWoodsOfWhispersAOakenEnt = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Ancient Oaken Ent @{Cgreen}(lvl 93, ???)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"A brown bear is peacefully eating berries from the undergrowth." tfMobsubstWoodsOfWhispersBrownBear = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A brown bear @{Cgreen}(lvl 47-51, ???)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"A powerful-looking wild boar grunts as he grubs the soil." tfMobsubstWoodsOfWhispersWildBoar = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A wild boar @{Cgreen}(lvl 45, ???)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"A strangely creaking birch appears to be walking around!" tfMobsubstWoodsOfWhispersEntOfBirch = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An Ent of Birch @{Cgreen}(lvl 83, ???)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"An ancient Birch-tree is standing silently in the forest." tfMobsubstWoodsOfWhispersAEntOfBirch = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The ancient Ent of Birch @{Cgreen}(lvl 89, ???)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"A mythical birch ent is standing here, seemingly smaller than other trees." tfMobsubstWoodsOfWhispersYEntOfBirch = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A young Ent of Birch @{Cgreen}(lvl 76, ???)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"A big and furious earwig is snapping its claw at everything in sight." tfMobsubstWoodsOfWhispersAngryEarwig = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An angry earwig @{Cgreen}(lvl 17, ???)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"An ancient tree of ash peacefully roams the whispering woods." tfMobsubstWoodsOfWhispersAEntOfAsh = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The ancient Ent of Ash @{Cgreen}(lvl 88, ???)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"A silver-colored wolf is prowling the woods, constantly hunting." tfMobsubstWoodsOfWhispersHungryWolf = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A hungry wolf @{Cgreen}(lvl 46, ???)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"An Ent of Ash is standing here, communicating with its fellow kin." tfMobsubstWoodsOfWhispersEntOfAsh = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An Ent of Ash @{Cgreen}(lvl 82, ???)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"A large moose is standing between some trees, eyeing you suspiciously." tfMobsubstWoodsOfWhispersAMoose = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A moose @{Cgreen}(lvl 41-46, ???)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"The old mountain ash is whispering as it communicates with its fellow kin." tfMobsubstWoodsOfWhispersAEntOfMAsh = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The ancient Ent of Mountain Ash @{Cgreen}(lvl 92, ???)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"A small mountain ash is walking around the woods of whispers." tfMobsubstWoodsOfWhispersYEntOfMAsh = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A young Ent of Mountain Ash @{Cgreen}(lvl 80, ???)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"The leaves of the mountain-ash rustle as it wanders past you." tfMobsubstWoodsOfWhispersEntOfMAsh = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An Ent of Mountain-Ash @{Cgreen}(lvl 86, ???)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"A mythical but seemingly lesser spruce is roaming the woods here." tfMobsubstWoodsOfWhispersYEntOfSpruce = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A young Ent of Spruce @{Cgreen}(lvl 77, ???)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"An old and tall spruce is seeking refuge deep within the forest." tfMobsubstWoodsOfWhispersAEntOfSpruce = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The ancient Ent of Spruce @{Cgreen}(lvl 90, ???)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"A mythical oak is wandering by, nurturing trees and plants nearby." tfMobsubstWoodsOfWhispersOakenEnt = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An Oaken Ent @{Cgreen}(lvl 87, ???)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"An adult troll, looking very dangerous, stands here guarding its pack!" tfMobsubstWoodsOfWhispersAdultTroll = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An adult troll @{Cgreen}(lvl 72-73, troll)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"An odd, medium-sized, stone is placed among the trees." tfMobsubstWoodsOfWhispersAdultTrollRock = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An adult troll @{Cgreen}(lvl 72-73, troll) - RockForm@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"A young forest troll is standing here, baffled by your presence." tfMobsubstWoodsOfWhispersYoungTroll = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A young troll @{Cgreen}(lvl 64, troll)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"A very large and strange stone stands between some trees." tfMobsubstWoodsOfWhispersYoungTrollRock = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A young troll @{Cgreen}(lvl 64, troll) - RockForm@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"A large cockroach is crawling on the floor here." tfMobsubstWoodsOfWhispersCockroach = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A large cockroach @{Cgreen}(lvl 13, ???)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"A tall pine with a thick trunk is standing here, taking care of its kin." tfMobsubstWoodsOfWhispersEntOfPine = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An Ent of Pine @{Cgreen}(lvl 85, ???)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"A huge green-glowing frog sits on a twig, waiting for a buzzing fly to catch." tfMobsubstWoodsOfWhispersGreenGlowingFrog = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A green-glowing frog @{Cgreen}(lvl 25, ???)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"An aggressive soldier ant protects the workers by marching beside them." tfMobsubstWoodsOfWhispersSoldierAnt = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A soldier ant @{Cgreen}(lvl 16, ???, hp?)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"The red worker is busy carrying food supplies and straws back to its hive." tfMobsubstWoodsOfWhispersRedWorkerAnt = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A red worker ant @{Cgreen}(lvl 13, ???, hp?)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"A young Ent of Ash is pacing around the forest, looking for any intruders." tfMobsubstWoodsOfWhispersYEntOfAsh = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A young Ent of Ash @{Cgreen}(lvl 75, ???)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"A giant worker ant is bringing back supplies to the anthill." tfMobsubstWoodsOfWhispersWorkerAnt = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A giant worker ant @{Cgreen}(lvl 18, ???)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"A mythical tree of Spruce is wandering around, aware of its enemies!" tfMobsubstWoodsOfWhispersEntOfSpruce = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}An Ent of Spruce @{Cgreen}(lvl 84, ???)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"A young oak is standing here, creaking violently as it turns towards you." tfMobsubstWoodsOfWhispersYOakenEnt = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A young Oaken Ent @{Cgreen}(lvl 79, ???)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"A thick and grand pine is furiously waving its branches to intimidate you." tfMobsubstWoodsOfWhispersAEntOfPine = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The ancient Ent of Pine @{Cgreen}(lvl 91-94, ???)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"A fat badger is hiding in the opening of its den." tfMobsubstWoodsOfWhispersFatBadger = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A fat badger @{Cgreen}(lvl 33, ???(hp))@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"A tiny pine-tree is moving between some larger trees here." tfMobsubstWoodsOfWhispersYEntOfPine = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A young Ent of Pine @{Cgreen}(lvl 78, ???)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"A powerful and irritated grizzly bear rises on its back feet and roars!" tfMobsubstWoodsOfWhispersGrizzlyBear = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}A grizzly bear @{Cgreen}(lvl 59, ???)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(The ancient tree awakens with a crash and plunges forward to secure your|Angry ash is here)" tfMobsubstWoodsOfWhispersAngryAsh = \
    /let mobName=@{nCyellow}Angry ash @{Cgreen}(lvl 100, ???)@{n}%; \
    /if (mobsubs & {P1} =~ "Angry ash is here") \
      /substitute -p %{PL}%{mobName}%{PR}%; \
    /elseif (mobsubs) \
      /substitute%; \
      /def -p99 -F -n1 -mregexp -t"imminent death!" tfMobsubstSpecial = \
        /substitute -p %%{PL}%{mobName}%%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(A black-hooded lady is standing here, chanting in a foul tongue\.|Zhariana is here)" tfMobsubstWoodsOfWhispersZhariana = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Zhariana @{Cgreen}(lvl ?, ???, agg/noflee/norecall)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"The Shining White-witch is facing the altar." tfMobsubstWoodsOfWhispersSharae = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}Sharae @{Cgreen}(lvl 100, ???, noflee/norecall)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"(An imprisoned monstrosity of a beast roars at you!|The Grawlth is here)" tfMobsubstWoodsOfWhispersGrawlth = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The Grawlth @{Cgreen}(lvl 99, light or pure?, noflee/norecall)@{n}%{PR}%; \
    /endif

; -----------------------  misc  -----------------------
/def -p99 -F -mregexp -t"A mean looking troll is standing here." tfMobsubst1 = \
    /if (mobsubs) \
      /substitute -p %{PL}@{hCyellow}Rampgruff @{Cgreen}(lvl 50, fire/slay troll)@{n}%{PR}%; \
    /else \
      /substitute -p @{nCyellow}A mean looking troll is standing here.@{h} (Rampgruff)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"A strange man is here, grinning at you roguishly." tfMobsubst3 = \
    /if (mobsubs) \
      /substitute -p %{PL}@{hCyellow}Riddling Rover @{Cgreen}(lvl 84, QM)@{n}%{PR}%; \
    /else \
      /substitute -p @{nCyellow}A strange man is here, grinning at you roguishly.@{h} (Riddling Rover)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"The actual mother of all fish flops around in the water here" tfMobsubst31 = \
    /if (mobsubs) \
      /substitute -p %{PL}@{nCyellow}The jumbo fish @{hCyellow}(Mother) @{Cgreen}(lvl 18, fish)@{n}%{PR}%; \
    /else \
      /substitute -p @{nCyellow}The actual mother of all fish flops around in the water here@{h} (Mother)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"An indigo gremlin is here, plotting the downfall of the pixies." tfMobsubst51 = \
    /if (mobsubs) \
      /substitute -p %{PL}@{hCyellow}Malcor @{Cgreen}(lvl 50, fire/pure/unlife)@{n}%{PR}%; \
    /else \
      /substitute -p @{nCyellow}An indigo gremlin is here, plotting the downfall of the pixies.@{h} (Malcor)@{n}%{PR}%; \
    /endif
/def -p99 -F -mregexp -t"A haunting spirit roams the lands looking for reprisal." tfMobsubst53 = \
    /if (mobsubs) \
      /substitute -p %{PL}@{hCyellow}The accursed spirit @{Cgreen}(lvl 101, insubstantial)@{n}%{PR}%; \
    /else \
      /substitute -p @{nCyellow}A haunting spirit @{hCbgmagenta}(Accursed spirit)@{n}roams the lands looking for reprisal.%{PR}%; \
    /endif%; \
    /tfshow ________________________________%; \
    tfnextlineshow ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/def -p99 -F -mregexp -t"An undead lich troll stands menacingly here." tfMobsubst56 = \
    /if (mobsubs) \
      /substitute -p %{PL}@{hCyellow}Grell the undead lich @{Cgreen}(lvl 65, pure/light/silver/heal)@{n}%{PR}%; \
    /endif
